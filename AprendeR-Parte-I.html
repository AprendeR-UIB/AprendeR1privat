<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>AprendeR Parte I</title>
  <meta name="description" content="Apuntes AprendeR bookdown::gitbook." />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="AprendeR Parte I" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="<a href="https://aprender-uib.github.io/AprendeR1/" class="uri">https://aprender-uib.github.io/AprendeR1/</a>" />
  <meta property="og:image" content="<a href="https://aprender-uib.github.io/AprendeR1/" class="uri">https://aprender-uib.github.io/AprendeR1/</a>/_bookdown_files/14cap13_EDextra_files/figure-html/unnamed-chunk-14-1.png" />
  <meta property="og:description" content="Apuntes AprendeR bookdown::gitbook." />
  <meta name="github-repo" content="AprendeR-UIB/AprendeR1" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="AprendeR Parte I" />
  
  <meta name="twitter:description" content="Apuntes AprendeR bookdown::gitbook." />
  <meta name="twitter:image" content="<a href="https://aprender-uib.github.io/AprendeR1/" class="uri">https://aprender-uib.github.io/AprendeR1/</a>/_bookdown_files/14cap13_EDextra_files/figure-html/unnamed-chunk-14-1.png" />

<meta name="author" content="Estadística descriptiva con R" />


<meta name="date" content="2021-03-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/d3-3.5.3/d3.min.js"></script>
<link href="libs/colorbrewer-1/colorbrewer.css" rel="stylesheet" />
<script src="libs/colorbrewer-1/colorbrewer.js"></script>
<link href="libs/streamgraph-1/streamgraph.css" rel="stylesheet" />
<script src="libs/streamgraph-binding-0.9.0/streamgraph.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">AprendeR Parte I</h1>
<h2 class="subtitle"><em>The UIB-AprendeR team</em></h2>
<p class="author"><em>Estadística descriptiva con R</em></p>
<p class="date"><em>2021-03-17</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#presentación">Presentación</a></li>
<li><a href="#part-parte-i-r-básico">(PART*) Parte I: R básico</a></li>
<li><a href="#chap:0"><span class="toc-section-number">1</span> Logística de R</a>
<ul>
<li><a href="#cómo-instalar-r-y-rstudio"><span class="toc-section-number">1.1</span> Cómo instalar R y <em>RStudio</em></a></li>
<li><a href="#sec:guardar"><span class="toc-section-number">1.2</span> Cómo guardar el trabajo realizado</a></li>
<li><a href="#sec:guiones"><span class="toc-section-number">1.3</span> Cómo trabajar con guiones y otros ficheros</a></li>
<li><a href="#sec:help"><span class="toc-section-number">1.4</span> Cómo obtener ayuda</a></li>
<li><a href="#sec:paquetes"><span class="toc-section-number">1.5</span> Cómo instalar y cargar paquetes</a></li>
<li><a href="#guía-rápida"><span class="toc-section-number">1.6</span> Guía rápida</a></li>
</ul></li>
<li><a href="#chap:calc"><span class="toc-section-number">2</span> La calculadora</a>
<ul>
<li><a href="#números-reales-operaciones-y-funciones-básicas"><span class="toc-section-number">2.1</span> Números reales: operaciones y funciones básicas</a></li>
<li><a href="#cifras-significativas-y-redondeos"><span class="toc-section-number">2.2</span> Cifras significativas y redondeos</a></li>
<li><a href="#definición-de-variables"><span class="toc-section-number">2.3</span> Definición de variables</a></li>
<li><a href="#definición-de-funciones"><span class="toc-section-number">2.4</span> Definición de funciones</a></li>
<li><a href="#números-complejos-opcional"><span class="toc-section-number">2.5</span> Números complejos (opcional)</a></li>
<li><a href="#guía-rápida-1"><span class="toc-section-number">2.6</span> Guía rápida</a></li>
<li><a href="#ejercicios"><span class="toc-section-number">2.7</span> Ejercicios</a>
<ul>
<li><a href="#test">Test</a></li>
<li><a href="#ejercicio">Ejercicio</a></li>
<li><a href="#respuestas-al-test">Respuestas al test</a></li>
</ul></li>
</ul></li>
<li><a href="#chap:lm"><span class="toc-section-number">3</span> Un aperitivo: Introducción a la regresión lineal</a>
<ul>
<li><a href="#sec:introlm"><span class="toc-section-number">3.1</span> Cálculo de rectas de regresión</a></li>
<li><a href="#rectas-de-regresión-y-transformaciones-logarítmicas"><span class="toc-section-number">3.2</span> Rectas de regresión y transformaciones logarítmicas</a></li>
<li><a href="#guía-rápida-2"><span class="toc-section-number">3.3</span> Guía rápida</a></li>
<li><a href="#ejercicios-1"><span class="toc-section-number">3.4</span> Ejercicios</a>
<ul>
<li><a href="#ejercicio-1">Ejercicio</a></li>
</ul></li>
</ul></li>
<li><a href="#chap:vect"><span class="toc-section-number">4</span> Vectores y otros tipos de listas</a>
<ul>
<li><a href="#sec:vect"><span class="toc-section-number">4.1</span> Construcción de vectores</a></li>
<li><a href="#operaciones-con-vectores"><span class="toc-section-number">4.2</span> Operaciones con vectores</a></li>
<li><a href="#entradas-y-trozos-de-vectores"><span class="toc-section-number">4.3</span> Entradas y trozos de vectores</a></li>
<li><a href="#subsec:factor"><span class="toc-section-number">4.4</span> Factores</a></li>
<li><a href="#sec:lists"><span class="toc-section-number">4.5</span> Listas heterogéneas</a></li>
<li><a href="#guía-rápida-de-funciones"><span class="toc-section-number">4.6</span> Guía rápida de funciones</a></li>
<li><a href="#ejercicios-2"><span class="toc-section-number">4.7</span> Ejercicios</a>
<ul>
<li><a href="#test-1">Test</a></li>
<li><a href="#ejercicio-2">Ejercicio</a></li>
<li><a href="#respuestas-al-test-1">Respuestas al test</a></li>
</ul></li>
</ul></li>
<li><a href="#chap:matrix"><span class="toc-section-number">5</span> Matrices</a>
<ul>
<li><a href="#construcción-de-matrices"><span class="toc-section-number">5.1</span> Construcción de matrices</a></li>
<li><a href="#sec:entrmatr"><span class="toc-section-number">5.2</span> Acceso a entradas y submatrices</a></li>
<li><a href="#algunas-funciones-para-matrices"><span class="toc-section-number">5.3</span> Algunas funciones para matrices</a></li>
<li><a href="#cálculo-matricial"><span class="toc-section-number">5.4</span> Cálculo matricial</a></li>
<li><a href="#valores-y-vectores-propios"><span class="toc-section-number">5.5</span> Valores y vectores propios</a></li>
<li><a href="#matrices-complejas-opcional"><span class="toc-section-number">5.6</span> Matrices complejas (opcional)</a></li>
<li><a href="#guía-rápida-de-funciones-1"><span class="toc-section-number">5.7</span> Guía rápida de funciones</a></li>
<li><a href="#ejercicios-3"><span class="toc-section-number">5.8</span> Ejercicios</a>
<ul>
<li><a href="#test-2">Test</a></li>
<li><a href="#ejercicio-3">Ejercicio</a></li>
<li><a href="#respuestas-al-test-2">Respuestas al test</a></li>
</ul></li>
</ul></li>
<li><a href="#chap:df"><span class="toc-section-number">6</span> <em>Data frames</em></a>
<ul>
<li><a href="#estructura-de-un-data-frame"><span class="toc-section-number">6.1</span> Estructura de un <em>data frame</em></a></li>
<li><a href="#cómo-importar-y-exportar-data-frames"><span class="toc-section-number">6.2</span> Cómo importar y exportar <em>data frames</em></a></li>
<li><a href="#cómo-crear-data-frames"><span class="toc-section-number">6.3</span> Cómo crear <em>data frames</em></a></li>
<li><a href="#sec:moddf"><span class="toc-section-number">6.4</span> Cómo modificar un <em>data frame</em></a></li>
<li><a href="#sec:dfaf"><span class="toc-section-number">6.5</span> Cómo añadir filas y columnas a un <em>data frame</em></a></li>
<li><a href="#cómo-seleccionar-trozos-de-un-data-frame"><span class="toc-section-number">6.6</span> Cómo seleccionar trozos de un <em>data frame</em></a></li>
<li><a href="#cómo-aplicar-una-función-a-las-variables-de-un-data-frame"><span class="toc-section-number">6.7</span> Cómo aplicar una función a las variables de un <em>data frame</em></a></li>
<li><a href="#sub:attach"><span class="toc-section-number">6.8</span> Cómo añadir las variables de un <em>data frame</em> al entorno global</a></li>
<li><a href="#guía-rápida-de-funciones-2"><span class="toc-section-number">6.9</span> Guía rápida de funciones</a></li>
<li><a href="#ejercicios-4"><span class="toc-section-number">6.10</span> Ejercicios</a>
<ul>
<li><a href="#test-3">Test</a></li>
<li><a href="#ejercicio-4">Ejercicio</a></li>
<li><a href="#respuestas-al-test-3">Respuestas al test</a></li>
</ul></li>
</ul></li>
<li><a href="#chap:plot"><span class="toc-section-number">7</span> Gráficos básicos</a>
<ul>
<li><a href="#la-función-plot"><span class="toc-section-number">7.1</span> La función <code>plot</code></a></li>
<li><a href="#parámetros-de-plot"><span class="toc-section-number">7.2</span> Parámetros de <code>plot</code></a></li>
<li><a href="#cómo-añadir-elementos-a-un-gráfico"><span class="toc-section-number">7.3</span> Cómo añadir elementos a un gráfico</a></li>
<li><a href="#guía-rápida-3"><span class="toc-section-number">7.4</span> Guía rápida</a></li>
<li><a href="#ejercicios-5"><span class="toc-section-number">7.5</span> Ejercicios</a>
<ul>
<li><a href="#test-4">Test</a></li>
<li><a href="#ejercicio-5">Ejercicio</a></li>
<li><a href="#respuestas-al-test-4">Respuestas al test</a></li>
</ul></li>
</ul></li>
<li><a href="#chap:for"><span class="toc-section-number">8</span> Estructuras de control básicas</a>
<ul>
<li><a href="#bucles-de-tipo-for"><span class="toc-section-number">8.1</span> Bucles de tipo “for”</a></li>
<li><a href="#bucles-de-tipo-while"><span class="toc-section-number">8.2</span> Bucles de tipo “while”</a></li>
<li><a href="#estructuras-condicionales"><span class="toc-section-number">8.3</span> Estructuras condicionales</a></li>
<li><a href="#guía-rápida-de-funciones-3"><span class="toc-section-number">8.4</span> Guía rápida de funciones</a></li>
<li><a href="#ejercicios-6"><span class="toc-section-number">8.5</span> Ejercicios</a>
<ul>
<li><a href="#test-5">Test</a></li>
<li><a href="#ejercicio-6">Ejercicio</a></li>
<li><a href="#respuestas-al-test-5">Respuestas al test</a></li>
</ul></li>
</ul></li>
<li><a href="#chap:distr"><span class="toc-section-number">9</span> Distribuciones de probabilidad</a>
<ul>
<li><a href="#ejercicios-7"><span class="toc-section-number">9.1</span> Ejercicios</a>
<ul>
<li><a href="#test-6">Test</a></li>
<li><a href="#problemas">Problemas</a></li>
<li><a href="#respuestas-al-test-6">Respuestas al test</a></li>
<li><a href="#soluciones-sucintas-de-los-problemas">Soluciones sucintas de los problemas</a></li>
</ul></li>
</ul></li>
<li><a href="#part-parte-ii-estadística-descriptiva">(PART*) Parte II: Estadística descriptiva</a></li>
<li><a href="#chap:edqual"><span class="toc-section-number">10</span> Descripción de datos cualitativos</a>
<ul>
<li><a href="#sec:edqual"><span class="toc-section-number">10.1</span> Frecuencias</a></li>
<li><a href="#tablas-unidimensionales-de-frecuencias"><span class="toc-section-number">10.2</span> Tablas unidimensionales de frecuencias</a></li>
<li><a href="#tablas-bidimensionales-de-frecuencias"><span class="toc-section-number">10.3</span> Tablas bidimensionales de frecuencias</a></li>
<li><a href="#tablas-multidimensionales-de-frecuencias"><span class="toc-section-number">10.4</span> Tablas multidimensionales de frecuencias</a></li>
<li><a href="#tablas-a-partir-de-data-frames-de-variables-cualitativas"><span class="toc-section-number">10.5</span> Tablas a partir de <em>data frames</em> de variables cualitativas</a></li>
<li><a href="#diagramas-de-barras"><span class="toc-section-number">10.6</span> Diagramas de barras</a></li>
<li><a href="#otros-gráficos-para-datos-cualitativos"><span class="toc-section-number">10.7</span> Otros gráficos para datos cualitativos</a></li>
<li><a href="#sec:exqual"><span class="toc-section-number">10.8</span> Un ejemplo completo</a></li>
<li><a href="#guía-rápida-de-funciones-4"><span class="toc-section-number">10.9</span> Guía rápida de funciones</a></li>
<li><a href="#ejercicios-8"><span class="toc-section-number">10.10</span> Ejercicios</a>
<ul>
<li><a href="#test-7">Test</a></li>
<li><a href="#ejercicio-7">Ejercicio</a></li>
<li><a href="#respuestas-al-test-7">Respuestas al test</a></li>
</ul></li>
</ul></li>
<li><a href="#chap:ord"><span class="toc-section-number">11</span> Descripción de datos ordinales</a>
<ul>
<li><a href="#frecuencias-para-datos-ordinales"><span class="toc-section-number">11.1</span> Frecuencias para datos ordinales</a></li>
<li><a href="#descripción-de-datos-ordinales-con-r"><span class="toc-section-number">11.2</span> Descripción de datos ordinales con R</a></li>
<li><a href="#guía-rápida-de-funciones-5"><span class="toc-section-number">11.3</span> Guía rápida de funciones</a></li>
<li><a href="#ejercicios-9"><span class="toc-section-number">11.4</span> Ejercicios</a>
<ul>
<li><a href="#test-8">Test</a></li>
<li><a href="#ejercicio-8">Ejercicio</a></li>
<li><a href="#respuestas-al-test-8">Respuestas al test</a></li>
</ul></li>
</ul></li>
<li><a href="#chap:quan"><span class="toc-section-number">12</span> Descripción de datos cuantitativos</a>
<ul>
<li><a href="#sec:quan"><span class="toc-section-number">12.1</span> Frecuencias</a></li>
<li><a href="#medidas-de-tendencia-central"><span class="toc-section-number">12.2</span> Medidas de tendencia central</a></li>
<li><a href="#medidas-de-posición"><span class="toc-section-number">12.3</span> Medidas de posición</a></li>
<li><a href="#medidas-de-dispersión"><span class="toc-section-number">12.4</span> Medidas de dispersión</a></li>
<li><a href="#diagramas-de-caja"><span class="toc-section-number">12.5</span> Diagramas de caja</a></li>
<li><a href="#guía-rápida-de-funciones-6"><span class="toc-section-number">12.6</span> Guía rápida de funciones</a></li>
<li><a href="#ejercicios-10"><span class="toc-section-number">12.7</span> Ejercicios</a>
<ul>
<li><a href="#test-9">Test</a></li>
<li><a href="#ejercicio-9">Ejercicio</a></li>
<li><a href="#respuestas-al-test-9">Respuestas al test</a></li>
</ul></li>
</ul></li>
<li><a href="#chap:hist"><span class="toc-section-number">13</span> Datos cuantitativos agrupados</a>
<ul>
<li><a href="#cómo-agrupar-datos"><span class="toc-section-number">13.1</span> Cómo agrupar datos</a></li>
<li><a href="#sec:agrupR"><span class="toc-section-number">13.2</span> Agrupamiento de datos con R</a></li>
<li><a href="#estadísticos-para-datos-agrupados"><span class="toc-section-number">13.3</span> Estadísticos para datos agrupados</a></li>
<li><a href="#sec:hist"><span class="toc-section-number">13.4</span> Histogramas</a></li>
<li><a href="#guía-rápida-de-funciones-7"><span class="toc-section-number">13.5</span> Guía rápida de funciones</a></li>
<li><a href="#ejercicios-11"><span class="toc-section-number">13.6</span> Ejercicios</a>
<ul>
<li><a href="#test-10">Test</a></li>
<li><a href="#ejercicio-10">Ejercicio</a></li>
<li><a href="#respuestas-al-test-10">Respuestas al test</a></li>
</ul></li>
</ul></li>
<li><a href="#gráficos-avanzados"><span class="toc-section-number">14</span> Gráficos avanzados</a>
<ul>
<li><a href="#nubes-de-palabras-o-de-etiquetas-word-clouds"><span class="toc-section-number">14.1</span> Nubes de palabras o de etiquetas (<em>word clouds</em>)</a></li>
<li><a href="#mapa-de-calor-o-heatmap"><span class="toc-section-number">14.2</span> Mapa de calor o <em>heatmap</em></a></li>
<li><a href="#sec:dendr"><span class="toc-section-number">14.3</span> Dendrogramas</a></li>
<li><a href="#gráficos-de-burbujas-o-bubbles"><span class="toc-section-number">14.4</span> Gráficos de burbujas o <em>bubbles</em></a></li>
<li><a href="#gráficos-de-corrientes-o-streamgraphs"><span class="toc-section-number">14.5</span> Gráficos de corrientes o <em>streamgraphs</em></a></li>
<li><a href="#guía-rápida-4"><span class="toc-section-number">14.6</span> Guía rápida</a></li>
</ul></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">AprendeR Parte I</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="presentación" class="section level1 unnumbered">
<h1 class="unnumbered">Presentación</h1>
<p>Edición preliminar en línea de la 1a parte del libro <em>AprendeR</em>, producido por un grupo de profesores del Departamento de Ciencias Matemáticas e Informática de la UIB.</p>
<p>El libro está escrito en <em>R Markdown</em>, usando <em>RStudio</em> como editor de texto y el paquete <strong>bookdown</strong> para convertir los ficheros <em>markdown</em> en un libro.</p>
<p>Este trabajo se publica bajo licencia <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">Atribución-No Comercial-SinDerivadas 4.0</a></p>
<!--chapter:end:index.Rmd-->
</div>
<div id="part-parte-i-r-básico" class="section level1 unnumbered">
<h1 class="unnumbered">(PART*) Parte I: R básico</h1>
</div>
<div id="chap:0" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Logística de R</h1>
<p>R es un entorno de programación para el análisis estadístico y gráfico de datos muy popular, cada día más utilizado en empresas y universidades. Su uso tiene muchas ventajas. Para empezar, es <em>software</em> libre. La elección de <em>software</em> libre es, en general, acertada por varios motivos. Por un lado, transmite valores socialmente positivos, como por ejemplo la libertad individual, el conocimiento compartido, la solidaridad y la cooperación. Por otro, nos aproxima al método científico, porque permite el examen y mejora del código desarrollado por otros usuarios y la reproducibilidad de los resultados obtenidos. Finalmente, pero no menos importante desde un punto de vista práctico, podemos adquirir de manera legal y gratuita copias del programa, sin necesidad de licencias personales o académicas.</p>
<p>Aparte de su faceta de <em>software</em> libre, R tiene algunas ventajas específicas: por ejemplo, su sintaxis básica es sencilla e intuitiva, con la que es muy fácil familiarizarse, lo que se traduce en un aprendizaje rápido y cómodo. Además, tiene una enorme comunidad de usuarios, estructurada alrededor de la <em>Comprehensive R Archive Network</em>, o <em>CRAN</em>, que desarrolla cada día nuevos paquetes que extienden sus funcionalidades y cubren casi todas las necesidades computacionales y estadísticas de un científico o ingeniero. Para que os hagáis una idea, en el momento de revisar estas notas (septiembre de 2019) el número de paquetes en el repositorio de la CRAN acaba de superar los 15000.</p>
<div id="cómo-instalar-r-y-rstudio" class="section level2" number="1.1">
<h2 number="1.1"><span class="header-section-number">1.1</span> Cómo instalar R y <em>RStudio</em></h2>
<p>Instalar R es muy sencillo; de hecho, seguramente ya lo tenéis instalado en vuestro ordenador, pero es conveniente que dispongáis de su versión más reciente y que regularmente lo pongáis al día. Los pasos a realizar en Windows o Mac OS X para instalar su última versión son los siguientes:</p>
<ul>
<li><p>Si sois usuarios de Windows, acceded a la página web de la <a href="http://cran.r-project.org/"><em>CRAN</em></a> y pulsad sobre el enlace <em>Download R for Windows</em>. A continuación, entrad en el enlace <em>base</em>, descargad R y seguid las instrucciones de instalación del documento <em>Installation and other instructions</em> que encontraréis en esa misma página.</p></li>
<li><p>Si sois usuarios de Mac OS X, acceded a la página web de la <a href="http://cran.r-project.org/"><em>CRAN</em></a> y pulsad sobre el enlace <em>Download R for Mac OS X</em>. A continuación, descargad el fichero <code>.pkg</code> correspondiente y, una vez descargado, abridlo y seguid las instrucciones del Asistente de Instalación.</p></li>
<li><p>Si trabajáis con Ubuntu o Debian, para instalar la última versión de R basta que ejecutéis en una terminal, estando conectados a Internet, la siguiente instrucción:</p></li>
</ul>
<pre><code>sudo aptitude install r-base</code></pre>
<p>Cuando instaláis R para Windows o Mac OS X, con él también se os instala una interfaz gráfica que se abrirá al abrir la aplicación y en la que podréis trabajar. La instalación para Linux no lleva una interfaz por defecto, así que sus usuarios tienen que trabajar con R en la terminal (ejecutando R para iniciar una sesión) o instalar aparte una interfaz. Independientemente de todas estas posibilidades, en este curso usaremos <em>RStudio</em> como interfaz gráfica de usuario de R para todos los sistemas operativos.</p>
<p>Propiamente hablando, <em>RStudio</em> es mucho más que una interfaz de R: se trata de todo un entorno integrado para utilizar y programar con R, que dispone de un conjunto de herramientas que facilitan el trabajo con este lenguaje. Para instalarlo, se ha de descargar del <em>url</em> <a href="http://www.rstudio.com/products/rstudio/download/">http://www.rstudio.com/products/rstudio/download/</a> la versión correspondiente al sistema operativo en el que se trabaja; en cada caso, escoged la versión gratuita de <em>RStudio Desktop</em>. Una vez descargado, si usáis Windows o Mac OS X ya lo podéis abrir directamente. En el caso de Linux, hay que ejecutar en una terminal la siguiente instrucción para completar su instalación:</p>
<pre><code>sudo dpkg -i rstudio-&lt;version&gt;-i386.deb</code></pre>
<p>donde <code>version</code> refiere a la versión concreta que hayáis descargado. Conviene recordar que <em>RStudio</em> no es R, ni tan sólo lo contiene: hay que instalar ambos programas. De hecho, las instalaciones de R y <em>RStudio</em> son independientes una de la otra, de manera que cuando se pone al día uno de estos programas, no se modifica el otro.</p>
<div class="figure" style="text-align: center">
<img src="AprendeR-Parte-I_files/figure-html/rstudio1.png" alt="Ventana de RStudio para Mac OS X." width="80%" />
<p class="caption">
(#fig:rstudio1)Ventana de RStudio para Mac OS X.
</p>
</div>
<p>Cuando se abre <em>RStudio</em>, aparece una ventana similar a la que muestra la Figura @ref(fig:rstudio1): su apariencia exacta dependerá del sistema operativo, de la versión de <em>RStudio</em> e incluso de los paquetes que estemos usando. De momento, nos concentraremos en la ventana de la izquierda, llamada la <strong>consola</strong> de R (la pestaña <em>Console</em>). Observaréis que en el momento de abrir la aplicación, dicha ventana contiene una serie de información (versión,
créditos etc.) y al final una línea en blanco encabezada por el símbolo <code>&gt;</code>. Este símbolo es la <strong>marca de inicio</strong> e indica que R espera que escribáis alguna instrucción y la ejecutéis.</p>
<p>Durante la mayor parte de este curso, usaremos <em>RStudio</em> de manera interactiva:</p>
<ol style="list-style-type: decimal">
<li>Escribiremos una instrucción en la consola, a la derecha de la marca de inicio de su última línea.</li>
<li>La ejecutaremos pulsando la tecla <em>Entrar</em> (<span class="math inline">\(\hookleftarrow\)</span>).</li>
<li>R la evaluará y, si corresponde, escribirá el resultado en la línea siguiente de la consola (como veremos, no todas las instrucciones hacen que R escriba algo).</li>
<li>R abrirá una nueva línea en blanco encabezada por una marca de inicio, donde esperará una nueva instrucción.</li>
</ol>
<p>Haced una prueba: escribid <code>1+1</code> junto a la marca de inicio y pulsad <em>Entrar</em>; R escribirá en la línea siguiente el resultado de la suma, <code>2</code>, y a continuación una nueva línea en blanco encabezada por la marca de inicio.
Ya hablaremos en la Lección @ref(chap:vect) del <code>[1]</code> que os habrá aparecido delante del 2 en el resultado. Hasta entonces, no os preocupéis por él. En los bloques de código de este libro no incluimos la marca de inicio, para que podáis copiar tranquilamente el código y luego pegarlo y ejecutarlo en vuestra consola, y el resultado aparece precedido de <code>##</code>, para que si por descuido copiáis un resultado, no se ejecute: el símbolo <code>#</code> sirve para indicar a R que no ejecute lo que venga a continuación en la misma línea. Así, en este libro el cálculo anterior corresponde a:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="dv">1</span><span class="op">+</span><span class="dv">1</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<p>Para facilitarnos el trabajo, la consola dispone de un mecanismo para acceder a las instrucciones ya ejecutadas y modificarlas si queremos. Si situamos el cursor a la derecha de la marca de inicio de la línea inferior y pulsamos la tecla de la flecha vertical ascendente <span class="math inline">\(\uparrow\)</span>, iremos obteniendo de manera consecutiva, en esa línea, las instrucciones escritas hasta el momento en la misma sesión; si nos pasamos, podemos usar la tecla <span class="math inline">\(\downarrow\)</span> para retroceder dentro de esta lista; una vez alcanzada la instrucción deseada, podemos volver a ejecutarla o, con las teclas de flechas horizontales, ir al lugar de la instrucción que queramos y reescribir un trozo antes de ejecutarla. Otra posibilidad es usar la pestaña <em>History</em> de la ventana superior derecha de <em>RStudio</em>, que contiene la lista de todas las instrucciones que se han ejecutado en la sesión actual. Si seleccionamos una instrucción de esta lista y pulsamos el botón <em>To console</em> del menú superior de la pestaña, la instrucción se copiará en la consola y la podremos modificar o ejecutar directamente.</p>
<p>También podemos copiar instrucciones de otros ficheros y pegarlas a la derecha de la marca de inicio de la manera habitual en el sistema operativo de nuestro ordenador. Pero hay que ir con cuidado: las instrucciones copiadas de ficheros en formato que no sea texto simple pueden contener caracteres invisibles a simple vista que generen errores al intentar ejecutar la instrucción copiada. En particular, esto afecta a las instrucciones que podáis copiar de ficheros en formato PDF, procurad no hacerlo. En cambio, no hay ningún problema en copiar y pegar instrucciones de ficheros html como los de estas lecciones.</p>
<p>Volvamos a la ventana de <em>RStudio</em> de la Figura @ref(fig:rstudio1). Observaréis que está dividida a su vez en tres ventanas. La de la izquierda es la consola, donde trabajamos en modo interactivo. La ventana inferior derecha tiene algunas pestañas, entre las que destacamos:</p>
<ul>
<li><em>Files</em>, que muestra el contenido de la carpeta de trabajo actual (véase la Sección @ref(sec:guardar)). Al hacer clic sobre un fichero en esta lista, se abrirá en la ventana de ficheros (véase la Sección @ref(sec:guiones)).</li>
<li><em>Plots</em>, que muestra los gráficos que hayamos producido durante la sesión. Se puede navegar entre ellos con las flechas de la barra superior de la pestaña.</li>
<li><em>Packages</em>, que muestra todos los paquetes instalados y, marcados, los que están cargados en la sesión actual (véase la Sección @ref(sec:paquetes)).</li>
<li><em>Help</em>, donde aparecerá la ayuda que pidamos (véase la Sección @ref(sec:help)).</li>
</ul>
<p>Por lo que se refiere a la ventana superior izquierda, destacamos las dos pestañas siguientes:</p>
<ul>
<li><em>Environment</em>, con la lista de los objetos actualmente definidos (véase la Lección @ref(chap:calc)).</li>
<li><em>History</em>, de la que ya hemos hablado, que contiene la lista de todas las instrucciones que hayamos ejecutado durante la sesión.</li>
</ul>
<p>Aparte de estas tres ventanas, <em>RStudio</em> dispone de una cuarta ventana para ficheros, que se abre en el sector superior izquierdo, sobre la consola (véase la Sección @ref(sec:guiones)).</p>
<p>Para cerrar <em>RStudio</em>, basta elegir <em>Quit RStudio</em> del menú <em>RStudio</em> o
pulsar la combinación de teclas usual para cerrar un programa en vuestro sistema operativo.</p>
</div>
<div id="sec:guardar" class="section level2" number="1.2">
<h2 number="1.2"><span class="header-section-number">1.2</span> Cómo guardar el trabajo realizado</h2>
<p>Antes de empezar a utilizar R en serio, lo primero que tenéis que hacer es crear en vuestro ordenador una carpeta específica que será vuestra <strong>carpeta de trabajo</strong> con R. A continuación, en las <em>Preferencias</em> de <em>RStudio</em>, que podréis abrir desde el menú <em>RStudio</em>, tenéis que declarar esta carpeta como <em>Default working directory</em>. A partir de este momento, por defecto, todo el trabajo que realicéis quedará guardado dentro de esta carpeta, y <em>RStudio</em> buscará dentro de esta carpeta todo lo que queráis que lea.
Si en un momento determinado queréis cambiar temporalmente de carpeta de trabajo, tenéis dos opciones:</p>
<ul>
<li><p>Podéis usar el menú <em>Session</em> <span class="math inline">\(\rightarrow\)</span> <em>Set Working Directory</em> <span class="math inline">\(\rightarrow\)</span> <em>Choose Directory…</em> para escoger una carpeta.</p></li>
<li><p>Podéis abrir la pestaña <em>Files</em> de la ventana inferior derecha y navegar por el árbol de directorios que aparece en su barra superior hasta llegar a la carpeta deseada.</p></li>
</ul>
<p>Tanto de una manera como de la otra, la carpeta que especifiquéis será la carpeta de trabajo durante lo que queda de sesión o hasta que la volváis a cambiar.</p>
<p>En cualquier momento podéis guardar la sesión en la que estéis trabajando usando el menú <em>Session</em> <span class="math inline">\(\rightarrow\)</span> <em>Save Workspace as…</em>.
Además, si no habéis modificado esta opción en las <em>Preferencias</em>, cuando cerréis <em>RStudio</em> se os pedirá si queréis guardar la sesión; si contestáis que sí, <em>RStudio</em> guardará en la carpeta de trabajo dos ficheros, <code>.RData</code> y <code>.RHistory</code>, que se cargarán automáticamente al volver a abrir <em>RStudio</em> y estaréis exactamente donde lo habíais dejado. Nuestro consejo es que digáis que no: normalmente, no os interesará arrastrar todo lo que hayáis hecho en sesiones anteriores. Y si queréis guardar algunas definiciones e instrucciones de una sesión, lo más práctico es guardarlas en un <em>guión</em> (véase la Sección @ref(sec:guiones)).</p>
<p>Los gráficos que generéis con <em>RStudio</em> aparecerán en la ventana inferior derecha, en la pestaña <em>Plots</em> que se activa automáticamente cuando se crea alguno. La apariencia del gráfico dependerá de las dimensiones de esta ventana, por lo que es conveniente que sea cuadrada si queréis que el gráfico no aparezca achatado o estirado. Si modificáis la forma de la ventana, las dimensiones del gráfico que aparezca en ella se modificarán de manera automática.</p>
<p>Para guardar un gráfico, hay que ir al menú <em>Export</em> de esta pestaña y seleccionar cómo queréis guardarlo: como una imagen en uno los formatos estándares de imágenes (.png, .jpeg, .tiff, etc.) o en formato PDF. Entonces, se abrirá una ventana donde podéis darle nombre, modificar sus dimensiones y especificar el directorio donde queráis que se guarde, entre otras opciones.</p>
</div>
<div id="sec:guiones" class="section level2" number="1.3">
<h2 number="1.3"><span class="header-section-number">1.3</span> Cómo trabajar con guiones y otros ficheros</h2>
<p>R admite la posibilidad de crear y usar ficheros de instrucciones que se pueden ejecutar y guardar llamados <strong>guiones</strong> (<em>scripts</em>). Estos guiones son una alternativa muy cómoda a las sesiones interactivas, porque permiten guardar las versiones finales de las instrucciones usadas, y no toda la sesión con pruebas, errores y resultados provisionales, y facilitan la ejecución de secuencias de instrucciones en un solo paso. Además, un guión se puede guardar, volver a abrir más adelante, editar, etc. Como ya hemos comentado, el símbolo <code>#</code> sirve para indicar a R que omita todo lo que hay a su derecha en la misma línea, lo que permite añadir comentarios a un guión.</p>
<p>Para crear un guión con <em>RStudio</em>, tenéis que ir al menú <em>File</em> <span class="math inline">\(\rightarrow\)</span> <em>New File</em> <span class="math inline">\(\rightarrow\)</span> <em>R Script</em>. Veréis que os aparece una ventana nueva en el sector superior izquierdo de la ventana de <em>RStudio</em>, sobre la consola: la llamaremos <strong>ventana de ficheros</strong>. En ella podéis escribir, línea a línea, las instrucciones que queráis. Para ejecutar instrucciones de esta ventana, basta que las seleccionéis y pulséis el botón <em>Run</em> que aparece en la barra superior de esta ventana.</p>
<p>Para guardar un guión, basta pulsar el botón con el icono de un disquete de ordenador que aparece en la barra superior de su ventana. Otra posibilidad es usar el menú <em>File</em> <span class="math inline">\(\rightarrow\)</span> <em>Save</em>, o pulsar la combinación de teclas usual para guardar un fichero en vuestro sistema operativo, siempre y cuando la <strong>ventana activa</strong> de <em>RStudio</em> (donde esté activo el cursor en ese momento) sea la del guión. Al guardar un guión por primera vez, se abre una ventana de diálogo donde <em>RStudio</em> espera que le demos un nombre; la costumbre es usar para los guiones la extensión <code>.R</code>.</p>
<p>Podéis abrir un guión ya preexistente con <em>RStudio</em> usando el menú <em>File</em> <span class="math inline">\(\rightarrow\)</span> <em>Open File</em> de <em>RStudio</em> o pulsando sobre él en la pestaña <em>Files</em>. También podéis arrastrar el icono del guión sobre el de <em>RStudio</em> o (si habéis declarado que la aplicación por defecto para abrir ficheros con extensión <code>.R</code> sea <em>RStudio</em>) simplemente abrir el fichero de la manera usual en vuestro sistema operativo.</p>
<p>Además de guiones, con <em>RStudio</em> también podemos crear otros tipos de ficheros que combinen instrucciones de R con instrucciones de otro lenguaje. En este curso lo usaremos para crear ficheros <em>R Markdown</em>, que permiten generar de manera muy cómoda informes y presentaciones que incorporen instrucciones de R (o sólo sus resultados). Para crear un fichero <em>R Markdown</em>, tenéis que ir al menú <em>File</em> <span class="math inline">\(\rightarrow\)</span> <em>New File</em> <span class="math inline">\(\rightarrow\)</span> <em>R Markdown…</em>, donde os aparecerá una ventana que os pedirá el tipo de documento (<em>Document</em>, <em>Presentation</em>…), su título y el formato de salida. Una vez completada esta información, se abrirá el fichero en la ventana superior izquierda.</p>
<p>Por poner un ejemplo, supongamos que habéis elegido realizar un informe (<em>Document</em>) con formato de salida html (los formatos posibles son: PDF, HTML o Word); entonces, para generar un informe básico basta sustituir las palabras clave que ha generado <em>RStudio</em> en esta ventana. Probadlo: cambiad el título y el texto; a continuación, guardad el fichero con el nombre que queráis y extensión <code>.Rmd</code>, y pulsad el botón <em>Knit</em> situado en la barra superior de la ventana; se generará un fichero HTML en la carpeta de trabajo, con el texto del fichero <em>R Markdown</em> y el mismo título cambiando la extensión <code>.Rmd</code> por <code>.html</code>, y se abrirá en una ventana aparte.</p>
<p>Aprender los primeros pasos de <em>R Markdown</em> es sencillo. Para ello, podéis consultar el manual de referencia rápida de <em>R Markdown</em> que encontraréis en el menú <em>Help</em> de <em>RStudio</em>, que para la mayoría de ejercicios de este curso es más que suficiente.
También os puede ser útiles las “chuletas” de <em>R Markdown</em> siguientes:</p>
<ul>
<li><p><a href="https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf">https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf</a></p></li>
<li><p><a href="https://github.com/rstudio/cheatsheets/raw/master/rmarkdown-2.0.pdf">https://github.com/rstudio/cheatsheets/raw/master/rmarkdown-2.0.pdf</a></p></li>
<li><p><a href="https://www.rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf">https://www.rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf</a></p></li>
</ul>
<p>En la Lección @ref(chap:Rmd) explicamos algunas técnicas para mejorar los ficheros resultantes.</p>
</div>
<div id="sec:help" class="section level2" number="1.4">
<h2 number="1.4"><span class="header-section-number">1.4</span> Cómo obtener ayuda</h2>
<p>Para conocer toda la información (qué hace, cuál es la sintaxis correcta, qué parámetros tiene, algunos ejemplos de uso…) sobre una función o un objeto, se puede usar el campo de búsqueda, marcado con una lupa, en la esquina superior derecha de la pestaña de <strong>Ayuda</strong> (<em>Help</em>), situada en la ventana inferior derecha de <em>RStudio</em>. Como alternativa, se pueden usar las instrucciones</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="kw">help</span>(nombre del objeto)</span></code></pre></div>
<p>o, equivalentemente,</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a>?nombre del objeto</span></code></pre></div>
<p>Por ejemplo, si entramos en el campo de búsqueda de la pestaña de Ayuda la palabra <code>sum</code>, o si <strong>entramos</strong> en la consola (es decir, si escribimos a la derecha de la marca de inicio y a continuación pulsamos la tecla <em>Entrar</em>) la instrucción</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="kw">help</span>(sum)</span></code></pre></div>
<p>obtenemos en la pestaña de Ayuda toda la información sobre la función <code>sum</code>.</p>
<p>Cuando hayamos avanzado un poco en este curso, la Ayuda os será muy útil. Aquí sólo veremos alguna aplicación simple de la mayoría de las funciones que estudiemos, con los parámetros más importantes y suficientes para nuestros propósitos, y necesitaréis consultar su Ayuda para conocer todos sus usos, todos sus parámetros u otra información relevante.</p>
<p>Si queremos pedir ayuda sobre un tema concreto, pero no sabemos el nombre exacto de la función, podemos entrar una palabra clave en el campo de búsqueda de la pestaña de Ayuda, o usar la función</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="kw">help.search</span>(<span class="st">&quot;palabra clave&quot;</span>)</span></code></pre></div>
<p>o, equivalentemente,</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a>??<span class="st">&quot;palabra clave&quot;</span></span></code></pre></div>
<p>(las comillas ahora son obligatorias). De esta manera, conseguiremos en la ventana de Ayuda una lista de las funciones que R entiende que están relacionadas con la palabra clave entrada. Entonces, pulsando en la función que nos interese de esta lista, aparecerá la información específica sobre ella.
Como podéis imaginar, conviene que la palabra clave esté en inglés.</p>
<p>Además de la ayuda que incorpora el mismo R, siempre podéis acudir a foros y listas de discusión para encontrar ayuda sobre cualquier duda que podáis tener. Algunos recursos que nosotros encontramos especialmente útiles son los siguientes:</p>
<ul>
<li>La sección dedicada a R del foro <a href="http://stackoverflow.com/questions/tagged/r"><em>stackoverflow</em></a></li>
<li>El archivo de la lista de discusión <a href="http://r.789695.n4.nabble.com/r-help-f789696.html"><em>R-help</em></a></li>
<li>El grupo de Facebook <a href="https://www.facebook.com/groups/rprojectsp"><em>R project en español</em></a></li>
</ul>
<p>Si tenéis alguna dificultad, es muy probable que alguien ya la haya tenido y se la hayan resuelto en alguno de estos foros.</p>
<p>Existe también una comunidad muy activa de usuarios hispanos de R, en cuyo <a href="http://r-es.org/Comunidad">portal web</a> encontraréis muchos recursos útiles para mejorar vuestro conocimiento de este lenguaje.</p>
</div>
<div id="sec:paquetes" class="section level2" number="1.5">
<h2 number="1.5"><span class="header-section-number">1.5</span> Cómo instalar y cargar paquetes</h2>
<p>Muchas funciones y tablas de datos útiles no vienen con la instalación básica de R, sino que forman parte de <strong>paquetes</strong> (<em>packages</em>), que se tienen que instalar y cargar para poderlos usar. Por citar un par de ejemplos, el paquete <strong>magic</strong> lleva una función <code>magic</code> que crea <strong>cuadrados mágicos</strong> (tablas cuadradas de números naturales diferentes dos a dos tales que las sumas de todas sus columnas, de todas sus filas y de sus dos diagonales principales valgan todas lo mismo), y para usarla tenemos que instalar y cargar este paquete. De manera similar, el paquete <strong>ggplot2</strong> incorpora una serie de funciones para dibujar gráficos avanzados que no podemos usar si primero no instalamos y cargamos este paquete.</p>
<p>Podemos consultar en la pestaña <em>Packages</em> la lista de paquetes que tenemos instalados. Los paquetes que aparecen marcados en esta lista son los que tenemos cargados en la sesión actual. Si queremos cargar un paquete ya instalado, basta marcarlo en esta lista; podemos hacerlo también desde la consola, con la instrucción</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="kw">library</span>(nombre del paquete)</span></code></pre></div>
<p>En caso de necesitar un paquete que no tengamos instalado, hay que instalarlo antes de poderlo cargar. La mayoría de los paquetes se pueden instalar desde el repositorio del CRAN; esto se puede hacer de dos maneras:</p>
<ul>
<li>Desde la consola, entrando la instrucción</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="kw">install.packages</span>(<span class="st">&quot;nombre del paquete&quot;</span>, <span class="dt">dep=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p>(las comillas son obligatorias, y fijaos en el plural de <code>packages</code> aunque sólo queráis instalar uno). El parámetro <code>dep=TRUE</code> hace que R instale no sólo el paquete requerido, sino todos aquellos de los que dependa para funcionar correctamente.</p>
<ul>
<li>Pulsando el botón <em>Install</em> de la barra superior de la pestaña de paquetes; al hacerlo, <em>RStudio</em> abre una ventana dónde se nos pide el nombre del paquete a instalar. Conviene dejar marcada la opción <em>Install dependencies</em>, para que se instalen también los paquetes necesarios para su funcionamiento.</li>
</ul>
<p>Así, supongamos que queremos construir cuadrados mágicos, pero aún no hemos cargado el paquete <code>magic</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="kw">magic</span>(<span class="dv">10</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a><span class="co">#&gt; Error in magic(10): no se pudo encontrar la función &quot;magic&quot;</span></span></code></pre></div>
<p>Así que instalamos y cargamos dicho paquete (también lo podríamos hacer desde la ventana <em>Packages</em>):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="kw">install.packages</span>(<span class="st">&quot;magic&quot;</span>, <span class="dt">dep=</span><span class="ot">TRUE</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a><span class="kw">library</span>(magic)</span></code></pre></div>
<p>Ahora ya podemos usar la función <code>magic</code>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="kw">magic</span>(<span class="dv">10</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a><span class="co">#&gt;  [1,]   34   35    6    7   98   99   70   71   42    43</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a><span class="co">#&gt;  [2,]   36   33    8    5  100   97   72   69   44    41</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a><span class="co">#&gt;  [3,]   11   10   83   82   75   74   47   46   39    38</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true"></a><span class="co">#&gt;  [4,]   12    9   84   81   73   76   48   45   40    37</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true"></a><span class="co">#&gt;  [5,]   87   86   79   78   51   50   23   22   15    14</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true"></a><span class="co">#&gt;  [6,]   85   88   77   80   52   49   21   24   13    16</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true"></a><span class="co">#&gt;  [7,]   63   62   55   54   27   26   19   18   91    90</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true"></a><span class="co">#&gt;  [8,]   61   64   53   56   25   28   17   20   89    92</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true"></a><span class="co">#&gt;  [9,]   59   58   31   30    3    2   95   94   67    66</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true"></a><span class="co">#&gt; [10,]   57   60   29   32    1    4   93   96   65    68</span></span></code></pre></div>
<p>Cuando cerramos <em>RStudio</em>, los paquetes instalados en la sesión siguen instalados, pero los cargados se pierden; por lo tanto, si queremos volver a usarlos en otra sesión, tendremos que volver a cargarlos.</p>
<p>Hay paquetes que no se encuentran en el CRAN y que, por lo tanto, no se pueden instalar de la forma que hemos visto. Cuando sea necesario, ya explicaremos la manera de instalarlos y cargarlos en cada caso.</p>
<p>Para terminar, observad que a la derecha del nombre de cada paquete en la pestaña <em>Packages</em> aparecen dos símbolos. Al pulsar el primero, seis puntitos, se abrirá en el navegador la página de información del paquete, y al pulsar el segundo, una crucecita, desinstalamos el paquete. Asimismo, en la barra superior de la pestaña <em>Packages</em> encontraréis un botón <em>Update</em> que sirve para poner al día los paquetes instalados, obteniendo sus últimas versiones publicadas.</p>
</div>
<div id="guía-rápida" class="section level2" number="1.6">
<h2 number="1.6"><span class="header-section-number">1.6</span> Guía rápida</h2>
<ul>
<li><code>help</code> o <code>?</code> permiten pedir información sobre una función. También se puede usar el campo de búsqueda de la pestaña <em>Help</em> en la ventana inferior derecha de <em>RStudio</em>.</li>
<li><code>help.search</code> o <code>??</code> permiten pedir información sobre una palabra clave (entrada entre comillas). De nuevo, también se puede usar el campo de búsqueda de la pestaña <em>Help</em> en la ventana inferior derecha de <em>RStudio</em>.</li>
<li><code>install.packages("paquete", dep=TRUE)</code> instala el <code>paquete</code> y todos los otros paquetes de los que dependa. También se puede usar el botón <em>Install</em> de la pestaña <em>Packages</em> en la ventana inferior derecha de <em>RStudio</em>.</li>
<li><code>library(paquete)</code> carga el <code>paquete</code>. También se puede cargar marcándolo en la ventana <em>Packages</em> de <em>RStudio</em>.</li>
</ul>
<!--chapter:end:01chap00_Logistica_de_R.Rmd-->
</div>
</div>
<div id="chap:calc" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> La calculadora</h1>
<p>Cuando se trabaja en modo interactivo en la consola de R, hay que escribir las instrucciones a la derecha de la marca de inicio <code>&gt;</code> de la línea inferior (que omitimos en los bloques de código de este libro).
Para evaluar una instrucción al terminar de escribirla, se tiene que pulsar la tecla <em>Entrar</em> (<span class="math inline">\(\hookleftarrow\)</span>); así, por ejemplo, si junto a la marca de inicio escribimos 2+3 y pulsamos <em>Entrar</em>, R escribirá en la línea siguiente el resultado, 5, y a continuación una nueva línea en blanco encabezada por la marca de inicio, donde podremos continuar entrando instrucciones.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="dv">2</span><span class="op">+</span><span class="dv">3</span> <span class="co">#Y ahora aquí pulsamos Entrar</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a><span class="co">#&gt; [1] 5</span></span></code></pre></div>
<p>Bueno, hemos hecho trampa. Como ya habíamos comentado en la lección anterior, se pueden escribir comentarios: R ignora todo lo que se escribe en la línea después de un signo <code>#</code>. También podéis observar que R ha dado el resultado en una línea que empieza con <code>[1]</code>; ya discutiremos en la Lección @ref(chap:vect) qué significa este <code>[1]</code>.</p>
<p>Si la expresión que entramos no está completa, R no la evaluará y en la línea siguiente esperará a que la acabemos, indicándolo con la <strong>marca de continuación</strong>, por defecto un signo +. (En estas notas, y excepto en el ejemplo que damos a continuación, no mostraremos este signo + para no confundirlo con una suma.) Además, si cometemos algún error de sintaxis, R nos avisará con un mensaje de error.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a><span class="dv">2</span><span class="op">*</span>(<span class="dv">3</span><span class="op">+</span><span class="dv">5</span> <span class="co">#Pulsamos Entrar, pero no hemos acabado</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a><span class="op">+</span><span class="st"> </span>) <span class="co">#ahora sí</span></span></code></pre></div>
<pre><code>#&gt; [1] 16</code></pre>
<pre><code>## Error: &lt;text&gt;:1:6: inesperado &#39;)&#39;
## 1: 2*3+5)
##          ^</code></pre>
<p>Como podemos ver, al ejecutar la segunda instrucción, R nos avisa de que el paréntesis no está en su sitio.</p>
<p>Se puede agrupar más de una instrucción en una sola línea separándolas con signos de punto y coma. Al pulsar la tecla <em>Entrar</em>, R las ejecutará todas, una tras otra y en el orden en el que las hayamos escrito.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a><span class="dv">2</span><span class="op">+</span><span class="dv">3</span>; <span class="dv">2</span><span class="op">+</span><span class="dv">4</span>; <span class="dv">2</span><span class="op">+</span><span class="dv">5</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a><span class="co">#&gt; [1] 5</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true"></a><span class="co">#&gt; [1] 6</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true"></a><span class="co">#&gt; [1] 7</span></span></code></pre></div>
<div id="números-reales-operaciones-y-funciones-básicas" class="section level2" number="2.1">
<h2 number="2.1"><span class="header-section-number">2.1</span> Números reales: operaciones y funciones básicas</h2>
<p>La separación entre la parte entera y la parte decimal en los números reales se indica con un punto, no con una coma. Por consistencia, en el texto también seguiremos el convenio angloamericano de usar un punto en lugar de una coma como separador decimal.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a><span class="dv">2</span><span class="op">+</span><span class="dv">2</span>,<span class="dv">5</span></span></code></pre></div>
<pre><code>## Error: &lt;text&gt;:1:4: inesperado &#39;,&#39;
## 1: 2+2,
##        ^</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="dv">2</span><span class="fl">+2.5</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a><span class="co">#&gt; [1] 4.5</span></span></code></pre></div>
<p>Las operaciones usuales se indican en R con los signos que damos en la lista siguiente.
Por lo que se refiere a los dos últimos operadores en esta lista, recordad que si <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span> son dos números reales, con <span class="math inline">\(b&gt;0\)</span>, la <strong>división entera</strong> de <span class="math inline">\(a\)</span> por <span class="math inline">\(b\)</span> da como <strong>cociente entero</strong> el mayor número entero <span class="math inline">\(q\)</span> tal que <span class="math inline">\(q\cdot b\leqslant a\)</span>, y como <strong>resto</strong>
la diferencia <span class="math inline">\(a-q\cdot b\)</span>. Por ejemplo, la división entera de 29.5 entre 6.3 es 29.5=4·6.3+4.3, con cociente entero 4 y resto 4.3. (Cuando <span class="math inline">\(b&lt;0\)</span>, R da como cociente entero el menor número entero <span class="math inline">\(q\)</span> tal que <span class="math inline">\(q\cdot b\geqslant a\)</span>, y como resto la diferencia <span class="math inline">\(a-q\cdot b\)</span>, que en este caso es negativa.)</p>
<ul>
<li><strong>Suma</strong>: <code>+</code></li>
<li><strong>Resta</strong>: -</li>
<li><strong>Multiplicación</strong>: <code>*</code></li>
<li><strong>División</strong>: <code>/</code></li>
<li><strong>Potencia</strong>: <code>^</code></li>
<li><strong>Cociente entero</strong>: <code>%/%</code></li>
<li><strong>Resto de la división entera</strong>: <code>%%</code></li>
</ul>
<!--
\begin{table}[htb]
\abovecaptionskip=-1ex
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|c|}
\hline
Operación\vphantom{$\Big($} & Suma & Resta & Multiplicación & División & Potencia & Cociente & Resto \\[-1ex] 
& & & & & & entero & div. entera\\\hline
Signo\vphantom{$\Big($} & `+` & `-` & `*` & `/` & `\^{`}  &\quad `\%/\%` & \qquad `\%\%` \\ \hline
\end{tabular}
\end{center}
\caption{Signos de operaciones aritméticas.}\label{tab:ops}
\end{table}
-->
<p>A continuación, damos algunos ejemplos de manejo de estas operaciones. Observad el uso natural de los paréntesis para indicar la precedencia de las operaciones.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a><span class="dv">2</span><span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">5</span><span class="op">/</span><span class="dv">2</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a><span class="co">#&gt; [1] 8.5</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true"></a><span class="dv">2</span><span class="op">*</span>(<span class="dv">3</span><span class="op">+</span><span class="dv">5</span><span class="op">/</span><span class="dv">2</span>) <span class="co">#Aquí lo único que dividimos entre 2 es 5</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true"></a><span class="co">#&gt; [1] 11</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true"></a><span class="dv">2</span><span class="op">*</span>((<span class="dv">3</span><span class="op">+</span><span class="dv">5</span>)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true"></a><span class="co">#&gt; [1] 8</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true"></a><span class="dv">2</span><span class="op">/</span><span class="dv">3</span><span class="op">+</span><span class="dv">4</span> <span class="co">#Aquí el denominador de la fracción es 3</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true"></a><span class="co">#&gt; [1] 4.666667</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true"></a><span class="dv">2</span><span class="op">/</span>(<span class="dv">3</span><span class="op">+</span><span class="dv">4</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true"></a><span class="co">#&gt; [1] 0.2857143</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true"></a><span class="dv">2</span><span class="op">^</span><span class="dv">3</span><span class="op">*</span><span class="dv">5</span> <span class="co">#Aquí el exponente es 3</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true"></a><span class="co">#&gt; [1] 40</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true"></a><span class="dv">2</span><span class="op">^</span>(<span class="dv">3</span><span class="op">*</span><span class="dv">5</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true"></a><span class="co">#&gt; [1] 32768</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true"></a><span class="dv">2</span><span class="op">^-</span><span class="dv">5</span>  <span class="co">#En este caso no hacen falta paréntesis...</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true"></a><span class="co">#&gt; [1] 0.03125</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true"></a><span class="dv">2</span><span class="op">^</span>(<span class="op">-</span><span class="dv">5</span>) <span class="co">#Pero queda más claro si se usan</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true"></a><span class="co">#&gt; [1] 0.03125</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true"></a><span class="dv">534</span><span class="op">%/%</span><span class="dv">7</span> <span class="co">#¿Cuántas semanas completas caben en 534 días?</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true"></a><span class="co">#&gt; [1] 76</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true"></a><span class="dv">534</span><span class="op">%%</span><span class="dv">7</span> <span class="co">#¿Y cuántos días sobran? </span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true"></a><span class="dv">534-76</span><span class="op">*</span><span class="dv">7</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true"></a><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<p>El objeto <code>pi</code> representa el número real <span class="math inline">\(\pi\)</span>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a>pi</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a><span class="co">#&gt; [1] 3.141593</span></span></code></pre></div>
<p>¡Cuidado! No podemos omitir el signo <code>*</code> en las multiplicaciones.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a><span class="dv">2</span>(<span class="dv">3</span><span class="op">+</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): tentativa de aplicar una no-función</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a><span class="dv">2</span><span class="op">*</span>(<span class="dv">3</span><span class="op">+</span><span class="dv">5</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true"></a><span class="co">#&gt; [1] 16</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a>2pi</span></code></pre></div>
<pre><code>## Error: &lt;text&gt;:1:2: unexpected symbol
## 1: 2pi
##      ^</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true"></a><span class="dv">2</span><span class="op">*</span>pi</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true"></a><span class="co">#&gt; [1] 6.283185</span></span></code></pre></div>
<p>Cuando un número es muy grande o muy pequeño, R emplea la llamada <code>notación científica</code> para dar una aproximación.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true"></a><span class="dv">2</span><span class="op">^</span><span class="dv">40</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true"></a><span class="co">#&gt; [1] 1.099512e+12</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true"></a><span class="dv">2</span><span class="op">^</span>(<span class="op">-</span><span class="dv">20</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true"></a><span class="co">#&gt; [1] 9.536743e-07</span></span></code></pre></div>
<p>En este ejemplo, <code>1.099512e+12</code> representa el número 1.099512·10<sup>12</sup>, es decir, 1099512000000, y <code>9.536743e-07</code> representa el número 9.536743· 10<sup>-7</sup>, es decir,
0.0000009536743. Como muestra el ejemplo siguiente, no es necesario que un número sea especialmente grande o pequeño
para que R lo escriba en notación científica: basta que esté rodeado de otros números en esa notación.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true"></a><span class="kw">c</span>(<span class="dv">2</span><span class="op">^</span><span class="dv">40</span>,<span class="dv">2</span><span class="op">^</span>(<span class="op">-</span><span class="dv">20</span>),<span class="dv">17</span><span class="op">/</span><span class="dv">3</span>) <span class="co">#La función c sirve para definir vectores</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true"></a><span class="co">#&gt; [1] 1.099512e+12 9.536743e-07 5.666667e+00</span></span></code></pre></div>
<p>Este <code>5.666667e+00</code> representa el número 5.666667·10<sup>0</sup>, es decir,
5.666667.</p>
<p>R dispone, entre muchas otras, de las funciones numéricas de la lista siguiente:</p>
<ul>
<li><p><strong>Valor absoluto</strong>, <span class="math inline">\(|x|\)</span>: <code>abs(x)</code></p></li>
<li><p><strong>Raíz cuadrada</strong>, <span class="math inline">\(\sqrt(x)\)</span>: <code>sqrt(x)</code></p></li>
<li><p><strong>Exponencial</strong>, <span class="math inline">\(e^x\)</span>: <code>exp(x)</code></p></li>
<li><p><strong>Logaritmo neperiano</strong>, <span class="math inline">\(\ln(x)\)</span>: <code>log(x)</code></p></li>
<li><p><strong>Logaritmo decimal</strong>, <span class="math inline">\(\log_{10}(x)\)</span>: <code>log10(x)</code></p></li>
<li><p><strong>Logaritmo binario</strong>, <span class="math inline">\(\log_2(x)\)</span>: <code>log2(x)</code></p></li>
<li><p><strong>Logaritmo en base <span class="math inline">\(a\)</span></strong>, <span class="math inline">\(\log_a(x)\)</span>: <code>log(x,a)</code></p></li>
<li><p><strong>Factorial</strong>, <span class="math inline">\(n!\)</span>: <code>factorial(n)</code></p></li>
<li><p><strong>Número combinatorio</strong>, <span class="math inline">\(\binom{n}{m}\)</span>: <code>choose(n,m)</code></p></li>
<li><p><strong>Seno</strong>, <span class="math inline">\(\sin(x)\)</span>: <code>sin(x)</code></p></li>
<li><p><strong>Coseno</strong>, <span class="math inline">\(\cos(x)\)</span>: <code>cos(x)</code></p></li>
<li><p><strong>Tangente</strong>, <span class="math inline">\(\tan(x)\)</span>: <code>tan(x)</code></p></li>
<li><p><strong>Arcoseno</strong>, <span class="math inline">\(\arcsin(x)\)</span>: <code>asin(x)</code></p></li>
<li><p><strong>Arcocoseno</strong>, <span class="math inline">\(\arccos(x)\)</span>: <code>acos(x)</code></p></li>
<li><p><strong>Arcotangente</strong>, <span class="math inline">\(\arctan(x)\)</span>: <code>atan(x)</code></p></li>
</ul>
<p>Recordad que el <strong>valor absoluto</strong> <span class="math inline">\(|x|\)</span> de un número <span class="math inline">\(x\)</span> se obtiene tomando <span class="math inline">\(x\)</span> sin signo: <span class="math inline">\(|-8|=|8|=8\)</span>. Recordad también que el <strong>factorial</strong> <span class="math inline">\(n!\)</span> de <span class="math inline">\(n\)</span>, es el producto
<span class="math display">\[
n!=n\cdot (n-1)\cdot (n-2) \cdots 3\cdot 2 \cdot 1
\]</span>
(con el convenio de que <span class="math inline">\(0!=1\)</span>), y es igual al número de maneras posibles de ordenar una lista de <span class="math inline">\(n\)</span> objetos diferentes (su número de <strong>permutaciones</strong>),
y que el <strong>número combinatorio</strong> <span class="math inline">\(\binom{n}{m}\)</span>, con <span class="math inline">\(m\leqslant n\)</span>, es
<span class="math display">\[
\binom{n}{m}=\frac{n!}{m!\cdot (n-m)!}=\frac{n(n-1)(n-2)\cdots (n-m+1)}{m(m-1)(m-2)\cdots 2\cdot 1},
\]</span>
y es igual al número de maneras posibles de escoger un subconjunto de <span class="math inline">\(m\)</span> elementos de un conjunto de <span class="math inline">\(n\)</span> objetos diferentes.</p>
<!--
|Función  | $\sqrt{x}$ | $e^x$ | $\ln(x)$ | $\log_{10}(x)$ | $\log_a(x)$ | $n!$ | $\binom{n}{m}$|
|---:|---:|---:|---:|---:|---:|---:|---:|  
**Signo** | sqrt | exp | log | log10 | log( , a) |`factorial`|`choose`|

|Función | $\sin(x)$ | $\cos(x)$ | $\tan(x)$ | $\arcsin(x)$ | $\mathrm{arccos}(x)$ | $\arctan(x)$ | `|`$x$`|` |
|---:|---:|---:|---:|---:|---:|---:|---:|  
**Signo** | `sin` | `cos`|`tan`|`asin`|`acos`| `atan`|`abs`|
-->
<!--
```
Signo & `sqrt`\vphantom{$\Big($} & `exp` & `log` & `log10` & `log( , a)` & `factorial` & `choose`\\ \hline\hline
Función &$\sin(x)$\vphantom{$\Big($} & $\cos(x)$ & $\tan(x)$ & $\arcsin(x)$ & $\mathrm{arccos}(x)$ & $\arctan(x)$ & $|x|$ \\ \hline
Signo & `sin`\vphantom{$\Big($} & `cos` & `tan` & `asin` & `acos`& `atan` & `abs`\\ \hline

```


```r

#\caption{Funciones numéricas.}\label{tab:fun}

```
-->
<!--
\begin{table}[htb]
\abovecaptionskip=-1ex
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|c|}
\hline
Función & $\sqrt{x}$ \vphantom{$\Big($} & $e^x$ & $\ln(x)$ & $\log_{10}(x)$ & $\log_a(x)$ & $n!$ & $\binom{n}{m}$\\ \hline
Signo & `sqrt`\vphantom{$\Big($} & `exp` & `log` & `log10` & `log( , a)` & `factorial` & `choose`\\ \hline\hline
Función &$\sin(x)$\vphantom{$\Big($} & $\cos(x)$ & $\tan(x)$ & $\arcsin(x)$ & $\mathrm{arccos}(x)$ & $\arctan(x)$ & $|x|$ \\ \hline
Signo & `sin`\vphantom{$\Big($} & `cos` & `tan` & `asin` & `acos`& `atan` & `abs`\\ \hline
\end{tabular}
\end{center}
\caption{Funciones numéricas.}\label{tab:fun}
\end{table}
-->
<p>Las funciones de R se aplican a sus argumentos introduciéndolos siempre entre paréntesis. Si la función se tiene que aplicar a más de un argumento, éstos se tienen que especificar en el orden que toque y separándolos mediante comas; R no tiene en cuenta los espacios en blanco alrededor de las comas. Veamos algunos ejemplos:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true"></a><span class="kw">sqrt</span>(<span class="dv">4</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true"></a><span class="kw">sqrt</span>(<span class="dv">8</span>)<span class="op">-</span><span class="dv">8</span><span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true"></a><span class="co">#&gt; [1] 0</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true"></a><span class="kw">log10</span>(<span class="dv">8</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true"></a><span class="co">#&gt; [1] 0.90309</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true"></a><span class="kw">log</span>(<span class="dv">8</span>)<span class="op">/</span><span class="kw">log</span>(<span class="dv">10</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true"></a><span class="co">#&gt; [1] 0.90309</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true"></a><span class="dv">7</span><span class="op">^</span><span class="kw">log</span>(<span class="dv">2</span>,<span class="dv">7</span>) <span class="co">#7 elevado al logaritmo en base 7 de 2 es 2</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true"></a><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true"></a><span class="dv">10</span><span class="op">!</span><span class="st"> </span><span class="co">#R no entiende esta expresión</span></span></code></pre></div>
<pre><code>10! #R no entiende esta expresión</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true"></a><span class="kw">factorial</span>(<span class="dv">10</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true"></a><span class="co">#&gt; [1] 3628800</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true"></a><span class="kw">exp</span>(<span class="kw">sqrt</span>(<span class="dv">8</span>))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true"></a><span class="co">#&gt; [1] 16.91883</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true"></a><span class="kw">choose</span>(<span class="dv">5</span>,<span class="dv">3</span>)  <span class="co">#Núm. de subconjuntos de 3 elementos de un conjunto de 5 </span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true"></a><span class="co">#&gt; [1] 10</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true"></a><span class="kw">choose</span>(<span class="dv">3</span>,<span class="dv">5</span>)  <span class="co">#Núm. de subconjuntos de 5 elementos de un conjunto de 3</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true"></a><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>R entiende que los argumentos de las funciones <code>sin</code>, <code>cos</code> y <code>tan</code> están en radianes. Si queremos aplicar una de estas funciones a un número de grados, podemos traducir los grados a radianes multiplicándolos por <span class="math inline">\(\pi/180\)</span>.
De manera similar, los resultados de <code>asin</code>, <code>acos</code> y <code>atan</code> también están en radianes, y se pueden traducir a grados
multiplicándolos por <span class="math inline">\(180/\pi\)</span>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true"></a><span class="kw">cos</span>(<span class="dv">60</span>) <span class="co">#Coseno de 60 radianes</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true"></a><span class="co">#&gt; [1] -0.952413</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true"></a><span class="kw">cos</span>(<span class="dv">60</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">180</span>) <span class="co">#Coseno de 60 grados</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true"></a><span class="co">#&gt; [1] 0.5</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true"></a><span class="kw">acos</span>(<span class="fl">0.5</span>)  <span class="co">#Arcocoseno de 0.5 en radianes</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true"></a><span class="co">#&gt; [1] 1.047198</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true"></a><span class="kw">acos</span>(<span class="fl">0.5</span>)<span class="op">*</span><span class="dv">180</span><span class="op">/</span>pi <span class="co">#Arcocoseno de 0.5 en grados</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true"></a><span class="co">#&gt; [1] 60</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true"></a><span class="kw">acos</span>(<span class="dv">2</span>) </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true"></a><span class="co">#&gt; [1] NaN</span></span></code></pre></div>
<p>Este último <code>NaN</code> (acrónimo de <code>Not a Number</code>) significa que el resultado no existe; en efecto, <span class="math inline">\(\mathrm{arccos}(2)\)</span> no existe como número real, ya que <span class="math inline">\(\cos(x)\)</span> siempre pertenece al intervalo <span class="math inline">\([-1,1]\)</span>.</p>
<p>Ya hemos visto que R dispone del signo <code>pi</code> para representar el número real <span class="math inline">\(\pi\)</span>. En cambio,
no tiene ningún signo para indicar la constante de Euler <span class="math inline">\(e\)</span>, y hay que emplear <code>exp(1)</code>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true"></a><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>) <span class="co">#2·e</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true"></a><span class="co">#&gt; [1] 5.436564</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true"></a><span class="kw">exp</span>(pi)<span class="op">-</span>pi<span class="op">^</span><span class="kw">exp</span>(<span class="dv">1</span>) <span class="co">#e^pi-pi^e</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true"></a><span class="co">#&gt; [1] 0.6815349</span></span></code></pre></div>
<p>Para terminar esta sección, observad el resultado siguiente:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true"></a><span class="kw">sqrt</span>(<span class="dv">2</span>)<span class="op">^</span><span class="dv">2-2</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true"></a><span class="co">#&gt; [1] 4.440892e-16</span></span></code></pre></div>
<p>R opera numéricamente con <span class="math inline">\(\sqrt{2}\)</span>, no formalmente,
y por eso no da como resultado de <span class="math inline">\((\sqrt{2})^2-2\)</span> el valor 0 exacto, sino
el número pequeñísimo 4.440892·10<sup>-16</sup>; de hecho, R trabaja internamente con una precisión de aproximadamente 16 cifras decimales, por lo que no siempre podemos esperar resultados exactos. Si necesitáis trabajar de manera exacta con más cifras significativas, os recomendamos usar las funciones del paquete <strong>Rmpfr</strong>.</p>
</div>
<div id="cifras-significativas-y-redondeos" class="section level2" number="2.2">
<h2 number="2.2"><span class="header-section-number">2.2</span> Cifras significativas y redondeos</h2>
<p>En cada momento, R decide cuántas cifras muestra de un número según el contexto. También podemos especificar este número de cifras para toda una sesión, entrándolo en lugar de los puntos suspensivos en <code>options(digits=...)</code>. Hay que tener presente que ejecutar esta instrucción no cambiará la precisión de los cálculos, sólo cómo se muestran los resultados.</p>
<p>Si queremos conocer una cantidad específica <em>n</em> de cifras significativas de un número <em>x</em>, podemos emplear la función</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true"></a><span class="kw">print</span>(x, n)</span></code></pre></div>
<p>Observad su efecto:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true"></a><span class="kw">sqrt</span>(<span class="dv">2</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true"></a><span class="co">#&gt; [1] 1.414214</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">sqrt</span>(<span class="dv">2</span>), <span class="dv">20</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true"></a><span class="co">#&gt; [1] 1.4142135623730951</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">sqrt</span>(<span class="dv">2</span>), <span class="dv">2</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true"></a><span class="co">#&gt; [1] 1.4</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true"></a><span class="dv">2</span><span class="op">^</span><span class="dv">100</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true"></a><span class="co">#&gt; [1] 1.267651e+30</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true"></a><span class="kw">print</span>(<span class="dv">2</span><span class="op">^</span><span class="dv">100</span>, <span class="dv">15</span>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true"></a><span class="co">#&gt; [1] 1.26765060022823e+30</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true"></a><span class="kw">print</span>(<span class="dv">2</span><span class="op">^</span><span class="dv">100</span>, <span class="dv">5</span>)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true"></a><span class="co">#&gt; [1] 1.2677e+30</span></span></code></pre></div>
<p>El número máximo de cifras que podemos pedir con <code>print</code> es 22; si pedimos más, R nos dará un mensaje de error.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">sqrt</span>(<span class="dv">2</span>), <span class="dv">22</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true"></a><span class="co">#&gt; [1] 1.4142135623730951</span></span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">sqrt</span>(<span class="dv">2</span>), <span class="dv">23</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true"></a><span class="co">#&gt; Error in print.default(sqrt(2), 23): invalid printing digits 23</span></span></code></pre></div>
<p>Por otro lado, hay que tener en cuenta que, como ya hemos comentado, R trabaja con una precisión de unas 16 cifras decimales y por lo tanto los dígitos más allá de esta precisión pueden ser incorrectos. Por ejemplo, si le pedimos las 22 primeras cifras de <span class="math inline">\(\pi\)</span>, obtenemos el resultado siguiente:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true"></a><span class="kw">print</span>(pi, <span class="dv">22</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true"></a><span class="co">#&gt; [1] 3.1415926535897931</span></span></code></pre></div>
<p>En cambio, <span class="math inline">\(\pi\)</span> vale en realidad 3.141592653589793<strong><em>238462…</em></strong>, lo que significa que el valor que da R es erróneo a partir de la decimosexta cifra decimal.</p>
<p>La función <code>print</code> permite indicar las cifras que queremos <em>leer</em>, pero no sirve para especificar las cifras decimales con las que queremos <em>trabajar</em>.
Para <em>redondear</em>un número <span class="math inline">\(x\)</span> a una cantidad específica <em>n</em> de cifras decimales, y trabajar solamente con esas cifras, hay que usar la función</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true"></a><span class="kw">round</span>(x, n)</span></code></pre></div>
<p>La diferencia entre los efectos de <code>print</code> y <code>round</code> consiste en que <code>print(sqrt(2), 4)</code> es igual a <span class="math inline">\(\sqrt{2}\)</span>, pero R sólo muestra sus primeras 4 cifras, 1.414, mientras que <code>round(sqrt(2), 3)</code> <em>es igual a</em> 1.414. Veamos algunos ejemplos</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">sqrt</span>(<span class="dv">2</span>), <span class="dv">4</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true"></a><span class="co">#&gt; [1] 1.414</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">sqrt</span>(<span class="dv">2</span>), <span class="dv">4</span>)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true"></a><span class="co">#&gt; [1] 1.414</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true"></a><span class="fl">1.414</span><span class="op">^</span><span class="dv">2</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true"></a><span class="co">#&gt; [1] 1.999396</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">sqrt</span>(<span class="dv">2</span>), <span class="dv">3</span>)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true"></a><span class="co">#&gt; [1] 1.414</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">sqrt</span>(<span class="dv">2</span>), <span class="dv">3</span>)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true"></a><span class="co">#&gt; [1] 1.999396</span></span></code></pre></div>
<p>En caso de empate, R redondea al valor que termina en cifra par, siguiendo la regla de redondeo en caso de empate recomendada por el estándar IEEE 754 para aritmética en coma flotante.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true"></a><span class="kw">round</span>(<span class="fl">2.25</span>, <span class="dv">1</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true"></a><span class="co">#&gt; [1] 2.2</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true"></a><span class="kw">round</span>(<span class="fl">2.35</span>, <span class="dv">1</span>)  </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true"></a><span class="co">#&gt; [1] 2.4</span></span></code></pre></div>
<p>¿Qué pasa si no se indica el número de cifras en el argumento de <code>round</code>?</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">sqrt</span>(<span class="dv">2</span>)) </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">sqrt</span>(<span class="dv">2</span>), <span class="dv">0</span>) </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true"></a><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>Al entrar <code>round(sqrt(2))</code>, R ha entendido que el número de cifras decimales al que queríamos redondear era 0. Esto significa que 0 es el <strong>valor por defecto</strong> de este parámetro. No es necesario especificar los valores por defecto de los parámetros de una función, y para saber cuáles son, hay que consultar su Ayuda. Así, por ejemplo, la Ayuda de <code>round</code> indica que su sintaxis es</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true"></a><span class="kw">round</span>(x, <span class="dt">digits=</span><span class="dv">0</span>)</span></code></pre></div>
<p>donde el valor de <code>digits</code> ha de ser un número entero que indique el número de cifras decimales. Esta sintaxis significa que el valor por defecto del parámetro <code>digits</code> es 0.</p>
<p>Escribir <code>digits=</code> en el argumento para especificar el número de cifras decimales es optativo, siempre que mantengamos el orden de los argumentos indicado en la Ayuda: en este caso, primero el número y luego las cifras. Este es el motivo por el que podemos escribir
<code>round(sqrt(2), 1)</code> en lugar de <code>round(sqrt(2), digits=1)</code>. Si cambiamos el orden de los argumentos, entonces sí que hay que especificar el nombre del parámetro, como muestra el siguiente ejemplo:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true"></a><span class="kw">round</span>(<span class="dt">digits=</span><span class="dv">3</span>, <span class="kw">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true"></a><span class="co">#&gt; [1] 1.414</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true"></a><span class="kw">round</span>(<span class="dv">3</span>, <span class="kw">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true"></a><span class="co">#&gt; [1] 3</span></span></code></pre></div>
<p>En la lista de funciones ya vimos una función de dos argumentos que toma uno por defecto: <code>log</code>. Su sintaxis completa es <code>log(x, base=...)</code>, y si no especificamos la <code>base</code>, toma su valor por defecto, <span class="math inline">\(e\)</span>, y calcula el logaritmo neperiano.</p>
<p>La función <code>round(x)</code> redondea <span class="math inline">\(x\)</span> al valor entero más cercano (y en caso de empate, al que termina en cifra par). R también dispone de otras funciones que permiten redondear a números enteros en otros sentidos específicos:</p>
<ul>
<li><p><code>floor(x)</code> redondea <span class="math inline">\(x\)</span> a un número entero <strong>por defecto</strong>, dando el mayor número entero menor o igual que <span class="math inline">\(x\)</span>, que denotamos por <span class="math inline">\(\lfloor x\rfloor\)</span>.</p></li>
<li><p><code>ceiling(x)</code> redondea <span class="math inline">\(x\)</span> a un número entero <strong>por exceso</strong>, dando el menor número entero mayor o igual que <span class="math inline">\(x\)</span>, que denotamos por <span class="math inline">\(\lceil x\rceil\)</span>.</p></li>
<li><p><code>trunc(x)</code> da la <strong>parte entera</strong> de <span class="math inline">\(x\)</span>, eliminando la parte decimal: es lo que se llama <strong>truncar</strong> <span class="math inline">\(x\)</span> a un entero.</p></li>
</ul>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true"></a><span class="kw">floor</span>(<span class="fl">8.3</span>) <span class="co">#El mayor entero menor o igual que 8.3</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true"></a><span class="co">#&gt; [1] 8</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true"></a><span class="kw">ceiling</span>(<span class="fl">8.3</span>) <span class="co">#El menor entero mayor o igual que 8.3</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true"></a><span class="co">#&gt; [1] 9</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true"></a><span class="kw">trunc</span>(<span class="fl">8.3</span>) <span class="co">#La parte entera de 8.3</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true"></a><span class="co">#&gt; [1] 8</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true"></a><span class="kw">round</span>(<span class="fl">8.3</span>) <span class="co">#El entero más cercano a 8.3</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true"></a><span class="co">#&gt; [1] 8</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true"></a><span class="kw">floor</span>(<span class="op">-</span><span class="fl">3.7</span>) <span class="co">#El mayor entero menor o igual que -3.7</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true"></a><span class="co">#&gt; [1] -4</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true"></a><span class="kw">ceiling</span>(<span class="op">-</span><span class="fl">3.7</span>) <span class="co">#El menor entero mayor o igual que -3.7</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true"></a><span class="co">#&gt; [1] -3</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true"></a><span class="kw">trunc</span>(<span class="op">-</span><span class="fl">3.7</span>) <span class="co">#La parte entera de -3.7</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true"></a><span class="co">#&gt; [1] -3</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true"></a><span class="kw">round</span>(<span class="op">-</span><span class="fl">3.7</span>) <span class="co">#El entero más cercano a -3.7</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true"></a><span class="co">#&gt; [1] -4</span></span></code></pre></div>
</div>
<div id="definición-de-variables" class="section level2" number="2.3">
<h2 number="2.3"><span class="header-section-number">2.3</span> Definición de variables</h2>
<p>R funciona mediante <strong>objetos</strong>, estructuras de diferentes tipos que sirven para realizar diferentes tareas. Una <strong>variable</strong> es un tipo de objeto que sirve para guardar datos.
Por ejemplo, si queremos crear una variable <code>x</code> que contenga el valor <span class="math inline">\(\pi^2\)</span>, podemos escribir:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true"></a>x=pi<span class="op">^</span><span class="dv">2</span></span></code></pre></div>
<p>Al entrar esta instrucción, R creará el objeto <code>x</code> y le asignará el valor que hemos especificado.
En general, se puede crear una variable y asignarle un valor, o asignar un nuevo valor a una variable definida anteriormente, mediante
la construcción</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true"></a>nombre_de_la_variable=valor</span></code></pre></div>
<p>También se puede conectar el nombre de la variable con el valor por medio de una flecha <code>-&gt;</code> o <code>&lt;-</code>, compuesta de un guión y un signo de desigualdad, de manera que el sentido de la flecha vaya del valor a la variable; por ejemplo, las tres primeras instrucciones siguientes son equivalentes, y asignan el valor 2 a la variable <span class="math inline">\(x\)</span>, mientras que las dos últimas son incorrectas:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true"></a>x=<span class="dv">2</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true"></a>x&lt;-<span class="dv">2</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true"></a><span class="dv">2</span>-&gt;x</span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true"></a><span class="dv">2</span>=x</span></code></pre></div>
<pre><code>## Error in 2 = x: lado izquierdo de la asignación inválida (do_set)</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true"></a><span class="dv">2</span>&lt;-x</span></code></pre></div>
<pre><code>## Error in 2 &lt;- x: lado izquierdo de la asignación inválida (do_set)</code></pre>
<p>Nosotros usaremos sistemáticamente el signo <code>=</code> para hacer asignaciones.</p>
<p>Se puede usar como nombre de una variable cualquier palabra que combine letras mayúsculas y minúsculas (R las distingue), con acentos o sin (aunque os recomendamos que no uséis letras acentuadas, ya que se pueden importar mal de un ordenador a otro), dígitos (0,…, 9), puntos <code>.</code> y guiones bajos <code>_</code>, siempre que empiece con una letra o un punto. Aunque no esté prohibido, es muy mala idea redefinir nombres que ya sepáis que tienen significado para R, como por ejemplo <code>pi</code> o <code>sqrt</code>.</p>
<p>Como podéis ver en las instrucciones anteriores y en las que siguen, cuando asignamos un valor a una variable, R no da ningún resultado; después podemos usar el nombre de la variable para referirnos al valor que representa.
Es posible asignar varios valores a una misma variable en una misma sesión: naturalmente, en cada momento R empleará el último valor asignado. Incluso se puede redefinir el valor de una variable usando en la nueva definición su valor actual.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true"></a>x=<span class="dv">5</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true"></a>x<span class="op">^</span><span class="dv">2</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true"></a><span class="co">#&gt; [1] 25</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true"></a>x=x<span class="dv">-2</span> <span class="co">#Redefinimos x como su valor actual menos 2</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true"></a>x</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true"></a><span class="co">#&gt; [1] 3</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true"></a>x<span class="op">^</span><span class="dv">2</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true"></a><span class="co">#&gt; [1] 9</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true"></a>x=<span class="kw">sqrt</span>(x) <span class="co">#Redefinimos x como la raíz cuadrada de su valor actual</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true"></a>x</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true"></a><span class="co">#&gt; [1] 1.732051</span></span></code></pre></div>
</div>
<div id="definición-de-funciones" class="section level2" number="2.4">
<h2 number="2.4"><span class="header-section-number">2.4</span> Definición de funciones</h2>
<p>A menudo querremos definir alguna función. Para ello tenemos que usar, en vez de simplemente <code>=</code>, una construcción especial:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true"></a>nombre_de_la_función=<span class="cf">function</span>(variables){definición}</span></code></pre></div>
<p>Una vez definida una función, la podemos aplicar a valores de la variable o variables.</p>
<p>Veamos un ejemplo. Vamos a llamar <span class="math inline">\(f\)</span> a la función <span class="math inline">\(x^2-2^x\)</span>, usando <span class="math inline">\(x\)</span> como variable, y a continuación la aplicamos a <span class="math inline">\(x=30\)</span>:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true"></a>f=<span class="cf">function</span>(x){x<span class="op">^</span><span class="dv">2-2</span><span class="op">^</span>x}</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true"></a><span class="kw">f</span>(<span class="dv">30</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true"></a><span class="co">#&gt; [1] -1073740924</span></span></code></pre></div>
<p>Conviene que os acostumbréis a escribir la fórmula que define la función entre llaves <code>{...}</code>. A veces es necesario y a veces no, pero no vale la pena discutir cuándo.</p>
<p>El nombre de la variable se indica dentro de los paréntesis que siguen al <code>function</code>. En el ejemplo anterior, la variable era <span class="math inline">\(x\)</span>, y por eso hemos escrito <code>=function(x)</code>. Si hubiéramos querido definir la función con variable <span class="math inline">\(t\)</span>, habríamos usado <code>=function(t)</code> (y, naturalmente, habríamos escrito la fórmula que define la función con la variable <span class="math inline">\(t\)</span>):</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true"></a>f=<span class="cf">function</span>(t){t<span class="op">^</span><span class="dv">2-2</span><span class="op">^</span>t}</span></code></pre></div>
<p>Se pueden definir funciones de dos o más variables con <code>function</code>, declarándolas todas. Por ejemplo, para definir la función <span class="math inline">\(f(x,y)=e^{(2x-y)^2}\)</span>, tenemos que entrar</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true"></a>f=<span class="cf">function</span>(x, y){<span class="kw">exp</span>((<span class="dv">2</span><span class="op">*</span>x<span class="op">-</span>y)<span class="op">^</span><span class="dv">2</span>)}</span></code></pre></div>
<p>y ahora ya podemos aplicar esta función a pares de valores:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true"></a><span class="kw">f</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true"></a><span class="co">#&gt; [1] 2.718282</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true"></a><span class="kw">f</span>(<span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true"></a><span class="co">#&gt; [1] 54.59815</span></span></code></pre></div>
<p>Las funciones no tienen por qué tener como argumentos o resultados sólo números reales: pueden involucrar vectores, matrices, tablas de datos, etc.
Y se pueden definir por medio de secuencias de instrucciones, no sólo mediante fórmulas numéricas directas; en este caso,
hay que separar las diferentes instrucciones con signos de punto y coma o escribir cada instrucción en una nueva línea.
Ya iremos viendo ejemplos a medida que avance el curso.</p>
<p>En cada momento se pueden saber los objetos (por ejemplo, variables y funciones) que se han definido en la sesión hasta ese momento entrando
la instrucción <code>ls()</code> o consultando la pestaña <em>Environment</em>.
Para borrar la definición de un objeto, hay que aplicarle la función <code>rm</code>.
Si se quiere hacer limpieza y borrar de golpe las definiciones de todos los objetos que se han definido hasta el momento,
se puede emplear la instrucción <code>rm(list=ls())</code> o usar el botón con el icono de la escoba de la barra superior de la pestaña <em>Environment</em>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())    <span class="co">#Borramos todas las definiciones</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true"></a>f=<span class="cf">function</span>(t){t<span class="op">^</span><span class="dv">2-2</span><span class="op">^</span>t}</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true"></a>a=<span class="dv">1</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true"></a>a</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true"></a><span class="kw">ls</span>()</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;a&quot; &quot;f&quot;</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true"></a><span class="kw">rm</span>(a)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true"></a><span class="kw">ls</span>()</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;f&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true"></a>a</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;a&#39; no encontrado</span></span></code></pre></div>
</div>
<div id="números-complejos-opcional" class="section level2" number="2.5">
<h2 number="2.5"><span class="header-section-number">2.5</span> Números complejos (opcional)</h2>
<p>Hasta aquí, hemos operado con números reales. Con R también podemos operar con números complejos. Los signos para las operaciones son los mismos que en el caso real.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true"></a>(<span class="dv">2</span><span class="op">+</span>5i)<span class="op">*</span><span class="dv">3</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true"></a><span class="co">#&gt; [1] 6+15i</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true"></a>(<span class="dv">2</span><span class="op">+</span>5i)<span class="op">*</span>(<span class="dv">3</span><span class="op">+</span>7i)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true"></a><span class="co">#&gt; [1] -29+29i</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true"></a>(<span class="dv">2</span><span class="op">+</span>5i)<span class="op">/</span>(<span class="dv">3</span><span class="op">+</span>7i)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true"></a><span class="co">#&gt; [1] 0.7068966+0.0172414i</span></span></code></pre></div>
<p>Fijaos en que cuando entramos en R un número complejo escrito en forma binomial <span class="math inline">\(a+bi\)</span>, <em>no</em> escribimos un <code>*</code> entre la <code>i</code> y su coeficiente; de hecho, <em>no hay que escribirlo</em> :</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true"></a><span class="dv">2</span><span class="op">+</span><span class="dv">5</span><span class="op">*</span>i</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;i&#39; no encontrado</span></span></code></pre></div>
<p>Por otro lado, si el coeficiente de <span class="math inline">\(i\)</span> es 1 o -1, hay que escribir el 1: por ejemplo, <span class="math inline">\(3-i\)</span> se tiene que escribir <code>3-1i</code>. Si no lo hacemos, R da un mensaje de error.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true"></a>(<span class="dv">3</span><span class="op">+</span>i)<span class="op">*</span>(<span class="dv">2</span><span class="op">-</span>i)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;i&#39; no encontrado</span></span></code></pre></div>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true"></a>(<span class="dv">3</span><span class="op">+</span>1i)<span class="op">*</span>(<span class="dv">2</span><span class="op">-</span>1i)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true"></a><span class="co">#&gt; [1] 7-1i</span></span></code></pre></div>
<p>Los complejos que tienen como parte imaginaria un número entero o un racional escrito en forma decimal se pueden entrar directamente en forma binomial, como lo hemos hecho hasta ahora. Para definir números complejos más… complejos, se puede usar la función</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true"></a><span class="kw">complex</span>(<span class="dt">real=</span>..., <span class="dt">imaginary=</span>...)</span></code></pre></div>
<p>Veamos un ejemplo:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true"></a><span class="dv">1</span><span class="op">+</span><span class="dv">2</span><span class="op">/</span>3i <span class="co">#Esto en realidad es 1 más 2 partido por 3i</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true"></a><span class="co">#&gt; [1] 1-0.666667i</span></span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true"></a><span class="dv">1</span><span class="op">+</span>(<span class="dv">2</span><span class="op">/</span><span class="dv">3</span>)i  </span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): objeto &#39;i&#39; no encontrado</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true"></a><span class="kw">complex</span>(<span class="dt">real=</span><span class="dv">1</span>, <span class="dt">imaginary=</span><span class="dv">2</span><span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true"></a><span class="co">#&gt; [1] 1+0.666667i</span></span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true"></a>z=<span class="dv">1</span><span class="op">+</span><span class="kw">sqrt</span>(<span class="dv">2</span>)i</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): objeto &#39;i&#39; no encontrado
</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true"></a>z=<span class="kw">complex</span>(<span class="dt">real=</span><span class="dv">1</span>, <span class="dt">imaginary=</span><span class="kw">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true"></a>z</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true"></a><span class="co">#&gt; [1] 1+1.414214i</span></span></code></pre></div>
<p>Como sabéis, los números complejos se inventaron para poder trabajar con raíces cuadradas de números negativos. Ahora bien, por defecto, cuando calculamos la raíz cuadrada de un número negativo R no devuelve un número complejo, sino que se limita a avisarnos de que no existe.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true"></a><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">3</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true"></a><span class="co">#&gt; Warning in sqrt(-3): Se han producido NaNs</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true"></a><span class="co">#&gt; [1] NaN</span></span></code></pre></div>
<p>Si queremos que R produzca un número complejo al calcular la raíz cuadrada de un número negativo, tenemos que especificar que este número negativo es un número complejo. La mejor manera de hacerlo es declarándolo como complejo aplicándole la función <code>as.complex</code></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true"></a><span class="kw">sqrt</span>(<span class="kw">as.complex</span>(<span class="op">-</span><span class="dv">3</span>))</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0+1.732051i</span></span></code></pre></div>
<p>La mayoría de las funciones que hemos dado para los números reales admiten extensiones para números complejos, y con R se calculan con la misma función. Ahora no entraremos a explicar cómo se definen estas extensiones, sólo lo comentamos por si sabéis qué hacen y os interesa calcularlas.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true"></a><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">+</span>3i)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true"></a><span class="co">#&gt; [1] 1.674149+0.895977i</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true"></a><span class="kw">exp</span>(<span class="dv">2</span><span class="op">+</span>3i)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true"></a><span class="co">#&gt; [1] -7.31511+1.042744i</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true"></a><span class="kw">sin</span>(<span class="dv">2</span><span class="op">+</span>3i)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true"></a><span class="co">#&gt; [1] 9.154499-4.168907i</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true"></a><span class="kw">acos</span>(<span class="kw">as.complex</span>(<span class="dv">2</span>)) <span class="co">#El arcocoseno de 2 es un número complejo</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true"></a><span class="co">#&gt; [1] 0+1.316958i</span></span></code></pre></div>
<p>La raíz cuadrada merece un comentario. Naturalmente, <code>sqrt(2+3i)</code> calcula un número complejo <span class="math inline">\(z\)</span> tal que <span class="math inline">\(z^2=2+3i\)</span>. Como ocurre con los números reales, todo número complejo diferente de 0 tiene dos raíces cuadradas, y una se obtiene multiplicando la otra por -1.
R da como raíz cuadrada de un número real la positiva, y como raíz cuadrada de un complejo la que tiene parte real positiva, y si su parte real es 0, la que tiene parte imaginaria positiva.
<!--
AAAAAAAA pendiente dibujo de raíces de  complejos
--></p>
<div class="figure" style="text-align: center">
<img src="02chap01_La_calculadora_files/figure-html/geom-1.png" alt="Interpretación geométrica de los números complejos." width="80%" />
<p class="caption">
(#fig:geom)Interpretación geométrica de los números complejos.
</p>
</div>
<!--
\begin{figure}[htb]
    \begin{center}
      \begin{picture}(200,140)(-40,-30)
      \put(-20,0){\line(1,0){200}} % l'eix x
      \put(0,-20){\line(0,1){130}} % l'eix y
      \put(120,80){$\bullet$}
      \multiput(120,0)(0,2){40}{$\scriptstyle\cdot$}
      \multiput(0,80)(2,0){60}{$\scriptstyle \cdot$}
    %   \curve(0,0, 59,40)
      \arc(30,20){-33.7}
      \put(31,18.4){\vector(-2,3){1}}
      \put(5,50){\small \red{$|z|=\sqrt{a^2+b^2}$}}
      \put(38,10){\small $ \theta_{z}$}
      \put(126,86){\small $ z=(a,b)=a+bi$}
      \put(120,-10){\small $ a$}
     \put(-10,80){\small $ b$}
     \put(45,-10){\small \red{$|z|\cos(\theta_{z})$}}
     \put(125,40){\small \red{$|z|\sin(\theta_{z})$}}
     \thicklines
\put(0,0){\line(3,2){120}}
      \end{picture}
    \end{center}
\caption{Interpretación geométrica de los números complejos.}
\label{fig:geom}
\end{figure}
-->
<p>Un número complejo <span class="math inline">\(z=a+bi\)</span> se puede representar como el punto <span class="math inline">\((a,b)\)</span> del plano cartesiano <span class="math inline">\(\mathbb{R}^2\)</span>. Esto permite asociarle dos
magnitudes geométricas: véase la Figura @ref(fig:geom)</p>
<ul>
<li><p>El <strong>módulo</strong> de <span class="math inline">\(z\)</span>, que denotaremos por <span class="math inline">\(|z|\)</span>, es la distancia
euclídea de <span class="math inline">\((0,0)\)</span> a <span class="math inline">\((a,b)\)</span>:
<span class="math display">\[
|z|=\sqrt{a^2+b^2}.
\]</span>
Si <span class="math inline">\(z\in \mathbb{R}\)</span>, su módulo coincide con su valor absoluto; en particular, si <span class="math inline">\(z=0\)</span>, su módulo es <span class="math inline">\(0\)</span>, y es el único número complejo de módulo 0.</p></li>
<li><p>El <strong>argumento</strong> de <span class="math inline">\(z\)</span> (para <span class="math inline">\(z\neq 0\)</span>), que denotaremos por
<span class="math inline">\(\theta_{z}\)</span>, es el ángulo que forman el semieje positivo de abscisas y el vector que va de <span class="math inline">\((0,0)\)</span> a <span class="math inline">\((a,b)\)</span>.
Este ángulo está determinado por las ecuaciones
<span class="math display">\[
\cos (\theta_{z})=\frac{a}{\sqrt{a^2+b^2}},\qquad
\sin (\theta_{z})=\frac{b}{\sqrt{a^2+b^2}}.
\]</span></p></li>
</ul>
<!--
\begin{table}[htb]
\abovecaptionskip=-1ex
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|}
\hline
Operación\vphantom{$\Big($} & Parte real & Parte imaginaria & Módulo & Argumento & Conjugado \\ \hline
Signo\vphantom{$\Big($} & `Re` & `Im` & `Mod` & `Arg` & `Conj` \\ \hline
\end{tabular}
\end{center}
\caption{Funciones específicas para números complejos.{Re}{Im}{Mod}{Arg}{Conj}}\label{tab:comp}
\end{table}
-->
<!--




Table: (\#tab:comp)Funciones específicas para números complejos.

|Operación        |Signo  |
|:----------------|:------|
|Parte real       |`Re`   |
|Parte imaginaria |`Im`   |
|Módulo           |`Mod`  |
|Argumento        |`Arg`  |
|Conjugado        |`Conj` |
-->
<p>R sabe calcular módulos y argumentos de números complejos. Los argumentos los da en radianes y dentro del intervalo <span class="math inline">\((-\pi,\pi]\)</span>.
En general, R dispone de las funciones básicas específicas para números complejos de la lista siguiente:</p>
<ul>
<li><strong>Parte real</strong>: <code>Re</code></li>
<li><strong>Parte imaginaria</strong>: <code>Im</code></li>
<li><strong>Módulo</strong>: <code>Mod</code></li>
<li><strong>Argumento</strong>: <code>Arg</code></li>
<li><strong>Conjugado</strong>: <code>Conj</code></li>
</ul>
<p>Recordad que el <strong>conjugado</strong> de un número complejo <span class="math inline">\(z=a+bi\)</span> es <span class="math inline">\(\overline{z}=a-bi\)</span>. Veamos algunos ejemplos de uso de estas funciones:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true"></a><span class="kw">Re</span>(<span class="dv">4</span><span class="op">-</span>7i)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true"></a><span class="co">#&gt; [1] 4</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true"></a><span class="kw">Im</span>(<span class="dv">4</span><span class="op">-</span>7i)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true"></a><span class="co">#&gt; [1] -7</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true"></a><span class="kw">Mod</span>(<span class="dv">4</span><span class="op">-</span>7i)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true"></a><span class="co">#&gt; [1] 8.062258</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true"></a><span class="kw">Arg</span>(<span class="dv">4</span><span class="op">-</span>7i)</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true"></a><span class="co">#&gt; [1] -1.05165</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true"></a><span class="kw">Conj</span>(<span class="dv">4</span><span class="op">-</span>7i)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true"></a><span class="co">#&gt; [1] 4+7i</span></span></code></pre></div>
<p>El módulo y el argumento de un número complejo <span class="math inline">\(z\neq 0\)</span> lo determinan de manera única, porque
<span class="math display">\[
z=|z|\big(\cos(\theta_z)+\sin(\theta_z)i\big).
\]</span>
Si queremos definir un número complejo mediante su módulo y argumento, no hace falta utilizar esta igualdad: podemos usar la instrucción</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true"></a><span class="kw">complex</span>(<span class="dt">modulus=</span>..., <span class="dt">argument=</span>...)</span></code></pre></div>
<p>Por ejemplo:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true"></a>z=<span class="kw">complex</span>(<span class="dt">modulus=</span><span class="dv">3</span>, <span class="dt">argument=</span>pi<span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true"></a>z</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true"></a><span class="co">#&gt; [1] 2.427051+1.763356i</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true"></a><span class="kw">Mod</span>(z)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true"></a><span class="co">#&gt; [1] 3</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true"></a><span class="kw">Arg</span>(z)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true"></a><span class="co">#&gt; [1] 0.6283185</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true"></a>pi<span class="op">/</span><span class="dv">5</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true"></a><span class="co">#&gt; [1] 0.6283185</span></span></code></pre></div>
</div>
<div id="guía-rápida-1" class="section level2" number="2.6">
<h2 number="2.6"><span class="header-section-number">2.6</span> Guía rápida</h2>
<ul>
<li>Signos de operaciones aritméticas:
<ul>
<li>Suma: <code>+</code></li>
<li>Resta: <code>-</code></li>
<li>Multiplicación: <code>*</code></li>
<li>División: <code>/</code></li>
<li>Potencia: <code>^</code></li>
<li>Cociente entero: <code>%/%</code></li>
<li>Resto de la división entera: <code>%%</code></li>
</ul></li>
<li>Funciones numéricas:
<ul>
<li>Valor absoluto: <code>abs</code></li>
<li>Raíz cuadrada: <code>sqrt</code></li>
<li>Exponencial de base <em>e</em>: <code>exp</code></li>
<li>Logaritmo neperiano: <code>log</code></li>
<li>Logaritmo decimal: <code>log10</code></li>
<li>Logaritmo binario: <code>log2</code></li>
<li>Logaritmo en base <span class="math inline">\(a\)</span>: <code>log(...,base=a)</code></li>
<li>Factorial: <code>factorial</code></li>
<li>Número combinatorio: <code>choose</code></li>
<li>Seno: <code>sin</code></li>
<li>Coseno: <code>cos</code></li>
<li>Tangente: <code>tan</code></li>
<li>Arcoseno: <code>asin</code></li>
<li>Arcocoseno: <code>acos</code></li>
<li>Arcotangente: <code>atan</code></li>
</ul></li>
<li><code>pi</code> es el número <span class="math inline">\(\pi\)</span>.</li>
<li><code>print(x, n)</code> muestra el valor de <span class="math inline">\(x\)</span> con <span class="math inline">\(n\)</span> cifras significativas.</li>
<li><code>round(x, n)</code> redondea el valor de <span class="math inline">\(x\)</span> a <span class="math inline">\(n\)</span> cifras decimales.</li>
<li><code>floor(x)</code> redondea <span class="math inline">\(x\)</span> a un número entero por defecto.</li>
<li><code>ceiling(x)</code> redondea <span class="math inline">\(x\)</span> a un número entero por exceso.</li>
<li><code>trunc(x)</code> da la parte entera de <span class="math inline">\(x\)</span>.</li>
<li><code>variable=valor</code> asigna el <code>valor</code> a la <code>variable</code>. Otras construcciones equivalentes son <code>variable&lt;-valor</code> y <code>valor-&gt;variable</code>.</li>
<li><code>función=function(variables){instrucciones}</code> define la <code>función</code> de variables las especificadas entre los paréntesis mediante las instrucciones especificadas entre las llaves.</li>
<li><code>ls()</code> nos da la lista de objetos actualmente definidos.</li>
<li><code>rm</code> borra la definición del objeto u objetos a los que se aplica.</li>
<li><code>rm(list=ls())</code> borra las definiciones de todos los objetos que hayamos definido.</li>
<li><code>complex</code> se usa para definir números complejos que no se puedan entrar directamente en forma binomial. Algunos parámetros importantes:
<ul>
<li><code>real</code> e <code>imaginary</code>: sirven para especificar su parte real y su parte imaginaria.</li>
<li><code>modulus</code> y <code>argument</code>: sirven para especificar su módulo y su argumento.</li>
</ul></li>
<li><code>as.complex</code> convierte un número real en complejo.</li>
<li>Funciones específicas para números complejos:
<ul>
<li>Parte real: <code>Re</code></li>
<li>Parte imaginaria: <code>Im</code></li>
<li>Módulo: <code>Mod</code></li>
<li>Argumento: <code>Arg</code></li>
<li>Conjugado: <code>Conj</code></li>
</ul></li>
</ul>
</div>
<div id="ejercicios" class="section level2" number="2.7">
<h2 number="2.7"><span class="header-section-number">2.7</span> Ejercicios</h2>
<div id="test" class="section level3 unnumbered">
<h3 class="unnumbered">Test</h3>
<p>En los tests, tenéis que entrar las respuestas sin dejar ningún espacio en blanco excepto los que se pidan explícitamente. Cuando os pidan que deis una instrucción de R, <em>no</em> tenéis que incluir la marca de inicio <code>&gt;</code>. Del mismo modo, cuando os pidan que copiéis un resultado dado por R, <em>no</em> tenéis que incluir el <code>[1]</code>.</p>
<p><em>(1)</em> Dad una expresión para calcular <span class="math inline">\((2+7)8+\frac{5}{2}-3^6+8!\)</span>, con las operaciones escritas exactamente en el orden dado y sin paréntesis innecesarios, y a continuación, separado por un único espacio en blanco, copiad exactamente el resultado que ha dado R al evaluarla.</p>
<p><em>(2)</em> Dad una expresión para calcular <span class="math inline">\(|\sin(\sqrt{2})-e^{\sqrt[5]{2}}|\)</span>, con las operaciones y funciones escritas exactamente en el orden dado, y a continuación, separado por un único espacio en blanco, copiad exactamente el resultado que ha dado R al evaluarla.</p>
<p><em>(3)</em> Dad una expresión para calcular <span class="math inline">\(\sin(37^{\mathrm{o}})\)</span>, empleando la construcción explicada en esta lección para calcular funciones trigonométricas de ángulos dados en grados, y a continuación, separado por un único espacio en blanco, copiad exactamente el resultado que ha dado R al evaluarla.</p>
<p><em>(4)</em> Dad una expresión para calcular <span class="math inline">\(3e-\pi\)</span>, con las operaciones escritas exactamente en la orden dado, y a continuación, separado por un único espacio en blanco, copiad exactamente el resultado que ha dado R al evaluarla.</p>
<p><em>(5)</em> Dad una expresión para calcular <span class="math inline">\(e^{2/3}\)</span> redondeado a 3 cifras decimales y a continuación, separado por un único espacio en blanco, copiad exactamente el resultado que ha dado R al evaluarla.</p>
<p><em>(6)</em> En una sola línea, definid <span class="math inline">\(x\)</span> como <span class="math inline">\(\sqrt{2}\)</span> e <span class="math inline">\(y\)</span> como <span class="math inline">\(\cos(3\pi)\)</span> y calculad <span class="math inline">\(\ln(x^{y})\)</span>; separad las tres instrucciones con puntos y comas seguidos de un único espacio en blanco. A continuación, separado por un espacio en blanco (sin punto y coma), copiad exactamente el resultado que ha dado R al evaluar esta secuencia de instrucciones.</p>
<p><em>(7)</em> Corresponde el número en notación científica <code>3.3333e10</code> al número 33333000000? Tenéis que contestar SI (sin acento) o NO.</p>
</div>
<div id="ejercicio" class="section level3 unnumbered">
<h3 class="unnumbered">Ejercicio</h3>
<p>Si hubiéramos empezado a contar segundos a partir de las 12 campanadas que marcaron el inicio de 2015, ¿qué día de qué año llegaríamos a los 250 millones de segundos? ¡Cuidado con los años bisiestos!</p>
</div>
<div id="respuestas-al-test" class="section level3 unnumbered">
<h3 class="unnumbered">Respuestas al test</h3>
<p><em>(1)</em> <code>(2+7)*8+5/2-3^6+factorial(8) 39665.5</code></p>
<p><em>(2)</em> <code>abs(sin(sqrt(2))-exp(2^(1/5))) 2.166319</code></p>
<p>También sería correcto <code>abs(sin(2^(1/2))-exp(2^(1/5))) 2.166319</code></p>
<p><em>(3)</em> <code>sin(37*pi/180) 0.601815</code></p>
<p><em>(4)</em> <code>3*exp(1)-pi 5.013253</code></p>
<p><em>(5)</em> <code>round(exp(2/3),3) 1.948</code></p>
<p><em>(6)</em> <code>x=sqrt(2); y=cos(3*pi); log(x^y) -0.3465736</code></p>
<p><em>(7)</em> SI</p>
<!--chapter:end:02chap01_La_calculadora.Rmd-->
</div>
</div>
</div>
<div id="chap:lm" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Un aperitivo: Introducción a la regresión lineal</h1>
<p>En muchos libros de texto y artículos científicos encontraréis gráficos donde una línea recta o algún otro tipo de curva se ajusta a una serie de observaciones representadas por medio de puntos en el plano. La situación en general es la siguiente. Supongamos que tenemos una serie de puntos del plano cartesiano <span class="math inline">\(\mathbb{R}^2\)</span>,
<span class="math display">\[
(x_1,y_1), (x_2,y_2),\ldots,(x_n,y_n),
\]</span>
que representan pares de observaciones de dos variables numéricas: por ejemplo, <span class="math inline">\(x=\)</span> año e <span class="math inline">\(y=\)</span> población, o <span class="math inline">\(x=\)</span> longitud de una rama e <span class="math inline">\(y=\)</span> número de hojas en la rama. Queremos describir cómo depende la variable <strong>dependiente</strong> <span class="math inline">\(y\)</span> de la variable <strong>independiente</strong> <span class="math inline">\(x\)</span> a partir de estas observaciones. Para ello, buscaremos una función <span class="math inline">\(y=f(x)\)</span> cuya gráfica se aproxime lo máximo posible a los puntos <span class="math inline">\((x_i,y_i)_{i=1,\ldots,n}\)</span>. Esta función nos dará un modelo matemático del comportamiento de las observaciones realizadas que nos permitirá entender mejor los mecanismos que relacionan las variables estudiadas o hacer predicciones sobre futuras observaciones.</p>
<p>Una primera opción, y la más sencilla, es estudiar si los puntos
<span class="math inline">\((x_i,y_i)_{i=1,\ldots,n}\)</span> satisfacen una relación lineal. En este caso, se busca la recta de ecuación <span class="math inline">\(y=b_1x+b_0\)</span>, con <span class="math inline">\(b_0,b_1\in \mathbb{R}\)</span>, que aproxime mejor los puntos dados, en el sentido de que la suma
de los cuadrados de las diferencias entre los valores <span class="math inline">\(y_i\)</span> y sus aproximaciones <span class="math inline">\(b_1x_i+b_0\)</span>,
<span class="math display">\[
\sum_{i=1}^n (y_i-(b_1x_i+b_0))^2,
\]</span>
sea mínima. A esta recta <span class="math inline">\(y=b_1x+b_0\)</span> se la llama <strong>recta de regresión por mínimos cuadrados</strong>; para abreviar, aquí la llamaremos simplemente <strong>recta de regresión</strong>, porque es la única que estudiaremos por ahora.</p>
<p>El objetivo de esta lección es ilustrar el uso de R mediante el cálculo de esta recta de regresión. Para ello, introduciremos algunas funciones de R que ya explicaremos con más detalle en otras lecciones. Utilizaremos también transformaciones logarítmicas para tratar casos en los que los puntos dados se aproximen mejor mediante una función potencial o exponencial.</p>
<div id="sec:introlm" class="section level2" number="3.1">
<h2 number="3.1"><span class="header-section-number">3.1</span> Cálculo de rectas de regresión</h2>
<p>Consideremos la Tabla @ref(tab:nin1), que da la altura media de los niños a determinadas edades. Los datos se han extraído de <a href="http://www.cdc.gov/growthcharts/clinical_charts.htm">http://www.cdc.gov/growthcharts/clinical_charts.htm</a>. Queremos determinar a partir de estos datos si hay una relación lineal entre la edad y la altura media de los niños.</p>
<table>
<caption>(#tab:nin1)Alturas medias de niños por edad.</caption>
<thead>
<tr class="header">
<th align="right">edad (años)</th>
<th align="right">altura (cm)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">76.11</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">86.45</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">95.27</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">109.18</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">122.03</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">133.73</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">143.73</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">156.41</td>
</tr>
</tbody>
</table>
<!--
\begin{table}[htb]
\begin{center}
\abovecaptionskip=7pt
\begin{tabular}{lcccccccc}
\toprule
edad (años) & 1 & 2 & 3 & 5 & 7 & 9 & 11 & 13\\
\midrule
altura (cm) & 76.11 & 86.45 & 95.27 & 109.18 & 122.03 & 133.73 & 143.73 & 156.41\\
\bottomrule
\end{tabular}
\caption{Alturas medias de niños por edad.}\label{tab:1}
\end{center}
\vspace*{-4ex}

\end{table}
-->
<p>Cuando tenemos una serie de observaciones emparejadas como las de esta tabla, la manera natural de almacenarlas en R es mediante una <strong>tabla de datos</strong>, un <strong><em>data frame</em></strong> en el argot de R. Aunque en este ejemplo concreto no sería necesario, lo haremos así para que empecéis a acostumbraros. La ventaja de tener los datos organizados en forma de <em>data frame</em> es que con ellos luego se pueden hacer muchas más cosas. Estudiaremos en detalle los <em>data frames</em> en la Lección @ref(chap:df).</p>
<p>Para crear este <em>data frame</em>, en primer lugar guardaremos cada fila de la Tabla @ref(tab:nin1) como un <strong>vector</strong>, es decir, como una lista ordenada de números, y le pondremos un nombre adecuado. Para definir un vector, podemos aplicar la función <code>c</code> a la secuencia ordenada de números, separados por comas:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true"></a>edad=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">11</span>,<span class="dv">13</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true"></a>altura=<span class="kw">c</span>(<span class="fl">76.11</span>,<span class="fl">86.45</span>,<span class="fl">95.27</span>,<span class="fl">109.18</span>,<span class="fl">122.03</span>,<span class="fl">133.73</span>,<span class="fl">143.73</span>,<span class="fl">156.41</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true"></a>edad</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true"></a><span class="co">#&gt; [1]  1  2  3  5  7  9 11 13</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true"></a>altura</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true"></a><span class="co">#&gt; [1]  76.11  86.45  95.27 109.18 122.03 133.73 143.73 156.41</span></span></code></pre></div>
<p>Ahora vamos a construir un <em>data frame</em> de dos columnas, una para la edad y otra para la altura, y lo llamaremos <code>datos1</code>. Estas columnas serán las <strong>variables</strong> de nuestra tabla de datos.
Para organizar diversos vectores de la misma longitud en un <em>data frame</em>, podemos aplicar la función <code>data.frame</code> a los vectores:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true"></a>datos1=<span class="kw">data.frame</span>(edad, altura)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true"></a>datos1</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true"></a><span class="co">#&gt;   edad altura</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true"></a><span class="co">#&gt; 1    1  76.11</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true"></a><span class="co">#&gt; 2    2  86.45</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true"></a><span class="co">#&gt; 3    3  95.27</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true"></a><span class="co">#&gt; 4    5 109.18</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true"></a><span class="co">#&gt; 5    7 122.03</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true"></a><span class="co">#&gt; 6    9 133.73</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true"></a><span class="co">#&gt; 7   11 143.73</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true"></a><span class="co">#&gt; 8   13 156.41</span></span></code></pre></div>
<p>Observad que las filas del <em>data frame</em> resultante corresponden a los pares (edad, altura) de la Tabla @ref(tab:nin1).</p>
<p>Al analizar unos datos, siempre es conveniente empezar con una representación gráfica que nos permita hacernos una idea de sus características. En este caso, lo primero que haremos será dibujar los pares (edad,altura) usando la función <code>plot</code>. Esta función tiene muchos parámetros que permiten mejorar el resultado, pero ya los veremos al estudiarla en detalle en la Lección @ref(chap:plot). Por ahora nos conformamos con un gráfico básico de estos puntos que nos muestre su distribución.</p>
<p>Dada una familia de puntos <span class="math inline">\((x_n,y_n)_{n=1,\ldots,k}\)</span>, si llamamos <code>x</code> al vector <span class="math inline">\((x_n)_{n=1,\ldots,k}\)</span> de sus abscisas e <code>y</code> al vector <span class="math inline">\((y_n)_{n=1,\ldots,k}\)</span> de sus ordenadas, podemos obtener el gráfico de los puntos <span class="math inline">\((x_n,y_n)_{n=1,\ldots,k}\)</span> mediante la instrucción</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true"></a><span class="kw">plot</span>(x, y)</span></code></pre></div>
<p>Si los vectores <code>x</code> e <code>y</code> son, en este orden, la primera y la segunda columna de un <em>data frame</em> de dos variables, como es nuestro caso, es suficiente aplicar la función <code>plot</code> al <em>data frame</em>.
Así, por ejemplo, para dibujar el gráfico de la Figura @ref(fig:A301) de los puntos <span class="math inline">\((\mathrm{edad}_n,\textrm{altura}_n)_{n=1,\ldots,8}\)</span>, basta entrar la siguiente instrucción:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true"></a><span class="kw">plot</span>(datos1)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03chap02_Un_aperitivo_files/figure-html/A301-1.png" alt="Representación gráfica de la altura media de los niños a determinadas edades." width="90%" />
<p class="caption">
(#fig:A301)Representación gráfica de la altura media de los niños a determinadas edades.
</p>
</div>
<p>Al ejecutar esta instrucción en la consola de <code>Rstudio</code>, el gráfico resultante se abrirá en la pestaña <em>Plots</em>, y en él se puede observar a simple vista que nuestros puntos siguen aproximadamente una recta.
Vamos a calcular ahora su recta de regresión.</p>
<p>Dada una familia de puntos <span class="math inline">\((x_n,y_n)_{n=1,\ldots,k}\)</span>, si llamamos <code>x</code> al vector <span class="math inline">\((x_n)_{n=1,\ldots,k}\)</span> de sus abscisas e <code>y</code> al vector <span class="math inline">\((y_n)_{n=1,\ldots,k}\)</span> de sus ordenadas, su recta de regresión se calcula con R por medio de la instrucción</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true"></a><span class="kw">lm</span>(y<span class="op">~</span>x)</span></code></pre></div>
<p>Fijaos en la sintaxis: dentro del argumento de <code>lm</code>, primero va el vector <code>y</code>, seguido del vector <code>x</code> conectado a <code>y</code> por una tilde <code>~</code>. Para R, esta tilde significa <strong>en función de</strong>: es decir, <code>lm(y~x)</code> significa <strong>la recta de regresión de <span class="math inline">\(y\)</span> en función de <span class="math inline">\(x\)</span></strong>. Para obtener este signo, los usuarios de Windows y Linux tienen que pulsar Ctrl+Alt+4 seguido de un espacio en blanco y los de Mac OS X con teclado español pueden pulsar Alt+Ñ seguido de un espacio en blanco.</p>
<p>Si los vectores <code>y</code> y <code>x</code> son dos columnas de un <em>data frame</em>, para calcular la recta de regresión de <span class="math inline">\(y\)</span> en función de <span class="math inline">\(x\)</span> podemos usar la instrucción</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true"></a><span class="kw">lm</span>(y<span class="op">~</span>x, <span class="dt">data=</span>nombre del data frame)</span></code></pre></div>
<p>Así pues, para calcular la recta de regresión de los puntos <span class="math inline">\((\mathrm{edad}_n,\textrm{altura}_n)_{n=1,\ldots,8}\)</span>, entramos la siguiente instrucción:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true"></a><span class="kw">lm</span>(altura<span class="op">~</span>edad, <span class="dt">data=</span>datos1)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true"></a><span class="co">#&gt; Call:</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true"></a><span class="co">#&gt; lm(formula = altura ~ edad, data = datos1)</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true"></a><span class="co">#&gt; (Intercept)         edad  </span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true"></a><span class="co">#&gt;      73.968        6.493</span></span></code></pre></div>
<p>El resultado que hemos obtenido significa que la recta de regresión tiene término independiente 73.968 (el punto donde la recta <em>interseca</em> al eje de las <span class="math inline">\(y\)</span>) y el coeficiente de <span class="math inline">\(x\)</span> es 6.493 (el coeficiente de la variable <code>edad</code>). Es decir, es la recta
<span class="math display">\[
y=6.493x+73.968.
\]</span>
Ahora la podemos superponer al gráfico anterior, empleando la función <code>abline</code>. Esta función permite añadir una recta al gráfico activo en la pestaña <em>Plots</em>. Por lo tanto, si no hemos cerrado el gráfico anterior, la instrucción</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true"></a><span class="kw">abline</span>(<span class="kw">lm</span>(altura<span class="op">~</span>edad, <span class="dt">data=</span>datos1))</span></code></pre></div>
<p>le añade la recta de regresión, produciendo la Figura @ref(fig:A302).
Se ve a simple vista que, efectivamente, esta recta aproxima muy bien los datos.</p>
<div class="figure" style="text-align: center">
<img src="03chap02_Un_aperitivo_files/figure-html/A302-1.png" alt="Ajuste mediante la recta de regresión de la altura media de los niños respecto de su edad." width="90%" />
<p class="caption">
(#fig:A302)Ajuste mediante la recta de regresión de la altura media de los niños respecto de su edad.
</p>
</div>
<p>Es importante tener presente que el análisis que hemos realizado de los pares de valores <span class="math inline">\((\mathrm{edad}_n, \textrm{altura}_n)_{n=1,\ldots,8}\)</span> ha sido puramente descriptivo: hemos mostrado que estos datos son consistentes con una función lineal, pero <em>no hemos demostrado</em> que la altura media sea función aproximadamente lineal de la edad. Esto último requeriría una demostración matemática o un argumento biológico, no una simple comprobación numérica para una muestra pequeña de valores, que, al fin y al cabo, es lo único que hemos hecho.</p>
<p>Lo que sí que podemos hacer ahora es usar la relación lineal observada para predecir la altura media de los niños de otras edades. Por ejemplo, ¿qué altura media estimamos que tienen los niños de 10 años? Si aplicamos la regla</p>
<p><span class="math display">\[
\textrm{altura}=6.493\cdot \mathrm{edad}+73.968,
\]</span>
podemos predecir que la altura media a los 10 años es
6.493·10+73.968=138.898, es decir, de unos 139 cm.</p>
<p>Para evaluar numéricamente si la relación lineal que hemos encontrado es significativa o no, podemos usar el <em>coeficiente de determinación</em> <span class="math inline">\(R^2\)</span>. No explicaremos aquí cómo se define, ya lo haremos en la Lección @ref(chap:regresion). Es suficiente saber que es un valor entre 0 y 1 y que cuanto más se aproxime la recta de regresión al conjunto de puntos, más cercano será a 1. Por el momento, y como regla general, si este coeficiente de determinación <span class="math inline">\(R^2\)</span> es mayor que 0.9, consideraremos que el ajuste de los puntos a la recta es bueno.</p>
<p>Cuando R calcula la recta de regresión también obtiene este valor, pero no lo muestra si no se lo pedimos. Si queremos saber todo lo que ha calculado R con la función <code>lm</code>, tenemos que emplear la construcción <code>summary(lm(...))</code>. En general, la función <code>summary</code> aplicada a un objeto de R nos da un resumen de los contenidos de este objeto, resumen que depende de la clase de objeto que se trate.</p>
<p>Veamos cuál es el resultado de esta instrucción en nuestro ejemplo:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">lm</span>(altura<span class="op">~</span>edad, <span class="dt">data=</span>datos1))</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true"></a><span class="co">#&gt; Call:</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true"></a><span class="co">#&gt; lm(formula = altura ~ edad, data = datos1)</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true"></a><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true"></a><span class="co">#&gt; -4.351 -1.743  0.408  2.018  2.745 </span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true"></a><span class="co">#&gt; (Intercept)  73.9681     1.7979   41.14 1.38e-08 ***</span></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true"></a><span class="co">#&gt; edad          6.4934     0.2374   27.36 1.58e-07 ***</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true"></a><span class="co">#&gt; ---</span></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true"></a><span class="co">#&gt; Residual standard error: 2.746 on 6 degrees of freedom</span></span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true"></a><span class="co">#&gt; Multiple R-squared:  0.992,  Adjusted R-squared:  0.9907 </span></span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true"></a><span class="co">#&gt; F-statistic: 748.4 on 1 and 6 DF,  p-value: 1.577e-07</span></span></code></pre></div>
<p>Por ahora podemos prescindir de casi toda esta información (en todo caso, observad que la columna <code>Estimate</code> nos da los coeficientes de la recta de regresión) y fijarnos sólo en el primer valor de la penúltima línea, <code>Multiple R-squared</code>. Éste es el coeficiente de determinación <span class="math inline">\(R^2\)</span> que nos interesa. En este caso ha sido de 0.992, lo que confirma que la recta de regresión aproxima muy bien los datos.</p>
<p>Podemos pedir a R que nos dé el valor <code>Multiple R-squared</code> sin tener que obtener todo el <code>summary</code>, añadiendo el sufijo <code>$r.squared</code> a la construcción <code>summary(lm(...))</code>.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">lm</span>(altura<span class="op">~</span>edad, <span class="dt">data=</span>datos1))<span class="op">$</span>r.squared</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.9920466</span></span></code></pre></div>
<p>Los sufijos que empiezan con <code>$</code> suelen usarse en R para obtener componentes de un objeto. Por ejemplo, si al nombre de un <em>data frame</em> le añadimos el sufijo formado por <code>$</code> seguido del nombre de una de sus variables, obtenemos el contenido de esta variable.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true"></a>datos1<span class="op">$</span>edad</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true"></a><span class="co">#&gt; [1]  1  2  3  5  7  9 11 13</span></span></code></pre></div>
<p>Veamos otro ejemplo de cálculo de recta de regresión.</p>

<div class="example">
<p><span id="exm:reg2" class="example"><strong>(#exm:reg2) </strong></span>Karl Pearson recopiló en 1903 las alturas de 1078 parejas formadas por un padre y un hijo. Hemos guardado en el <code>url</code> <a href="http://aprender.uib.es/Rdir/pearson.txt">http://aprender.uib.es/Rdir/pearson.txt</a> un fichero que contiene estas alturas.
Si lo abrís en un navegador, veréis que es una tabla de dos columnas, etiquetadas <code>Padres</code> e <code>Hijos</code> (Figura @ref(fig:pearson)). Cada fila contiene las alturas en pulgadas de un par Padre-Hijo.</p>
</div>
<div class="figure" style="text-align: center">
<img src="AprendeR-Parte-I_files/figure-html/pearson.png" alt="Vista en un navegador del fichero pearson.txt." width="90%" />
<p class="caption">
(#fig:pearson)Vista en un navegador del fichero pearson.txt.
</p>
</div>
<p>Vamos a usar estos datos para estudiar si hay dependencia lineal entre la altura de un hijo y la de su padre. Para ello, lo primero que haremos será cargarlos en un <em>data frame</em>. Esto se puede llevar a cabo de dos maneras:</p>
<ul>
<li>Usando el menú <em>Import Dataset</em>  de la pestaña <em>Environment</em> de la ventana superior derecha de <em>RStudio</em>, sobre el que volveremos en la Lección @ref(chap:df). Al pulsar sobre este menú, se nos ofrece la posibilidad de importar un fichero de diferentes maneras; en este ejemplo, vamos a usar <em>From Text (readr)…</em>, que es la adecuada para importar tablas de Internet. Al seleccionarla, se nos pide el <code>url</code> del fichero y se nos dan a escoger una serie de opciones donde podemos especificar el nombre del <em>data frame</em> que queremos crear, si el fichero tiene o no una primera fila con los nombres de las columnas, cuál es el signo usado para separar columnas, etc. Pulsando el botón <em>Update</em> podremos ver en el campo <em>Data Preview</em> de esta ventana de diálogo el aspecto del <em>data frame</em> que obtendremos con las opciones seleccionadas; se trata entonces de escoger las opciones adecuadas para que se cree la versión correcta del <em>data frame</em>.
En el caso concreto de esta tabla <code>pearson.txt</code>, se tiene que seleccionar la casilla de <em>First Row as Names</em> y escoger el valor <em>Whitespace</em> en <em>Delimiter</em> (Figura @ref(fig:guardpearson)). Al pulsar el botón <em>Import</em>, se importará el fichero en un <em>data frame</em> con el nombre especificado en el campo <em>Name</em> y se verá su contenido en la ventana de ficheros si se ha seleccionado la casilla <em>Open Data Viewer</em>.</li>
</ul>
<!--
AAAAAAAAAAAAAAAA arreglar problemas con la caption que no va en latex
Opciones para guardar el fichero `pearson.txt` en un *data frame* llamado df_pearson usando el menú *Import Dataset*.
-->
<div class="figure" style="text-align: center">
<img src="AprendeR-Parte-I_files/figure-html/guardpearson.png" alt="Opciones para guardar el fichero *pearson.txt* en un *data frame* llamado *df_pearson* usando el menú *Import Dataset*." width="90%" />
<p class="caption">
(#fig:guardpearson)Opciones para guardar el fichero <em>pearson.txt</em> en un <em>data frame</em> llamado <em>df_pearson</em> usando el menú <em>Import Dataset</em>.
</p>
</div>
<ul>
<li>Usando la instrucción <code>read.table</code>, de la que también hablaremos en la Lección @ref(chap:df); por ahora simplemente hay que saber que se ha de aplicar al nombre del fichero entre comillas, si está en el directorio de trabajo, o a su <code>url</code>, también escrito entre comillas. Si además el fichero contiene una primera fila con los nombres de las columnas, hay que añadir el parámetro <code>header=TRUE</code>.</li>
</ul>
<p>Así pues, para cargar esta tabla de datos concreta en un <em>data frame</em> llamado <code>df_pearson</code>, podemos usar el menú <em>Import Dataset</em>, o entrar la instrucción siguiente:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true"></a>df_pearson=<span class="kw">read.table</span>(<span class="st">&quot;http://aprender.uib.es/Rdir/pearson.txt&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p>En ambos casos, para comprobar que se ha cargado bien, podemos usar las funciones <code>str</code>, que muestra la estructura del <em>data frame</em>, y <code>head</code>, que muestra sus primeras filas.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true"></a><span class="kw">str</span>(df_pearson)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    1078 obs. of  2 variables:</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true"></a><span class="co">#&gt;  $ Padres: num  65 63.3 65 65.8 61.1 ...</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true"></a><span class="co">#&gt;  $ Hijos : num  59.8 63.2 63.3 62.8 64.3 ...</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true"></a><span class="kw">head</span>(df_pearson)</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true"></a><span class="co">#&gt;     Padres    Hijos</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true"></a><span class="co">#&gt; 1 65.04851 59.77827</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true"></a><span class="co">#&gt; 2 63.25094 63.21404</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true"></a><span class="co">#&gt; 3 64.95532 63.34242</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true"></a><span class="co">#&gt; 4 65.75250 62.79238</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true"></a><span class="co">#&gt; 5 61.13723 64.28113</span></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true"></a><span class="co">#&gt; 6 63.02254 64.24221</span></span></code></pre></div>
<p>El resultado de <code>str(df_pearson)</code> nos dice que este <em>data frame</em> está formado por 1078 observaciones (filas) de dos variables (columnas) llamadas <code>Padres</code> e <code>Hijos</code>. El resultado de <code>head(df_pearson)</code> nos muestra sus primeras seis filas, que podemos comprobar que coinciden con las del fichero original mostrado en la Figura @ref(fig:pearson).</p>
<p>Calculemos la recta de regresión de las alturas de los hijos respecto de las de los padres: ahora las siguientes instrucciones:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true"></a><span class="kw">lm</span>(Hijos<span class="op">~</span>Padres, <span class="dt">data=</span>df_pearson)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true"></a><span class="co">#&gt; Call:</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true"></a><span class="co">#&gt; lm(formula = Hijos ~ Padres, data = df_pearson)</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true"></a><span class="co">#&gt; (Intercept)       Padres  </span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true"></a><span class="co">#&gt;     33.8866       0.5141</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">lm</span>(Hijos<span class="op">~</span>Padres, <span class="dt">data=</span>df_pearson))<span class="op">$</span>r.squared</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true"></a><span class="co">#&gt; [1] 0.2513401</span></span></code></pre></div>
<p>Obtenemos la recta de regresión
<span class="math display">\[
y=33.8866+0.5141x,
\]</span>
donde <span class="math inline">\(y\)</span> representa la altura de un hijo y <span class="math inline">\(x\)</span> la de su padre, y un coeficiente de determinación <span class="math inline">\(R^2=0.25\)</span>,
muy bajo. La regresión no es muy buena, como se puede observar en la Figura @ref(fig:pears2) que generamos con el código siguiente:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true"></a><span class="kw">plot</span>(df_pearson)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true"></a><span class="kw">abline</span>(<span class="kw">lm</span>(Hijos<span class="op">~</span>Padres, <span class="dt">data=</span>df_pearson),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03chap02_Un_aperitivo_files/figure-html/pears2-1.png" alt="Representación gráfica de las alturas de los hijos en función de la de sus padres, junto con su recta de regresión." width="90%" />
<p class="caption">
(#fig:pears2)Representación gráfica de las alturas de los hijos en función de la de sus padres, junto con su recta de regresión.
</p>
</div>
<p>Hemos usado el parámetro <code>col="red"</code> en el <code>abline</code> para que la recta de regresión sea roja y facilitar así su visualización en medio de la nube de puntos.</p>
</div>
<div id="rectas-de-regresión-y-transformaciones-logarítmicas" class="section level2" number="3.2">
<h2 number="3.2"><span class="header-section-number">3.2</span> Rectas de regresión y transformaciones logarítmicas</h2>
<p>La dependencia de un valor en función de otro no siempre es lineal. A veces podremos detectar otras dependencias (en concreto, exponenciales o potenciales) realizando un <strong>cambio de escala</strong> adecuado en el gráfico.</p>
<p>Cuando dibujamos un gráfico, lo normal es marcar cada eje de manera que la misma distancia entre marcas signifique la misma diferencia entre sus valores; por ejemplo, en el gráfico de la Figura @ref(fig:A301), las marcas sobre cada uno de los ejes están igualmente espaciadas, de manera que entre cada par de marcas consecutivas en el eje de abscisas hay una diferencia de 2 años y entre cada par de marcas consecutivas en el eje de ordenadas hay una diferencia de 20 cm.
Decimos entonces que los ejes están
en <strong>escala lineal</strong>.
Pero a veces es conveniente dibujar algún eje en <strong>escala logarítmica</strong>, situando las marcas de tal manera que la misma distancia entre marcas signifique el mismo <em>cociente</em> entre sus valores. Como el logaritmo transforma cocientes en restas, un eje en escala logarítmica representa el logaritmo de sus valores en escala lineal.</p>
<p>Decimos que un gráfico está en <strong>escala semilogarítmica</strong> cuando su eje de abscisas está en escala lineal y su eje de ordenadas en escala logarítmica. Salvo por los valores en las marcas sobre el eje de las <span class="math inline">\(y\)</span>, esto significa que dibujamos en escala lineal el gráfico de <span class="math inline">\(\log(y)\)</span> en función de <span class="math inline">\(x\)</span>. Así pues, si al representar unos puntos <span class="math inline">\((x,y)\)</span> en escala semilogarítmica observamos que siguen aproximadamente una recta, esto querrá decir que los valores <span class="math inline">\(\log(y)\)</span> siguen una ley aproximadamente lineal en los valores <span class="math inline">\(x\)</span>, y, por lo tanto, que <span class="math inline">\(y\)</span> sigue una ley aproximadamente exponencial en <span class="math inline">\(x\)</span>. En efecto, si <span class="math inline">\(\log(y)= ax+b\)</span>, entonces
<span class="math display">\[
y=10^{\log(y)}= 10^{ax+b}=10^{ax}\cdot 10^{b}=10^{b}\cdot (10^{a})^{x}=\beta\cdot \alpha^x,
\]</span>
donde <span class="math inline">\(\beta=10^b\)</span> y <span class="math inline">\(\alpha=10^a\)</span>.</p>
<p>De manera similar, decimos que un gráfico está en <strong>escala doble logarítmica</strong> cuando ambos ejes están en escala logarítmica. Esto es equivalente, de nuevo salvo por los valores en las marcas sobre los ejes, a dibujar en escala lineal el gráfico de <span class="math inline">\(\log(y)\)</span> en función de <span class="math inline">\(\log(x)\)</span>. Por consiguiente, si al dibujar unos puntos <span class="math inline">\((x,y)\)</span> en escala doble logarítmica observamos que siguen aproximadamente una recta, esto querrá decir que los valores <span class="math inline">\(\log(y)\)</span> siguen una ley aproximadamente lineal en los valores <span class="math inline">\(\log(x)\)</span>, y, por lo tanto, que <span class="math inline">\(y\)</span> sigue una ley aproximadamente potencial en <span class="math inline">\(x\)</span>. En efecto, si <span class="math inline">\(\log(y)= a\log(x)+b\)</span>, entonces
<span class="math display">\[
y=10^{\log(y)}= 10^{a\log(x)+b}=10^{a\log(x)}\cdot 10^{b}=10^{b}\cdot (10^{\log(x)})^{a}
=10^{b}\cdot x^{a}=\beta \cdot x^{a},
\]</span>
donde <span class="math inline">\(\beta=10^b\)</span>.</p>
<p>Veamos algunos ejemplos de regresiones lineales con cambios de escala.</p>

<div class="example">
<p><span id="exm:reg3" class="example"><strong>(#exm:reg3) </strong></span>La serotonina se asocia a la estabilidad emocional en el hombre. En un experimento (véase el artículo de B. Peskar y S. Spector “Serotonin: Radioimmunoassay” en <em>Science</em> 179 (1973), pp. 1340-1341) se midió, para algunas cantidades de serotonina (expresadas en <em>nanogramos</em>, la milmillonésima parte de un gramo), el porcentaje de inhibición de un cierto proceso bioquímico en el que se observaba su presencia. El objetivo era estimar la cantidad de serotonina presente en un tejido a partir del porcentaje de inhibición observado. Los datos que se obtuvieron son los de la Tabla @ref(tab:T4).</p>
</div>
<table>
<caption>(#tab:T4)Porcentajes de inhibición de un cierto proceso bioquímico en presencia de serotonina.</caption>
<thead>
<tr class="header">
<th align="right">serotonina (ng)</th>
<th align="right">inhibición (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1.2</td>
<td align="right">19</td>
</tr>
<tr class="even">
<td align="right">3.6</td>
<td align="right">36</td>
</tr>
<tr class="odd">
<td align="right">12.0</td>
<td align="right">60</td>
</tr>
<tr class="even">
<td align="right">33.0</td>
<td align="right">84</td>
</tr>
</tbody>
</table>
<!--
```
\begin{table}[htb]
\begin{center}
\abovecaptionskip=6pt
\begin{tabular}{ccccc}
\toprule
serotonina (ng) & 1.2 & 3.6 & 12 & 33 \\
\midrule
inhibición (\%) & 19 & 36 & 60 & 84 \\
\bottomrule
\end{tabular}
\caption{Porcentajes de inhibición de un cierto proceso bioquímico en presencia de serotonina.}\label{tab:4}
\end{center}
\end{table}
```
-->
<p>Como queremos predecir la cantidad de serotonina en función de la inhibición observada, consideraremos los pares (inhibición,serotonina). En esta ocasión, en vez de trabajar con un <em>data frame</em>, trabajaremos directamente con los vectores.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true"></a>inh=<span class="kw">c</span>(<span class="dv">19</span>,<span class="dv">36</span>,<span class="dv">60</span>,<span class="dv">84</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true"></a>ser=<span class="kw">c</span>(<span class="fl">1.2</span>,<span class="fl">3.6</span>,<span class="dv">12</span>,<span class="dv">33</span>)</span></code></pre></div>
<p>Con la instrucción siguiente obtenemos la Figura @ref(fig:F304bis), donde vemos claramente que la cantidad de serotonina no es función lineal de la inhibición.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true"></a><span class="kw">plot</span>(inh, ser)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03chap02_Un_aperitivo_files/figure-html/F304bis-1.png" alt="Representación gráfica en escala lineal del porcentaje de inhibición en función de la cantidad de serotonina." width="90%" />
<p class="caption">
(#fig:F304bis)Representación gráfica en escala lineal del porcentaje de inhibición en función de la cantidad de serotonina.
</p>
</div>
<!--
```
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.45\textwidth]{regr-ser1.pdf}
\end{center}
\caption{Representación gráfica en escala lineal del porcentaje de inhibición en función de la cantidad de serotonina.}\label{fig:3.4}
\end{figure}
```
-->
<p>Vamos a dibujar ahora el gráfico semilogarítmico de estos puntos, para ver si de esta manera quedan sobre una recta. Para ello, tenemos que añadir al argumento de <code>plot</code> el parámetro <code>log="y"</code>.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true"></a><span class="kw">plot</span>(inh, ser, <span class="dt">log=</span><span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03chap02_Un_aperitivo_files/figure-html/F305bis-1.png" alt="Representación gráfica en escala semilogarítmica del porcentaje de inhibición en función de la cantidad de serotonina." width="90%" />
<p class="caption">
(#fig:F305bis)Representación gráfica en escala semilogarítmica del porcentaje de inhibición en función de la cantidad de serotonina.
</p>
</div>
<!--
```
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.45\textwidth]{regr-ser2.pdf}
\end{center}
\caption{Representación gráfica en escala semilogarítmica del porcentaje de inhibición en función de la cantidad de serotonina.}\label{fig:3.5}
\end{figure}
```
-->
<p>Obtenemos la Figura @ref(fig:F305bis). Observad cómo las marcas en el eje de ordenadas no están distribuidas de manera lineal: la distancia de 5 a 10 es la misma que de 10 a 20. Los puntos en este gráfico sí que parecen seguir una recta. Por lo tanto, parece que el logaritmo de la cantidad de serotonina es una función aproximadamente lineal del porcentaje de inhibición.
Para confirmarlo, calcularemos la recta de regresión de los puntos</p>
<p><span class="math display">\[
(\textrm{inhibición}_n,\log(\textrm{serotonina}_n))_{n=1,\ldots,4}.
\]</span>
Para calcular los logaritmos en base 10 de todas las cantidades de serotonina en un solo paso, podemos aplicar la función <code>log10</code> directamente al vector <code>ser</code>.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true"></a><span class="kw">log10</span>(ser)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.07918125 0.55630250 1.07918125 1.51851394</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true"></a><span class="kw">lm</span>(<span class="kw">log10</span>(ser)<span class="op">~</span>inh)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true"></a><span class="co">#&gt; Call:</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true"></a><span class="co">#&gt; lm(formula = log10(ser) ~ inh)</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true"></a><span class="co">#&gt; (Intercept)          inh  </span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true"></a><span class="co">#&gt;    -0.28427      0.02196</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">lm</span>(<span class="kw">log10</span>(ser)<span class="op">~</span>inh))<span class="op">$</span>r.squared</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true"></a><span class="co">#&gt; [1] 0.9921146</span></span></code></pre></div>
<p>El resultado indica que la recta de regresión de estos puntos es
<span class="math inline">\(y= 0.02196x-0.28427\)</span>, con un valor de <span class="math inline">\(R^2\)</span> de 0.992, muy bueno.
Por lo tanto, podemos afirmar que, aproximadamente,</p>
<p><span class="math display">\[
\log(\textrm{serotonina})= 0.02196\cdot \mbox{inhibición}-0.28427.
\]</span>
Elevando 10 a cada uno de los lados de esta identidad, obtenemos</p>
<p><span class="math display">\[\begin{align*}
\textrm{serotonina} = &amp; 10^{\log(\textrm{serotonina})}= 10^{-0.28427}\cdot 10^{0.02196\cdot \textrm{inhibición}} \\ = &amp;  0.52\cdot 1.052^{\textrm{inhibición}}.
\end{align*}\]</span>
Es decir, los puntos de partida siguen aproximadamente la función exponencial</p>
<p><span class="math display">\[
y=0.52\cdot 1.052^{x}.
\]</span></p>
<p>Vamos ahora a dibujar en un mismo gráfico
los puntos <span class="math inline">\((\textrm{inhibición}_n,\textrm{serotonina}_n)\)</span> y esta función exponencial. Para añadir la gráfica de una función <span class="math inline">\(y=f(x)\)</span> al gráfico activo en la pestaña <em>Plots</em> podemos emplear la función</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true"></a><span class="kw">curve</span>(<span class="kw">f</span>(x), <span class="dt">add=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p>Así, el código siguiente produce la Figura @ref(fig:F306bis); fijaos en cómo hemos especificado la función <span class="math inline">\(y=0.52\cdot 1.052^{x}\)</span> dentro del <code>curve</code>.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true"></a><span class="kw">plot</span>(inh, ser)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true"></a><span class="kw">curve</span>(<span class="fl">0.52</span><span class="op">*</span><span class="fl">1.052</span><span class="op">^</span>x, <span class="dt">add=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03chap02_Un_aperitivo_files/figure-html/F306bis-1.png" alt="Representación gráfica en escala lineal del porcentaje de inhibición en función de la cantidad de serotonina, junto con la función $y=0.52\cdot 1.052^x$." width="90%" />
<p class="caption">
(#fig:F306bis)Representación gráfica en escala lineal del porcentaje de inhibición en función de la cantidad de serotonina, junto con la función <span class="math inline">\(y=0.52\cdot 1.052^x\)</span>.
</p>
</div>
<!--
```
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.45\textwidth]{regr-ser3.pdf}
\end{center}
\caption{Representación gráfica en escala lineal del porcentaje de inhibición en función de la cantidad de serotonina, junto con la función $y=0.52\cdot 1.052^x$.}\label{fig:3.6}
\end{figure}
```
-->
<p>Ahora podemos usar la relación observada,</p>
<p><span class="math display">\[
\textrm{serotonina}= 0.52\cdot 1.052^{\textrm{inhibición}},
\]</span>
para estimar la cantidad de serotonina presente en el tejido a partir de una inhibición concreta. Por ejemplo, si hemos observado un 25% de inhibición, podemos estimar que la cantidad de serotonina es
0.52·1.052<sup>25</sup>=1.84 ng</p>

<div class="example">
<p><span id="exm:reg4" class="example"><strong>(#exm:reg4) </strong></span>Consideremos ahora los datos de la Tabla @ref(tab:sida). Se trata de los números acumulados de casos de SIDA en los Estados Unidos desde 1981 hasta 1992, extraídos del <em>HIV/AIDS Surveillance Report</em> de 1993 (<a href="http://www.cdc.gov/hiv/topics/surveillance/resources/reports/index.htm">http://www.cdc.gov/hiv/topics/surveillance/resources/reports/index.htm</a>). <em>Acumulados</em> significa que, para cada año, se da el número de casos detectados <em>hasta</em> entonces.</p>
</div>
<table>
<caption>(#tab:sida)Números acumulados anuales de casos de SIDA en los Estados Unidos, 1981 a 1992.</caption>
<thead>
<tr class="header">
<th align="right">año</th>
<th align="right">casos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1981</td>
<td align="right">97</td>
</tr>
<tr class="even">
<td align="right">1982</td>
<td align="right">709</td>
</tr>
<tr class="odd">
<td align="right">1983</td>
<td align="right">2698</td>
</tr>
<tr class="even">
<td align="right">1984</td>
<td align="right">6928</td>
</tr>
<tr class="odd">
<td align="right">1985</td>
<td align="right">15242</td>
</tr>
<tr class="even">
<td align="right">1986</td>
<td align="right">29944</td>
</tr>
<tr class="odd">
<td align="right">1987</td>
<td align="right">52902</td>
</tr>
<tr class="even">
<td align="right">1988</td>
<td align="right">83903</td>
</tr>
<tr class="odd">
<td align="right">1989</td>
<td align="right">120612</td>
</tr>
<tr class="even">
<td align="right">1990</td>
<td align="right">161711</td>
</tr>
<tr class="odd">
<td align="right">1991</td>
<td align="right">206247</td>
</tr>
<tr class="even">
<td align="right">1992</td>
<td align="right">257085</td>
</tr>
</tbody>
</table>
<!--
\begin{table}[htb]
\begin{center}
\abovecaptionskip=7pt
\begin{tabular}{ccccccccccccc}
\toprule
año & 1981 & 1982 &1983 &1984& 1985 &1986 &1987 &1988 \\
\midrule
casos & 97 & 709 & 2698 & 6928 & 15242 & 29944 & 52902 & 83903 \\
\bottomrule
año &1989\vphantom{$A^{\mbox{ A}}$} &1990& 1991 &1992\\
\midrule
casos & 120612 & 161711 & 206247 & 257085\\
\bottomrule
\end{tabular}
\caption{Números acumulados anuales de casos de SIDA en los Estados Unidos.}
\label{tab:3}
\end{center}
\end{table}
-->
<p>Queremos estudiar el comportamiento de estos números acumulados de casos en función del tiempo expresado en años a partir de 1980. Lo primero que hacemos es cargar los datos en un <em>data frame</em>. Fijaos en que la lista de años va a ser la secuencia de números consecutivos entre 1 y 12. Para definir la secuencia de números consecutivos entre <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span> podemos usar la construcción <code>a:b</code>. Esto nos ahorra trabajo y reduce las oportunidades de cometer errores al escribir los números.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true"></a>tiempo=<span class="dv">1</span><span class="op">:</span><span class="dv">12</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true"></a>SIDA_acum=<span class="kw">c</span>(<span class="dv">97</span>,<span class="dv">709</span>,<span class="dv">2698</span>,<span class="dv">6928</span>,<span class="dv">15242</span>,<span class="dv">29944</span>,<span class="dv">52902</span>,<span class="dv">83903</span>,<span class="dv">120612</span>,<span class="dv">161711</span>,<span class="dv">206247</span>,<span class="dv">257085</span>)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true"></a>df_SIDA=<span class="kw">data.frame</span>(tiempo, SIDA_acum)</span></code></pre></div>
<p>Con la instrucción siguiente dibujamos estos datos:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true"></a><span class="kw">plot</span>(df_SIDA)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03chap02_Un_aperitivo_files/figure-html/F307a-1.png" alt="Representación gráfica en escala lineal  del número acumulado de casos de SIDA en EEUU desde 1980 en función de los años transcurridos desde ese año." width="90%" />
<p class="caption">
(#fig:F307a)Representación gráfica en escala lineal del número acumulado de casos de SIDA en EEUU desde 1980 en función de los años transcurridos desde ese año.
</p>
</div>
<p>Obtenemos el gráfico de la Figura @ref(fig:F307a), y está claro que los puntos <span class="math inline">\((x_n,y_n)\)</span>, donde <span class="math inline">\(x\)</span> representa el año e <span class="math inline">\(y\)</span> el número acumulado de casos de SIDA, no se ajustan a una recta. De hecho, a simple vista se diría que el crecimiento de <span class="math inline">\(y\)</span> en función de <span class="math inline">\(x\)</span> es exponencial.</p>
<p>Para confirmar este crecimiento exponencial, dibujamos el gráfico semilogarítmico:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true"></a><span class="kw">plot</span>(df_SIDA, <span class="dt">log=</span><span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03chap02_Un_aperitivo_files/figure-html/F307b-1.png" alt="Representación gráfica en escala semilogarítmica  del número acumulado de casos de SIDA en EEUU desde 1980 en función de los años transcurridos desde ese año." width="90%" />
<p class="caption">
(#fig:F307b)Representación gráfica en escala semilogarítmica del número acumulado de casos de SIDA en EEUU desde 1980 en función de los años transcurridos desde ese año.
</p>
</div>
<p>Obtenemos el gráfico de la Figura @ref(fig:F307b), donde los puntos tampoco siguen una recta. Así pues, resulta que <span class="math inline">\(y\)</span> tampoco parece ser función exponencial de <span class="math inline">\(x\)</span>.</p>
<p>Vamos a ver si el crecimiento de <span class="math inline">\(y\)</span> en función de <span class="math inline">\(x\)</span> es potencial. Para ello, dibujaremos un gráfico doble logarítmico de los puntos <span class="math inline">\((x_n,y_n)\)</span>, especificando <code>log="xy"</code> dentro del argumento de <code>plot</code>.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true"></a><span class="kw">plot</span>(df_SIDA, <span class="dt">log=</span><span class="st">&quot;xy&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03chap02_Un_aperitivo_files/figure-html/F307c-1.png" alt="Representación gráfica en escala doble logarítmica  del número acumulado de casos de SIDA en EEUU desde 1980 en función de los años transcurridos desde ese año." width="90%" />
<p class="caption">
(#fig:F307c)Representación gráfica en escala doble logarítmica del número acumulado de casos de SIDA en EEUU desde 1980 en función de los años transcurridos desde ese año.
</p>
</div>
<p>Obtenemos el gráfico de la Figura @ref(fig:F307c), y ahora sí que parece lineal. Así que parece que los números acumulados de casos de SIDA crecieron potencialmente con el transcurso de los años.</p>
<p>Lo que haremos ahora será calcular la recta de regresión del logaritmo de <code>SIDA_acum</code> respecto del logaritmo de <code>tiempo</code> y mirar el coeficiente de determinación. Recordad que podemos aplicar una función a todas las entradas de un vector en un solo paso.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true"></a><span class="kw">lm</span>(<span class="kw">log10</span>(SIDA_acum)<span class="op">~</span><span class="kw">log10</span>(tiempo), <span class="dt">data=</span>df_SIDA)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true"></a><span class="co">#&gt; Call:</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true"></a><span class="co">#&gt; lm(formula = log10(SIDA_acum) ~ log10(tiempo), data = df_SIDA)</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true"></a><span class="co">#&gt;   (Intercept)  log10(tiempo)  </span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true"></a><span class="co">#&gt;         1.918          3.274</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">lm</span>(<span class="kw">log10</span>(SIDA_acum)<span class="op">~</span><span class="kw">log10</span>(tiempo), <span class="dt">data=</span>df_SIDA))<span class="op">$</span>r.squared</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true"></a><span class="co">#&gt; [1] 0.9983866</span></span></code></pre></div>
<p>La regresión que obtenemos es <span class="math inline">\(\log(y)=1.918 + 3.274\log(x)\)</span>, con un valor de <span class="math inline">\(R^2\)</span> de 0.998, muy alto.
Elevando 10 a ambos lados de esta igualdad, obtenemos</p>
<p><span class="math display">\[\begin{align*}
y=10^{\log(y)}= &amp; 10^{1.918}\cdot 10^{3.274\log(x)}=10^{1.918}\cdot (10^{\log(x)})^{3.274}
\\ = &amp; 82.79422\cdot x^{3.274}.
\end{align*}\]</span>
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</p>
<p><span class="math display">\[
y=82.79422\cdot x^{3.274},
\]</span>
dibujaremos los puntos y la curva en un único gráfico (en escala lineal):</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true"></a><span class="kw">plot</span>(df_SIDA)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true"></a><span class="kw">curve</span>(<span class="fl">82.79422</span><span class="op">*</span>x<span class="op">^</span><span class="fl">3.274</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03chap02_Un_aperitivo_files/figure-html/SF3010-1.png" alt="Representación gráfica en escala lineal de la cantidad acumulada de enfermos de SIDA en EEUU desde 1980 en función de los años transcurridos desde ese año, junto con su ajuste mediante la función potencial $82.79422 · x^{3.274}$." width="90%" />
<p class="caption">
(#fig:SF3010)Representación gráfica en escala lineal de la cantidad acumulada de enfermos de SIDA en EEUU desde 1980 en función de los años transcurridos desde ese año, junto con su ajuste mediante la función potencial <span class="math inline">\(82.79422 · x^{3.274}\)</span>.
</p>
</div>
<p>Obtenemos la Figura
@ref(fig:SF3010), donde vemos que la curva se ajusta bastante bien a los puntos.</p>
<!--
\begin{figure}[h]
\begin{center}
\includegraphics[width=0.45\textwidth]{regr9.pdf}
\end{center}
\caption{Representación gráfica en escala lineal de la cantidad acumulada de enfermos de SIDA en EEUU desde 1980 en función de los años transcurridos desde ese año, junto con su ajuste mediante la función potencial $82.79422\cdot x^{3.274}$.}\label{fig:3.10} 
\end{figure}
-->
<p>Hay que mencionar aquí que se han propuesto modelos matemáticos que predicen que, cuando se inicia una epidemia de SIDA en una población, los números acumulados de casos en los primeros años son proporcionales al cubo del tiempo transcurrido desde el inicio; véase, por ejemplo, el artículo de S.A. Colgate, E. A. Stanley, J. M. Hyman, S. P. Layne y C. Qualls “Risk behavior-based model of the cubic growth of acquired immunodeficiency syndrome in the United States”, en <em>PNAS</em> 86 (1989), pp. 4793-4797. El resultado del análisis que hemos realizado es consistente con esta predicción teórica.</p>
</div>
<div id="guía-rápida-2" class="section level2" number="3.3">
<h2 number="3.3"><span class="header-section-number">3.3</span> Guía rápida</h2>
<ul>
<li><code>c</code> sirve para definir vectores.</li>
<li><code>a:b</code>, con a&lt;b, define un vector con la secuencia a,a+1,a+2,…, b.</li>
<li><code>data.frame</code>, aplicada a unos vectores de la misma longitud, define un <em>data frame</em> (el tipo de objetos de R en los que guardamos usualmente las tablas de datos) cuyas columnas serán estos vectores.</li>
<li><code>read.table</code> define un <em>data frame</em> a partir de un fichero externo. También se puede usar el menú <em>Import Dataset</em> de la pestaña <em>Environment</em> en la ventana superior derecha de <em>RStudio</em>.</li>
<li><code>lm(y~x)</code> calcula la recta de regresión del vector <span class="math inline">\(y\)</span> respecto del vector <span class="math inline">\(x\)</span>. Si <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span> son dos columnas de un <em>data frame</em>, éste se ha de especificar en el argumento mediante el parámetro <code>data</code> igualado al nombre del <em>data frame</em>.</li>
<li><code>summary</code> sirve para obtener un resumen estadístico de un objeto. Este resumen depende del objeto. En el caso de una recta de regresión calculada con <code>lm</code>, muestra una serie de información estadística extra obtenida en dicho cálculo.</li>
<li><code>plot(x, y)</code> produce el gráfico de los puntos <span class="math inline">\((x_n,y_n)\)</span>. Si <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span> son, respectivamente, la primera y la segunda columna de un <em>data frame</em> de dos columnas, se le puede entrar directamente el nombre del <em>data frame</em> como argumento. El parámetro <code>log</code> sirve para indicar los ejes que se desea que estén en escala logarítmica: <code>"x"</code> (abscisas),
<code>"y"</code> (ordenadas) o <code>"xy"</code> (ambos).</li>
<li><code>abline</code> añade una recta al gráfico activo.</li>
<li><code>curve(función, add=TRUE)</code> añade la gráfica de la <code>función</code> al gráfico activo.</li>
</ul>
</div>
<div id="ejercicios-1" class="section level2" number="3.4">
<h2 number="3.4"><span class="header-section-number">3.4</span> Ejercicios</h2>
<div id="ejercicio-1" class="section level3 unnumbered">
<h3 class="unnumbered">Ejercicio</h3>
<p>Las larvas de <em>Lymantria dispar</em>, conocidas como <em>orugas peludas del alcornoque</em>, son una plaga en bosques y huertos. En un experimento se quiso determinar la capacidad de atracción de una cierta feromona sobre los machos de esta especie, con el objetivo de emplearla en trampas (véase el artículo de M. Beroza y E. F. Knipling “Gypsy moth control with the sex attractant pheromone” en <em>Science</em> 177 (1972), pp. 19-27).
En la Tabla @ref(tab:cuques), <span class="math inline">\(x\)</span> representa la cantidad de feromona empleada, en microgramos (la millonésima parte de un gramo) y <span class="math inline">\(N\)</span> el número de machos atrapados en una trampa empleando esta cantidad de feromona para atraerlos.</p>
<table>
<caption>(#tab:cuques)Cantidades de feromona empleadas en trampas y números de machos atrapados.</caption>
<thead>
<tr class="header">
<th align="right"><span class="math inline">\(x\)</span></th>
<th align="right"><span class="math inline">\(N\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.1</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">1.0</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">5.0</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="right">10.0</td>
<td align="right">11</td>
</tr>
<tr class="odd">
<td align="right">100.0</td>
<td align="right">20</td>
</tr>
</tbody>
</table>
<!--
\begin{table}[htb]
\abovecaptionskip=7pt
\begin{center}
\begin{tabular}{lccccc}
\toprule
$x$ & 0.1 & 1 & 5 & 10 & 100 \\
\midrule
$N$ & 3 & 6 & 9 & 11 & 20 \\
\bottomrule
\end{tabular}
\caption{Cantidades de feromona empleadas en trampas y números de machos atrapados.}\label{tabla:cuques}
\end{center}
\end{table}
-->
<ol style="list-style-type: decimal">
<li><p>Decidid si, en los puntos <span class="math inline">\((x,N)\)</span> dados en la Tabla @ref(tab:cuques), el valor de <span class="math inline">\(N\)</span> sigue una función aproximadamente lineal, exponencial o potencial en el valor de <span class="math inline">\(x\)</span>.</p></li>
<li><p>En caso de ser una función de uno de estos tres tipos, calculadla.</p></li>
<li><p>Representad en un gráfico los puntos <span class="math inline">\((x,N)\)</span> de la Tabla @ref(tab:cuques) y la función que hayáis calculado en el apartado anterior, para visualizar la bondad del ajuste de la curva a los puntos.</p></li>
<li><p>Estimad cuánta feromona tenemos que usar en una trampa para atraer a 50 machos.</p></li>
</ol>
<!--chapter:end:03chap02_Un_aperitivo.Rmd-->
</div>
</div>
</div>
<div id="chap:vect" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Vectores y otros tipos de listas</h1>
<p>Un <strong>vector</strong> es una secuencia ordenada de datos. R dispone de muchos tipos de datos, entre los que destacamos:</p>
<ul>
<li><code>logical</code> (lógicos: <code>TRUE</code>, verdadero, o <code>FALSE</code>, falso)</li>
<li><code>integer</code> (números enteros)</li>
<li><code>numeric</code> o <code>double</code> (números reales)</li>
<li><code>complex</code> (números complejos)</li>
<li><code>character</code> (palabras)</li>
</ul>
<p>Una restricción fundamental de los vectores en R es que todos sus objetos han de ser del mismo tipo: todos números, todos palabras, etc.
Cuando queramos usar vectores formados por objetos de diferentes tipos, tendremos que usar <strong>listas heterogéneas</strong> (véase la Sección @ref(sec:lists)).</p>
<div id="sec:vect" class="section level2" number="4.1">
<h2 number="4.1"><span class="header-section-number">4.1</span> Construcción de vectores</h2>
<p>Para definir un vector con unos elementos dados, por ejemplo</p>
<p style="text-align:center">
1, 5, 6, 2, 5, 7, 8, 3, 5, 2, 1, 0
</p>
<p>podemos aplicar la función <code>c</code> a estos elementos separados por comas.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true"></a>x=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true"></a>x</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true"></a><span class="co">#&gt;  [1] 1 5 6 2 5 7 8 3 5 2 1 0</span></span></code></pre></div>
<p>Si queremos crear un vector de palabras con la instrucción <code>c</code>, tenemos que entrarlas obligatoriamente entre comillas. R también nos las muestra entre comillas.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true"></a>nombres=<span class="kw">c</span>(<span class="st">&quot;Pep&quot;</span>,<span class="st">&quot;Catalina&quot;</span>,<span class="st">&quot;Joan&quot;</span>,<span class="st">&quot;Pau&quot;</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true"></a>nombres</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;Pep&quot;      &quot;Catalina&quot; &quot;Joan&quot;     &quot;Pau&quot;</span></span></code></pre></div>
<p>Si nos olvidamos de las comillas:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true"></a>nombres=<span class="kw">c</span>(Pep,Catalina,Joan,Pau)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;Pep&#39; no encontrado</span></span></code></pre></div>
<p>Hemos mencionado que todos los elementos de un vector han de ser del mismo tipo. Por este motivo, si juntamos datos de diferentes tipos en un vector, R automáticamente los convertirá a un tipo que pueda ser común a todos ellos. El orden de conversión entre los tipos que hemos explicado al principio de la lección es: <code>character</code> gana a <code>complex</code>, que gana a <code>numeric</code>, que gana a <code>integer</code>, que gana a <code>logical</code>. Así, cuando alguna entrada de un vector es de tipo palabra, R considera el resto de sus entradas como palabras (y las muestra entre comillas), como se puede ver en el siguiente ejemplo:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true"></a><span class="kw">c</span>(<span class="dv">2</span>,<span class="fl">3.5</span>,<span class="ot">TRUE</span>,<span class="st">&quot;casa&quot;</span>)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;2&quot;    &quot;3.5&quot;  &quot;TRUE&quot; &quot;casa&quot;</span></span></code></pre></div>
<p>Otra posibilidad para crear un vector es usar la función <code>scan</code>.
Si ejecutamos la instrucción <code>scan()</code> (así, con el argumento vacío), R abre en la consola un entorno de diálogo donde podemos ir entrando datos separados por espacios en blanco; cada vez que pulsemos la tecla <em>Entrar</em>, R importará los datos que hayamos escrito desde la vez anterior en que la pulsamos y abrirá una nueva línea donde esperará más datos; cuando hayamos acabado, dejamos la última línea en blanco (pulsando por última vez la tecla <em>Entrar</em>) y R cerrará el vector.</p>
<p>Por ejemplo, para crear un vector <code>x_scan</code> que contenga dos copias de</p>
<p style="text-align:center">
1, 5, 6, 2, 5, 7, 8, 3, 5, 2, 1, 0
</p>
<p>una posibiidad sería primero entrar <code>scan()</code>, a continuación copiar esta secuencia con el editor de textos y pegarla dos veces en la última línea de la consola, pulsando <em>Entrar</em> después de cada vez, y finalmente pulsar <em>Entrar</em> por tercera vez en la última línea en blanco. Probadlo vosotros.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true"></a>x_scan=<span class="kw">scan</span>()  <span class="co">#Y pulsamos Entrar</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true"></a><span class="dv">1</span><span class="op">:</span><span class="st"> </span><span class="dv">1</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">2</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">0</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true"></a><span class="dv">13</span><span class="op">:</span><span class="st"> </span><span class="dv">1</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">2</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">0</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true"></a><span class="dv">25</span><span class="op">:</span><span class="st"> </span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true"></a>Read <span class="dv">24</span> items</span></code></pre></div>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true"></a>x_scan</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true"></a><span class="co">#&gt;  [1] 1 5 6 2 5 7 8 3 5 2 1 0 1 5 6 2 5 7 8 3 5 2 1 0</span></span></code></pre></div>
<p>La función <code>scan</code> también se puede usar para copiar en un vector el contenido de un fichero de texto situado en el directorio de trabajo, o del que conozcamos su dirección en Internet. La manera de hacerlo es aplicando <code>scan</code>
al nombre del fichero o a su <em>url</em>, entrados en ambos casos entre comillas. Por ejemplo, para definir un vector llamado <code>notas</code> con las notas de un examen que tenemos guardadas en el fichero
<a href="http://aprender.uib.es/Rdir/notas.txt">http://aprender.uib.es/Rdir/notas.txt</a> , sólo tenemos que entrar:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true"></a>notas=<span class="kw">scan</span>(<span class="st">&quot;http://aprender.uib.es/Rdir/notas.txt&quot;</span>)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true"></a>notas</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true"></a><span class="co">#&gt;  [1]  4.1  7.8  5.8  6.5  4.8  6.9  1.3  6.4  4.6  6.9  9.4  3.0  6.8  4.8  5.6</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true"></a><span class="co">#&gt; [16]  7.7 10.0  4.4  1.7  8.0  6.3  3.0  7.5  3.8  7.2  5.7  7.3  6.0  5.7  4.7</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true"></a><span class="co">#&gt; [31]  5.1  1.5  7.0  7.0  6.0  6.6  7.2  5.0  3.5  3.3  4.7  5.4  7.1  8.2  6.7</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true"></a><span class="co">#&gt; [46]  0.1  5.1  6.8  6.9  8.8  4.5  6.6  2.0  3.0  6.7  7.9  7.7  6.4  3.0  5.3</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true"></a><span class="co">#&gt; [61]  5.1  5.3  5.1  5.4  3.0</span></span></code></pre></div>
<p>Si primero descargamos este fichero, sin cambiarle el nombre, en el directorio de trabajo de R, para definir el vector anterior bastará entrar:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true"></a>notas2=<span class="kw">scan</span>(<span class="st">&quot;notas.txt&quot;</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true"></a>notas2</span></code></pre></div>
<p>Si usamos el menú <em>Import Dataset</em> de la pestaña <em>Environment</em> para importar un vector contenido en un fichero externo como explicamos en el Ejemplo @ref(exm:reg2), obtendremos en realidad un <em>data frame</em> de una sola columna, llamada <code>V1</code>. Para construir un vector con esta columna, podemos usar luego la instrucción</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true"></a>nombre_del_vector=nombre_del_dataframe<span class="op">$</span>V1</span></code></pre></div>
<p>Véase la Lección @ref(chap:df) para más detalles.</p>
<p>La función <code>scan</code> dispone de muchos parámetros, que podéis consultar en su Ayuda. Estos parámetros se entran entre los paréntesis de <code>scan()</code>. Los más útiles en este momento son los siguientes:</p>
<ul>
<li><code>sep</code>: sirve para indicar el signo usado para separar entradas consecutivas si no son espacios en blanco. Para ello se ha de igualar <code>sep</code> a este signo, entrecomillado. Por ejemplo, si vamos a entrar las entradas separadas por comas (o si están así en el fichero que vamos a importar), tenemos que especificar <code>sep=","</code>.</li>
</ul>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true"></a>x_scan2=<span class="kw">scan</span>()  </span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true"></a><span class="dv">1</span><span class="op">:</span><span class="st"> </span><span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true"></a><span class="dv">1</span><span class="op">:</span><span class="st"> </span></span></code></pre></div>
<pre><code>## Error in scan() : scan() expected &#39;a real&#39;, got &#39;1,2,3,4&#39;</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true"></a>x_scan2=<span class="kw">scan</span>(<span class="dt">sep=</span><span class="st">&quot;,&quot;</span>)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true"></a><span class="dv">1</span><span class="op">:</span><span class="st"> </span><span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true"></a><span class="dv">5</span><span class="op">:</span><span class="st"> </span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true"></a>Read <span class="dv">4</span> items</span></code></pre></div>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true"></a>x_scan2</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true"></a><span class="co">#&gt; [1] 1 2 3 4</span></span></code></pre></div>
<ul>
<li><code>dec</code>: sirve para indicar el separador decimal cuando no es un punto.
Para ello hemos de igualar <code>dec</code> al separador decimal entre comillas.
Por ejemplo, si queremos crear con <code>scan</code> un vector formado por los dos números reales 4,5 y 6,2 escritos exactamente de esta manera, tenemos que especificar <code>dec=","</code>.</li>
</ul>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true"></a>x_scan3=<span class="kw">scan</span>()</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true"></a><span class="dv">1</span><span class="op">:</span><span class="st"> </span><span class="dv">4</span>,<span class="dv">5</span> <span class="dv">6</span>,<span class="dv">2</span></span></code></pre></div>
<pre><code>## Error in scan() : scan() expected &#39;a real&#39;, got &#39;4,5&#39;</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true"></a>x_scan3=<span class="kw">scan</span>(<span class="dt">dec=</span><span class="st">&quot;,&quot;</span>)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true"></a><span class="dv">1</span><span class="op">:</span><span class="st"> </span><span class="dv">4</span>,<span class="dv">5</span> <span class="dv">6</span>,<span class="dv">2</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true"></a><span class="dv">3</span><span class="op">:</span><span class="st"> </span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true"></a>Read <span class="dv">2</span> items</span></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true"></a>x_scan3</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true"></a><span class="co">#&gt; [1] 4.5 6.2</span></span></code></pre></div>
<ul>
<li><code>what</code>: sirve para indicar a R de qué tipo tiene que considerar los datos que se le entren. En particular,
<code>what="character"</code> especifica que los valores que se le entran son palabras, aunque no estén entre comillas (si se entran entre comillas, no hace falta especificarlo).</li>
</ul>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true"></a>x_scan4=<span class="kw">scan</span>()</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true"></a><span class="dv">1</span><span class="op">:</span><span class="st">  </span>Pep Catalina Joan Pau</span></code></pre></div>
<pre><code>## Error in scan() : scan() expected &#39;a real&#39;, got &#39;Pep&#39;</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true"></a>x_scan4=<span class="kw">scan</span>(<span class="dt">what=</span><span class="st">&quot;character&quot;</span>)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true"></a><span class="dv">1</span><span class="op">:</span><span class="st"> </span>Pep Catalina Joan Pau</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true"></a><span class="dv">5</span><span class="op">:</span><span class="st"> </span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true"></a>Read <span class="dv">4</span> items</span></code></pre></div>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true"></a>x_scan4</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;Pep&quot;      &quot;Catalina&quot; &quot;Joan&quot;     &quot;Pau&quot;</span></span></code></pre></div>
<ul>
<li><code>encoding</code>: sirve para indicar la codificación de alfabeto del fichero externo que se va a importar. Sólo es necesario especificarlo si dicho fichero contiene caracteres que no sean de 7 bits; o sea, letras acentuadas o caracteres especiales. En este caso, si su codificación no es la que espera nuestro ordenador y no la especificamos con este parámetro, estos caracteres se importarán mal. Sus dos posibles valores son <code>"latin1"</code> y <code>"UTF-8"</code>. Por ejemplo, si sois usuarios de Windows, seguramente vuestro ordenador espere que el fichero a importar esté codificado en <code>latin1</code>; entonces, si está codificado en <code>utf8</code> y contiene letras acentuadas, no las entenderá a no ser que especifiquéis <code>encoding="UTF-8"</code>.</li>
</ul>
<!--
Veamos un ejemplo en sentido contrario: en [http://aprender.uib.es/Rdir/enlatin1.txt](http://aprender.uib.es/Rdir/enlatin1.txt)  hemos guardado algunos nombres con acentos y hemos codificado el fichero en latin1. En la sesión siguiente se puede ver cómo si lo importamos desde un ordenador Mac sin avisar de la codificación, los acentos se traducen mal.




```r
x_scan5=scan("http://aprender.uib.es/Rdir/enlatin1.txt", what="character")
head(x_scan5, 20)
#>  [1] "estudio"        "bebe"           "sexo"           "1"             
#>  [5] "Informática"    "No"             "Mujer"          "2"             
#>  [9] "Matemáticas"    "No"             "Hombre"         "3"             
#> [13] "Ing.Industrial" "Sí"             "Mujer"          "4"             
#> [17] "Informática"    "Sí"             "Hombre"         "5"
x_scan6=scan("http://aprender.uib.es/Rdir/enlatin1.txt", what="character", encoding="latin1")
head(x_scan6, 20)
#>  [1] "estudio"        "bebe"           "sexo"           "1"             
#>  [5] "Informática"    "No"             "Mujer"          "2"             
#>  [9] "Matemáticas"    "No"             "Hombre"         "3"             
#> [13] "Ing.Industrial" "Sí"             "Mujer"          "4"             
#> [17] "Informática"    "Sí"             "Hombre"         "5"
```
-->
<p>Para definir un vector constante podemos usar la función</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true"></a><span class="kw">rep</span>(a, n)</span></code></pre></div>
<p>que genera un vector que contiene el valor <span class="math inline">\(a\)</span> repetido <span class="math inline">\(n\)</span> veces.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true"></a><span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">6</span>)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true"></a><span class="co">#&gt; [1] 1 1 1 1 1 1</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true"></a><span class="kw">rep</span>(<span class="st">&quot;Palma&quot;</span>, <span class="dv">5</span>) <span class="co">#Las palabras, siempre entre comillas</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;Palma&quot; &quot;Palma&quot; &quot;Palma&quot; &quot;Palma&quot; &quot;Palma&quot;</span></span></code></pre></div>
<p>La función <code>rep</code> también se puede usar para repetir vectores. Ahora bien, cuando decimos que queremos repetir cinco veces los valores 1, 2, 3, podemos referirnos a</p>
<p style="text-align:center">
1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3
</p>
<p>o a</p>
<p style="text-align:center">
1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3.
</p>
<p>Para especificar el tipo de repetición tenemos que usar el parámetro adecuado en el argumento de <code>rep</code>: si añadimos <code>times=5</code>, repetiremos el vector en bloque cinco veces (en el primer sentido), y si en cambio añadimos <code>each=5</code>, repetiremos cada valor cinco veces (en el segundo sentido).</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true"></a><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">times=</span><span class="dv">5</span>)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true"></a><span class="co">#&gt;  [1] 1 2 3 1 2 3 1 2 3 1 2 3 1 2 3</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true"></a><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">each=</span><span class="dv">5</span>)</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true"></a><span class="co">#&gt;  [1] 1 1 1 1 1 2 2 2 2 2 3 3 3 3 3</span></span></code></pre></div>
<p>Si queremos repetir cada elemento de un vector un número diferente de veces, podemos especificarlo con el parámetro <code>times</code> igualado al vector de estas multiplicidades.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true"></a><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="dt">times=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)) </span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true"></a><span class="co">#&gt;  [1] 1 1 2 2 2 3 3 3 3 4 4 4 4 4</span></span></code></pre></div>
<p>Las progresiones aritméticas se pueden especificar de manera compacta usando la función <code>seq</code>. Una primera manera de hacerlo es mediante la instrucción</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true"></a><span class="kw">seq</span>(a, b, <span class="dt">by=</span>p)</span></code></pre></div>
<p>que especifica la progresión aritmética de paso <span class="math inline">\(p\)</span> que empieza en <span class="math inline">\(a\)</span>,
<span class="math inline">\(a, a+p, a+2p, \ldots\)</span>, hasta llegar a <span class="math inline">\(b\)</span>. En concreto, si <span class="math inline">\(a&lt;b\)</span> y <span class="math inline">\(p&gt;0\)</span>, la función <code>seq(a, b, by=p)</code> genera un vector con la secuencia creciente
<span class="math inline">\(a,a+p,a+2p,\ldots\)</span> hasta llegar al último valor de esta sucesión menor o igual que <span class="math inline">\(b\)</span>. Por ejemplo:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true"></a><span class="kw">seq</span>(<span class="dv">3</span>, <span class="dv">150</span>, <span class="dt">by=</span><span class="fl">4.5</span>)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true"></a><span class="co">#&gt;  [1]   3.0   7.5  12.0  16.5  21.0  25.5  30.0  34.5  39.0  43.5  48.0  52.5</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true"></a><span class="co">#&gt; [13]  57.0  61.5  66.0  70.5  75.0  79.5  84.0  88.5  93.0  97.5 102.0 106.5</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true"></a><span class="co">#&gt; [25] 111.0 115.5 120.0 124.5 129.0 133.5 138.0 142.5 147.0</span></span></code></pre></div>
<p>Si en cambio <span class="math inline">\(a&gt;b\)</span> y <span class="math inline">\(p&lt;0\)</span>, entonces <code>seq(a, b, by=p)</code> genera un vector con la secuencia decreciente <span class="math inline">\(a,a+p, a+2p, \ldots\)</span>
hasta parar en el último valor de esta sucesión <code>mayor</code> o igual que <span class="math inline">\(b\)</span>. Por ejemplo:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true"></a><span class="kw">seq</span>(<span class="dv">80</span>, <span class="dv">4</span>, <span class="dt">by=</span><span class="op">-</span><span class="fl">3.5</span>)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true"></a><span class="co">#&gt;  [1] 80.0 76.5 73.0 69.5 66.0 62.5 59.0 55.5 52.0 48.5 45.0 41.5 38.0 34.5 31.0</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true"></a><span class="co">#&gt; [16] 27.5 24.0 20.5 17.0 13.5 10.0  6.5</span></span></code></pre></div>
<p>Finalmente, si el signo de <span class="math inline">\(p\)</span> no es el correcto, obtenemos un mensaje de error:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true"></a><span class="kw">seq</span>(<span class="dv">80</span>, <span class="dv">4</span>, <span class="dt">by=</span><span class="fl">3.5</span>)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true"></a><span class="co">#&gt; Error in seq.default(80, 4, by = 3.5): wrong sign in &#39;by&#39; argument</span></span></code></pre></div>
<p>Como vimos en la lección anterior, la instrucción <code>seq</code> con paso <span class="math inline">\(\pm 1\)</span> se puede abreviar con el signo <code>:</code>. La instrucción <code>a:b</code> define la secuencia de números consecutivos entre dos números <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span>, es decir, la secuencia <span class="math inline">\(a, a+1, a+2, \ldots\)</span> hasta llegar a <span class="math inline">\(b\)</span> (si <span class="math inline">\(a&lt; b\)</span>), o <span class="math inline">\(a, a-1, a-2, \ldots\)</span> hasta llegar a <span class="math inline">\(b\)</span> (si <span class="math inline">\(a&gt; b\)</span>).</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true"></a><span class="dv">1</span><span class="op">:</span><span class="dv">15</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true"></a><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true"></a><span class="fl">2.3</span><span class="op">:</span><span class="fl">12.5</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true"></a><span class="co">#&gt;  [1]  2.3  3.3  4.3  5.3  6.3  7.3  8.3  9.3 10.3 11.3 12.3</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true"></a><span class="dv">34</span><span class="op">:-</span><span class="dv">5</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true"></a><span class="co">#&gt;  [1] 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true"></a><span class="co">#&gt; [26]  9  8  7  6  5  4  3  2  1  0 -1 -2 -3 -4 -5</span></span></code></pre></div>
<p>Id con cuidado con los paréntesis y las operaciones al usar este operador:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true"></a><span class="dv">-3</span><span class="op">:</span><span class="dv">5</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true"></a><span class="co">#&gt; [1] -3 -2 -1  0  1  2  3  4  5</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true"></a><span class="op">-</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true"></a><span class="co">#&gt; [1] -3 -4 -5</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true"></a><span class="dv">2</span><span class="op">:</span><span class="dv">3</span><span class="op">*</span><span class="dv">4</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true"></a><span class="co">#&gt; [1]  8 12</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true"></a><span class="dv">2</span><span class="op">:</span>(<span class="dv">3</span><span class="op">*</span><span class="dv">4</span>)</span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true"></a><span class="co">#&gt;  [1]  2  3  4  5  6  7  8  9 10 11 12</span></span></code></pre></div>
<p>La función <code>seq</code> también se puede usar para definir progresiones aritméticas de otras dos maneras. En primer lugar, la función</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true"></a><span class="kw">seq</span>(a, b, <span class="dt">length.out=</span>n)</span></code></pre></div>
<p>define la progresión aritmética de longitud <span class="math inline">\(n\)</span> que va de <span class="math inline">\(a\)</span> a <span class="math inline">\(b\)</span>; su paso es, por lo tanto, <span class="math inline">\(p=(b-a)/(n-1)\)</span> si <span class="math inline">\(n&gt;1\)</span>; si <span class="math inline">\(n=1\)</span> sólo produce el valor <span class="math inline">\(a\)</span>.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true"></a><span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dt">length.out=</span><span class="dv">10</span>)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true"></a><span class="co">#&gt;  [1]  2.000000  2.888889  3.777778  4.666667  5.555556  6.444444  7.333333</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true"></a><span class="co">#&gt;  [8]  8.222222  9.111111 10.000000</span></span></code></pre></div>
<p>Por otro lado,</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true"></a><span class="kw">seq</span>(a, <span class="dt">by=</span>p, <span class="dt">length.out=</span>n)</span></code></pre></div>
<p>define la progresión aritmética de longitud <span class="math inline">\(n\)</span> y paso <span class="math inline">\(p\)</span> que empieza en <span class="math inline">\(a\)</span>:
<span class="math inline">\(a, a+p, a+2p, \ldots, a+(n-1)p\)</span>.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true"></a><span class="kw">seq</span>(<span class="dv">2</span>, <span class="dt">by=</span><span class="fl">0.5</span>, <span class="dt">length.out=</span><span class="dv">10</span>)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true"></a><span class="co">#&gt;  [1] 2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5 6.0 6.5</span></span></code></pre></div>
<p>A estas alturas habréis observado que cuando el resultado de una instrucción es un vector, R comienza cada línea del resultado con un número entre corchetes <code>[ ]</code>. Este número indica la posición dentro del vector de la primera entrada de la línea correspondiente. De esta manera, en el resultado de <code>seq(2, 10, length.out=10)</code>, R nos indica que 2.000000 es el primer elemento de este vector y 8.222222 su octavo elemento.</p>
<p>La función <code>c</code> que hemos usado para crear vectores en realidad <em>concatena</em> sus argumentos en un vector (de ahí viene la <code>c</code>). Si la aplicamos a vectores, crea un nuevo vector concatenando sus elementos. Podemos mezclar vectores y datos en su argumento.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true"></a>x=<span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dv">2</span><span class="op">:</span><span class="dv">10</span>)</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true"></a>x</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true"></a><span class="co">#&gt;  [1]  1  1  1  1  1  1  1  1  1  1  2  3  4  5  6  7  8  9 10</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true"></a>x=<span class="kw">c</span>(<span class="dv">0</span>,x,<span class="dv">20</span>,<span class="dv">30</span>)</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true"></a>x</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true"></a><span class="co">#&gt;  [1]  0  1  1  1  1  1  1  1  1  1  1  2  3  4  5  6  7  8  9 10 20 30</span></span></code></pre></div>
<p>Esta última construcción, <code>x=c(0,x,20,30)</code>, muestra que la función <code>c</code> se puede usar para añadir valores al principio o al final de un vector sin cambiarle el nombre: en este caso, hemos redefinido <code>x</code> añadiéndole un 0 al principio y 20, 30 al final.</p>
<p>Un vector se puede modificar fácilmente usando el editor de datos que incorpora <em>Rstudio</em>. Para hacerlo, se aplica la función <code>fix</code> al vector que queremos editar. R abre entonces el vector en una nueva ventana de edición. Mientras esta ventana esté abierta, será la ventana activa de R y no podremos volver a nuestra sesión de R hasta que la cerremos. Los cambios que hagamos en el vector con el editor de datos se guardarán cuando cerremos esta ventana.</p>
<p>Probadlo. Cread un vector con R y abridlo en el editor. Por ejemplo:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true"></a>x=<span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dv">2</span><span class="op">:</span><span class="dv">10</span>)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true"></a><span class="kw">fix</span>(x)</span></code></pre></div>
<p>Se abrirá entonces una ventana como la que mostramos en la Figura @ref(fig:editvect). Ahora, en esta ventana, podéis añadir, borrar y cambiar los datos que queráis. Por ejemplo, añadid un 0 al principio y 20, 30 al final y guardad el resultado (pulsando el botón <em>Save</em> en la ventana del editor). El contenido del vector <code>x</code> se habrá modificado, como podréis comprobar entrando <code>x</code> en la consola.</p>
<div class="figure" style="text-align: center">
<img src="AprendeR-Parte-I_files/figure-html/finestres0.png" alt="Ventana del editor de vectores de *RStudio* para Mac OS X." width="90%" />
<p class="caption">
(#fig:editvect)Ventana del editor de vectores de <em>RStudio</em> para Mac OS X.
</p>
</div>
</div>
<div id="operaciones-con-vectores" class="section level2" number="4.2">
<h2 number="4.2"><span class="header-section-number">4.2</span> Operaciones con vectores</h2>
<p>El manejo de vectores con R tiene una propiedad muy útil, que ya observamos en la sección anterior al entrar <code>-(3:5)</code> o <code>2:3*4</code>: podemos aplicar una función a todos los elementos de un vector en un solo paso.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true"></a>x=<span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">30</span>, <span class="dt">by=</span><span class="dv">3</span>)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true"></a>x</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true"></a><span class="co">#&gt;  [1]  2  5  8 11 14 17 20 23 26 29</span></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true"></a>x<span class="fl">+2.5</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true"></a><span class="co">#&gt;  [1]  4.5  7.5 10.5 13.5 16.5 19.5 22.5 25.5 28.5 31.5</span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true"></a><span class="fl">2.5</span><span class="op">*</span>x</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true"></a><span class="co">#&gt;  [1]  5.0 12.5 20.0 27.5 35.0 42.5 50.0 57.5 65.0 72.5</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true"></a><span class="kw">sqrt</span>(x) </span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true"></a><span class="co">#&gt;  [1] 1.414214 2.236068 2.828427 3.316625 3.741657 4.123106 4.472136 4.795832</span></span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true"></a><span class="co">#&gt;  [9] 5.099020 5.385165</span></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true"></a><span class="dv">2</span><span class="op">^</span>x</span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true"></a><span class="co">#&gt;  [1]         4        32       256      2048     16384    131072   1048576</span></span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true"></a><span class="co">#&gt;  [8]   8388608  67108864 536870912</span></span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true"></a>x<span class="op">^</span><span class="dv">2</span></span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true"></a><span class="co">#&gt;  [1]   4  25  64 121 196 289 400 529 676 841</span></span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true"></a>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb148-17"><a href="#cb148-17" aria-hidden="true"></a><span class="co">#&gt; [1]  1  4  9 16</span></span>
<span id="cb148-18"><a href="#cb148-18" aria-hidden="true"></a><span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span> <span class="co">#Cuidado con los paréntesis</span></span>
<span id="cb148-19"><a href="#cb148-19" aria-hidden="true"></a><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16</span></span></code></pre></div>
<p>A veces no es posible aplicar una función concreta a todo un vector entrándolo dentro del argumento de la función, como hemos hecho en los ejemplos anteriores. En estos casos, podemos usar la instrucción <code>sapply(vector, FUN=función)</code>.</p>
<p>Por ejemplo, dentro de un rato veremos que la función <code>mean</code> calcula la media aritmética de un vector. Supongamos que definimos una función <code>F</code> que, aplicada a un número natural <span class="math inline">\(x\)</span>, calcula la media de los números
<span class="math inline">\(1,2,\ldots,x\)</span>.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true"></a>F=<span class="cf">function</span>(x){<span class="kw">mean</span>(<span class="dv">1</span><span class="op">:</span>x)}</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true"></a><span class="kw">F</span>(<span class="dv">20</span>)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true"></a><span class="co">#&gt; [1] 10.5</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true"></a><span class="kw">F</span>(<span class="dv">30</span>)</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true"></a><span class="co">#&gt; [1] 15.5</span></span></code></pre></div>
<p>Resulta que no podemos aplicar esta función a todas las entradas de un vector <span class="math inline">\(x\)</span> entrando simplemente <code>F(x)</code>.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true"></a><span class="kw">F</span>(<span class="dv">20</span><span class="op">:</span><span class="dv">30</span>)</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true"></a><span class="co">#&gt; [1] 10.5</span></span></code></pre></div>
<p>En casos como este, podemos recurrir a la función <code>sapply</code>.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true"></a><span class="kw">sapply</span>(<span class="dv">20</span><span class="op">:</span><span class="dv">30</span>, <span class="dt">FUN=</span>F)</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true"></a><span class="co">#&gt;  [1] 10.5 11.0 11.5 12.0 12.5 13.0 13.5 14.0 14.5 15.0 15.5</span></span></code></pre></div>
<p>También podemos operar término a término las entradas de dos vectores de la misma longitud.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true"></a><span class="dv">1</span><span class="op">:</span><span class="dv">5</span><span class="op">+</span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span> <span class="co">#Suma entrada a entrada</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true"></a><span class="co">#&gt; [1]  2  4  6  8 10</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true"></a>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) <span class="co">#Producto entrada a entrada</span></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true"></a><span class="co">#&gt; [1]  1  4  9 16 25</span></span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true"></a>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) <span class="co">#Potencia entrada a entrada</span></span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true"></a><span class="co">#&gt; [1]    1    4   27  256 3125</span></span></code></pre></div>
<p>Esto nos permite calcular fácilmente vectores de la forma <span class="math inline">\((x_n)_{n=p, \ldots, q}\)</span>, formados por los términos <span class="math inline">\(x_p, x_{p+1}, \ldots, x_q\)</span> de una sucesión <span class="math inline">\((x_n)_n\)</span>, a partir de la fórmula explícita de <span class="math inline">\(x_n\)</span> como función del índice <span class="math inline">\(n\)</span>: basta aplicar esta fórmula a <code>p:q</code>. Por ejemplo, para definir el vector
<span class="math display">\[
x=(3\cdot 2^n-20)_{n=1, \ldots, 20}
\]</span>
podemos entrar lo siguiente:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true"></a>n=<span class="dv">1</span><span class="op">:</span><span class="dv">20</span> <span class="co">#Secuencia 1,...,20, y la llamamos n por comodidad</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true"></a>x=<span class="dv">3</span><span class="op">*</span><span class="dv">2</span><span class="op">^</span>n<span class="dv">-20</span> <span class="co">#Aplicamos la fórmula a n=1,...,20</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true"></a>x</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true"></a><span class="co">#&gt;  [1]     -14      -8       4      28      76     172     364     748    1516</span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true"></a><span class="co">#&gt; [10]    3052    6124   12268   24556   49132   98284  196588  393196  786412</span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true"></a><span class="co">#&gt; [19] 1572844 3145708</span></span></code></pre></div>
<p>De manera similar, para definir el vector
<span class="math display">\[
y=\Big(\dfrac{n}{n^2+1}\Big)_{n=0, \ldots, 20}
\]</span>
podemos usar lo siguiente:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true"></a>n=<span class="dv">0</span><span class="op">:</span><span class="dv">20</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true"></a>y=n<span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true"></a>y</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true"></a><span class="co">#&gt;  [1] 0.00000000 0.50000000 0.40000000 0.30000000 0.23529412 0.19230769</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true"></a><span class="co">#&gt;  [7] 0.16216216 0.14000000 0.12307692 0.10975610 0.09900990 0.09016393</span></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true"></a><span class="co">#&gt; [13] 0.08275862 0.07647059 0.07106599 0.06637168 0.06225681 0.05862069</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true"></a><span class="co">#&gt; [19] 0.05538462 0.05248619 0.04987531</span></span></code></pre></div>
<p>En ambos casos, y para facilitar la visualización de la construcción, hemos creado el vector <span class="math inline">\(n\)</span> con los índices de los términos de la sucesión, y después hemos obtenido el trozo de sucesión deseado aplicando la función que la define a <span class="math inline">\(n\)</span>. También habríamos podido generar estos vectores escribiendo directamente la sucesión de índices en la fórmula que los define. Por ejemplo:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true"></a>(<span class="dv">0</span><span class="op">:</span><span class="dv">20</span>)<span class="op">/</span>((<span class="dv">0</span><span class="op">:</span><span class="dv">20</span>)<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true"></a><span class="co">#&gt;  [1] 0.00000000 0.50000000 0.40000000 0.30000000 0.23529412 0.19230769</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true"></a><span class="co">#&gt;  [7] 0.16216216 0.14000000 0.12307692 0.10975610 0.09900990 0.09016393</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true"></a><span class="co">#&gt; [13] 0.08275862 0.07647059 0.07106599 0.06637168 0.06225681 0.05862069</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true"></a><span class="co">#&gt; [19] 0.05538462 0.05248619 0.04987531</span></span></code></pre></div>
<p>R dispone de muchas funciones para aplicar a vectores, relacionadas principalmente con la estadística. Veamos algunas que nos pueden ser útiles por el momento, y ya iremos viendo otras a medida que avance el curso:</p>
<ul>
<li><code>length</code> calcula la longitud del vector.</li>
<li><code>max</code> y <code>min</code> calculan sus valores máximo y mínimo, respectivamente.</li>
<li><code>sum</code> calcula la suma de sus entradas.</li>
<li><code>prod</code> calcula el producto de sus entradas.</li>
<li><code>mean</code> calcula la media aritmética de sus entradas.</li>
<li><code>diff</code> calcula el vector formado por las diferencias sucesivas entre entradas del vector original.</li>
<li><code>cumsum</code> calcula el vector de <strong>sumas acumuladas</strong> de las entradas del vector original: cada entrada de <code>cumsum(x)</code> es la suma de las entradas de <code>x</code> hasta su posición.</li>
<li><code>sort</code> ordena los elementos del vector en el orden natural creciente del tipo de datos que lo forman: el orden numérico, el orden alfabético, etc. Si lo queremos ordenar en orden decreciente, podemos incluir en su argumento el parámetro <code>dec=TRUE</code>.</li>
<li><code>rev</code> invierte el orden de los elementos del vector; por lo tanto, <code>rev(sort(...))</code> es otra opción para ordenar en orden decreciente.</li>
</ul>
<p>Veamos algunos ejemplos:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true"></a>x=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true"></a><span class="kw">length</span>(x)</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true"></a><span class="co">#&gt; [1] 12</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true"></a><span class="kw">max</span>(x)</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true"></a><span class="co">#&gt; [1] 8</span></span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true"></a><span class="kw">min</span>(x)</span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true"></a><span class="co">#&gt; [1] 0</span></span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true"></a><span class="kw">sum</span>(x)</span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true"></a><span class="co">#&gt; [1] 45</span></span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true"></a><span class="kw">prod</span>(x)</span>
<span id="cb156-11"><a href="#cb156-11" aria-hidden="true"></a><span class="co">#&gt; [1] 0</span></span>
<span id="cb156-12"><a href="#cb156-12" aria-hidden="true"></a><span class="kw">mean</span>(x)</span>
<span id="cb156-13"><a href="#cb156-13" aria-hidden="true"></a><span class="co">#&gt; [1] 3.75</span></span>
<span id="cb156-14"><a href="#cb156-14" aria-hidden="true"></a><span class="kw">cumsum</span>(x)</span>
<span id="cb156-15"><a href="#cb156-15" aria-hidden="true"></a><span class="co">#&gt;  [1]  1  6 12 14 19 26 34 37 42 44 45 45</span></span>
<span id="cb156-16"><a href="#cb156-16" aria-hidden="true"></a><span class="kw">diff</span>(x)</span>
<span id="cb156-17"><a href="#cb156-17" aria-hidden="true"></a><span class="co">#&gt;  [1]  4  1 -4  3  2  1 -5  2 -3 -1 -1</span></span>
<span id="cb156-18"><a href="#cb156-18" aria-hidden="true"></a><span class="kw">sort</span>(x)</span>
<span id="cb156-19"><a href="#cb156-19" aria-hidden="true"></a><span class="co">#&gt;  [1] 0 1 1 2 2 3 5 5 5 6 7 8</span></span>
<span id="cb156-20"><a href="#cb156-20" aria-hidden="true"></a><span class="kw">sort</span>(x, <span class="dt">dec=</span><span class="ot">TRUE</span>)</span>
<span id="cb156-21"><a href="#cb156-21" aria-hidden="true"></a><span class="co">#&gt;  [1] 8 7 6 5 5 5 3 2 2 1 1 0</span></span>
<span id="cb156-22"><a href="#cb156-22" aria-hidden="true"></a><span class="kw">rev</span>(x)</span>
<span id="cb156-23"><a href="#cb156-23" aria-hidden="true"></a><span class="co">#&gt;  [1] 0 1 2 5 3 8 7 5 2 6 5 1</span></span></code></pre></div>
<p>La función <code>sum</code> es útil para evaluar sumatorios; por ejemplo, si queremos calcular
<span class="math display">\[
\sum_{n=0}^{200} \frac{1}{n^2+1}
\]</span>
sólo tenemos que entrar:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true"></a>n=<span class="dv">0</span><span class="op">:</span><span class="dv">200</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true"></a><span class="kw">sum</span>(<span class="dv">1</span><span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true"></a><span class="co">#&gt; [1] 2.071687</span></span></code></pre></div>
<p>La función <code>cumsum</code> permite definir sucesiones descritas mediante sumatorios; a modo de ejemplo, para definir la sucesión de los 20 primeros <strong>números armónicos</strong>
<span class="math display">\[
y=\Big(\sum_{i=1}^n \frac{1}{i}\Big)_{n=1, \ldots, 20}
\]</span>
basta aplicar <code>cumsum</code> al vector <span class="math inline">\(x=(1/i)_{i=1, \ldots, 20}\)</span> de la manera siguiente:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true"></a>i=<span class="dv">1</span><span class="op">:</span><span class="dv">20</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true"></a>x=<span class="dv">1</span><span class="op">/</span>i</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true"></a>y=<span class="kw">cumsum</span>(x)</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true"></a>y</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true"></a><span class="co">#&gt;  [1] 1.000000 1.500000 1.833333 2.083333 2.283333 2.450000 2.592857 2.717857</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true"></a><span class="co">#&gt;  [9] 2.828968 2.928968 3.019877 3.103211 3.180134 3.251562 3.318229 3.380729</span></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true"></a><span class="co">#&gt; [17] 3.439553 3.495108 3.547740 3.597740</span></span></code></pre></div>
</div>
<div id="entradas-y-trozos-de-vectores" class="section level2" number="4.3">
<h2 number="4.3"><span class="header-section-number">4.3</span> Entradas y trozos de vectores</h2>
<p>Si queremos extraer el valor de una entrada concreta de un vector, o si queremos referirnos a esta entrada para usarla en un cálculo, podemos emplear la construcción</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true"></a>vector[i]</span></code></pre></div>
<p>que indica la <span class="math inline">\(i\)</span>-ésima entrada del <code>vector</code>. En particular, <code>vector[length(vector)-i]</code> es la <span class="math inline">\((i+1)\)</span>-ésima entrada del <code>vector</code> empezando por el final: su última entrada es <code>vector[length(vector)]</code>, la penúltima es <code>vector[length(vector)-1]</code> y así sucesivamente.</p>
<p>Observad que para referirnos a elementos de un vector, empleamos corchetes <code>[ ]</code>, y no los paréntesis redondos usuales.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true"></a>x=<span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">50</span>, <span class="dt">by=</span><span class="fl">1.5</span>)</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true"></a>x</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true"></a><span class="co">#&gt;  [1]  2.0  3.5  5.0  6.5  8.0  9.5 11.0 12.5 14.0 15.5 17.0 18.5 20.0 21.5 23.0</span></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true"></a><span class="co">#&gt; [16] 24.5 26.0 27.5 29.0 30.5 32.0 33.5 35.0 36.5 38.0 39.5 41.0 42.5 44.0 45.5</span></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true"></a><span class="co">#&gt; [31] 47.0 48.5 50.0</span></span></code></pre></div>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true"></a><span class="kw">x</span>(<span class="dv">3</span>) <span class="co">#¿La tercera entrada del vector?</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true"></a><span class="co">#&gt; Error in x(3): no se pudo encontrar la función &quot;x&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true"></a>x[<span class="dv">3</span>] <span class="co">#La tercera entrada del vector, ahora sí</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true"></a><span class="co">#&gt; [1] 5</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true"></a>x[<span class="kw">length</span>(x)]  <span class="co">#La última entrada del vector</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true"></a><span class="co">#&gt; [1] 50</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true"></a>x[<span class="kw">length</span>(x)<span class="op">-</span><span class="dv">5</span>] <span class="co">#La sexta entrada del vector empezando por el final</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true"></a><span class="co">#&gt; [1] 42.5</span></span></code></pre></div>
<p>También podemos extraer subvectores de un vector. Una primera manera de obtener un subvector es especificando los índices de las entradas que lo han de formar:</p>
<ul>
<li><code>vector[y]</code>, donde <code>y</code> es un vector (de índices), crea un nuevo vector con las entradas del <code>vector</code> original cuyos índices pertenecen a <code>y</code>.</li>
<li>En particular, si <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span> son dos números naturales, <code>vector[a:b]</code> crea un nuevo vector con las entradas del <code>vector</code> original que van de la <span class="math inline">\(a\)</span>-ésima a la <span class="math inline">\(b\)</span>-ésima.</li>
<li><code>vector[-y]</code>, donde <code>y</code> es un vector (de índices), es el complementario de <code>vector[y]</code>: sus entradas son las del <code>vector</code> original cuyos índices <em>no</em> pertenecen a <code>y</code>.</li>
<li>En particular, <code>vector[-i]</code> borra la entrada <span class="math inline">\(i\)</span>-ésima del <code>vector</code> original.</li>
</ul>
<p>Veamos algunos ejemplos:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true"></a>n=<span class="dv">1</span><span class="op">:</span><span class="dv">10</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true"></a>x=<span class="dv">2</span><span class="op">*</span><span class="dv">3</span><span class="op">^</span>n<span class="dv">-5</span><span class="op">*</span>n<span class="op">^</span><span class="dv">3</span><span class="op">*</span><span class="dv">2</span><span class="op">^</span>n</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true"></a>x</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true"></a><span class="co">#&gt;  [1]       -4     -142    -1026    -4958   -19514   -67662  -215146  -642238</span></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true"></a><span class="co">#&gt;  [9] -1826874 -5001902</span></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true"></a>x[<span class="op">-</span><span class="dv">3</span>] <span class="co">#x sin la tercera entrada</span></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true"></a><span class="co">#&gt; [1]       -4     -142    -4958   -19514   -67662  -215146  -642238 -1826874</span></span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true"></a><span class="co">#&gt; [9] -5001902</span></span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true"></a>x[<span class="dv">3</span><span class="op">:</span><span class="dv">7</span>] <span class="co">#Los elementos tercero a séptimo de x</span></span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true"></a><span class="co">#&gt; [1]   -1026   -4958  -19514  -67662 -215146</span></span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true"></a>x[<span class="dv">7</span><span class="op">:</span><span class="dv">3</span>] <span class="co">#Los elementos séptimo a tercero de x</span></span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true"></a><span class="co">#&gt; [1] -215146  -67662  -19514   -4958   -1026</span></span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true"></a>x[<span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">length</span>(x), <span class="dt">by=</span><span class="dv">2</span>)] <span class="co">#Los elementos de índice impar de x</span></span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true"></a><span class="co">#&gt; [1]       -4    -1026   -19514  -215146 -1826874</span></span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true"></a>x[<span class="kw">seq</span>(<span class="dv">2</span>, <span class="kw">length</span>(x), <span class="dt">by=</span><span class="dv">2</span>)] <span class="co">#Los elementos de índice par </span></span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true"></a><span class="co">#&gt; [1]     -142    -4958   -67662  -642238 -5001902</span></span>
<span id="cb163-17"><a href="#cb163-17" aria-hidden="true"></a>x[<span class="op">-</span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">length</span>(x), <span class="dt">by=</span><span class="dv">2</span>)] <span class="co">#Borramos los elementos de índice impar</span></span>
<span id="cb163-18"><a href="#cb163-18" aria-hidden="true"></a><span class="co">#&gt; [1]     -142    -4958   -67662  -642238 -5001902</span></span>
<span id="cb163-19"><a href="#cb163-19" aria-hidden="true"></a>x[(<span class="kw">length</span>(x)<span class="op">-</span><span class="dv">5</span>)<span class="op">:</span><span class="kw">length</span>(x)] <span class="co">#Los últimos 6 elementos de x</span></span>
<span id="cb163-20"><a href="#cb163-20" aria-hidden="true"></a><span class="co">#&gt; [1]   -19514   -67662  -215146  -642238 -1826874 -5001902</span></span>
<span id="cb163-21"><a href="#cb163-21" aria-hidden="true"></a>x[<span class="kw">length</span>(x)<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="kw">length</span>(x)] <span class="co">#No os dejéis los paréntesis ...</span></span>
<span id="cb163-22"><a href="#cb163-22" aria-hidden="true"></a><span class="co">#&gt; [1] -19514  -4958  -1026   -142     -4</span></span></code></pre></div>
<p>Fijaos en las dos últimas instrucciones: si denotamos <code>length(x)</code> por <span class="math inline">\(n\)</span>, entonces
<code>(length(x)-5):length(x)</code> es la secuencia de índices
<span class="math inline">\(n-5, n-4, n-3, n-2, n-1, n\)</span>, mientras que <code>length(x)-5:length(x)</code> es la secuencia
<span class="math inline">\(n-(5, 6, 7, \ldots, n)=n-5, n-6, n-7, \ldots, 1, 0\)</span>.</p>
<!--
Table: (\#tab:opslog) Operadores lógicos
|Operador  | $=$ | $\neq$ | $<$ | $>$ | $\leq$ | $\geq$ | negación  | conjunción | disjunción|
|---|---|---|---|---|---|---|---|---|---| 
|Signo  | `==` | `!=` | `<` | `>` | `<=`| `>=` | `!` | `&` | `|` |

\begin{table}[htb]
\abovecaptionskip=-1ex
\begin{center}
\indR{==}\indR{\char33 =}\indR{>}\indR{<=}\indR{>=}\indR{<}\indR{\char33}\indR{\&}\indR{\char124}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}
\hline
Operador \vphantom{$\Big($} & $=$ & $\neq$ & $<$ & $>$ & $\leq$ & $\geq$ & negación & conjunción & disjunción \\ \hline
Signo \vphantom{$\Big($} & `==` & `!=` & `<` & `>` & `<=`& `>=` & `!` & `\&` & `|` \\
\hline
\end{tabular}
\end{center}
\caption{\label{tab:opslog} Signos de operadores lógicos}
\end{table}
-->
<p>También podemos extraer las entradas de un vector (o sus índices) que satisfagan alguna condición. Los operadores lógicos que podemos usar para definir estas condiciones son los que damos en la lista siguiente:</p>
<ul>
<li><span class="math inline">\(=\)</span>: <code>==</code></li>
<li><span class="math inline">\(\neq\)</span>: <code>!=</code></li>
<li><span class="math inline">\(&lt;\)</span>: <code>&lt;</code></li>
<li><span class="math inline">\(&gt;\)</span>: <code>&gt;</code></li>
<li><span class="math inline">\(\leqslant\)</span>: <code>&lt;=</code></li>
<li><span class="math inline">\(\geqslant\)</span>: <code>&gt;=</code></li>
<li>negación: <code>!</code></li>
<li>conjunción: <code>&amp;</code></li>
<li>disjunción: <code>|</code></li>
</ul>
<p>Veamos un ejemplo (y observad su sintaxis). Vamos a extraer los elementos mayores que 3 de un vector <code>x</code>.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true"></a>x=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true"></a>x[x<span class="op">&gt;</span><span class="dv">3</span>]</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true"></a><span class="co">#&gt; [1] 5 6 5 7 8 5</span></span></code></pre></div>
<p>En esta última instrucción, la construcción <code>x&gt;3</code> define un vector que, en cada posición, contiene un <code>TRUE</code> si el elemento correspondiente del vector <code>x</code> es mayor que 3 y un <code>FALSE</code> si no lo es.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true"></a>x<span class="op">&gt;</span><span class="dv">3</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true"></a><span class="co">#&gt;  [1] FALSE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE FALSE  TRUE FALSE FALSE</span></span></code></pre></div>
<p>Entonces <code>x[x&gt;3]</code> lo que nos da son las entradas del vector <code>x</code> correspondientes a los <code>TRUE</code> de este vector de valores lógicos.</p>
<p>Veamos otros ejemplos.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true"></a>x[x<span class="op">&gt;</span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span>x<span class="op">&lt;=</span><span class="dv">5</span>] <span class="co">#Elementos mayores que 2 y menores o iguales que 5</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true"></a><span class="co">#&gt; [1] 5 5 3 5</span></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true"></a>x[x<span class="op">!=</span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span>x<span class="op">!=</span><span class="dv">5</span>] <span class="co">#Elementos diferentes de 2 y de 5</span></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true"></a><span class="co">#&gt; [1] 1 6 7 8 3 1</span></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true"></a>x[x<span class="op">&gt;</span><span class="dv">5</span> <span class="op">|</span><span class="st"> </span>x<span class="op">&lt;=</span><span class="dv">2</span>] <span class="co">#Elementos mayores que 5 o menores o iguales que 2</span></span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true"></a><span class="co">#&gt; [1] 1 6 2 7 8 2 1</span></span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true"></a>x[x<span class="op">&gt;=</span><span class="dv">4</span>] <span class="co">#Elementos mayores o iguales que 4</span></span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true"></a><span class="co">#&gt; [1] 5 6 5 7 8 5</span></span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true"></a>x[<span class="op">!</span>x<span class="op">&lt;</span><span class="dv">4</span>] <span class="co">#Elementos que NO son menores que 4; es equivalente a la anterior</span></span>
<span id="cb166-10"><a href="#cb166-10" aria-hidden="true"></a><span class="co">#&gt; [1] 5 6 5 7 8 5</span></span>
<span id="cb166-11"><a href="#cb166-11" aria-hidden="true"></a>x[x<span class="op">%%</span><span class="dv">4</span><span class="op">==</span><span class="dv">0</span>] <span class="co">#Elementos múltiplos de 4</span></span>
<span id="cb166-12"><a href="#cb166-12" aria-hidden="true"></a><span class="co">#&gt; [1] 8</span></span></code></pre></div>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true"></a>x[x<span class="op">&gt;</span><span class="dv">3</span>] </span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true"></a><span class="co">#&gt; [1] 5 6 5 7 8 5</span></span></code></pre></div>
<p>Esta construcción también permite extraer las entradas de un vector cuyos índices sean los de las entradas de otro vector que satisfagan una condición lógica. Por ejemplo:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true"></a>x</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true"></a><span class="co">#&gt;  [1] 1 5 6 2 5 7 8 3 5 2 1</span></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true"></a>y=<span class="kw">c</span>(<span class="dv">2</span>,<span class="op">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">4</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true"></a>x[y<span class="op">&gt;</span><span class="dv">0</span>] <span class="co">#Entradas de x correspondientes a entradas positivas de y</span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true"></a><span class="co">#&gt; [1] 1 2 5 8 2 1</span></span></code></pre></div>
<p>Para obtener los <em>índices</em> de las entradas del vector que satisfacen una condición dada, podemos usar la función <code>which</code>. Esta función, aplicada a un vector de valores lógicos, da los índices de las posiciones de los <code>TRUE</code>. Así, para saber los índices de las entradas de <code>x</code> que son mayores que 3, usamos <code>which(x&gt;3)</code>, que nos dará los índices de las entradas <code>TRUE</code> del vector <code>x&gt;3</code>.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true"></a>x</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true"></a><span class="co">#&gt;  [1] 1 5 6 2 5 7 8 3 5 2 1</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true"></a>x[x<span class="op">&gt;</span><span class="dv">3</span>] <span class="co">#Elementos mayores que 3</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true"></a><span class="co">#&gt; [1] 5 6 5 7 8 5</span></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true"></a><span class="kw">which</span>(x<span class="op">&gt;</span><span class="dv">3</span>) <span class="co">#Índices de los elementos mayores que 3</span></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true"></a><span class="co">#&gt; [1] 2 3 5 6 7 9</span></span></code></pre></div>
<p>Veamos otros ejemplos:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true"></a><span class="kw">which</span>(x<span class="op">&gt;</span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span>x<span class="op">&lt;=</span><span class="dv">5</span>) <span class="co">#Índices de los elementos &gt; 2 y &lt;= 5</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true"></a><span class="co">#&gt; [1] 2 5 8 9</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true"></a><span class="kw">which</span>(x<span class="op">!=</span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span>x<span class="op">!=</span><span class="dv">5</span>) <span class="co">#Índices de los elementos diferentes de 2 y 5</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true"></a><span class="co">#&gt; [1]  1  3  6  7  8 11</span></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true"></a><span class="kw">which</span>(x<span class="op">&gt;</span><span class="dv">5</span> <span class="op">|</span><span class="st"> </span>x<span class="op">&lt;=</span><span class="dv">2</span>) <span class="co">#Índices de los elementos &gt; 5 o &lt;= 2</span></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true"></a><span class="co">#&gt; [1]  1  3  4  6  7 10 11</span></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true"></a><span class="kw">which</span>(x<span class="op">%%</span><span class="dv">2</span><span class="op">==</span><span class="dv">0</span>) <span class="co">#Índices de los elementos pares del vector</span></span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true"></a><span class="co">#&gt; [1]  3  4  7 10</span></span></code></pre></div>
<p>La instrucción <code>which.min(x)</code> nos da la primera posición en la que el vector toma su valor mínimo; <code>which.max(x)</code> hace lo mismo, pero para el máximo. En cambio, con
<code>which(x==min(x))</code> obtenemos todas las posiciones en las que el vector toma su valor mínimo y, con <code>which(x==max(x))</code>, aquellas en las que toma su valor máximo.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true"></a>x</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true"></a><span class="co">#&gt;  [1] 1 5 6 2 5 7 8 3 5 2 1</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true"></a><span class="kw">which.min</span>(x)</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true"></a><span class="kw">which</span>(x<span class="op">==</span><span class="kw">min</span>(x))</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true"></a><span class="co">#&gt; [1]  1 11</span></span></code></pre></div>
<p>Si un vector no contiene ningún término que satisfaga la condición que imponemos, obtenemos como respuesta un vector vacío. R lo indica con <code>numeric(0)</code> si es de números, <code>character(0)</code> si es de palabras, o <code>integer(0)</code> si es de índices de entradas de un vector. Estos vectores vacíos tienen longitud, naturalmente, 0.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true"></a>x=<span class="dv">2</span><span class="op">^</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>)</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true"></a>x</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true"></a><span class="co">#&gt;  [1]    1    2    4    8   16   32   64  128  256  512 1024</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true"></a>x[<span class="dv">20</span><span class="op">&lt;</span>x <span class="op">&amp;</span><span class="st"> </span>x<span class="op">&lt;</span><span class="dv">30</span>] <span class="co">#Elementos de x estrictamente entre 20 y 30</span></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true"></a><span class="co">#&gt; numeric(0)</span></span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true"></a><span class="kw">length</span>(x[<span class="dv">20</span><span class="op">&lt;</span>x <span class="op">&amp;</span><span class="st"> </span>x<span class="op">&lt;</span><span class="dv">30</span>]) <span class="co">#¿Cuántas entradas hay entre 20 y 30?</span></span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true"></a><span class="co">#&gt; [1] 0</span></span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true"></a><span class="kw">which</span>(x<span class="op">&gt;</span><span class="dv">1500</span>) <span class="co">#Índices de elementos mayores que 1500</span></span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true"></a><span class="co">#&gt; integer(0)</span></span></code></pre></div>
<p>Si R no sabe de qué tipo son los datos que faltan en un vector vacío, lo indica con <code>NULL</code>. También podemos usar este valor para definir un vector vacío.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true"></a>x=<span class="kw">c</span>()</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true"></a>x</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true"></a><span class="co">#&gt; NULL</span></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true"></a>z=<span class="ot">NULL</span></span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true"></a>z</span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true"></a><span class="co">#&gt; NULL</span></span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true"></a>y=<span class="kw">c</span>(x,<span class="dv">2</span>,z)</span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true"></a>y</span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true"></a><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<p>Los operadores lógicos que hemos explicado también se pueden usar para pedir si una condición sobre unos números concretos se satisface o no. Por ejemplo:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true"></a><span class="kw">exp</span>(pi)<span class="op">&gt;</span>pi<span class="op">^</span>(<span class="kw">exp</span>(<span class="dv">1</span>)) <span class="co">#¿Es mayor e^pi que pi^e?</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true"></a><span class="dv">1234567</span><span class="op">%%</span><span class="dv">9</span><span class="op">==</span><span class="dv">0</span> <span class="co">#¿Es 1234567 múltiplo de 9?</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true"></a><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p>Podemos modificar algunas entradas de un vector simplemente declarando sus nuevos valores. Esto se puede hacer entrada a entrada, o para todo un subvector de golpe.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true"></a>x=<span class="dv">1</span><span class="op">:</span><span class="dv">10</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true"></a>x</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true"></a><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10</span></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true"></a>x[<span class="dv">3</span>]=<span class="dv">15</span> <span class="co">#En la posición 3 escribimos 15</span></span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true"></a>x[<span class="dv">11</span>]=<span class="dv">25</span> <span class="co">#Añadimos en la posición 11 un 25</span></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true"></a>x</span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true"></a><span class="co">#&gt;  [1]  1  2 15  4  5  6  7  8  9 10 25</span></span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true"></a>x[<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>]=x[<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>]<span class="op">+</span><span class="dv">10</span> <span class="co">#Sumamos 10 a las entradas en las posiciones 2 a 4</span></span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true"></a>x</span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true"></a><span class="co">#&gt;  [1]  1 12 25 14  5  6  7  8  9 10 25</span></span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true"></a>x[(<span class="kw">length</span>(x)<span class="op">-</span><span class="dv">2</span>)<span class="op">:</span><span class="kw">length</span>(x)]=<span class="dv">0</span>   <span class="co">#Igualamos las últimas tres entradas a 0</span></span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true"></a>x</span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true"></a><span class="co">#&gt;  [1]  1 12 25 14  5  6  7  8  0  0  0</span></span></code></pre></div>
<p>Fijaos en la próxima instrucción:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true"></a>x[<span class="kw">length</span>(x)<span class="op">+</span><span class="dv">3</span>]=<span class="dv">2</span>   </span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true"></a>x</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true"></a><span class="co">#&gt;  [1]  1 12 25 14  5  6  7  8  0  0  0 NA NA  2</span></span></code></pre></div>
<p>Hemos añadido al vector <code>x</code> el valor 2 tres posiciones más allá de su última entrada. Entonces, en las posiciones 12 y 13 ha escrito <code>NA</code> antes de añadir en la 14 el 2. Estos <code>NA</code>, de <em>Not Available</em>, indican que las entradas correspondientes del vector no existen.</p>
<p>Los <code>NA</code> serán muy importantes cuando usemos vectores en estadística descriptiva, donde podrán representar valores desconocidos, errores, etc.
Serán importantes porque son molestos, puesto que, por norma general, una función aplicada a un vector que contenga algún <code>NA</code> da <code>NA</code>.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true"></a><span class="kw">sum</span>(x)</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true"></a><span class="co">#&gt; [1] NA</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true"></a><span class="kw">mean</span>(x)</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true"></a><span class="co">#&gt; [1] NA</span></span></code></pre></div>
<p>Afortunadamente, muchas de las funciones para vectores admiten un parámetro <code>na.rm</code> que, igualado a <code>TRUE</code>, hace que la función sólo tenga en cuenta las entradas definidas.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true"></a><span class="kw">sum</span>(x, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true"></a><span class="co">#&gt; [1] 80</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true"></a><span class="kw">mean</span>(x, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true"></a><span class="co">#&gt; [1] 6.666667</span></span></code></pre></div>
<p>Para especificar las entradas no definidas de un vector <span class="math inline">\(x\)</span> no podemos usar la condición lógica <code>x==NA</code>, sino la función <code>is.na(x)</code>.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true"></a>x</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true"></a><span class="co">#&gt;  [1]  1 12 25 14  5  6  7  8  0  0  0 NA NA  2</span></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true"></a><span class="kw">which</span>(x<span class="op">==</span><span class="ot">NA</span>) <span class="co">#¿Índices de entradas NA?</span></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true"></a><span class="co">#&gt; integer(0)</span></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true"></a><span class="kw">is.na</span>(x)</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true"></a><span class="co">#&gt;  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE</span></span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true"></a><span class="co">#&gt; [13]  TRUE FALSE</span></span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true"></a><span class="kw">which</span>(<span class="kw">is.na</span>(x))   <span class="co">#Índices de entradas NA</span></span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true"></a><span class="co">#&gt; [1] 12 13</span></span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true"></a>y=x  <span class="co">#Creamos una copia de x y la llamamos y</span></span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true"></a>y[<span class="kw">is.na</span>(y)]=<span class="kw">mean</span>(y, <span class="dt">na.rm=</span><span class="ot">TRUE</span>) <span class="co">#Cambiamos los NA de y por la media del resto de entradas</span></span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true"></a>y</span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true"></a><span class="co">#&gt;  [1]  1.000000 12.000000 25.000000 14.000000  5.000000  6.000000  7.000000</span></span>
<span id="cb179-14"><a href="#cb179-14" aria-hidden="true"></a><span class="co">#&gt;  [8]  8.000000  0.000000  0.000000  0.000000  6.666667  6.666667  2.000000</span></span></code></pre></div>
<p>Naturalmente, podemos usar la negación de <code>is.na(x)</code> para obtener las entradas
definidas de un vector <code>x</code>: formarán el vector <code>x[!is.na(x)]</code>.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true"></a>x</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true"></a><span class="co">#&gt;  [1]  1 12 25 14  5  6  7  8  0  0  0 NA NA  2</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true"></a>x[<span class="op">!</span><span class="kw">is.na</span>(x)]</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true"></a><span class="co">#&gt;  [1]  1 12 25 14  5  6  7  8  0  0  0  2</span></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true"></a><span class="kw">sum</span>(x[<span class="op">!</span><span class="kw">is.na</span>(x)])</span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true"></a><span class="co">#&gt; [1] 80</span></span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true"></a><span class="kw">cumsum</span>(x)</span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true"></a><span class="co">#&gt;  [1]  1 13 38 52 57 63 70 78 78 78 78 NA NA NA</span></span></code></pre></div>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true"></a><span class="kw">cumsum</span>(x, <span class="dt">na.rm=</span><span class="ot">TRUE</span>) <span class="co">#cumsum no admite na.rm</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true"></a><span class="co">#&gt; Error in cumsum(x, na.rm = TRUE): 2 arguments passed to &#39;cumsum&#39; which requires 1</span></span></code></pre></div>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true"></a><span class="kw">cumsum</span>(x[<span class="op">!</span><span class="kw">is.na</span>(x)])</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true"></a><span class="co">#&gt;  [1]  1 13 38 52 57 63 70 78 78 78 78 80</span></span></code></pre></div>
<p>Las entradas no definidas de un vector también se pueden borrar aplicándole la función <code>na.omit</code>.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true"></a><span class="kw">na.omit</span>(x)</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true"></a><span class="co">#&gt;  [1]  1 12 25 14  5  6  7  8  0  0  0  2</span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true"></a><span class="co">#&gt; attr(,&quot;na.action&quot;)</span></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true"></a><span class="co">#&gt; [1] 12 13</span></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true"></a><span class="co">#&gt; attr(,&quot;class&quot;)</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;omit&quot;</span></span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true"></a><span class="kw">sum</span>(<span class="kw">na.omit</span>(x))</span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true"></a><span class="co">#&gt; [1] 80</span></span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true"></a><span class="kw">cumsum</span>(<span class="kw">na.omit</span>(x))</span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true"></a><span class="co">#&gt;  [1]  1 13 38 52 57 63 70 78 78 78 78 80</span></span></code></pre></div>
<p>Observad el resultado de <code>na.omit(x)</code>. Contiene un primer vector formado por las entradas del vector original que no son <code>NA</code>, y luego una serie de información extra llamados <strong>atributos</strong>, e indicados por R con <code>attr</code>: los índices de las entradas que ha eliminado y el tipo de acción que ha llevado a cabo.
Como podéis ver, estos atributos no interfieren para nada en las operaciones que se realicen con el primer vector, pero si os molestan, se pueden eliminar: la instrucción</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true"></a><span class="kw">attr</span>(objeto , atributo)=<span class="ot">NULL</span></span></code></pre></div>
<p>borra el <code>atributo</code> del <code>objeto</code>.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true"></a>x_sinNA=<span class="kw">na.omit</span>(x)</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true"></a>x_sinNA</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true"></a><span class="co">#&gt;  [1]  1 12 25 14  5  6  7  8  0  0  0  2</span></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true"></a><span class="co">#&gt; attr(,&quot;na.action&quot;)</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true"></a><span class="co">#&gt; [1] 12 13</span></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true"></a><span class="co">#&gt; attr(,&quot;class&quot;)</span></span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;omit&quot;</span></span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true"></a><span class="kw">attr</span>(x_sinNA, <span class="st">&quot;na.action&quot;</span>)=<span class="ot">NULL</span></span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true"></a><span class="kw">attr</span>(x_sinNA, <span class="st">&quot;class&quot;</span>)=<span class="ot">NULL</span></span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true"></a>x_sinNA</span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true"></a><span class="co">#&gt;  [1]  1 12 25 14  5  6  7  8  0  0  0  2</span></span></code></pre></div>
</div>
<div id="subsec:factor" class="section level2" number="4.4">
<h2 number="4.4"><span class="header-section-number">4.4</span> Factores</h2>
<p>Un <strong>factor</strong> es como un vector, pero con una estructura interna más rica que permite usarlo para clasificar observaciones. Para ilustrar la diferencia entre vectores y factores, vamos a crear un vector <code>Ciudades</code> con los nombres de algunas ciudades, y a continuación un factor <code>Ciudades.factor</code> con el mismo contenido, aplicando a este vector la función <code>factor</code>.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true"></a>Ciudades=<span class="kw">c</span>(<span class="st">&quot;Madrid&quot;</span>,<span class="st">&quot;Palma&quot;</span>,<span class="st">&quot;Madrid&quot;</span>,<span class="st">&quot;Madrid&quot;</span>,<span class="st">&quot;Barcelona&quot;</span>,<span class="st">&quot;Palma&quot;</span>,<span class="st">&quot;Madrid&quot;</span>,<span class="st">&quot;Madrid&quot;</span>)</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true"></a>Ciudades</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;Madrid&quot;    &quot;Palma&quot;     &quot;Madrid&quot;    &quot;Madrid&quot;    &quot;Barcelona&quot; &quot;Palma&quot;    </span></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true"></a><span class="co">#&gt; [7] &quot;Madrid&quot;    &quot;Madrid&quot;</span></span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true"></a>Ciudades.factor=<span class="kw">factor</span>(Ciudades)</span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true"></a>Ciudades.factor</span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true"></a><span class="co">#&gt; [1] Madrid    Palma     Madrid    Madrid    Barcelona Palma     Madrid   </span></span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true"></a><span class="co">#&gt; [8] Madrid   </span></span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true"></a><span class="co">#&gt; Levels: Barcelona Madrid Palma</span></span></code></pre></div>
<p>Observad la diferencia. El factor dispone de un atributo especial llamado <code>niveles</code> (<em>levels</em>), y cada elemento del factor es igual a un nivel; de esta manera, los niveles <em>clasifican</em> las entradas del factor.
Podríamos decir, en resumen, que un factor es una lista formada por copias de etiquetas (los niveles), como podrían ser el sexo o la especie de unos individuos.</p>
<p>Cuando tengamos un vector que queramos usar para clasificar datos, conviene definirlo como un factor y así podremos hacer más cosas con él. Para crear un factor, hemos de definir un vector y transformarlo en factor por medio de una de las funciones <code>factor</code> o <code>as.factor</code>. La diferencia entre estas funciones es que <code>as.factor</code> <em>convierte</em> el vector en un factor, y toma como sus niveles los diferentes valores que aparecen en el vector, mientras que <code>factor</code> <em>define</em> un factor a partir del vector, y dispone de algunos parámetros que permiten modificar el factor que se crea, tales como:</p>
<ul>
<li><code>levels</code>, que permite especificar los niveles e incluso añadir niveles que no aparecen en el vector.</li>
<li><code>labels</code>, que permite cambiar los nombres de los niveles.</li>
</ul>
<p>De esta manera, con <code>as.factor</code> o con <code>factor</code> sin especificar <code>levels</code>, el factor tendrá como niveles los diferentes valores que toman las entradas del vector, y además aparecerán en su lista de niveles, <code>Levels</code>, ordenados en orden alfabético. Si especificamos el parámetro <code>levels</code> en la función <code>factor</code>, los niveles aparecerán en dicha lista en el orden en el que los entremos en él.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true"></a>S=<span class="kw">c</span>(<span class="st">&quot;M&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>,<span class="st">&quot;F&quot;</span>,<span class="st">&quot;F&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>)</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true"></a>Sex=<span class="kw">as.factor</span>(S)</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true"></a>Sex</span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true"></a><span class="co">#&gt;  [1] M M F M F F F M M F</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true"></a><span class="co">#&gt; Levels: F M</span></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true"></a>Sex2=<span class="kw">factor</span>(S)   <span class="co">#Esto definirá el mismo factor</span></span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true"></a>Sex2</span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true"></a><span class="co">#&gt;  [1] M M F M F F F M M F</span></span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true"></a><span class="co">#&gt; Levels: F M</span></span></code></pre></div>
<p>Ahora vamos a añadir un tercer nivel, <code>I</code>, que no está representado en <code>S</code>:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true"></a>Sex3=<span class="kw">factor</span>(S, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;F&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;I&quot;</span>))</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true"></a>Sex3</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true"></a><span class="co">#&gt;  [1] M M F M F F F M M F</span></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true"></a><span class="co">#&gt; Levels: F M I</span></span></code></pre></div>
<p>Fijaos en que ahora R no ordena alfabéticamente los niveles, sino en el orden especificado en el <code>levels</code>.</p>
<p>Y ahora vamos a cambiar el orden de los niveles y su nombre:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true"></a>Sex4=<span class="kw">factor</span>(S, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>,<span class="st">&quot;I&quot;</span>), <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Masc.&quot;</span>,<span class="st">&quot;Fem.&quot;</span>,<span class="st">&quot;Indet.&quot;</span>))</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true"></a>Sex4</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true"></a><span class="co">#&gt;  [1] Masc. Masc. Fem.  Masc. Fem.  Fem.  Fem.  Masc. Masc. Fem. </span></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true"></a><span class="co">#&gt; Levels: Masc. Fem. Indet.</span></span></code></pre></div>
<p>Para obtener los niveles de un factor, podemos emplear la función <code>levels</code>.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true"></a><span class="kw">levels</span>(Sex)</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;F&quot; &quot;M&quot;</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true"></a><span class="kw">levels</span>(Sex4)</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;Masc.&quot;  &quot;Fem.&quot;   &quot;Indet.&quot;</span></span></code></pre></div>
<p>La función <code>levels</code> también permite cambiar los nombres de los niveles de un factor.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true"></a>Notas=<span class="kw">as.factor</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>))</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true"></a>Notas</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true"></a><span class="co">#&gt;  [1] 1 2 2 3 1 3 2 4 2 3 4 2</span></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true"></a><span class="co">#&gt; Levels: 1 2 3 4</span></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true"></a><span class="kw">levels</span>(Notas)=<span class="kw">c</span>(<span class="st">&quot;Muy.mal&quot;</span>,<span class="st">&quot;Mal&quot;</span>,<span class="st">&quot;Bien&quot;</span>,<span class="st">&quot;Muy.bien&quot;</span>)</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true"></a>Notas</span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true"></a><span class="co">#&gt;  [1] Muy.mal  Mal      Mal      Bien     Muy.mal  Bien     Mal      Muy.bien</span></span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true"></a><span class="co">#&gt;  [9] Mal      Bien     Muy.bien Mal     </span></span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true"></a><span class="co">#&gt; Levels: Muy.mal Mal Bien Muy.bien</span></span></code></pre></div>
<p>Observad que los niveles han heredado el orden del factor original.</p>
<p>Con la función <code>levels</code> también podemos agrupar varios niveles de un factor en uno solo, simplemente repitiendo nombres al especificarlos; por ejemplo, en el factor de notas anterior, vamos a agrupar los niveles “Muy mal” y “Mal” en uno solo, y lo mismo con los niveles “Muy bien” y “Bien”:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true"></a>Notas_2niv=Notas</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true"></a><span class="kw">levels</span>(Notas_2niv)=<span class="kw">c</span>(<span class="st">&quot;Mal&quot;</span>,<span class="st">&quot;Mal&quot;</span>,<span class="st">&quot;Bien&quot;</span>,<span class="st">&quot;Bien&quot;</span>)</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true"></a>Notas_2niv</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true"></a><span class="co">#&gt;  [1] Mal  Mal  Mal  Bien Mal  Bien Mal  Bien Mal  Bien Bien Mal </span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true"></a><span class="co">#&gt; Levels: Mal Bien</span></span></code></pre></div>
<p>Nos hemos referido varias veces al orden de los niveles. En realidad, hay dos tipos de factores: simples y ordenados. Hasta ahora sólo hemos considerado los factores <strong>simples</strong>, en los que el orden de los niveles realmente no importa, y si lo modificamos es sólo por razones estéticas o de comprensión de los datos; en este caso, la manera más sencilla de hacerlo es redefiniendo el factor con <code>factor</code> y modificando en el parámetro <code>levels</code> el orden de los niveles.
Pero si el orden de los niveles es relevante para analizar los datos, entonces es conveniente definir el factor como <strong>ordenado</strong>. Esto se lleva a cabo con la función <code>ordered</code>, que dispone de los mismos parámetros que <code>factor</code>. Así, si queremos que nuestro factor <code>Notas</code> sea un factor ordenado, con sus niveles ordenados de “Muy mal” a “Muy bien”, hay que entrar lo siguiente:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true"></a>Notas=<span class="kw">ordered</span>(Notas, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;Muy.mal&quot;</span>,<span class="st">&quot;Mal&quot;</span>,<span class="st">&quot;Bien&quot;</span>,<span class="st">&quot;Muy.bien&quot;</span>))</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true"></a>Notas</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true"></a><span class="co">#&gt;  [1] Muy.mal  Mal      Mal      Bien     Muy.mal  Bien     Mal      Muy.bien</span></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true"></a><span class="co">#&gt;  [9] Mal      Bien     Muy.bien Mal     </span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true"></a><span class="co">#&gt; Levels: Muy.mal &lt; Mal &lt; Bien &lt; Muy.bien</span></span></code></pre></div>
<p>Observad que R indica el orden de los niveles de un factor ordenado mediante el signo <code>&lt;</code>.</p>
<p>Aunque en la instrucción anterior hemos aplicado la función <code>ordered</code> a un factor, también se puede aplicar a un vector, como si usáramos <code>factor</code>.</p>
</div>
<div id="sec:lists" class="section level2" number="4.5">
<h2 number="4.5"><span class="header-section-number">4.5</span> Listas heterogéneas</h2>
<p>Los vectores que hemos estudiado hasta el momento sólo pueden contener datos, y estos datos han de ser de un solo tipo. Por ejemplo, no podemos construir un vector que contenga simultáneamente palabras y números, o cuyas entradas sean a su vez vectores. Este problema se resuelve con las <strong>listas heterogéneas</strong>; para abreviar, las llamaremos por su nombre en R: <strong><em>list</em></strong>. Una <em>list</em> es una lista formada por objetos que pueden ser de clases diferentes. Así, en una misma <em>list</em> podemos combinar números, palabras, vectores, otras <em>list</em>, etc. En la Lección @ref(chap:lm) ya aparecieron dos objetos de clase <code>list</code>: los resultados de <code>lm(...)</code> y <code>summary(lm(...))</code>.</p>
<p>Supongamos por ejemplo que queremos guardar en una lista un vector, su nombre, su media, y su vector de sumas acumuladas. En este caso, tendríamos que hacerlo en forma de lista heterogénea usando la función <code>list</code>.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true"></a>x=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="op">-</span><span class="dv">3</span>,<span class="op">-</span><span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true"></a>L=<span class="kw">list</span>(<span class="dt">nombre=</span><span class="st">&quot;x&quot;</span>, <span class="dt">vector=</span>x, <span class="dt">media=</span><span class="kw">mean</span>(x), <span class="dt">sumas=</span><span class="kw">cumsum</span>(x))</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true"></a>L</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true"></a><span class="co">#&gt; $nombre</span></span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;x&quot;</span></span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true"></a><span class="co">#&gt; $vector</span></span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true"></a><span class="co">#&gt; [1]  1  2 -3 -4  5  6</span></span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true"></a><span class="co">#&gt; $media</span></span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true"></a><span class="co">#&gt; [1] 1.166667</span></span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true"></a><span class="co">#&gt; $sumas</span></span>
<span id="cb194-14"><a href="#cb194-14" aria-hidden="true"></a><span class="co">#&gt; [1]  1  3  0 -4  1  7</span></span></code></pre></div>
<p>Observad la sintaxis de la función <code>list</code>: le hemos entrado como argumento los diferentes objetos que van a formar la lista heterogénea, poniendo a cada uno un nombre adecuado. Este nombre es interno de la <em>list</em>: por ejemplo, pese a que <code>L</code> contiene un objeto llamado <code>sumas</code>, en el entorno de trabajo de R no tenemos definida ninguna variable con ese nombre (a no ser que la hayamos definido previamente durante la sesión).</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true"></a>sumas</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;sumas&#39; no encontrado</span></span></code></pre></div>
<p>Para referirnos o usar una componente concreta de una <em>list</em>, tenemos que añadir al nombre de la <em>list</em> el sufijo formado por un signo <code>$</code> y el nombre de la componente; recordad cómo extraíamos el valor de <span class="math inline">\(R^2\)</span> de un <code>summary(lm(...))</code> en la Sección @ref(sec:introlm).</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true"></a>L<span class="op">$</span>nombre</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;x&quot;</span></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true"></a>L<span class="op">$</span>vector</span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true"></a><span class="co">#&gt; [1]  1  2 -3 -4  5  6</span></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true"></a>L<span class="op">$</span>media</span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true"></a><span class="co">#&gt; [1] 1.166667</span></span></code></pre></div>
<p>También podemos indicar el objeto por su posición en la <em>list</em> usando un par de dobles corchetes <code>[[ ]]</code>. Si usamos sólo un par de corchetes, como en los vectores, lo que obtenemos es una <em>list</em> formada por esa única componente, no el objeto que forma la componente.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true"></a>L[[<span class="dv">1</span>]]</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;x&quot;</span></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true"></a>L[[<span class="dv">4</span>]]  <span class="co">#Esto es un vector</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true"></a><span class="co">#&gt; [1]  1  3  0 -4  1  7</span></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true"></a><span class="dv">3</span><span class="op">*</span>L[[<span class="dv">4</span>]] <span class="co">#Y podemos operar con él</span></span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true"></a><span class="co">#&gt; [1]   3   9   0 -12   3  21</span></span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true"></a>L[<span class="dv">4</span>]   <span class="co">#Esto es una list, no un vector</span></span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true"></a><span class="co">#&gt; $sumas</span></span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true"></a><span class="co">#&gt; [1]  1  3  0 -4  1  7</span></span></code></pre></div>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true"></a><span class="dv">3</span><span class="op">*</span>L[<span class="dv">4</span>]   <span class="co">#Y NO podemos operar con él</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true"></a><span class="co">#&gt; Error in 3 * L[4]: argumento no-numérico para operador binario</span></span></code></pre></div>
<p>Para conocer la estructura interna de una <em>list</em>, es decir, los nombres de los objetos que la forman y su naturaleza, podemos usar la función <code>str</code>. Si sólo queremos saber sus nombres, podemos usar la función <code>names</code>. Si la <em>list</em> se obtiene con una función de R cuyo resultado sea una estructura de este tipo, como, por ejemplo, <code>lm</code>, es recomendable consultar la Ayuda de la función, ya que probablemente explique el significado de los objetos que la forman.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true"></a><span class="kw">str</span>(L)</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true"></a><span class="co">#&gt; List of 4</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true"></a><span class="co">#&gt;  $ nombre: chr &quot;x&quot;</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true"></a><span class="co">#&gt;  $ vector: num [1:6] 1 2 -3 -4 5 6</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true"></a><span class="co">#&gt;  $ media : num 1.17</span></span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true"></a><span class="co">#&gt;  $ sumas : num [1:6] 1 3 0 -4 1 7</span></span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true"></a><span class="kw">names</span>(L)</span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;nombre&quot; &quot;vector&quot; &quot;media&quot;  &quot;sumas&quot;</span></span></code></pre></div>
<p>Finalmente, queremos comentar que la función <code>c</code> también se puede usar para concatenar <em>lists</em> o para añadir miembros a una <em>list</em>:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true"></a>L=<span class="kw">c</span>(L, <span class="dt">numero.pi=</span>pi)</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true"></a>L</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true"></a><span class="co">#&gt; $nombre</span></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;x&quot;</span></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true"></a><span class="co">#&gt; $vector</span></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true"></a><span class="co">#&gt; [1]  1  2 -3 -4  5  6</span></span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true"></a><span class="co">#&gt; $media</span></span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true"></a><span class="co">#&gt; [1] 1.166667</span></span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true"></a><span class="co">#&gt; $sumas</span></span>
<span id="cb200-13"><a href="#cb200-13" aria-hidden="true"></a><span class="co">#&gt; [1]  1  3  0 -4  1  7</span></span>
<span id="cb200-14"><a href="#cb200-14" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb200-15"><a href="#cb200-15" aria-hidden="true"></a><span class="co">#&gt; $numero.pi</span></span>
<span id="cb200-16"><a href="#cb200-16" aria-hidden="true"></a><span class="co">#&gt; [1] 3.141593</span></span></code></pre></div>
</div>
<div id="guía-rápida-de-funciones" class="section level2" number="4.6">
<h2 number="4.6"><span class="header-section-number">4.6</span> Guía rápida de funciones</h2>
<ul>
<li><code>c</code> sirve para definir un vector concatenando elementos o vectores. También sirve para concatenar <em>lists</em>.</li>
<li><code>scan</code> crea un vector importando datos que se entren en la consola o contenidos en un fichero. Algunos parámetros importantes:
<ul>
<li><code>dec</code>: indica el separador decimal.</li>
<li><code>sep</code>: indica el signo usado para separar las entradas.</li>
<li><code>what</code>: indica el tipo de datos que se importan.</li>
<li><code>encoding</code>: indica la codificación de alfabeto del fichero externo;
sus dos valores posibles son <code>"latin1"</code> y <code>"UTF-8"</code>.</li>
</ul></li>
<li><code>rep</code> sirve para definir un vector repitiendo un valor o las entradas de otro vector. Algunos parámetros importantes:
<ul>
<li><code>each</code>: cuando aplicamos la función a un vector, sirve para indicar cuántas veces queremos repetir cada entrada del vector.</li>
<li><code>times</code>: cuando aplicamos la función a un vector, sirve para indicar cuántas veces queremos repetir todo el vector en bloque.</li>
</ul></li>
<li><code>seq</code> sirve para definir progresiones aritméticas. Sus tres usos principales son:
<ul>
<li><code>seq(a, b, by=p)</code> define la progresión <span class="math inline">\(a, a+p, a+2p, \ldots, b\)</span> (o parándose en el término inmediatamente anterior a <span class="math inline">\(b\)</span>, si <span class="math inline">\(b\)</span> no pertenece a la progresión).</li>
<li><code>seq(a, b, length.out=n)</code> define la progresión <span class="math inline">\(\overbrace{a, a+p, a+2p, \ldots, b}^n\)</span> de longitud <span class="math inline">\(n\)</span>, tomando como paso <span class="math inline">\(p=(b-a)/(n-1)\)</span>.</li>
<li><code>seq(a, by=p, length.out=n)</code> define la progresión <span class="math inline">\(a, a+p, a+2p, \ldots, a+(n-1)p\)</span></li>
</ul></li>
<li><code>a:b</code> es sinónimo de <code>seq(a, b, by=1)</code> (si <span class="math inline">\(a&lt;b\)</span>) o <code>seq(a, b, by=-1)</code> (si <span class="math inline">\(a&gt;b\)</span>).</li>
<li><code>NULL</code> indica un vector vacío.</li>
<li><code>fix</code> abre un vector (o, en general, un objeto de datos: una matriz, un <em>data frame</em>…) en el editor de datos.</li>
<li>Funciones para vectores:
<ul>
<li><code>length</code>: calcula la longitud de un vector.</li>
<li><code>max</code>: calcula el máximo de un vector.</li>
<li><code>min</code>: calcula el mínimo de un vector</li>
<li><code>sum</code>: calcula la suma de las entradas de un vector.</li>
<li><code>prod</code>: calcula el producto de las entradas de un vector.</li>
<li><code>mean</code>: calcula la media de las entradas de un vector.</li>
<li><code>cumsum</code>: calcula el vector de sumas acumuladas de un vector</li>
<li><code>diff</code>: calcula el vector de diferencias consecutivas de un vector.</li>
<li><code>sort</code>: ordena en orden creciente las entradas de un vector.</li>
<li><code>rev</code>: invierte el orden de un vector.</li>
</ul>
Las funciones <code>max</code>, <code>min</code>, <code>sum</code>, <code>prod</code> y <code>mean</code> admiten el parámetro <code>na.rm=TRUE</code> que impone que no se tengan en cuenta los valores <code>NA</code> del vector al calcularla.</li>
<li><code>sapply(vector, FUN=función)</code> aplica la <code>función</code> a todas las entradas del <code>vector</code>.</li>
<li><code>vector[...]</code> se usa para especificar un elemento o un subvector del <code>vector</code>. Las entradas que formarán el subvector pueden especificarse mediante el vector de sus índices o mediante una condición lógica sobre las entradas. Los signos de operadores lógicos que se pueden usar para definir condiciones lógicas son los siguientes:
<ul>
<li><code>==</code>: <span class="math inline">\(=\)</span></li>
<li><code>!=</code>: <span class="math inline">\(\neq\)</span></li>
<li><code>&lt;</code>: <span class="math inline">\(&lt;\)</span></li>
<li><code>&gt;</code>: <span class="math inline">\(&gt;\)</span></li>
<li><code>&lt;=</code>: <span class="math inline">\(\leqslant\)</span></li>
<li><code>&gt;=</code>: <span class="math inline">\(\geqslant\)</span></li>
<li><code>!</code>: negación</li>
<li><code>&amp;</code>: conjunción</li>
<li><code>|</code>: disjunción</li>
</ul></li>
<li><code>which</code> sirve para obtener los índices de las entradas de un vector que satisfacen una condición lógica.</li>
<li><code>which.min</code> y <code>which.max</code> dan la primera posición en la que el vector toma su valor mínimo o máximo, respectivamente.</li>
<li><code>is.na</code> es la alternativa correcta a la condición <code>==NA</code>.</li>
<li><code>na.omit</code> elimina las entradas <code>NA</code> de un vector.</li>
<li><code>as.factor</code> transforma un vector en un factor.</li>
<li><code>factor</code> crea un factor a partir de un vector. Algunos parámetros importantes:
<ul>
<li><code>levels</code>: sirve para especificar los niveles.</li>
<li><code>labels</code>: sirve para cambiar los nombres de los niveles.</li>
</ul></li>
<li><code>ordered</code> crea un factor ordenado a partir de un vector o un factor; sus parámetros son los mismos que los de <code>factor</code>.</li>
<li><code>levels</code> sirve para obtener los niveles de un factor, y también para cambiar sus nombres.</li>
<li><code>list</code> construye listas heterogéneas, <em>lists</em>.</li>
<li><code>str</code> sirve para obtener la estructura de una <em>list</em>.</li>
<li><code>names</code> sirve para conocer los nombres de las componentes de una <em>list</em>.</li>
<li><code>list$componente</code> sirve para referirnos al objeto que forma la <code>componente</code> de la <em>list</em>.</li>
<li><code>list[[i]]</code> sirve para referirnos al objeto que forma la <span class="math inline">\(i\)</span>-ésima componente de la <em>list</em>.</li>
</ul>
</div>
<div id="ejercicios-2" class="section level2" number="4.7">
<h2 number="4.7"><span class="header-section-number">4.7</span> Ejercicios</h2>
<div id="test-1" class="section level3 unnumbered">
<h3 class="unnumbered">Test</h3>
<p><em>(1)</em> Dad el valor del elemento decimocuarto de la sucesión de números consecutivos entre -25 y 71.</p>
<p><em>(2)</em> Dad la instrucción que crea, usando la función <code>c</code>, un vector llamado <code>Pueblos</code> formado por los nombres Palma, Inca, Manacor, Binissalem.</p>
<p><em>(3)</em> Tomad la progresión de números consecutivos que va de -7 a 20, cambiad el décimo elemento empezando por el final por un 30 y calculad la media. Dad su valor redondeado a 3 cifras decimales (el valor, no las instrucciones empleadas).</p>
<p><em>(4)</em> Dad la instrucción que crea, usando la función <code>rep</code>, un vector llamado <code>As</code> formado por 100 copias de la letra A.</p>
<p><em>(5)</em> Decid, indicándolo con SI (sin acento) o NO, si la igualdad <span class="math inline">\(2\cdot 3^n-4\cdot 2^n=1560\)</span> es verdadera para algún número natural <span class="math inline">\(n\)</span> entre 0 y 100.</p>
<p><em>(6)</em> Dad el menor número natural <span class="math inline">\(n\)</span> tal que <span class="math inline">\(2\cdot 3^n-4\cdot 0.8^n\geqslant 10^6\)</span>.</p>
<p><em>(7)</em> Dad el valor de <span class="math inline">\(n\)</span> en el que la secuencia <span class="math inline">\((2\cdot 3^n-4\cdot 2.5^n)_{n=0,\ldots,100}\)</span> toma su valor mínimo.</p>
<p><em>(8)</em> Decid, respondiendo SI (sin acento) o NO, si la secuencia <span class="math inline">\((4^n-3\cdot 2^n)_{n=0,\ldots,200}\)</span> es creciente o no.</p>
<p><em>(9)</em> Decid si la secuencia <span class="math inline">\((4^n-7\cdot 2^n)_{n=0,\ldots,200}\)</span> es creciente, decreciente o ninguna de las dos cosas. La respuesta tiene que ser CRECIENTE, DECRECIENTE o NADA, según sea el caso.</p>
<p><em>(10)</em> Dad el primer valor de <span class="math inline">\(n\)</span> para el que
<span class="math display">\[
\sum_{y=0}^n \frac{e^y}{y+1}
\]</span>
es mayor o igual que <span class="math inline">\(10^6\)</span>. Si no existe, tenéis que contestar NO.</p>
<p><em>(11)</em> Dad el valor de la suma
<span class="math display">\[
\sum_{n=0}^{30} n\cdot e^{-n}
\]</span>
redondeado a 3 cifras decimales.</p>
<p><em>(12)</em> Dad una instrucción que cambie los nombres de los niveles de un factor llamado <code>F</code> de 5 niveles a <code>S</code>, <code>A</code>, <code>N</code>, <code>E</code> y <code>MH</code> (en este orden).</p>
<p><em>(13)</em> Dad una instrucción que defina un factor llamado F01 a partir del vector (0, 1, 0, 0, 1, 0), asignando al 0 y al 1 los niveles <code>No</code> y <code>Yes</code>, respectivamente.</p>
<p><em>(14)</em> El quinto objeto de una <em>list</em> llamada <code>Datos</code> es un vector que además contiene valores <code>NA</code>. Dad una instrucción que calcule su media sin tener en cuenta los <code>NA</code>.</p>
</div>
<div id="ejercicio-2" class="section level3 unnumbered">
<h3 class="unnumbered">Ejercicio</h3>
<p>Tenemos las siguientes notas obtenidas por unos estudiantes en un examen:</p>
<pre><code>7.9, 4.3, 5.5, 7.9, 9.8, 2.7, 4.7, 2.4, 8.3, 7.3, 6.8, 6.3, 4.8, 5.7, 3.8, 6.3, 5.4, 
5.4, 80, 4.2, 8.3, 4.7, 6.0, 6.8, 5.7, 6.5, 4.6, 5.4, 3.7, 7.1, 5.5, 6.0, 6.7, 7.0, 
7.3, 3.0, 6.6, 6.1, 2.4, 7.1,  9.4, 3.7, 4.5, 5.1, 5.9, 4.7, 5.5, 8.9, 8.1, 8.3, 4.3,
7.1, 9.3, 5.1, 6.1, 3.0, 5.7, 6.8, 3.1, 7.7,  7.3 , 7.0, 6.2, 8.8, 5.3, 4.0.</code></pre>
<ol style="list-style-type: decimal">
<li>Cread un vector con estas notas (podéis copiarlas de este documento y pegarlas) y ponedle un nombre adecuado.</li>
<li>¿Cuántas notas contiene este vector? ¿Cuál es su valor medio?</li>
<li>¡Vaya! El 80 ha sido un error, tenía que ser un 8.0. Cambiad el 80 del vector anterior por un 8.0, sin volver a entrar el resto de notas. Volved a calcular la media de las notas tras haber corregido este error.</li>
<li>¿Cuál es la nota mínima obtenida por estos estudiantes? ¿Cuántos estudiantes la han sacado?</li>
<li>¿Cuántos estudiantes han logrado un notable (entre 7 y 8.9)? ¿Qué porcentaje del total de estudiantes representan?</li>
<li>¿Qué grupo es más numeroso: el de los estudiantes que han sacado entre 4 y 4.9, o el de los que han sacado entre 5 y 5.9?</li>
<li>Ordenad en orden creciente estas notas y obtened su <code>mediana</code> : una vez ordenado el vector, si tiene un número impar de entradas, su mediana es el valor central, y si tiene un número par de entradas, su mediana es la media aritmética de los dos valores centrales.</li>
<li>La mediana de un vector se puede calcular directamente con la función <code>median</code>.
Calculad la del vector anterior con esta función.
¿Da lo mismo que el valor obtenido en el punto anterior?</li>
<li>¿Cuántos notas diferentes hay en esta muestra? (Podéis emplear astutamente algunas funciones explicadas en esta lección, o podéis consultar <code>help.search("duplicated")</code> a ver si encontráis una función que elimine las entradas duplicadas de un vector.)</li>
</ol>
</div>
<div id="respuestas-al-test-1" class="section level3 unnumbered">
<h3 class="unnumbered">Respuestas al test</h3>
<p><em>(1)</em> -12</p>
<p><em>(2)</em> <code>Pueblos=c("Palma","Inca","Manacor","Binissalem")</code></p>
<p><em>(3)</em> 7.179</p>
<p><em>(4)</em> <code>As=rep("A",100)</code></p>
<p><em>(5)</em> NO</p>
<p><em>(6)</em> 12</p>
<p><em>(7)</em> 3</p>
<p><em>(8)</em> SI</p>
<p><em>(9)</em> NADA</p>
<p><em>(10)</em> 17</p>
<p><em>(11)</em> 0.921</p>
<p><em>(12)</em> <code>levels(F)=c("S","A","N","E","MH")</code></p>
<p><em>(13)</em> <code>F01=factor(c(0,1,0,0,1,0), labels=c("No","Yes"))</code></p>
<p><em>(14)</em> <code>mean(Datos[[5]],na.rm=TRUE)</code>. También sería correcto <code>mean(na.omit(Datos[[5]]))</code>.</p>
<!--chapter:end:04chap03_Vectores.Rmd-->
</div>
</div>
</div>
<div id="chap:matrix" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Matrices</h1>
<p>Una <strong>matriz de orden</strong> <span class="math inline">\(n\times m\)</span> es una tabla
rectangular de números (o, en algunas situaciones específicas, algún otro tipo de datos: valores lógicos, etiquetas…) formada por <span class="math inline">\(n\)</span> filas y <span class="math inline">\(m\)</span> columnas. Una matriz es <strong>cuadrada</strong> cuando tiene el mismo número de filas que de columnas, es decir, cuando <span class="math inline">\(n=m\)</span>; en este caso, decimos que la matriz es de <strong>orden</strong> <span class="math inline">\(n\)</span>. En matemáticas, es costumbre escribir las matrices rodeadas por paréntesis para marcar con claridad sus límites. Por ejemplo,</p>
<p><span class="math display">\[
A = \left(\begin{matrix}
2 &amp; 1 &amp; -3\\ -4 &amp; 3 &amp; \sqrt{3}\end{matrix}
\right)
\]</span></p>
<p>es una matriz <span class="math inline">\(2\times 3\)</span>.</p>
<div id="construcción-de-matrices" class="section level2" number="5.1">
<h2 number="5.1"><span class="header-section-number">5.1</span> Construcción de matrices</h2>
<p>Disponemos de dos maneras básicas de definir una matriz en R. En primer lugar, la instrucción</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true"></a><span class="kw">matrix</span>(vector , <span class="dt">nrow=</span>n, <span class="dt">byrow=</span>valor_lógico)</span></code></pre></div>
<p>define una matriz de <span class="math inline">\(n\)</span> filas (<em>rows</em>) formada por las entradas del <code>vector</code>. Si se entra <code>byrow=TRUE</code>, la matriz se construye por filas, mientras que con <code>byrow=FALSE</code> se construye por columnas; este último es el valor por defecto, por lo que no hace falta especificarlo. En vez de emplear <code>nrow</code>, se puede indicar el número de columnas con <code>ncol</code>. Veamos algunos ejemplos:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true"></a><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">nrow=</span><span class="dv">2</span>)</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    3    5</span></span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true"></a><span class="co">#&gt; [2,]    2    4    6</span></span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true"></a><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">nrow=</span><span class="dv">3</span>)</span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    4</span></span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true"></a><span class="co">#&gt; [2,]    2    5</span></span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true"></a><span class="co">#&gt; [3,]    3    6</span></span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true"></a><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb203-12"><a href="#cb203-12" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    2    3</span></span>
<span id="cb203-13"><a href="#cb203-13" aria-hidden="true"></a><span class="co">#&gt; [2,]    4    5    6</span></span>
<span id="cb203-14"><a href="#cb203-14" aria-hidden="true"></a><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb203-15"><a href="#cb203-15" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb203-16"><a href="#cb203-16" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    2</span></span>
<span id="cb203-17"><a href="#cb203-17" aria-hidden="true"></a><span class="co">#&gt; [2,]    3    4</span></span>
<span id="cb203-18"><a href="#cb203-18" aria-hidden="true"></a><span class="co">#&gt; [3,]    5    6</span></span></code></pre></div>
<p>Observad cómo muestra R las matrices: indica las filas con <code>[i,]</code>, donde <span class="math inline">\(i\)</span> es el índice de la fila, y las columnas con <code>[,j]</code>, donde <span class="math inline">\(j\)</span> es el índice de la columna.</p>
<p>Para construir una matriz de <span class="math inline">\(n\)</span> filas o <span class="math inline">\(n\)</span> columnas, es conveniente que la longitud del vector al que se aplica <code>matrix</code> sea múltiplo de <span class="math inline">\(n\)</span>. Si no es así, R rellena la última fila o columna con entradas del principio del vector y emite un mensaje de advertencia.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true"></a><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">nrow=</span><span class="dv">4</span>)</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true"></a><span class="co">#&gt; Warning in matrix(1:6, nrow = 4): la longitud de los datos [6] no es un</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true"></a><span class="co">#&gt; submúltiplo o múltiplo del número de filas [4] en la matriz</span></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    5</span></span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true"></a><span class="co">#&gt; [2,]    2    6</span></span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true"></a><span class="co">#&gt; [3,]    3    1</span></span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true"></a><span class="co">#&gt; [4,]    4    2</span></span></code></pre></div>
<p>En particular, se puede definir una matriz constante aplicando la función <code>matrix</code> a un número. En este caso, se han de usar los parámetros <code>nrow</code> y <code>ncol</code> para especificar el orden de la matriz. Por ejemplo, la siguiente instrucción define una matriz de orden <span class="math inline">\(2\times 3\)</span> con todas sus entradas iguales a 1:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true"></a><span class="kw">matrix</span>(<span class="dv">1</span>, <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">ncol=</span><span class="dv">3</span>) </span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    1    1</span></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true"></a><span class="co">#&gt; [2,]    1    1    1</span></span></code></pre></div>
<p>Otra manera posible de definir matrices es combinando filas o columnas. La instrucción</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true"></a><span class="kw">rbind</span>(vector1, vector2, ....)</span></code></pre></div>
<p>construye la matriz de filas <em>vector1</em>, <em>vector2</em>… (que han de tener la misma longitud) en este orden. Si en lugar de <code>rbind</code> se usa <code>cbind</code>, se obtiene la matriz cuyas columnas son los vectores a los que se aplica.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true"></a><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">6</span>), <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">0</span>))</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    0    2</span></span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true"></a><span class="co">#&gt; [2,]    2    3    6</span></span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true"></a><span class="co">#&gt; [3,]    1    2    0</span></span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true"></a><span class="kw">cbind</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">6</span>), <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">0</span>))</span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    2    1</span></span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true"></a><span class="co">#&gt; [2,]    0    3    2</span></span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true"></a><span class="co">#&gt; [3,]    2    6    0</span></span></code></pre></div>
<p>Con las funciones <code>cbind</code> o <code>rbind</code> también podemos añadir columnas, o filas, a una matriz; en concreto, si <span class="math inline">\(A\)</span> es una matriz de orden <span class="math inline">\(n\times m\)</span> y <span class="math inline">\(v\)</span> es un vector de longitud <span class="math inline">\(n\)</span>, la instrucción <code>cbind(A, v)</code> define la matriz de orden <span class="math inline">\(n\times(m+1)\)</span> que tiene como primeras <span class="math inline">\(m\)</span> columnas las de <span class="math inline">\(A\)</span> y como columna <span class="math inline">\(m+1\)</span> el vector <span class="math inline">\(v\)</span>; de manera similar, <code>cbind(v, A)</code> define la matriz de orden <span class="math inline">\(n\times(m+1)\)</span> que tiene como primera columna el vector <span class="math inline">\(v\)</span> y después las columnas de <span class="math inline">\(A\)</span>. Con <code>cbind</code> también podemos concatenar por columnas dos matrices con el mismo número de filas. La instrucción <code>rbind</code> es similar a <code>cbind</code>, pero actúa por filas en vez de por columnas: permite añadir filas arriba o abajo de una matriz ya existente, y, en general, concatenar por filas dos matrices con el mismo número de columnas.</p>
<p>Veamos algunos ejemplos de uso de estas dos funciones.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true"></a>A=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="dt">nrow=</span><span class="dv">2</span>)</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true"></a>A</span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    3</span></span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true"></a><span class="co">#&gt; [2,]    2    4</span></span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true"></a><span class="kw">cbind</span>(<span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">8</span>), <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>), A)</span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true"></a><span class="co">#&gt; [1,]    7    5    1    3</span></span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true"></a><span class="co">#&gt; [2,]    8    6    2    4</span></span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true"></a><span class="kw">cbind</span>(A, A)</span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    3    1    3</span></span>
<span id="cb208-13"><a href="#cb208-13" aria-hidden="true"></a><span class="co">#&gt; [2,]    2    4    2    4</span></span>
<span id="cb208-14"><a href="#cb208-14" aria-hidden="true"></a><span class="kw">rbind</span>(A, <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">12</span>))</span>
<span id="cb208-15"><a href="#cb208-15" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb208-16"><a href="#cb208-16" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    3</span></span>
<span id="cb208-17"><a href="#cb208-17" aria-hidden="true"></a><span class="co">#&gt; [2,]    2    4</span></span>
<span id="cb208-18"><a href="#cb208-18" aria-hidden="true"></a><span class="co">#&gt; [3,]   10   12</span></span>
<span id="cb208-19"><a href="#cb208-19" aria-hidden="true"></a><span class="kw">rbind</span>(A, A)</span>
<span id="cb208-20"><a href="#cb208-20" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb208-21"><a href="#cb208-21" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    3</span></span>
<span id="cb208-22"><a href="#cb208-22" aria-hidden="true"></a><span class="co">#&gt; [2,]    2    4</span></span>
<span id="cb208-23"><a href="#cb208-23" aria-hidden="true"></a><span class="co">#&gt; [3,]    1    3</span></span>
<span id="cb208-24"><a href="#cb208-24" aria-hidden="true"></a><span class="co">#&gt; [4,]    2    4</span></span></code></pre></div>
<p>Como pasaba con los vectores, todas las entradas de una matriz en R han de ser del mismo tipo de datos, y si una matriz contiene datos de diferentes tipos, automáticamente los convierte a un tipo que pueda ser común a todos ellos.</p>
<p>Si los vectores que concatenamos con <code>rbind</code> o <code>cbind</code> tienen nombres, las filas o columnas correspondientes de la matriz los heredan.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true"></a>x=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true"></a>y=<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true"></a><span class="kw">rbind</span>(x, y)</span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true"></a><span class="co">#&gt;   [,1] [,2] [,3]</span></span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true"></a><span class="co">#&gt; x    1    2    3</span></span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true"></a><span class="co">#&gt; y    0    1   -1</span></span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true"></a><span class="kw">cbind</span>(x, y)</span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true"></a><span class="co">#&gt;      x  y</span></span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true"></a><span class="co">#&gt; [1,] 1  0</span></span>
<span id="cb209-10"><a href="#cb209-10" aria-hidden="true"></a><span class="co">#&gt; [2,] 2  1</span></span>
<span id="cb209-11"><a href="#cb209-11" aria-hidden="true"></a><span class="co">#&gt; [3,] 3 -1</span></span></code></pre></div>
<p>Se puede también poner nombres a las filas y las columnas de una matriz con la instrucción</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true"></a><span class="kw">dimnames</span>(matriz)=<span class="kw">list</span>(vector de nombres de filas, vector de nombres de columnas)</span></code></pre></div>
<p>Si las filas o las columnas no han de tener nombres, se declara su vector de nombres como <code>NULL</code> en esta <code>list</code>.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true"></a>A=<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">nrow=</span><span class="dv">3</span>)</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true"></a>A</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    4</span></span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true"></a><span class="co">#&gt; [2,]    2    5</span></span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true"></a><span class="co">#&gt; [3,]    3    6</span></span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true"></a><span class="kw">dimnames</span>(A)=<span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;X1&quot;</span>,<span class="st">&quot;X2&quot;</span>,<span class="st">&quot;X3&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;Y1&quot;</span>,<span class="st">&quot;Y2&quot;</span>))</span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true"></a>A</span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true"></a><span class="co">#&gt;    Y1 Y2</span></span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true"></a><span class="co">#&gt; X1  1  4</span></span>
<span id="cb211-11"><a href="#cb211-11" aria-hidden="true"></a><span class="co">#&gt; X2  2  5</span></span>
<span id="cb211-12"><a href="#cb211-12" aria-hidden="true"></a><span class="co">#&gt; X3  3  6</span></span>
<span id="cb211-13"><a href="#cb211-13" aria-hidden="true"></a><span class="kw">dimnames</span>(A)=<span class="kw">list</span>(<span class="ot">NULL</span>, <span class="kw">c</span>(<span class="st">&quot;Palma&quot;</span>,<span class="st">&quot;Barcelona&quot;</span>))</span>
<span id="cb211-14"><a href="#cb211-14" aria-hidden="true"></a>A</span>
<span id="cb211-15"><a href="#cb211-15" aria-hidden="true"></a><span class="co">#&gt;      Palma Barcelona</span></span>
<span id="cb211-16"><a href="#cb211-16" aria-hidden="true"></a><span class="co">#&gt; [1,]     1         4</span></span>
<span id="cb211-17"><a href="#cb211-17" aria-hidden="true"></a><span class="co">#&gt; [2,]     2         5</span></span>
<span id="cb211-18"><a href="#cb211-18" aria-hidden="true"></a><span class="co">#&gt; [3,]     3         6</span></span></code></pre></div>
<p>Los nombres de las filas y columnas de una matriz pueden servir para hacer más clara la información contenida en la misma.</p>
</div>
<div id="sec:entrmatr" class="section level2" number="5.2">
<h2 number="5.2"><span class="header-section-number">5.2</span> Acceso a entradas y submatrices</h2>
<p>La <strong>entrada</strong> <span class="math inline">\((i, j)\)</span> de una matriz es el elemento situado en su fila <span class="math inline">\(i\)</span> y su columna <span class="math inline">\(j\)</span>. Por ejemplo, las entradas (1,2) y (2,1) de la matriz
<span class="math display">\[
A = \left(\begin{matrix}
2 &amp; 1 &amp; -3\\ -4 &amp; 3 &amp; \sqrt{3}\end{matrix}
\right)
\]</span>
son, respectivamente, 1 y -4.</p>
<p>El acceso a las entradas de una matriz se realiza como en los vectores, sólo que ahora en las matrices podemos especificar la fila y la columna:</p>
<ul>
<li><p><code>M[i,j]</code> indica la entrada <span class="math inline">\((i, j)\)</span> de la matriz <code>M</code>.</p></li>
<li><p><code>M[i, ]</code> indica la fila <span class="math inline">\(i\)</span>-ésima de <code>M</code>.</p></li>
<li><p><code>M[ ,j]</code> indica la columna <span class="math inline">\(j\)</span>-ésima de <code>M</code>.</p></li>
</ul>
<p>En los dos últimos casos, el resultado es un vector. Si queremos que el resultado sea una matriz de una sola fila o de una sola columna, respectivamente, tenemos que añadir el parámetro <code>drop=FALSE</code> dentro de los corchetes.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true"></a>M=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">9</span>,<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">5</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true"></a>M</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    3    5    2</span></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true"></a><span class="co">#&gt; [2,]    3    6    2    9</span></span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true"></a><span class="co">#&gt; [3,]    8    4    2    5</span></span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true"></a>M[<span class="dv">2</span>,<span class="dv">4</span>]  <span class="co">#Entrada (2,4)</span></span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true"></a><span class="co">#&gt; [1] 9</span></span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true"></a>M[<span class="dv">3</span>,<span class="dv">1</span>]  <span class="co">#Entrada (3,1)</span></span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true"></a><span class="co">#&gt; [1] 8</span></span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true"></a>M[<span class="dv">1</span>, ]  <span class="co">#Fila 1</span></span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true"></a><span class="co">#&gt; [1] 1 3 5 2</span></span>
<span id="cb212-13"><a href="#cb212-13" aria-hidden="true"></a>M[<span class="dv">1</span>, , drop=<span class="ot">FALSE</span>] <span class="co">#ATENCIÓN: fijaos en las dos comas</span></span>
<span id="cb212-14"><a href="#cb212-14" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb212-15"><a href="#cb212-15" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    3    5    2</span></span>
<span id="cb212-16"><a href="#cb212-16" aria-hidden="true"></a>M[ ,<span class="dv">3</span>]  <span class="co">#Columna 3</span></span>
<span id="cb212-17"><a href="#cb212-17" aria-hidden="true"></a><span class="co">#&gt; [1] 5 2 2</span></span>
<span id="cb212-18"><a href="#cb212-18" aria-hidden="true"></a>M[ ,<span class="dv">3</span>, drop=<span class="ot">FALSE</span>]</span>
<span id="cb212-19"><a href="#cb212-19" aria-hidden="true"></a><span class="co">#&gt;      [,1]</span></span>
<span id="cb212-20"><a href="#cb212-20" aria-hidden="true"></a><span class="co">#&gt; [1,]    5</span></span>
<span id="cb212-21"><a href="#cb212-21" aria-hidden="true"></a><span class="co">#&gt; [2,]    2</span></span>
<span id="cb212-22"><a href="#cb212-22" aria-hidden="true"></a><span class="co">#&gt; [3,]    2</span></span></code></pre></div>
<p>Estas construcciones sirven también para definir submatrices, y no sólo entradas, filas o columnas. Naturalmente, para indicar más de una fila o más de una columna tenemos que usar vectores de índices.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true"></a>M[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)] <span class="co">#Submatriz de filas 1, 2 y columnas 1, 3</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    5</span></span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true"></a><span class="co">#&gt; [2,]    3    2</span></span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true"></a>M[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), ] <span class="co">#Submatriz de filas 1, 3 y todas las columnas</span></span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    3    5    2</span></span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true"></a><span class="co">#&gt; [2,]    8    4    2    5</span></span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true"></a>M[ ,<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)] <span class="co">#Submatriz de columnas 2, 3, 4 y todas las filas</span></span>
<span id="cb213-10"><a href="#cb213-10" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb213-11"><a href="#cb213-11" aria-hidden="true"></a><span class="co">#&gt; [1,]    3    5    2</span></span>
<span id="cb213-12"><a href="#cb213-12" aria-hidden="true"></a><span class="co">#&gt; [2,]    6    2    9</span></span>
<span id="cb213-13"><a href="#cb213-13" aria-hidden="true"></a><span class="co">#&gt; [3,]    4    2    5</span></span></code></pre></div>
<p>Si las filas o las columnas de una matriz tienen nombres, se pueden usar para especificar trozos de la misma.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true"></a>A=<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>, <span class="dt">nrow=</span><span class="dv">3</span>)</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true"></a><span class="kw">dimnames</span>(A)=<span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;X1&quot;</span>,<span class="st">&quot;X2&quot;</span>,<span class="st">&quot;X3&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;Y1&quot;</span>,<span class="st">&quot;Y2&quot;</span>,<span class="st">&quot;Y3&quot;</span>))</span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true"></a>A</span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true"></a><span class="co">#&gt;    Y1 Y2 Y3</span></span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true"></a><span class="co">#&gt; X1  1  4  7</span></span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true"></a><span class="co">#&gt; X2  2  5  8</span></span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true"></a><span class="co">#&gt; X3  3  6  9</span></span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true"></a>A[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dv">2</span>]</span>
<span id="cb214-9"><a href="#cb214-9" aria-hidden="true"></a><span class="co">#&gt; X1 X3 </span></span>
<span id="cb214-10"><a href="#cb214-10" aria-hidden="true"></a><span class="co">#&gt;  4  6</span></span>
<span id="cb214-11"><a href="#cb214-11" aria-hidden="true"></a>A[<span class="kw">c</span>(<span class="st">&quot;X1&quot;</span>,<span class="st">&quot;X3&quot;</span>),<span class="st">&quot;Y2&quot;</span>]</span>
<span id="cb214-12"><a href="#cb214-12" aria-hidden="true"></a><span class="co">#&gt; X1 X3 </span></span>
<span id="cb214-13"><a href="#cb214-13" aria-hidden="true"></a><span class="co">#&gt;  4  6</span></span>
<span id="cb214-14"><a href="#cb214-14" aria-hidden="true"></a>A[<span class="kw">c</span>(<span class="st">&quot;X1&quot;</span>,<span class="st">&quot;X3&quot;</span>),<span class="kw">c</span>(<span class="st">&quot;Y1&quot;</span>,<span class="st">&quot;Y2&quot;</span>)]</span>
<span id="cb214-15"><a href="#cb214-15" aria-hidden="true"></a><span class="co">#&gt;    Y1 Y2</span></span>
<span id="cb214-16"><a href="#cb214-16" aria-hidden="true"></a><span class="co">#&gt; X1  1  4</span></span>
<span id="cb214-17"><a href="#cb214-17" aria-hidden="true"></a><span class="co">#&gt; X3  3  6</span></span></code></pre></div>
<p>La diagonal principal de una matriz cuadrada (la que va de la esquina superior izquierda a la esquina inferior derecha) se obtiene con la función <code>diag</code>. Si la matriz no es cuadrada, <code>diag</code> produce el vector de entradas (1, 1), (2, 2) … hasta que se para en la última fila o la última columna.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true"></a>A=<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>, <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true"></a>A </span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    2    3</span></span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true"></a><span class="co">#&gt; [2,]    4    5    6</span></span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true"></a><span class="co">#&gt; [3,]    7    8    9</span></span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true"></a><span class="kw">diag</span>(A)</span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true"></a><span class="co">#&gt; [1] 1 5 9</span></span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true"></a>B=<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true"></a>B</span>
<span id="cb215-11"><a href="#cb215-11" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span id="cb215-12"><a href="#cb215-12" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    2    3    4    5</span></span>
<span id="cb215-13"><a href="#cb215-13" aria-hidden="true"></a><span class="co">#&gt; [2,]    6    7    8    9   10</span></span>
<span id="cb215-14"><a href="#cb215-14" aria-hidden="true"></a><span class="kw">diag</span>(B)</span>
<span id="cb215-15"><a href="#cb215-15" aria-hidden="true"></a><span class="co">#&gt; [1] 1 7</span></span></code></pre></div>
</div>
<div id="algunas-funciones-para-matrices" class="section level2" number="5.3">
<h2 number="5.3"><span class="header-section-number">5.3</span> Algunas funciones para matrices</h2>
<p>Las <strong>dimensiones</strong> de una matriz, es decir, sus números de filas y de columnas, se obtienen con las funciones <code>nrow</code> y <code>ncol</code>, respectivamente. Si queremos un vector formado por las dos dimensiones, podemos emplear la función <code>dim</code>.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true"></a>X=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">4</span>), <span class="dt">byrow=</span><span class="ot">TRUE</span>, <span class="dt">nrow=</span><span class="dv">2</span>)</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true"></a>X</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    2    4    3    5    1</span></span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true"></a><span class="co">#&gt; [2,]    4    6    7    1    6    4</span></span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true"></a><span class="kw">nrow</span>(X)</span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true"></a><span class="kw">ncol</span>(X)</span>
<span id="cb216-9"><a href="#cb216-9" aria-hidden="true"></a><span class="co">#&gt; [1] 6</span></span>
<span id="cb216-10"><a href="#cb216-10" aria-hidden="true"></a><span class="kw">dim</span>(X)</span>
<span id="cb216-11"><a href="#cb216-11" aria-hidden="true"></a><span class="co">#&gt; [1] 2 6</span></span></code></pre></div>
<p>La mayoría de las funciones numéricas para vectores se pueden aplicar a matrices. Por ejemplo, podemos usar las funciones <code>sum</code>, <code>prod</code> o <code>mean</code> para obtener la suma, el producto o la media, respectivamente, de <em>todas</em> las entradas de una matriz.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true"></a>A=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true"></a>A</span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    2    1</span></span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true"></a><span class="co">#&gt; [2,]    3   -1    3</span></span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true"></a><span class="kw">sum</span>(A)</span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true"></a><span class="co">#&gt; [1] 9</span></span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true"></a><span class="kw">mean</span>(A)</span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true"></a><span class="co">#&gt; [1] 1.5</span></span></code></pre></div>
<p>En estadística a veces es necesario calcular la suma o la media por filas o por columnas de una matriz. Esto se puede llevar a cabo con las instrucciones siguientes:</p>
<ul>
<li><code>colSums</code> produce un vector con las sumas de las columnas.</li>
<li><code>rowSums</code> produce un vector con las sumas de las filas.</li>
<li><code>colMeans</code> produce un vector con las medias de las columnas.</li>
<li><code>rowMeans</code> produce un vector con las medias de las filas.</li>
</ul>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true"></a>A=<span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>))</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true"></a>A</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    2    3    2</span></span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true"></a><span class="co">#&gt; [2,]    2    5    3    1</span></span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true"></a><span class="co">#&gt; [3,]    4    1    2    4</span></span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true"></a><span class="kw">colSums</span>(A)  <span class="co">#Sumas de columnas</span></span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true"></a><span class="co">#&gt; [1] 7 8 8 7</span></span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true"></a><span class="kw">rowSums</span>(A)  <span class="co">#Sumas de filas</span></span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true"></a><span class="co">#&gt; [1]  8 11 11</span></span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true"></a><span class="kw">colMeans</span>(A)  <span class="co">#Medias de columnas</span></span>
<span id="cb218-12"><a href="#cb218-12" aria-hidden="true"></a><span class="co">#&gt; [1] 2.333333 2.666667 2.666667 2.333333</span></span>
<span id="cb218-13"><a href="#cb218-13" aria-hidden="true"></a><span class="kw">rowMeans</span>(A)  <span class="co">#Medias de filas</span></span>
<span id="cb218-14"><a href="#cb218-14" aria-hidden="true"></a><span class="co">#&gt; [1] 2.00 2.75 2.75</span></span></code></pre></div>
<p>Si queremos aplicar otras funciones a las filas o las columnas de una matriz, podemos emplear la función <code>apply</code>. Su estructura básica es</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true"></a><span class="kw">apply</span>(A, <span class="dt">MARGIN=</span>..., <span class="dt">FUN=</span>función)</span></code></pre></div>
<p>donde <code>A</code> es una matriz, la <code>función</code> es la que queremos aplicar,
y el valor de <code>MARGIN</code> ha de ser <code>1</code> si la queremos aplicar por filas, <code>2</code> si la queremos aplicar por columnas, o <code>c(1, 2)</code> si la queremos aplicar entrada a entrada; como pasaba con los vectores, en muchas ocasiones podemos aplicar una función a todas las entradas de una matriz entrando la matriz en su argumento, pero a veces es necesario usar <code>apply</code> con <code>MARGIN=c(1,2)</code>.</p>
<p>Por ejemplo, vamos a calcular la <strong>norma euclídea</strong> de las filas de la matriz <span class="math inline">\(A\)</span> anterior (la raíz cuadrada de la suma de los cuadrados de sus entradas):</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true"></a>f=<span class="cf">function</span>(x){<span class="kw">sqrt</span>(<span class="kw">sum</span>(x<span class="op">^</span><span class="dv">2</span>))}</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true"></a><span class="kw">apply</span>(A, <span class="dt">MARGIN=</span><span class="dv">1</span>, <span class="dt">FUN=</span>f)  </span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true"></a><span class="co">#&gt; [1] 4.242641 6.244998 6.082763</span></span></code></pre></div>
<p>Vamos a ordenar cada columna de la matriz <span class="math inline">\(A\)</span>:</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true"></a>A_ord=<span class="kw">apply</span>(A, <span class="dt">MARGIN=</span><span class="dv">2</span>, <span class="dt">FUN=</span>sort)  <span class="co">#Matriz con cada columna de A ordenada</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true"></a>A_ord</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    1    2    1</span></span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true"></a><span class="co">#&gt; [2,]    2    2    3    2</span></span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true"></a><span class="co">#&gt; [3,]    4    5    3    4</span></span></code></pre></div>
<p>Finalmente, vamos a calcular la matriz de raíces cuadradas de las entradas de <span class="math inline">\(A\)</span>
sin usar <code>apply</code> y usándola:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true"></a><span class="kw">sqrt</span>(A)  </span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true"></a><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]</span></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true"></a><span class="co">#&gt; [1,] 1.000000 1.414214 1.732051 1.414214</span></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true"></a><span class="co">#&gt; [2,] 1.414214 2.236068 1.732051 1.000000</span></span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true"></a><span class="co">#&gt; [3,] 2.000000 1.000000 1.414214 2.000000</span></span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true"></a><span class="kw">apply</span>(A, <span class="dt">MARGIN=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">FUN=</span>sqrt)  </span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true"></a><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]</span></span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true"></a><span class="co">#&gt; [1,] 1.000000 1.414214 1.732051 1.414214</span></span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true"></a><span class="co">#&gt; [2,] 1.414214 2.236068 1.732051 1.000000</span></span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true"></a><span class="co">#&gt; [3,] 2.000000 1.000000 1.414214 2.000000</span></span></code></pre></div>
</div>
<div id="cálculo-matricial" class="section level2" number="5.4">
<h2 number="5.4"><span class="header-section-number">5.4</span> Cálculo matricial</h2>
<p>Las operaciones algebraicas usuales con matrices numéricas se indican de la manera siguiente:</p>
<ul>
<li><p>La <strong>traspuesta</strong> se obtiene con la función <code>t</code>.</p></li>
<li><p>La <strong>suma</strong> de matrices se indica con el signo usual <code>+</code>.</p></li>
<li><p>El <strong>producto por un escalar</strong> de una matriz se indica con el signo usual <code>*</code>.</p></li>
<li><p>El <strong>producto</strong> de matrices se indica con <code>%*%</code>.</p></li>
</ul>
<p><strong>¡Atención!</strong> Si <em>multiplicáis</em> dos matrices con el signo <code>*</code>, no obtenéis el producto de las dos matrices, sino la matriz que tiene en cada entrada <span class="math inline">\((i, j)\)</span> el producto de las entradas <span class="math inline">\((i, j)\)</span> de cada una de las dos matrices. Esto a veces es útil, pero no es el producto de matrices. De manera similar, si <span class="math inline">\(M\)</span> es una matriz y entráis <code>M^n</code>, el resultado no es la potencia <span class="math inline">\(n\)</span>-ésima de <span class="math inline">\(M\)</span>, sino la matriz que tiene en cada entrada la potencia <span class="math inline">\(n\)</span>-ésima de la entrada correspondiente de <span class="math inline">\(M\)</span>. De nuevo, esto a veces es útil, pero muy pocas veces coincide con la potencia <span class="math inline">\(n\)</span>-ésima de <span class="math inline">\(M\)</span>.</p>
<p>Veamos algunos ejemplos de operaciones matriciales:</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true"></a>A=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true"></a>A</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    2</span></span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true"></a><span class="co">#&gt; [2,]    1    3</span></span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true"></a>B=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">2</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true"></a>B</span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true"></a><span class="co">#&gt; [1,]   -2    4</span></span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true"></a><span class="co">#&gt; [2,]    3    1</span></span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true"></a><span class="co">#&gt; [3,]    0    2</span></span>
<span id="cb223-12"><a href="#cb223-12" aria-hidden="true"></a>C=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb223-13"><a href="#cb223-13" aria-hidden="true"></a>C</span>
<span id="cb223-14"><a href="#cb223-14" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb223-15"><a href="#cb223-15" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    0    1</span></span>
<span id="cb223-16"><a href="#cb223-16" aria-hidden="true"></a><span class="co">#&gt; [2,]    2    1    0</span></span>
<span id="cb223-17"><a href="#cb223-17" aria-hidden="true"></a><span class="kw">t</span>(B) <span class="co">#Traspuesta</span></span>
<span id="cb223-18"><a href="#cb223-18" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb223-19"><a href="#cb223-19" aria-hidden="true"></a><span class="co">#&gt; [1,]   -2    3    0</span></span>
<span id="cb223-20"><a href="#cb223-20" aria-hidden="true"></a><span class="co">#&gt; [2,]    4    1    2</span></span>
<span id="cb223-21"><a href="#cb223-21" aria-hidden="true"></a><span class="kw">t</span>(B)<span class="op">+</span>C <span class="co">#Suma</span></span>
<span id="cb223-22"><a href="#cb223-22" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb223-23"><a href="#cb223-23" aria-hidden="true"></a><span class="co">#&gt; [1,]   -1    3    1</span></span>
<span id="cb223-24"><a href="#cb223-24" aria-hidden="true"></a><span class="co">#&gt; [2,]    6    2    2</span></span>
<span id="cb223-25"><a href="#cb223-25" aria-hidden="true"></a><span class="dv">5</span><span class="op">*</span>A <span class="co">#Producto por escalar</span></span>
<span id="cb223-26"><a href="#cb223-26" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb223-27"><a href="#cb223-27" aria-hidden="true"></a><span class="co">#&gt; [1,]    5   10</span></span>
<span id="cb223-28"><a href="#cb223-28" aria-hidden="true"></a><span class="co">#&gt; [2,]    5   15</span></span>
<span id="cb223-29"><a href="#cb223-29" aria-hidden="true"></a>C<span class="op">%*%</span>B <span class="co">#Producto</span></span>
<span id="cb223-30"><a href="#cb223-30" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb223-31"><a href="#cb223-31" aria-hidden="true"></a><span class="co">#&gt; [1,]   -2    6</span></span>
<span id="cb223-32"><a href="#cb223-32" aria-hidden="true"></a><span class="co">#&gt; [2,]   -1    9</span></span>
<span id="cb223-33"><a href="#cb223-33" aria-hidden="true"></a>(C<span class="op">%*%</span>B)<span class="op">%*%</span>A <span class="co">#Producto </span></span>
<span id="cb223-34"><a href="#cb223-34" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb223-35"><a href="#cb223-35" aria-hidden="true"></a><span class="co">#&gt; [1,]    4   14</span></span>
<span id="cb223-36"><a href="#cb223-36" aria-hidden="true"></a><span class="co">#&gt; [2,]    8   25</span></span>
<span id="cb223-37"><a href="#cb223-37" aria-hidden="true"></a>A<span class="op">^</span><span class="dv">2</span> <span class="co">#Esto no es elevar al cuadrado</span></span>
<span id="cb223-38"><a href="#cb223-38" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb223-39"><a href="#cb223-39" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    4</span></span>
<span id="cb223-40"><a href="#cb223-40" aria-hidden="true"></a><span class="co">#&gt; [2,]    1    9</span></span>
<span id="cb223-41"><a href="#cb223-41" aria-hidden="true"></a>A<span class="op">%*%</span>A  <span class="co">#Esto sí</span></span>
<span id="cb223-42"><a href="#cb223-42" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb223-43"><a href="#cb223-43" aria-hidden="true"></a><span class="co">#&gt; [1,]    3    8</span></span>
<span id="cb223-44"><a href="#cb223-44" aria-hidden="true"></a><span class="co">#&gt; [2,]    4   11</span></span></code></pre></div>
<p>Al multiplicar matrices por vectores, R trata por defecto estos últimos como vectores columna, pero si en alguna situación concreta la manera natural de entender un vector es como vector fila, lo hace sin ningún reparo. Veamos algunos ejemplos:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true"></a>A=<span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>))</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true"></a>A</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    2</span></span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true"></a><span class="co">#&gt; [2,]    3    4</span></span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true"></a>v=<span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>)</span></code></pre></div>
<p>El producto
<span class="math display">\[
\left(\begin{array}{cc}
1 &amp; 2 \\ 3 &amp; 4\end{array}
\right)\cdot \left(\begin{array}{c}
5\\ 6\end{array}
\right)
\]</span>
se obtiene mediante</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true"></a>A<span class="op">%*%</span>v</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true"></a><span class="co">#&gt;      [,1]</span></span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true"></a><span class="co">#&gt; [1,]   17</span></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true"></a><span class="co">#&gt; [2,]   39</span></span></code></pre></div>
<p>El producto
<span class="math display">\[
\left(\begin{array}{cc}
5 &amp; 6\end{array}\right)\cdot\left(\begin{array}{cc}
1 &amp; 2 \\ 3 &amp; 4\end{array}
\right)
\]</span>
se obtiene mediante</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true"></a>v<span class="op">%*%</span>A</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true"></a><span class="co">#&gt; [1,]   23   34</span></span></code></pre></div>
<p>El producto
<span class="math display">\[
\left(\begin{array}{cc}
5 &amp; 6\end{array}\right)\cdot \left(\begin{array}{c}
5\\ 6\end{array}
\right)
\]</span>
se obtiene mediante</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true"></a>v<span class="op">%*%</span>v</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true"></a><span class="co">#&gt;      [,1]</span></span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true"></a><span class="co">#&gt; [1,]   61</span></span></code></pre></div>
<p>El producto
<span class="math display">\[
\left(\begin{array}{c}
5\\ 6\end{array}
\right)\cdot
\left(\begin{array}{cc}
5 &amp; 6\end{array}\right) 
\]</span>
se obtiene mediante</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true"></a>v<span class="op">%*%</span><span class="kw">t</span>(v)</span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true"></a><span class="co">#&gt; [1,]   25   30</span></span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true"></a><span class="co">#&gt; [2,]   30   36</span></span></code></pre></div>
<p>La versión básica de R no lleva ninguna función para calcular potencias de matrices,
y hay que cargar algún paquete adecuado para disponer de ella. Por ejemplo,
el paquete <strong>expm</strong> dispone de la operación <code>%^%</code> y el paquete <strong>matrixcalc</strong>, que aporta muchas funciones específicas para efectuar cálculos con matrices, de la función <code>matrix.power</code>. No obstante, hay que tener en cuenta que estas funciones, y otras parecidas, no calculan las potencias de manera exacta, sino que emplean algoritmos de cálculo numérico para aproximarlas a cambio de calcularlas rápido, y por lo tanto no siempre dan el resultado exacto.</p>
<p>Así, para calcular
<span class="math display">\[
\left(\begin{array}{cc}
1 &amp; 2 \\ 1 &amp; 3\end{array}
\right)^{20}
\]</span>
podemos entrar</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true"></a>A=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true"></a><span class="kw">library</span>(expm)</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true"></a>A<span class="op">%^%</span><span class="dv">20</span> </span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true"></a><span class="co">#&gt;             [,1]         [,2]</span></span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true"></a><span class="co">#&gt; [1,] 58063278153 158631825968</span></span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true"></a><span class="co">#&gt; [2,] 79315912984 216695104121</span></span></code></pre></div>
<p>o</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true"></a><span class="kw">library</span>(matrixcalc)</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true"></a><span class="kw">matrix.power</span>(A, <span class="dv">20</span>)</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true"></a><span class="co">#&gt;             [,1]         [,2]</span></span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true"></a><span class="co">#&gt; [1,] 58063278153 158631825968</span></span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true"></a><span class="co">#&gt; [2,] 79315912984 216695104121</span></span></code></pre></div>
<p>El determinante de una matriz cuadrada se calcula con la función <code>det</code>.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true"></a>Y=<span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true"></a>Y</span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    3    2</span></span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true"></a><span class="co">#&gt; [2,]    2    3    5</span></span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true"></a><span class="co">#&gt; [3,]   -1    3    2</span></span>
<span id="cb231-7"><a href="#cb231-7" aria-hidden="true"></a><span class="kw">det</span>(Y)</span>
<span id="cb231-8"><a href="#cb231-8" aria-hidden="true"></a><span class="co">#&gt; [1] -18</span></span></code></pre></div>
<p>Para ganar en rapidez, R calcula los determinantes usando un método numérico que a veces produce efectos no deseados como el siguiente:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true"></a>A=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">10</span>,<span class="dv">30</span>,<span class="dv">100</span>), <span class="dt">nrow=</span><span class="dv">2</span>)</span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true"></a>A</span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true"></a><span class="co">#&gt; [1,]    3   30</span></span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true"></a><span class="co">#&gt; [2,]   10  100</span></span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true"></a><span class="kw">det</span>(A)</span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true"></a><span class="co">#&gt; [1] 3.552714e-14</span></span></code></pre></div>
<p>Pero, de hecho,
<span class="math display">\[
\left|\begin{array}{cc}
3 &amp; 30\\ 10 &amp;100
\end{array}\right|=
3\cdot 100-30\cdot 10=0.
\]</span></p>
<p>Por lo tanto, este determinante 3.552714·10<sup>-14</sup> es en realidad 0.</p>
<p>Para calcular el rango de una matriz <span class="math inline">\(A\)</span>, si esta es cuadrada y ya tenéis cargado el paquete <strong>matrixcalc</strong>, podéis usar la fución <code>matrix.rank</code>. Si la matriz no es cuadrada, podéis usar la función <code>rankMatrix</code> del paquete <strong>Matrix</strong>.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true"></a>X=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="op">-</span><span class="dv">7</span>,<span class="dv">3</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">16</span>,<span class="op">-</span><span class="dv">3</span>,<span class="dv">4</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true"></a>X</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true"></a><span class="co">#&gt; [1,]    0    1    0</span></span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true"></a><span class="co">#&gt; [2,]   -7    3   -1</span></span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true"></a><span class="co">#&gt; [3,]   16   -3    4</span></span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true"></a><span class="kw">det</span>(X)</span>
<span id="cb233-8"><a href="#cb233-8" aria-hidden="true"></a><span class="co">#&gt; [1] 12</span></span>
<span id="cb233-9"><a href="#cb233-9" aria-hidden="true"></a><span class="kw">matrix.rank</span>(X)</span>
<span id="cb233-10"><a href="#cb233-10" aria-hidden="true"></a><span class="co">#&gt; [1] 3</span></span></code></pre></div>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true"></a><span class="kw">library</span>(Matrix)</span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true"></a>Y=<span class="kw">rbind</span>(<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>), <span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true"></a>Y</span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true"></a><span class="co">#&gt; [1,]    0    0    0</span></span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true"></a><span class="co">#&gt; [2,]    1    1    1</span></span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true"></a><span class="kw">rankMatrix</span>(Y)</span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true"></a><span class="co">#&gt; attr(,&quot;method&quot;)</span></span>
<span id="cb234-10"><a href="#cb234-10" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;tolNorm2&quot;</span></span>
<span id="cb234-11"><a href="#cb234-11" aria-hidden="true"></a><span class="co">#&gt; attr(,&quot;useGrad&quot;)</span></span>
<span id="cb234-12"><a href="#cb234-12" aria-hidden="true"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb234-13"><a href="#cb234-13" aria-hidden="true"></a><span class="co">#&gt; attr(,&quot;tol&quot;)</span></span>
<span id="cb234-14"><a href="#cb234-14" aria-hidden="true"></a><span class="co">#&gt; [1] 6.661338e-16</span></span></code></pre></div>
<p>Podemos calcular la inversa de una matriz invertible con la instrucción <code>solve</code>. Por ejemplo, para calcular la inversa <span class="math inline">\(A^{-1}\)</span> de la matriz</p>
<p><span class="math display">\[
A=\left(\begin{array}{ccc}
1 &amp; 3 &amp; 4 \\ 0 &amp; 2 &amp; -1 \\ 2 &amp; 1 &amp; 2\end{array}
\right)
\]</span>
podemos entrar lo siguiente:</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true"></a>A=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true"></a><span class="kw">solve</span>(A) </span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true"></a><span class="co">#&gt;            [,1]       [,2]        [,3]</span></span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true"></a><span class="co">#&gt; [1,] -0.2941176  0.1176471  0.64705882</span></span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true"></a><span class="co">#&gt; [2,]  0.1176471  0.3529412 -0.05882353</span></span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true"></a><span class="co">#&gt; [3,]  0.2352941 -0.2941176 -0.11764706</span></span></code></pre></div>
<p>Obtenemos</p>
<p><span class="math display">\[
A^{-1}=\left(\begin{array}{ccc}
-0.2941176 &amp; 0.1176471 &amp; 0.64705882\\
0.1176471 &amp; 0.3529412 &amp; -0.05882353\\
0.2352941 &amp; -0.2941176 &amp; -0.11764706
\end{array}
\right).
\]</span>
Comprobemos si esta matriz es realmente la inversa de <span class="math inline">\(A\)</span>:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true"></a>A<span class="op">%*%</span><span class="kw">solve</span>(A) </span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true"></a><span class="co">#&gt;              [,1] [,2]          [,3]</span></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true"></a><span class="co">#&gt; [1,] 1.000000e+00    0  0.000000e+00</span></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true"></a><span class="co">#&gt; [2,] 5.551115e-17    1 -2.775558e-17</span></span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true"></a><span class="co">#&gt; [3,] 0.000000e+00    0  1.000000e+00</span></span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true"></a><span class="kw">solve</span>(A)<span class="op">%*%</span>A </span>
<span id="cb236-7"><a href="#cb236-7" aria-hidden="true"></a><span class="co">#&gt;      [,1]         [,2]         [,3]</span></span>
<span id="cb236-8"><a href="#cb236-8" aria-hidden="true"></a><span class="co">#&gt; [1,]    1 0.000000e+00 0.000000e+00</span></span>
<span id="cb236-9"><a href="#cb236-9" aria-hidden="true"></a><span class="co">#&gt; [2,]    0 1.000000e+00 1.110223e-16</span></span>
<span id="cb236-10"><a href="#cb236-10" aria-hidden="true"></a><span class="co">#&gt; [3,]    0 2.775558e-17 1.000000e+00</span></span></code></pre></div>
<p>Los productos<code>A%*%solve(A)</code> y <code>solve(A)%*%A</code> no han dado exactamente la matriz identidad, como deberían, pero la diferencia está en la decimosexta cifra decimal. Recordad que R no trabaja con precisión infinita, a veces los errores de redondeo son inevitables.</p>
<p>La función <code>solve</code> también sirve para resolver sistemas de ecuaciones lineales</p>
<p><span class="math display">\[
\left.\begin{array}{c}
a_{1,1} x_1+\cdots +a_{1,n}x_n = b_1 \\
a_{2,1} x_1+\cdots +a_{2,n}x_n = b_2 \\
\vdots\qquad\ \\
a_{n,1} x_1+\cdots +a_{n,n}x_n = b_n
\end{array}
\right\}
\]</span>
cuya <strong>matriz del sistema</strong></p>
<p><span class="math display">\[
A=\left(\begin{array}{ccc}
a_{1,1} &amp; \cdots &amp; a_{1,n} \\
\vdots &amp; \ddots &amp; \vdots\\
a_{n,1} &amp; \cdots &amp; a_{n,n}
\end{array}
\right)
\]</span>
sea cuadrada e invertible. Para ello, se usaría la instrucción</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true"></a><span class="kw">solve</span>(A, b)</span></code></pre></div>
<p>donde <code>A</code> es la matriz <span class="math inline">\(A\)</span> del sistema y <code>b</code> es el vector de términos independientes
<span class="math display">\[
b=(b_1, \ldots, b_{n}).
\]</span></p>
<p>Por ejemplo, para resolver el sistema
<span class="math display">\[
\left.\begin{array}{r}
x+6y-3z = 7 \\
2x-y+z = 2\\
x+y-z = 3
\end{array}
\right\},
\]</span>
que escrito en forma matricial es
<span class="math display">\[
\left(\begin{array}{ccc}
1 &amp; 6 &amp; -3 \\ 2 &amp; -1 &amp; 1 \\ 1 &amp; 1 &amp; -1\end{array}
\right)\cdot 
\left(\begin{array}{c} x \\ y \\ z \end{array}
\right)=
\left(\begin{array}{c} 7 \\ 2 \\ 3 \end{array}
\right), 
\]</span>
podemos entrar</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true"></a>A=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="op">-</span><span class="dv">3</span>,<span class="dv">2</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true"></a>A</span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    6   -3</span></span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true"></a><span class="co">#&gt; [2,]    2   -1    1</span></span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true"></a><span class="co">#&gt; [3,]    1    1   -1</span></span>
<span id="cb238-7"><a href="#cb238-7" aria-hidden="true"></a>b=<span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb238-8"><a href="#cb238-8" aria-hidden="true"></a><span class="kw">solve</span>(A, b)</span>
<span id="cb238-9"><a href="#cb238-9" aria-hidden="true"></a><span class="co">#&gt; [1]  1.6666667  0.4444444 -0.8888889</span></span></code></pre></div>
<p>y obtenemos que la solución del sistema (redondeada a 7 cifras decimales) es</p>
<p><span class="math display">\[
x=1.6666667, \ y=0.4444444, \ z=-0.8888889.
\]</span></p>
</div>
<div id="valores-y-vectores-propios" class="section level2" number="5.5">
<h2 number="5.5"><span class="header-section-number">5.5</span> Valores y vectores propios</h2>
<p>La función básica para calcular valores y vectores propios es <code>eigen</code>, por el hecho que, en inglés, los valores y vectores propios se llaman <code>eigenvalues</code> y <code>eigenvectors</code>, respectivamente. (Si necesitáis repasar las definiciones de vector y valor propio de una matriz y de descomposición canónica de una matriz diagonalizable, y por qué son importantes, podéis consultar las entradas correspondientes de la <em>Wikipedia</em>:
<a href="http://es.wikipedia.org/wiki/Vector_propio_y_valor_propio">http://es.wikipedia.org/wiki/Vector_propio_y_valor_propio</a>
y <a href="http://es.wikipedia.org/wiki/Matriz_diagonalizable">http://es.wikipedia.org/wiki/Matriz_diagonalizable</a>.)</p>
<p>Supongamos, por ejemplo, que queremos calcular los valores propios de la matriz</p>
<p><span class="math display">\[
A=\left(\begin{array}{ccc}2 &amp; 6 &amp; -8 \\ 0 &amp; 6 &amp; -3 \\ 0 &amp; 2 &amp; 1\end{array}
\right).
\]</span></p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true"></a>A=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">6</span>,<span class="op">-</span><span class="dv">8</span>,<span class="dv">0</span>,<span class="dv">6</span>,<span class="op">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true"></a>A</span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true"></a><span class="co">#&gt; [1,]    2    6   -8</span></span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true"></a><span class="co">#&gt; [2,]    0    6   -3</span></span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true"></a><span class="co">#&gt; [3,]    0    2    1</span></span>
<span id="cb239-7"><a href="#cb239-7" aria-hidden="true"></a><span class="kw">eigen</span>(A)</span>
<span id="cb239-8"><a href="#cb239-8" aria-hidden="true"></a><span class="co">#&gt; eigen() decomposition</span></span>
<span id="cb239-9"><a href="#cb239-9" aria-hidden="true"></a><span class="co">#&gt; $values</span></span>
<span id="cb239-10"><a href="#cb239-10" aria-hidden="true"></a><span class="co">#&gt; [1] 4 3 2</span></span>
<span id="cb239-11"><a href="#cb239-11" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb239-12"><a href="#cb239-12" aria-hidden="true"></a><span class="co">#&gt; $vectors</span></span>
<span id="cb239-13"><a href="#cb239-13" aria-hidden="true"></a><span class="co">#&gt;           [,1]       [,2] [,3]</span></span>
<span id="cb239-14"><a href="#cb239-14" aria-hidden="true"></a><span class="co">#&gt; [1,] 0.2672612 -0.8164966    1</span></span>
<span id="cb239-15"><a href="#cb239-15" aria-hidden="true"></a><span class="co">#&gt; [2,] 0.8017837  0.4082483    0</span></span>
<span id="cb239-16"><a href="#cb239-16" aria-hidden="true"></a><span class="co">#&gt; [3,] 0.5345225  0.4082483    0</span></span></code></pre></div>
<p>El resultado de <code>eigen</code> es una <code>list</code> con dos objetos: <code>values</code> y <code>vectors</code>.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true"></a><span class="kw">str</span>(<span class="kw">eigen</span>(A))</span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true"></a><span class="co">#&gt; List of 2</span></span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true"></a><span class="co">#&gt;  $ values : num [1:3] 4 3 2</span></span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true"></a><span class="co">#&gt;  $ vectors: num [1:3, 1:3] 0.267 0.802 0.535 -0.816 0.408 ...</span></span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true"></a><span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr &quot;eigen&quot;</span></span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true"></a><span class="kw">eigen</span>(A)<span class="op">$</span>values</span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true"></a><span class="co">#&gt; [1] 4 3 2</span></span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true"></a><span class="kw">eigen</span>(A)<span class="op">$</span>vectors</span>
<span id="cb240-9"><a href="#cb240-9" aria-hidden="true"></a><span class="co">#&gt;           [,1]       [,2] [,3]</span></span>
<span id="cb240-10"><a href="#cb240-10" aria-hidden="true"></a><span class="co">#&gt; [1,] 0.2672612 -0.8164966    1</span></span>
<span id="cb240-11"><a href="#cb240-11" aria-hidden="true"></a><span class="co">#&gt; [2,] 0.8017837  0.4082483    0</span></span>
<span id="cb240-12"><a href="#cb240-12" aria-hidden="true"></a><span class="co">#&gt; [3,] 0.5345225  0.4082483    0</span></span></code></pre></div>
<p>El objeto <code>values</code> es un vector con los valores propios, y el objeto <code>vectors</code> es una matriz cuyas columnas son vectores propios: la primera columna es un vector propio del primer valor propio del vector <code>values</code>, la segunda lo es del segundo, y así sucesivamente. De este modo, del resultado anterior deducimos que los valores propios de <span class="math inline">\(A\)</span> son 2, 3 y 4 y que</p>
<p><span class="math display">\[
\left(\begin{array}{c} 1 \\ 0 \\ 0\end{array}\right),
\left(\begin{array}{c} -0.8164966 \\ 0.4082483 \\ 0.4082483\end{array}\right),
\left(\begin{array}{c} 0.2672612 \\ 0.8017837 \\ 0.5345225\end{array}\right)
\]</span></p>
<p>son vectores propios de <span class="math inline">\(A\)</span> de valores propios 2, 3 y 4, respectivamente (o, para ser precisos, los dos últimos son vectores propios de valor propio 3 y 4 redondeados a 7 cifras decimales).</p>
<p>Es importante tener en cuenta algunas propiedades de la función <code>eigen</code>:</p>
<ul>
<li><p>Da los valores propios en orden decreciente de su valor absoluto (o de su módulo, si hay valores propios complejos) y repetidos tantas veces como su multiplicidad.</p></li>
<li><p>Si hay algún valor propio con multiplicidad mayor que 1, da tantos vectores de este valor propio como su multiplicidad. Además, en este caso procura que estos vectores propios sean linealmente independientes. Por lo tanto, cuando da vectores propios repetidos de algún valor propio es porque para este valor propio no existen tantos vectores propios linealmente independientes como su multiplicidad y, por consiguiente, la matriz no es diagonalizable.</p></li>
</ul>
<p>Del resultado de <code>eigen(A)</code> se puede obtener una <strong>descomposición canónica</strong>
<span class="math display">\[
A= P\cdot D\cdot P^{-1}
\]</span>
de una matriz diagonalizable <span class="math inline">\(A\)</span>: basta tomar como <span class="math inline">\(D\)</span> la matriz diagonal que tiene como diagonal principal el vector <code>eigen(A)$values</code> y como <span class="math inline">\(P\)</span> la matriz <code>eigen(A)$vectors</code>.</p>
<p>Para construir una matriz diagonal cuya diagonal principal sea un <code>vector</code> dado, podemos usar la instrucción <code>diag(vector)</code>. Si aplicamos <code>diag</code> a un número <span class="math inline">\(n\)</span>, produce la matriz identidad de orden <span class="math inline">\(n\)</span>.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true"></a><span class="kw">diag</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true"></a><span class="co">#&gt; [1,]    2    0    0</span></span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true"></a><span class="co">#&gt; [2,]    0    5    0</span></span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true"></a><span class="co">#&gt; [3,]    0    0   -1</span></span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true"></a><span class="kw">diag</span>(<span class="dv">3</span>)</span>
<span id="cb241-7"><a href="#cb241-7" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb241-8"><a href="#cb241-8" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    0    0</span></span>
<span id="cb241-9"><a href="#cb241-9" aria-hidden="true"></a><span class="co">#&gt; [2,]    0    1    0</span></span>
<span id="cb241-10"><a href="#cb241-10" aria-hidden="true"></a><span class="co">#&gt; [3,]    0    0    1</span></span></code></pre></div>
<p>La función <code>diag</code> ya había salido en la Sección @ref(sec:entrmatr): si se aplica a una matriz, se obtiene el vector formado por sus entradas (1,1), (2,2) …; ahora vemos que si se aplica a un vector, produce una matriz diagonal.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true"></a>B=<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true"></a>B</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    2    3    4    5</span></span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true"></a><span class="co">#&gt; [2,]    6    7    8    9   10</span></span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true"></a><span class="kw">diag</span>(B)</span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true"></a><span class="co">#&gt; [1] 1 7</span></span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true"></a><span class="kw">diag</span>(<span class="kw">diag</span>(B))</span>
<span id="cb242-9"><a href="#cb242-9" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb242-10"><a href="#cb242-10" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    0</span></span>
<span id="cb242-11"><a href="#cb242-11" aria-hidden="true"></a><span class="co">#&gt; [2,]    0    7</span></span></code></pre></div>
<p>Veamos un ejemplo de uso de <code>eigen</code> para calcular una descomposición canónica.
Como hemos visto, la matriz
<span class="math display">\[
A=\left(\begin{array}{ccc}2 &amp; 6 &amp; -8 \\ 0 &amp; 6 &amp; -3 \\ 0 &amp; 2 &amp; 1\end{array}
\right)
\]</span>
es de orden 3 y tiene sus tres valores propios diferentes. Por lo tanto, es diagonalizable y las matrices de una descomposición canónica son las siguientes:</p>
<ul>
<li>La matriz diagonal <span class="math inline">\(D\)</span> de valores propios es</li>
</ul>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true"></a>D=<span class="kw">diag</span>(<span class="kw">eigen</span>(A)<span class="op">$</span>values) </span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true"></a>D</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true"></a><span class="co">#&gt; [1,]    4    0    0</span></span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true"></a><span class="co">#&gt; [2,]    0    3    0</span></span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true"></a><span class="co">#&gt; [3,]    0    0    2</span></span></code></pre></div>
<ul>
<li>La matriz <span class="math inline">\(P\)</span> de vectores propios es</li>
</ul>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true"></a>P=<span class="kw">eigen</span>(A)<span class="op">$</span>vectors </span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true"></a>P</span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true"></a><span class="co">#&gt;           [,1]       [,2] [,3]</span></span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true"></a><span class="co">#&gt; [1,] 0.2672612 -0.8164966    1</span></span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true"></a><span class="co">#&gt; [2,] 0.8017837  0.4082483    0</span></span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true"></a><span class="co">#&gt; [3,] 0.5345225  0.4082483    0</span></span></code></pre></div>
<p>Por consiguiente, una descomposición canónica de <span class="math inline">\(A\)</span> es (redondeando)</p>
<p><span class="math display">\[
A=\left(\begin{array}{ccc}
0.2673 &amp; -0.8165 &amp; 1\\
0.8019 &amp; 0.4082 &amp; 0\\
0.5345 &amp; 0.4082 &amp; 0
\end{array}
\right)\!\cdot\!
\left(\begin{array}{ccc}
4 &amp; 0 &amp; 0 \\ 0 &amp; 3 &amp; 0\\ 0 &amp; 0 &amp; 2 \end{array}
\right)\!\cdot\!
\left(\begin{array}{ccc}
0.2673 &amp; -0.8165 &amp; 1\\
0.8019 &amp; 0.4082 &amp; 0\\
0.5345 &amp; 0.4082 &amp; 0
\end{array}
\right)^{-1}.
\]</span></p>
<p>Comprobemos que, efectivamente, <span class="math inline">\(A=P\cdot D\cdot P^{-1}\)</span>:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true"></a>P<span class="op">%*%</span>D<span class="op">%*%</span><span class="kw">solve</span>(P)</span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true"></a><span class="co">#&gt; [1,]    2    6   -8</span></span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true"></a><span class="co">#&gt; [2,]    0    6   -3</span></span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true"></a><span class="co">#&gt; [3,]    0    2    1</span></span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true"></a>A</span>
<span id="cb245-7"><a href="#cb245-7" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb245-8"><a href="#cb245-8" aria-hidden="true"></a><span class="co">#&gt; [1,]    2    6   -8</span></span>
<span id="cb245-9"><a href="#cb245-9" aria-hidden="true"></a><span class="co">#&gt; [2,]    0    6   -3</span></span>
<span id="cb245-10"><a href="#cb245-10" aria-hidden="true"></a><span class="co">#&gt; [3,]    0    2    1</span></span></code></pre></div>
<p>Veamos otro ejemplo. Queremos decidir si la matriz
<span class="math display">\[
B=\left(\begin{array}{ccc}0 &amp; 1 &amp; 0 \\ -7 &amp; 3 &amp; -1 \\ 16 &amp; -3 &amp; 4\end{array}
\right)
\]</span>
es diagonalizable y, en caso afirmativo, obtener una descomposición canónica.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true"></a>B=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="op">-</span><span class="dv">7</span>,<span class="dv">3</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">16</span>,<span class="op">-</span><span class="dv">3</span>,<span class="dv">4</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true"></a><span class="kw">eigen</span>(B)</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true"></a><span class="co">#&gt; eigen() decomposition</span></span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true"></a><span class="co">#&gt; $values</span></span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true"></a><span class="co">#&gt; [1] 3 2 2</span></span>
<span id="cb246-6"><a href="#cb246-6" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb246-7"><a href="#cb246-7" aria-hidden="true"></a><span class="co">#&gt; $vectors</span></span>
<span id="cb246-8"><a href="#cb246-8" aria-hidden="true"></a><span class="co">#&gt;            [,1]       [,2]       [,3]</span></span>
<span id="cb246-9"><a href="#cb246-9" aria-hidden="true"></a><span class="co">#&gt; [1,] -0.1301889 -0.1825742 -0.1825742</span></span>
<span id="cb246-10"><a href="#cb246-10" aria-hidden="true"></a><span class="co">#&gt; [2,] -0.3905667 -0.3651484 -0.3651484</span></span>
<span id="cb246-11"><a href="#cb246-11" aria-hidden="true"></a><span class="co">#&gt; [3,]  0.9113224  0.9128709  0.9128709</span></span></code></pre></div>
<p>Da dos veces el mismo vector propio de valor propio 2. Esto significa que <span class="math inline">\(B\)</span> no tiene dos vectores propios linealmente independientes de este valor propio, y, por lo tanto, no es diagonalizable.</p>
</div>
<div id="matrices-complejas-opcional" class="section level2" number="5.6">
<h2 number="5.6"><span class="header-section-number">5.6</span> Matrices complejas (opcional)</h2>
<p>La mayoría de las instrucciones explicadas en esta lección para operar con matrices numéricas sirven sin ningún cambio para operar con matrices de entradas números complejos. Por ejemplo, para elevar al cuadrado la matriz
<span class="math display">\[
\left( \begin{array}{cc} 3-2i &amp; 5+3\\ 1+2i &amp; 2-i \end{array}
\right),
\]</span>
podemos entrar:</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true"></a>A=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">3</span><span class="op">-</span>2i,<span class="dv">5</span><span class="op">+</span>3i,<span class="dv">1</span><span class="op">+</span>2i,<span class="dv">2</span><span class="op">-</span>1i), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true"></a>A</span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true"></a><span class="co">#&gt; [1,] 3-2i 5+3i</span></span>
<span id="cb247-5"><a href="#cb247-5" aria-hidden="true"></a><span class="co">#&gt; [2,] 1+2i 2-1i</span></span>
<span id="cb247-6"><a href="#cb247-6" aria-hidden="true"></a>A<span class="op">%*%</span>A</span>
<span id="cb247-7"><a href="#cb247-7" aria-hidden="true"></a><span class="co">#&gt;       [,1]  [,2]</span></span>
<span id="cb247-8"><a href="#cb247-8" aria-hidden="true"></a><span class="co">#&gt; [1,]  4+1i 34+0i</span></span>
<span id="cb247-9"><a href="#cb247-9" aria-hidden="true"></a><span class="co">#&gt; [2,] 11+7i  2+9i</span></span></code></pre></div>
<p>Para calcular sus valores y vectores propios, podemos entrar:</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true"></a><span class="kw">eigen</span>(A)</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true"></a><span class="co">#&gt; eigen() decomposition</span></span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true"></a><span class="co">#&gt; $values</span></span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true"></a><span class="co">#&gt; [1] 4.902076+1.101916i 0.097924-4.101916i</span></span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb248-6"><a href="#cb248-6" aria-hidden="true"></a><span class="co">#&gt; $vectors</span></span>
<span id="cb248-7"><a href="#cb248-7" aria-hidden="true"></a><span class="co">#&gt;                     [,1]                 [,2]</span></span>
<span id="cb248-8"><a href="#cb248-8" aria-hidden="true"></a><span class="co">#&gt; [1,] 0.8483705+0.000000i  0.8519823+0.000000i</span></span>
<span id="cb248-9"><a href="#cb248-9" aria-hidden="true"></a><span class="co">#&gt; [2,] 0.4695014+0.244614i -0.5216168-0.045189i</span></span></code></pre></div>
<p>Y para resolver el sistema de ecuaciones
<span class="math display">\[
\left.
\begin{array}{rl} 
(3-2i)x+(5+3i)y &amp; = 2-i\\
(1+2i)x+(2-i)y &amp; = 3 
\end{array}
\right\}
\]</span>
podemos entrar:</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true"></a>A=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">3</span><span class="op">-</span>2i,<span class="dv">5</span><span class="op">+</span>3i,<span class="dv">1</span><span class="op">+</span>2i,<span class="dv">2</span><span class="op">-</span>1i), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true"></a>b=<span class="kw">c</span>(<span class="dv">2</span><span class="op">-</span>1i,<span class="dv">3</span>)</span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true"></a><span class="kw">solve</span>(A, b)</span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true"></a><span class="co">#&gt; [1] 0.4705882-0.7176471i 0.4823529+0.1294118i</span></span></code></pre></div>
<p>La excepción más importante son los determinantes.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true"></a><span class="kw">det</span>(A)</span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true"></a><span class="co">#&gt; Error in determinant.matrix(x, logarithm, ...): &#39;determinant&#39; not currently defined for complex matrices</span></span></code></pre></div>
<p>Pero resulta que el determinante de una matriz es igual al producto de sus valores propios, incluyendo repeticiones. Por lo tanto, para calcular el determinante de una matriz compleja <span class="math inline">\(A\)</span> podemos usar <code>prod(eigen(A)$values)</code>.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true"></a>A=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">3</span><span class="op">-</span>2i, <span class="dv">5</span><span class="op">+</span>3i, <span class="dv">1</span><span class="op">+</span>2i, <span class="dv">2</span><span class="op">-</span>1i), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true"></a><span class="kw">prod</span>(<span class="kw">eigen</span>(A)<span class="op">$</span>values)</span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true"></a><span class="co">#&gt; [1] 5-20i</span></span></code></pre></div>
</div>
<div id="guía-rápida-de-funciones-1" class="section level2" number="5.7">
<h2 number="5.7"><span class="header-section-number">5.7</span> Guía rápida de funciones</h2>
<ul>
<li><code>matrix</code> sirve para construir una matriz a partir de un vector. Algunos parámetros importantes:
<ul>
<li><code>byrow</code>: un parámetro lógico para indicar si la matriz se construye por filas (igualado a <code>TRUE</code>) o por columnas (valor por defecto).</li>
<li><code>nrow</code>: el número de filas.</li>
<li><code>ncol</code>: el número de columnas.</li>
</ul></li>
<li><code>cbind</code> concatena vectores y matrices por columnas.</li>
<li><code>rbind</code> concatena vectores y matrices por filas.</li>
<li><code>dimnames</code> permite poner nombres a las filas y las columnas de una matriz.</li>
<li><code>matriz[..., ...]</code> se usa para especificar un elemento, una fila, una columna o una submatriz de la <code>matriz</code>. Si extraemos una fila o una columna con el parámetro <code>drop=FALSE</code>, el resultado es una matriz y no un vector.</li>
<li><code>diag</code> tiene dos usos:
<ul>
<li>aplicada a un vector, construye una matriz diagonal</li>
<li>aplicada a una matriz, extrae su diagonal principal.</li>
</ul></li>
<li><code>nrow</code> da el número de filas de una matriz.</li>
<li><code>ncol</code> da el número de columnas de una matriz.</li>
<li><code>dim</code> da un vector con las dimensiones de una matriz.</li>
<li><code>sum</code> calcula la suma de las entradas de una matriz.</li>
<li><code>prod</code> calcula el producto de las entradas de una matriz.</li>
<li><code>mean</code> calcula la media aritmética de las entradas de una matriz.</li>
<li><code>colSums</code> y <code>rowSums</code> calculan, respectivamente, las sumas de las entradas de cada una de las columnas y de cada una de las filas de una matriz.</li>
<li><code>colMeans</code> y <code>rowMeans</code> calculan, respectivamente, las medias de cada una de las columnas y de cada una de las filas de una matriz.</li>
<li><code>apply(matriz, MARGIN=..., FUN=función)</code> aplica la <code>función</code> a las filas (<code>MARGIN=1</code>), a las columnas (<code>MARGIN=2</code>) o a todas las entradas (<code>MARGIN=c(1, 2)</code>) de la <code>matriz</code>.</li>
<li>Signos de operaciones del álgebra matricial:
<ul>
<li><code>+</code>: Suma</li>
<li><code>*</code>: Producto por escalar</li>
<li><code>%*%</code>: Producto de matrices</li>
<li><code>%^%</code> del paquete <strong>expm</strong>: Potencia</li>
<li><code>t</code>: Traspuesta</li>
</ul></li>
<li><code>matrix.power(X, k)</code> del paquete <strong>matrixcalc</strong> calcula la potencia <span class="math inline">\(k\)</span>-ésima de la matriz <span class="math inline">\(X\)</span>.</li>
<li><code>det</code> calcula el determinante de una matriz.</li>
<li><code>matrix.rank</code> del paquete <strong>matrixcalc</strong>, calcula el rango de una matriz cuadrada.</li>
<li><code>rankMatrix</code> del paquete <strong>Matrix</strong>, calcula el rango de una matriz arbitraria.</li>
<li><code>solve</code>, aplicada a una matriz invertible <span class="math inline">\(A\)</span>, calcula su inversa <span class="math inline">\(A^{-1}\)</span>, y aplicada a una matriz invertible <span class="math inline">\(A\)</span> y un vector <span class="math inline">\(b\)</span>, calcula <span class="math inline">\(A^{-1}\cdot b\)</span>.</li>
<li><code>eigen</code> calcula los valores y vectores propios de una matriz. El resultado es una <code>list</code> con dos componentes:
<ul>
<li><code>values</code>: un vector con los valores propios.</li>
<li><code>vectors</code>: una matriz cuyas columnas son vectores propios de los correspondientes valores propios.</li>
</ul></li>
</ul>
</div>
<div id="ejercicios-3" class="section level2" number="5.8">
<h2 number="5.8"><span class="header-section-number">5.8</span> Ejercicios</h2>
<div id="test-2" class="section level3 unnumbered">
<h3 class="unnumbered">Test</h3>
<p><em>(1)</em> Dad una instrucción, empleando la función <code>matrix</code> con el parámetro <code>nrow</code>, que construya por filas la matriz
<span class="math inline">\(\left(\begin{array}{ccc} 1 &amp; 5 &amp; 3\\ 2 &amp; 3 &amp; 9\end{array} \right)\)</span>.</p>
<p><em>(2)</em> Dad una instrucción que use la función <code>rbind</code> para construir la matriz
<span class="math inline">\(\left(\begin{array}{ccc} 1 &amp; 5 &amp; 3\\ 2 &amp; 3 &amp; 9\end{array} \right)\)</span>.</p>
<p><em>(3)</em> Dad la instrucción que indica la entrada (2,3) de una matriz llamada M.</p>
<p><em>(4)</em> Dad la instrucción que da una matriz de una sola columna formada por la octava columna de una matriz llamada M.</p>
<p><em>(5)</em> Emplead la función <code>diag</code> para construir la matriz diagonal con diagonal principal <span class="math inline">\((1,-1,3,4)\)</span>.</p>
<p><em>(6)</em> Dad el valor del determinante de la matriz <span class="math display">\[\left(\begin{array}{cccc}
1 &amp; 2 &amp; 3 &amp; 4\\ 5 &amp; 6 &amp; 7 &amp; 8 \\ 9 &amp; 8 &amp; 7 &amp; 6\\ 5 &amp; 4 &amp; 3 &amp; 2\end{array} \right).\]</span></p>
<p><em>(7)</em> Dad la entrada (2,2) de <span class="math inline">\(A\cdot (A+ A^t)\cdot A\)</span>, donde <span class="math inline">\(A=\left(\begin{array}{cc} 1 &amp; 3 \\ 2 &amp; 4 \end{array} \right)\)</span>. Si no existe, tenéis que responder NO.</p>
<p><em>(8)</em> Dad la entrada (2,3) de la matriz <span class="math display">\[\left(\begin{array}{ccc} 1 &amp; 5 &amp; 3\\ 2 &amp; 3 &amp; 9\\ 4 &amp; 1 &amp; 1\end{array} \right)^{-1}\]</span> como un número real redondeado a 4 cifras decimales. Si no existe, tenéis que responder NO.</p>
<p><em>(9)</em> Dad el valor de <span class="math inline">\(y\)</span>, redondeado a 4 cifras decimales, en la solución del sistema
<span class="math display">\[
\left.\begin{array}{ll} x+5y+3z &amp; = 1\\ 2x+3y+9z &amp; =1\\ 4x+y+z &amp; = 1\end{array}
\right\}
\]</span>
Si no existe o no es único, tenéis que contestar NO.</p>
<p><em>(10)</em> Dad los valores propios, separados por un espacio en blanco, en orden decreciente de su valor absoluto y repetidos tantas veces como su multiplicidad, de la matriz
<span class="math display">\[\left(\begin{array}{ccc}
2 &amp; 4 &amp; -6 \\ 0 &amp; 0 &amp; 3 \\ 0 &amp; -2 &amp; 5
\end{array} \right).\]</span></p>
<p><em>(11)</em> Dad, redondeado a 3 cifras decimales, el vector propio de valor propio 4 de la matriz
<span class="math display">\[\left(\begin{array}{ccc}
-48 &amp; 35 &amp; -12\cr -134 &amp; 95 &amp; -32\cr -194 &amp; 133 &amp;-44
\end{array}
\right)\]</span> que da R. Dad sus entradas separadas por exactamente un espacio en blanco. Si no existe, responded NO.</p>
<p><em>(12)</em> Dad el rango de la matriz <span class="math display">\[\left(\begin{array}{cccc}
-2 &amp; -8 &amp; -2 &amp; 3\\ -3 &amp; -6 &amp; -1 &amp; 2\\ -9 &amp;-22 &amp; -3 &amp; 7\\ -18 &amp; -44 &amp; -8 &amp; 15
\end{array}
\right).\]</span></p>
</div>
<div id="ejercicio-3" class="section level3 unnumbered">
<h3 class="unnumbered">Ejercicio</h3>
<p>Sean <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span> dos cantidades de las cuales efectuamos una serie de <span class="math inline">\(k\)</span>
observaciones conjuntas, de forma que obtenemos una secuencia de pares de valores
<span class="math display">\[
(x_{1}, y_{1}), (x_{2}, y_{2}), \ldots, (x_{k}, y_{k}).
\]</span>
Como veíamos en la Lección @ref(chap:lm), si queremos encontrar la recta <span class="math inline">\(y=ax+b\)</span> que aproxime mejor estas observaciones, una posibilidad es calcular los valores <span class="math inline">\(a, b\in \mathbb{R}\)</span> tales que
<span class="math display">\[
\sum_{i=1}^k (ax_{i}+b-y_{i})^2
\]</span>
sea mínimo. De este modo encontraríamos la <strong>recta de regresión por mínimos cuadrados</strong>. Resulta (no lo demostraremos aquí) que los coeficientes <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span> de esta recta de regresión se obtienen por medio de la fórmula
<span class="math display">\[
\left(\begin{matrix} b\\ a \end{matrix}
\right)=
(D_{2}\cdot D_{2}^t)^{-1}\cdot D_{2}\cdot w, 
\]</span>
donde
<span class="math display">\[
w=\left(\begin{matrix}y_{1}\\ \vdots\\ y_{k}\end{matrix}
\right), \quad
D_{2}=\left(\begin{matrix}
1 &amp; 1 &amp; \ldots &amp; 1 \\
x_{1} &amp; x_{2} &amp; \ldots &amp; x_{k}
\end{matrix}
\right).
\]</span></p>
<ol style="list-style-type: lower-alpha">
<li>Calculad de este modo los valores de <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span> cuando las observaciones son las de la Tabla @ref(tab:Ex501) (es la Tabla @ref(tab:nin1) de la Lección @ref(chap:lm)), y comprobad que obtenéis el mismo resultado que obteníamos en su momento con la función <code>lm</code>.</li>
</ol>
<table>
<caption>(#tab:Ex501)Alturas medias de niños por edad.</caption>
<thead>
<tr class="header">
<th align="right">edad (años)</th>
<th align="right">altura (cm)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">76.11</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">86.45</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">95.27</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">109.18</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">122.03</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">133.73</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">143.73</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">156.41</td>
</tr>
</tbody>
</table>
<!--
\begin{table}[htb]
\abovecaptionskip=-3pt
\begin{center}
\begin{tabular}{ccccccccc}
\toprule
$x$: (edad, en años) & 1 & 2 & 3 & 5 & 7 & 9 & 11 & 13\\
\midrule
$y$: (altura, en cm) & 76.11 & 86.45 & 95.27 & 109.18 & 122.03 & 133.73 & 143.73 & 156.41\\
\bottomrule
\end{tabular}
\end{center}
\caption{Alturas medias de niños por edad.\label{tab:Ex5.1}} 
\end{table}
-->
<p>De manera similar, si queremos obtener una función cuadrática <span class="math inline">\(y=a x^2+b x+c\)</span> que aproxime los pares <span class="math inline">\((x_i, y_i)_{y=1, \ldots, k}\)</span>, podemos buscar los coeficientes <span class="math inline">\(a, b, c\)</span> que minimicen el valor de
<span class="math display">\[
\sum_{i=1}^k (ax_{i}^2+bx_{i}+c-y_{i})^2.
\]</span>
Estos coeficientes se obtienen de manera similar, por medio de la fórmula
<span class="math display">\[
\left(\begin{matrix}
c\\ b\\ a \end{matrix}
\right)=
(D_{3}\cdot D_{3}^t)^{-1}\cdot D_{3}\cdot w, 
\]</span>
donde <span class="math inline">\(w\)</span> es como antes y ahora
<span class="math display">\[
D_{3}=\left(\begin{matrix}
1 &amp; 1 &amp; \ldots &amp; 1 \\
x_{1} &amp; x_{2} &amp; \ldots &amp; x_{k}\\[0.5ex]
x_{1}^2 &amp; x_{2}^2 &amp; \ldots &amp; x_{k}^2
\end{matrix}
\right).
\]</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li><p>Calculad los valores de <span class="math inline">\(a, b, c\)</span> para los pares <span class="math inline">\((x,y)\)</span> de la Tabla @ref(tab:Ex501).</p></li>
<li><p>Con R, podemos calcular estos coeficientes de la manera siguiente: si definimos un nuevo vector <span class="math inline">\(z\)</span> con los cuadrados de los valores de <span class="math inline">\(x\)</span>, y aplicamos la función</p></li>
</ol>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true"></a><span class="kw">lm</span>(y<span class="op">~</span>x<span class="op">+</span>z)</span></code></pre></div>
<p>obtenemos los coeficientes de la función lineal <span class="math inline">\(y=c+bx+az\)</span> que mejor se ajusta a las ternas <span class="math inline">\((x_i,z_i,y_i)\)</span>, en el sentido de que minimiza la suma de las diferencias al cuadrado entre los valores <span class="math inline">\(y_i\)</span> y los correspondientes <span class="math inline">\(c+bx_i+az_i\)</span>; substituyendo entonces <span class="math inline">\(z\)</span> por <span class="math inline">\(x^2\)</span> en esta relación, obtenemos la función <span class="math inline">\(y=c+bx+ax^2\)</span> que buscábamos. Comprobad que, efectivamente, coincide con la calculada en el apartado anterior.</p>
</div>
<div id="respuestas-al-test-2" class="section level3 unnumbered">
<h3 class="unnumbered">Respuestas al test</h3>
<p><em>(1)</em> <code>matrix(c(1,5,3,2,3,9),nrow=2,byrow=TRUE)</code></p>
<p><em>(2)</em> <code>rbind(c(1,5,3),c(2,3,9))</code></p>
<p><em>(3)</em> <code>M[2,3]</code></p>
<p><em>(4)</em> <code>M[,8,drop=FALSE]</code></p>
<p><em>(5)</em> <code>diag(c(1,-1,3,4))</code></p>
<p><em>(6)</em> 0</p>
<p><em>(7)</em> 240
<!--
(Nosaltres ho hem calculat definint $A$ i llavors fent `(A%*%(A+t(A))%*%A)[2,2]`.)
--></p>
<p><em>(8)</em> -0.0224
<!--
(Nosaltres ho hem calculat amb `A=matrix(c(1,5,3,2,3,9,4,1,1),nrow=3,?\\ `byrow=TRUE); round(solve(A)[2,3],4)`.)
--></p>
<p><em>(9)</em> 0.1493
<!--
(Nosaltres ho hem calculat amb `A=matrix(c(1,5,3,2,3,9,4,1,1),nrow=3,byrow=TRUE); b=c(1,1,1); round(solve(A,b),4)[2]`.)
--></p>
<p><em>(10)</em> 3 2 2
<!--
(Nosaltres ho hem calculat amb `A=matrix(c(2,4,-6,0,0,3,0,-2,5),nrow=3,byrow=TRUE); eigen(A)$values`.)
--></p>
<p><em>(11)</em> 0.371 0.743 0.557
<!--
(Nosaltres ho hem calculat definint aquesta matriu com a $A$, i aleshores fent primer `eigen(A)$values` per mirar a quina posició li correspon el valor propi 4 i després  `round(eigen(A)$vectors,3)` per calcular els vectors propis arrodonits.)
--></p>
<p><em>(12)</em> 3
<!--
(Nosaltres ho hem calculat amb `A=matrix(c(-2,-8,-2,3,-3,-6,-1,2,-9,-22,-3,7,-18,-44,-8,15),nrow=4,byrow=TRUE); qr(A)$rank`.)
--></p>
<!--chapter:end:05chap04_Matrices.Rmd-->
</div>
</div>
</div>
<div id="chap:df" class="section level1" number="6">
<h1 number="6"><span class="header-section-number">6</span> <em>Data frames</em></h1>
<p>Habitualmente, dispondremos de una serie de datos que describirán algunos
aspectos de un conjunto de individuos, y querremos analizarlos. El análisis estadístico de estos datos puede ser de dos tipos básicos:</p>
<ul>
<li><p><strong>Análisis exploratorio</strong>, o <strong>descriptivo</strong>, cuando nuestro objetivo sea resumir, representar y explicar los datos concretos de los que disponemos. La <strong>estadística descriptiva</strong> es el conjunto de técnicas que se usan con este fin.</p></li>
<li><p><strong>Análisis inferencial</strong>, si nuestro objetivo es deducir (<strong>inferir</strong>), a partir de estos datos,
información significativa sobre el total de la población o las poblaciones de interés. Las técnicas que se usan en este caso forman la <strong>estadística inferencial</strong>.</p></li>
</ul>
<p>En las próximas lecciones explicaremos algunas técnicas básicas de estadística descriptiva orientadas al análisis de datos. Estas técnicas consistirán en una serie de medidas, gráficos y modelos descriptivos que nos permitirán resumir y explorar un conjunto de datos, con el objetivo final de entenderlos lo mejor posible. De todas formas, ambos tipos de análisis estadístico están relacionados. Así, por un lado, cualquier análisis inferencial se suele empezar explorando los datos que se usarán, y por otro, muchas técnicas descriptivas permiten estimar propiedades de la población de la que se ha extraído la muestra. Por citar un ejemplo, la media aritmética de las alturas de una muestra de individuos nos da un valor supuestamente representativo de esta muestra, pero también <em>estima</em> la media de las alturas del total de la población, si la muestra es aleatoria.</p>
<p>Los datos de los que disponemos suelen ser multidimensionales, en el sentido de que
observamos varias características de una serie de individuos. Estos datos
se tienen que registrar de alguna manera. Normalmente, los
guardaremos en un archivo de ordenador con un formato preestablecido.
Los formatos de almacenamiento de datos en un ordenador son diversos: texto
simple (codificado en diferentes formatos: ASCII, isolatin, utf8…), hojas
de cálculo (archivos de <em>Open Office</em> o <em>Excel</em>), bases de datos, etc.
Una de las maneras básicas de almacenar datos es en forma de <strong>tablas
de datos</strong>, pequeñas bases de datos donde se han anotado los valores de algunas variables para una serie de observaciones.</p>
<p>Como ya comentamos en la Lección @ref(chap:lm), la manera más conveniente de guardar en R una tabla de datos es en forma de <em>data frame</em>. En concreto, un <em>data frame</em> es una tabla de doble entrada, formada por variables en las columnas y observaciones de estas variables en las filas, de manera que cada fila contiene los valores de las variables para un mismo caso o individuo. En este sentido, un <em>data frame</em> tiene la apariencia de una matriz, pero con la diferencia de que cada columna de un <em>data frame</em> puede contener datos de un tipo diferente, siempre que todos los datos de una misma columna sean del mismo tipo, porque corresponden a observaciones
de una misma propiedad: así, una columna puede estar formada por números, por ejemplo, alguna medida; otra, por palabras, por ejemplo, la especie del individuo; otra, por valores lógicos, por ejemplo, que describan si una cierta propiedad está presente o ausente en el individuo; etc. De esta manera, las columnas de un <em>data frame</em> son vectores o factores, mientras que las filas son listas heterogéneas.</p>
<p>Los tipos de datos que consideramos en este curso son los siguientes:</p>
<ul>
<li><p>Datos de tipo <strong>atributo</strong>, o <strong>cualitativos</strong>. Son los que expresan una cualidad del individuo, tales como el sexo, el nombre, la especie… . En R, guardaremos las listas de datos cualitativos en vectores (habitualmente, de palabras), o en factores si vamos a usarlos para clasificar individuos.</p></li>
<li><p>Datos <strong>ordinales</strong>. Son datos similares a los cualitativos, con la única diferencia de que se pueden ordenar de manera natural. Por ejemplo, los niveles de calidad ambiental de un ecosistema (malo, regular, normal, bueno, muy bueno) o las calificaciones en un examen (suspenso, aprobado, notable, sobresaliente) son datos ordinales. En cambio, no se pueden ordenar de manera significativa los sexos o las especies de los individuos. En R, guardaremos las listas de datos ordinales en factores ordenados.</p></li>
<li><p>Datos <strong>cuantitativos</strong>. Son datos que se refieren a medidas, tales como edades, longitudes, pesos, tiempos, números de individuos, etc. En R, guardaremos las listas de datos cuantitativos en vectores de números.</p></li>
</ul>
<p>El análisis, tanto descriptivo como inferencial, de un conjunto de datos es
diferente según su tipo. Así, para datos cualitativos sólo tiene interés estudiar y representar las frecuencias con que aparecen sus diferentes valores, mientras que el análisis de datos cuantitativos suele involucrar el cálculo de medidas estadísticas que evalúen numéricamente sus propiedades.</p>
<div id="estructura-de-un-data-frame" class="section level2" number="6.1">
<h2 number="6.1"><span class="header-section-number">6.1</span> Estructura de un <em>data frame</em></h2>
<p>La instalación básica de R lleva predefinidos algunos objetos de datos.
Podemos echarles un vistazo entrando la instrucción <code>data()</code>, que mostrará en la ventana de ficheros la lista de los objetos de datos a los que tenemos acceso en la sesión actual de R (los que lleva la instalación básica de R y los que aporten los paquetes que tengamos cargados). Estos objetos no aparecen cuando hacemos <code>ls()</code> ni se borran con <code>rm(list=ls())</code>, y podemos pedir información sobre cada uno de ellos en la ventana de Ayuda. Al final de la lista que obtenemos con <code>data()</code> se nos indica que si entramos</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true"></a><span class="kw">data</span>(<span class="dt">package=</span><span class="kw">.packages</span>(<span class="dt">all.available=</span><span class="ot">TRUE</span>))</span></code></pre></div>
<p>obtendremos la lista de <em>todos</em> los objetos de datos a los que tenemos acceso, incluyendo los de los paquetes instalados pero no cargados en la sesión actual.</p>
<p>Una de las tablas de datos más populares que lleva R es el llamado <em>iris data set</em>, que contiene la longitud y la anchura de los pétalos y sépalos y la especie de 150 flores iris. El famoso estadístico Sir R. A. Fisher usó este conjunto de datos en su artículo “The Use of Multiple Measurements in Taxonomic Problems” (publicado en <em>Annals of Eugenics</em> 7 (1936), pp. 179-188, y que podéis descargar de <a href="http://digital.library.adelaide.edu.au/coll/special//fisher/138.pdf">http://digital.library.adelaide.edu.au/coll/special//fisher/138.pdf</a>). En R, este conjunto de datos de flores iris está recogido en el <em>data frame</em> <code>iris</code>. Para más información sobre estos datos, podéis leer su <a href="http://en.wikipedia.org/wiki/Iris_flower_data_set">entrada en la <em>Wikipedia</em></a> y para más información específica sobre la tabla <code>iris</code> de R, podéis consultar la Ayuda de <code>iris</code>.</p>
<p>En esta sección vamos a trabajar con esta tabla de datos, así que lo primero que haremos será copiarla en un nuevo <em>data frame</em> que llamaremos <code>d.f</code>; de este modo trabajaremos sobre la copia <code>d.f</code> y tendremos acceso al <em>data frame</em> <code>iris</code> original si necesitamos volver a él. De todas formas, si trabajamos directamente sobre <code>iris</code> y lo echamos a perder, lo podemos recuperar ejecutando la instrucción <code>data(iris)</code>, que devolverá a este objeto su contenido original.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true"></a>d.f=iris</span></code></pre></div>
<p>Si pidiéramos ahora a R que nos mostrase el objeto <code>d.f</code> mediante</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true"></a>d.f</span></code></pre></div>
<p>obtendríamos el contenido del <em>data frame</em> en la consola: una larga lista de datos formada por las 150 filas de la tabla; naturalmente, no vamos a copiar aquí esta salida. Para echarle un vistazo al <em>data frame</em>, y así poder entender su estructura y conocer los nombres de sus variables, os recomendamos usar la instrucción</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true"></a><span class="kw">View</span>(d.f)</span></code></pre></div>
<p>que lo mostrará en la ventana superior izquierda de <em>RStudio</em>:
véase la Figura @ref(fig:View).</p>
<div class="figure" style="text-align: center">
<img src="AprendeR-Parte-I_files/figure-html/View.png" alt="Vista de un *data frame* con `View`." width="90%" />
<p class="caption">
(#fig:View)Vista de un <em>data frame</em> con <code>View</code>.
</p>
</div>
<!--

\begin{figure}[htb]
\abovecaptionskip=-1ex
\begin{center}
\includegraphics[width=0.7\linewidth]{View}
\end{center}
\caption{Vista de un *data frame* con `View`.}\label{fig:View}
\end{figure}
-->
<p>También podemos consultar en la consola las primeras filas del <em>data frame</em>, aplicando la función <code>head</code> al <em>data frame</em> y al número de filas que queremos que muestre; su valor por defecto es 6.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true"></a><span class="kw">head</span>(d.f, <span class="dv">5</span>)  <span class="co">#Las primeras 5 filas</span></span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true"></a><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true"></a><span class="co">#&gt; 1          5.1         3.5          1.4         0.2  setosa</span></span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true"></a><span class="co">#&gt; 2          4.9         3.0          1.4         0.2  setosa</span></span>
<span id="cb257-5"><a href="#cb257-5" aria-hidden="true"></a><span class="co">#&gt; 3          4.7         3.2          1.3         0.2  setosa</span></span>
<span id="cb257-6"><a href="#cb257-6" aria-hidden="true"></a><span class="co">#&gt; 4          4.6         3.1          1.5         0.2  setosa</span></span>
<span id="cb257-7"><a href="#cb257-7" aria-hidden="true"></a><span class="co">#&gt; 5          5.0         3.6          1.4         0.2  setosa</span></span></code></pre></div>
<p>La función <code>tail</code>, con una estructura similar a <code>head</code>, nos muestra la “cola” de la tabla.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true"></a><span class="kw">tail</span>(d.f, <span class="dv">5</span>)    <span class="co">#Las últimas 5 filas</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true"></a><span class="co">#&gt;     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species</span></span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true"></a><span class="co">#&gt; 146          6.7         3.0          5.2         2.3 virginica</span></span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true"></a><span class="co">#&gt; 147          6.3         2.5          5.0         1.9 virginica</span></span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true"></a><span class="co">#&gt; 148          6.5         3.0          5.2         2.0 virginica</span></span>
<span id="cb258-6"><a href="#cb258-6" aria-hidden="true"></a><span class="co">#&gt; 149          6.2         3.4          5.4         2.3 virginica</span></span>
<span id="cb258-7"><a href="#cb258-7" aria-hidden="true"></a><span class="co">#&gt; 150          5.9         3.0          5.1         1.8 virginica</span></span></code></pre></div>
<p>Observad que las columnas del <em>data frame</em> tienen <strong>nombres</strong> (R los llama <code>names</code>) y las filas, que corresponden a individuos, tienen como <strong>identificador</strong> (R llama a estos identificadores <code>rownames</code>) un número natural correlativo que va del 1 al 150. Podemos comprobar también que, en cada fila, la columna <code>Species</code> contiene una palabra que describe la especie de la flor, mientras que las otras cuatro columnas contienen números que corresponden a medidas.
Como veremos, la columna <code>Species</code> no es un vector propiamente dicho, sino un factor (con niveles las tres especies de iris: <em>setosa</em>, <em>versicolor</em> y <em>virginica</em>), lo que nos facilita el uso de esta variable para clasificar las flores.</p>
<p>Si queremos conocer la estructura global de un <em>data frame</em>, le podemos aplicar la función <code>str</code>.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true"></a><span class="kw">str</span>(d.f)</span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    150 obs. of  5 variables:</span></span>
<span id="cb259-3"><a href="#cb259-3" aria-hidden="true"></a><span class="co">#&gt;  $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...</span></span>
<span id="cb259-4"><a href="#cb259-4" aria-hidden="true"></a><span class="co">#&gt;  $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...</span></span>
<span id="cb259-5"><a href="#cb259-5" aria-hidden="true"></a><span class="co">#&gt;  $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...</span></span>
<span id="cb259-6"><a href="#cb259-6" aria-hidden="true"></a><span class="co">#&gt;  $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...</span></span>
<span id="cb259-7"><a href="#cb259-7" aria-hidden="true"></a><span class="co">#&gt;  $ Species     : Factor w/ 3 levels &quot;setosa&quot;,&quot;versicolor&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</span></span></code></pre></div>
<p>El resultado de esta instrucción nos muestra la estructura del objeto <code>d.f</code>. Nos dice que es un <em>data frame</em> formado por 150 observaciones (filas) de 5 variables (columnas), y de cada variable nos da su nombre (precedido de un signo <code>$</code>) y su tipo de datos: las cuatro primeras son variables cuantitativas, formadas por vectores numéricos (<code>num</code>), y la quinta es una variable cualitativa, un factor con (<code>w/</code>, de <em>with</em>) 3 niveles que corresponden a las especies. Además, nos muestra los primeros valores de cada variable: en el caso del factor, los unos significan <em>setosa</em>, su primer nivel por orden alfabético.</p>
<p>Las funciones siguientes nos permiten obtener los nombres de las variables, los identificadores de las filas y las dimensiones de un <em>data frame</em>:</p>
<ul>
<li><code>names</code>: Produce un vector con los nombres de las columnas.</li>
<li><code>rownames</code>: Produce un vector con los identificadores de las filas.</li>
<li><code>dimnames</code>: Produce una <code>list</code> formada por dos vectores: el de los identificadores de las filas y el de los nombres de las columnas.</li>
<li><code>dim</code>: Produce un vector con el número de filas y el número de columnas.</li>
</ul>
<p>Veamos sus valores sobre nuestro <em>data frame</em>:</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true"></a><span class="kw">names</span>(d.f)</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;Sepal.Length&quot; &quot;Sepal.Width&quot;  &quot;Petal.Length&quot; &quot;Petal.Width&quot;  &quot;Species&quot;</span></span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true"></a><span class="kw">rownames</span>(d.f)</span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true"></a><span class="co">#&gt;   [1] &quot;1&quot;   &quot;2&quot;   &quot;3&quot;   &quot;4&quot;   &quot;5&quot;   &quot;6&quot;   &quot;7&quot;   &quot;8&quot;   &quot;9&quot;   &quot;10&quot;  &quot;11&quot;  &quot;12&quot; </span></span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true"></a><span class="co">#&gt;  [13] &quot;13&quot;  &quot;14&quot;  &quot;15&quot;  &quot;16&quot;  &quot;17&quot;  &quot;18&quot;  &quot;19&quot;  &quot;20&quot;  &quot;21&quot;  &quot;22&quot;  &quot;23&quot;  &quot;24&quot; </span></span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true"></a><span class="co">#&gt;  [25] &quot;25&quot;  &quot;26&quot;  &quot;27&quot;  &quot;28&quot;  &quot;29&quot;  &quot;30&quot;  &quot;31&quot;  &quot;32&quot;  &quot;33&quot;  &quot;34&quot;  &quot;35&quot;  &quot;36&quot; </span></span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true"></a><span class="co">#&gt;  [37] &quot;37&quot;  &quot;38&quot;  &quot;39&quot;  &quot;40&quot;  &quot;41&quot;  &quot;42&quot;  &quot;43&quot;  &quot;44&quot;  &quot;45&quot;  &quot;46&quot;  &quot;47&quot;  &quot;48&quot; </span></span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true"></a><span class="co">#&gt;  [49] &quot;49&quot;  &quot;50&quot;  &quot;51&quot;  &quot;52&quot;  &quot;53&quot;  &quot;54&quot;  &quot;55&quot;  &quot;56&quot;  &quot;57&quot;  &quot;58&quot;  &quot;59&quot;  &quot;60&quot; </span></span>
<span id="cb260-9"><a href="#cb260-9" aria-hidden="true"></a><span class="co">#&gt;  [61] &quot;61&quot;  &quot;62&quot;  &quot;63&quot;  &quot;64&quot;  &quot;65&quot;  &quot;66&quot;  &quot;67&quot;  &quot;68&quot;  &quot;69&quot;  &quot;70&quot;  &quot;71&quot;  &quot;72&quot; </span></span>
<span id="cb260-10"><a href="#cb260-10" aria-hidden="true"></a><span class="co">#&gt;  [73] &quot;73&quot;  &quot;74&quot;  &quot;75&quot;  &quot;76&quot;  &quot;77&quot;  &quot;78&quot;  &quot;79&quot;  &quot;80&quot;  &quot;81&quot;  &quot;82&quot;  &quot;83&quot;  &quot;84&quot; </span></span>
<span id="cb260-11"><a href="#cb260-11" aria-hidden="true"></a><span class="co">#&gt;  [85] &quot;85&quot;  &quot;86&quot;  &quot;87&quot;  &quot;88&quot;  &quot;89&quot;  &quot;90&quot;  &quot;91&quot;  &quot;92&quot;  &quot;93&quot;  &quot;94&quot;  &quot;95&quot;  &quot;96&quot; </span></span>
<span id="cb260-12"><a href="#cb260-12" aria-hidden="true"></a><span class="co">#&gt;  [97] &quot;97&quot;  &quot;98&quot;  &quot;99&quot;  &quot;100&quot; &quot;101&quot; &quot;102&quot; &quot;103&quot; &quot;104&quot; &quot;105&quot; &quot;106&quot; &quot;107&quot; &quot;108&quot;</span></span>
<span id="cb260-13"><a href="#cb260-13" aria-hidden="true"></a><span class="co">#&gt; [109] &quot;109&quot; &quot;110&quot; &quot;111&quot; &quot;112&quot; &quot;113&quot; &quot;114&quot; &quot;115&quot; &quot;116&quot; &quot;117&quot; &quot;118&quot; &quot;119&quot; &quot;120&quot;</span></span>
<span id="cb260-14"><a href="#cb260-14" aria-hidden="true"></a><span class="co">#&gt; [121] &quot;121&quot; &quot;122&quot; &quot;123&quot; &quot;124&quot; &quot;125&quot; &quot;126&quot; &quot;127&quot; &quot;128&quot; &quot;129&quot; &quot;130&quot; &quot;131&quot; &quot;132&quot;</span></span>
<span id="cb260-15"><a href="#cb260-15" aria-hidden="true"></a><span class="co">#&gt; [133] &quot;133&quot; &quot;134&quot; &quot;135&quot; &quot;136&quot; &quot;137&quot; &quot;138&quot; &quot;139&quot; &quot;140&quot; &quot;141&quot; &quot;142&quot; &quot;143&quot; &quot;144&quot;</span></span>
<span id="cb260-16"><a href="#cb260-16" aria-hidden="true"></a><span class="co">#&gt; [145] &quot;145&quot; &quot;146&quot; &quot;147&quot; &quot;148&quot; &quot;149&quot; &quot;150&quot;</span></span>
<span id="cb260-17"><a href="#cb260-17" aria-hidden="true"></a><span class="kw">dimnames</span>(d.f)</span>
<span id="cb260-18"><a href="#cb260-18" aria-hidden="true"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb260-19"><a href="#cb260-19" aria-hidden="true"></a><span class="co">#&gt;   [1] &quot;1&quot;   &quot;2&quot;   &quot;3&quot;   &quot;4&quot;   &quot;5&quot;   &quot;6&quot;   &quot;7&quot;   &quot;8&quot;   &quot;9&quot;   &quot;10&quot;  &quot;11&quot;  &quot;12&quot; </span></span>
<span id="cb260-20"><a href="#cb260-20" aria-hidden="true"></a><span class="co">#&gt;  [13] &quot;13&quot;  &quot;14&quot;  &quot;15&quot;  &quot;16&quot;  &quot;17&quot;  &quot;18&quot;  &quot;19&quot;  &quot;20&quot;  &quot;21&quot;  &quot;22&quot;  &quot;23&quot;  &quot;24&quot; </span></span>
<span id="cb260-21"><a href="#cb260-21" aria-hidden="true"></a><span class="co">#&gt;  [25] &quot;25&quot;  &quot;26&quot;  &quot;27&quot;  &quot;28&quot;  &quot;29&quot;  &quot;30&quot;  &quot;31&quot;  &quot;32&quot;  &quot;33&quot;  &quot;34&quot;  &quot;35&quot;  &quot;36&quot; </span></span>
<span id="cb260-22"><a href="#cb260-22" aria-hidden="true"></a><span class="co">#&gt;  [37] &quot;37&quot;  &quot;38&quot;  &quot;39&quot;  &quot;40&quot;  &quot;41&quot;  &quot;42&quot;  &quot;43&quot;  &quot;44&quot;  &quot;45&quot;  &quot;46&quot;  &quot;47&quot;  &quot;48&quot; </span></span>
<span id="cb260-23"><a href="#cb260-23" aria-hidden="true"></a><span class="co">#&gt;  [49] &quot;49&quot;  &quot;50&quot;  &quot;51&quot;  &quot;52&quot;  &quot;53&quot;  &quot;54&quot;  &quot;55&quot;  &quot;56&quot;  &quot;57&quot;  &quot;58&quot;  &quot;59&quot;  &quot;60&quot; </span></span>
<span id="cb260-24"><a href="#cb260-24" aria-hidden="true"></a><span class="co">#&gt;  [61] &quot;61&quot;  &quot;62&quot;  &quot;63&quot;  &quot;64&quot;  &quot;65&quot;  &quot;66&quot;  &quot;67&quot;  &quot;68&quot;  &quot;69&quot;  &quot;70&quot;  &quot;71&quot;  &quot;72&quot; </span></span>
<span id="cb260-25"><a href="#cb260-25" aria-hidden="true"></a><span class="co">#&gt;  [73] &quot;73&quot;  &quot;74&quot;  &quot;75&quot;  &quot;76&quot;  &quot;77&quot;  &quot;78&quot;  &quot;79&quot;  &quot;80&quot;  &quot;81&quot;  &quot;82&quot;  &quot;83&quot;  &quot;84&quot; </span></span>
<span id="cb260-26"><a href="#cb260-26" aria-hidden="true"></a><span class="co">#&gt;  [85] &quot;85&quot;  &quot;86&quot;  &quot;87&quot;  &quot;88&quot;  &quot;89&quot;  &quot;90&quot;  &quot;91&quot;  &quot;92&quot;  &quot;93&quot;  &quot;94&quot;  &quot;95&quot;  &quot;96&quot; </span></span>
<span id="cb260-27"><a href="#cb260-27" aria-hidden="true"></a><span class="co">#&gt;  [97] &quot;97&quot;  &quot;98&quot;  &quot;99&quot;  &quot;100&quot; &quot;101&quot; &quot;102&quot; &quot;103&quot; &quot;104&quot; &quot;105&quot; &quot;106&quot; &quot;107&quot; &quot;108&quot;</span></span>
<span id="cb260-28"><a href="#cb260-28" aria-hidden="true"></a><span class="co">#&gt; [109] &quot;109&quot; &quot;110&quot; &quot;111&quot; &quot;112&quot; &quot;113&quot; &quot;114&quot; &quot;115&quot; &quot;116&quot; &quot;117&quot; &quot;118&quot; &quot;119&quot; &quot;120&quot;</span></span>
<span id="cb260-29"><a href="#cb260-29" aria-hidden="true"></a><span class="co">#&gt; [121] &quot;121&quot; &quot;122&quot; &quot;123&quot; &quot;124&quot; &quot;125&quot; &quot;126&quot; &quot;127&quot; &quot;128&quot; &quot;129&quot; &quot;130&quot; &quot;131&quot; &quot;132&quot;</span></span>
<span id="cb260-30"><a href="#cb260-30" aria-hidden="true"></a><span class="co">#&gt; [133] &quot;133&quot; &quot;134&quot; &quot;135&quot; &quot;136&quot; &quot;137&quot; &quot;138&quot; &quot;139&quot; &quot;140&quot; &quot;141&quot; &quot;142&quot; &quot;143&quot; &quot;144&quot;</span></span>
<span id="cb260-31"><a href="#cb260-31" aria-hidden="true"></a><span class="co">#&gt; [145] &quot;145&quot; &quot;146&quot; &quot;147&quot; &quot;148&quot; &quot;149&quot; &quot;150&quot;</span></span>
<span id="cb260-32"><a href="#cb260-32" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb260-33"><a href="#cb260-33" aria-hidden="true"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb260-34"><a href="#cb260-34" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;Sepal.Length&quot; &quot;Sepal.Width&quot;  &quot;Petal.Length&quot; &quot;Petal.Width&quot;  &quot;Species&quot;</span></span>
<span id="cb260-35"><a href="#cb260-35" aria-hidden="true"></a><span class="kw">dim</span>(d.f)</span>
<span id="cb260-36"><a href="#cb260-36" aria-hidden="true"></a><span class="co">#&gt; [1] 150   5</span></span></code></pre></div>
<p>Fijaos en que el resultado de <code>rownames</code> son los identificadores de las filas entre comillas, es decir, considerados como palabras; R entiende siempre que estos identificadores son palabras, aunque, como en este caso, sean números.</p>
<p>Recordaréis que se puede obtener el valor de una componente de una <code>list</code> añadiendo al nombre de esta última el sufijo formado por el signo <code>$</code> seguido del nombre de la componente. De manera similar, para obtener una columna concreta de un <em>data frame</em> basta añadir al nombre de este último el sufijo formado por el signo<code>$</code>seguido del nombre de la variable; el resultado será un vector o un factor, según cómo esté definida la columna dentro del <em>data frame</em>.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true"></a>d.f<span class="op">$</span>Sepal.Length[<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>]</span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true"></a><span class="co">#&gt;  [1] 5.1 4.9 4.7 4.6 5.0 5.4 4.6 5.0 4.4 4.9 5.4 4.8 4.8 4.3 5.8 5.7 5.4 5.1 5.7</span></span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true"></a><span class="co">#&gt; [20] 5.1 5.4 5.1 4.6 5.1 4.8 5.0 5.0 5.2 5.2 4.7</span></span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true"></a>d.f<span class="op">$</span>Species[<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>]</span>
<span id="cb261-5"><a href="#cb261-5" aria-hidden="true"></a><span class="co">#&gt;  [1] setosa setosa setosa setosa setosa setosa setosa setosa setosa setosa</span></span>
<span id="cb261-6"><a href="#cb261-6" aria-hidden="true"></a><span class="co">#&gt; [11] setosa setosa setosa setosa setosa setosa setosa setosa setosa setosa</span></span>
<span id="cb261-7"><a href="#cb261-7" aria-hidden="true"></a><span class="co">#&gt; [21] setosa setosa setosa setosa setosa setosa setosa setosa setosa setosa</span></span>
<span id="cb261-8"><a href="#cb261-8" aria-hidden="true"></a><span class="co">#&gt; Levels: setosa versicolor virginica</span></span></code></pre></div>
<p>Como también pasaba con las componentes de las <code>list</code>, las variables de un <em>data frame</em> son internas, no están definidas en el entorno global de trabajo de R.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true"></a>Sepal.Length </span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;Sepal.Length&#39; no encontrado</span></span></code></pre></div>
<p>En la Sección @ref(sub:attach) explicaremos cómo podemos declarar las variables internas de un <em>data frame</em> como variables globales, y así poder usarlas directamente por su nombre, sin tener que añadirles delante el nombre del <em>data frame</em> y el <code>$</code>.</p>
<p>Los <em>data frames</em> comparten con las matrices el uso de los corchetes para extraer trozos por filas y columnas. Los resultados que se obtienen son de nuevo <em>data frames</em>, y tanto los nombres de las columnas como los identificadores de las filas se heredan del <em>data frame</em> original. Podemos comprobarlo en los siguientes ejemplos.</p>
<ul>
<li>La subtabla formada por las 5 primeras filas de <code>d.f</code>:</li>
</ul>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true"></a>d.f[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, ]</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true"></a><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true"></a><span class="co">#&gt; 1          5.1         3.5          1.4         0.2  setosa</span></span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true"></a><span class="co">#&gt; 2          4.9         3.0          1.4         0.2  setosa</span></span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true"></a><span class="co">#&gt; 3          4.7         3.2          1.3         0.2  setosa</span></span>
<span id="cb263-6"><a href="#cb263-6" aria-hidden="true"></a><span class="co">#&gt; 4          4.6         3.1          1.5         0.2  setosa</span></span>
<span id="cb263-7"><a href="#cb263-7" aria-hidden="true"></a><span class="co">#&gt; 5          5.0         3.6          1.4         0.2  setosa</span></span></code></pre></div>
<ul>
<li>La subtabla formada por las 3 primeras columnas de las 5 primeras filas de <code>d.f</code>:</li>
</ul>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true"></a>d.f[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true"></a><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length</span></span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true"></a><span class="co">#&gt; 1          5.1         3.5          1.4</span></span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true"></a><span class="co">#&gt; 2          4.9         3.0          1.4</span></span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true"></a><span class="co">#&gt; 3          4.7         3.2          1.3</span></span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true"></a><span class="co">#&gt; 4          4.6         3.1          1.5</span></span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true"></a><span class="co">#&gt; 5          5.0         3.6          1.4</span></span></code></pre></div>
<ul>
<li>La subtabla formada por las filas correspondientes a las flores de especie <em>virginica</em> cuya longitud del sépalo es mayor que 7:</li>
</ul>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true"></a>d.f[d.f<span class="op">$</span>Species<span class="op">==</span><span class="st">&quot;virginica&quot;</span> <span class="op">&amp;</span><span class="st"> </span>d.f<span class="op">$</span>Sepal.Length<span class="op">&gt;</span><span class="dv">7</span>, ]  </span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true"></a><span class="co">#&gt;     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species</span></span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true"></a><span class="co">#&gt; 103          7.1         3.0          5.9         2.1 virginica</span></span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true"></a><span class="co">#&gt; 106          7.6         3.0          6.6         2.1 virginica</span></span>
<span id="cb265-5"><a href="#cb265-5" aria-hidden="true"></a><span class="co">#&gt; 108          7.3         2.9          6.3         1.8 virginica</span></span>
<span id="cb265-6"><a href="#cb265-6" aria-hidden="true"></a><span class="co">#&gt; 110          7.2         3.6          6.1         2.5 virginica</span></span>
<span id="cb265-7"><a href="#cb265-7" aria-hidden="true"></a><span class="co">#&gt; 118          7.7         3.8          6.7         2.2 virginica</span></span>
<span id="cb265-8"><a href="#cb265-8" aria-hidden="true"></a><span class="co">#&gt; 119          7.7         2.6          6.9         2.3 virginica</span></span>
<span id="cb265-9"><a href="#cb265-9" aria-hidden="true"></a><span class="co">#&gt; 123          7.7         2.8          6.7         2.0 virginica</span></span>
<span id="cb265-10"><a href="#cb265-10" aria-hidden="true"></a><span class="co">#&gt; 126          7.2         3.2          6.0         1.8 virginica</span></span>
<span id="cb265-11"><a href="#cb265-11" aria-hidden="true"></a><span class="co">#&gt; 130          7.2         3.0          5.8         1.6 virginica</span></span>
<span id="cb265-12"><a href="#cb265-12" aria-hidden="true"></a><span class="co">#&gt; 131          7.4         2.8          6.1         1.9 virginica</span></span>
<span id="cb265-13"><a href="#cb265-13" aria-hidden="true"></a><span class="co">#&gt; 132          7.9         3.8          6.4         2.0 virginica</span></span>
<span id="cb265-14"><a href="#cb265-14" aria-hidden="true"></a><span class="co">#&gt; 136          7.7         3.0          6.1         2.3 virginica</span></span></code></pre></div>
<ul>
<li>La subtabla formada por las 4 primeras filas de la subtabla anterior:</li>
</ul>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true"></a>d.f[d.f<span class="op">$</span>Species<span class="op">==</span><span class="st">&quot;virginica&quot;</span> <span class="op">&amp;</span><span class="st"> </span>d.f<span class="op">$</span>Sepal.Length<span class="op">&gt;</span><span class="dv">7</span>, ][<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, ]</span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true"></a><span class="co">#&gt;     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species</span></span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true"></a><span class="co">#&gt; 103          7.1         3.0          5.9         2.1 virginica</span></span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true"></a><span class="co">#&gt; 106          7.6         3.0          6.6         2.1 virginica</span></span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true"></a><span class="co">#&gt; 108          7.3         2.9          6.3         1.8 virginica</span></span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true"></a><span class="co">#&gt; 110          7.2         3.6          6.1         2.5 virginica</span></span></code></pre></div>
<p>En todos los casos, obtenemos subtablas del <em>data frame</em> <code>d.f</code> con sus filas y columnas determinadas por las expresiones entre corchetes.</p>
</div>
<div id="cómo-importar-y-exportar-data-frames" class="section level2" number="6.2">
<h2 number="6.2"><span class="header-section-number">6.2</span> Cómo importar y exportar <em>data frames</em></h2>
<p>R dispone de varias instrucciones que permiten importar ficheros externos como objetos de datos; por ejemplo, ya vimos en la Sección @ref(sec:vect) la función <code>scan</code>, que permitía definir un vector con el contenido de un fichero. En esta sección explicaremos cómo podemos definir un <em>data frame</em> a partir de una tabla de datos contenida en un fichero externo. Para ello, usaremos la función <code>read.table</code> o el menú <em>Import Dataset</em> de la pestaña <strong>Environment</strong> de la ventana superior derecha de <em>RStudio</em>.</p>
<p>Empecemos con la función <code>read.table</code>. Para crear un <em>data frame</em> a partir de un fichero de texto simple que contenga una tabla de datos, podemos aplicar esta función al nombre del fichero, si está en el directorio de trabajo de R, o a su <em>url</em>, si está en Internet; en ambos casos, entre comillas. Esta función <code>read.table</code> tiene algunos parámetros que evitan errores en la creación del <em>data frame</em>:</p>
<ul>
<li><p><code>sep</code>. Como ya ocurría con la función <code>scan</code>, la función <code>read.table</code> entiende por defecto que las separaciones entre columnas en el fichero están marcadas por espacios en blanco. Si esta separación está marcada por comas, signos de punto y coma, tabuladores o de cualquier otra manera, hay que especificarlo con este parámetro. Por ejemplo, tenemos que especificar <code>sep=","</code> para indicar que las separaciones entre columnas son comas, <code>sep=";"</code> para indicar que las separaciones entre columnas son signos de punto y coma, y <code>sep="\t"</code> para indicar que las separaciones entre columnas son tabuladores.</p></li>
<li><p><code>header</code>. Si la tabla que importamos tiene una primera fila con los nombres de las columnas, es conveniente especificarlo con el parámetro <code>header=TRUE</code>; en caso contrario, y según cómo esté formateado el fichero, puede que R entienda la fila de los nombres de las variables como la primera fila de observaciones.
Si, en cambio, las columnas de la tabla que importamos no tienen nombre, no hace falta especificar el parámetro <code>header</code> (o usar <code>header=FALSE</code>, que es su valor por defecto), y después ya pondremos nombres a las variables con la función <code>names</code> (véase la Sección @ref(sec:moddf)).</p></li>
<li><p><code>dec</code>. Como ya explicamos en la función <code>scan</code>, podemos usar el parámetro <code>dec</code> para especificar el separador decimal, si no es un punto.</p></li>
<li><p><code>stringsAsFactors</code>. Por defecto, <code>read.table</code> transforma en factores las columnas de palabras de la tabla que importa. Para impedir esta transformación, de manera que los vectores de palabras se importen como tales, podemos usar <code>stringsAsFactors=FALSE</code>.</p></li>
<li><p><code>encoding</code>. Como también ya explicamos en el contexto de la función <code>scan</code>, este parámetro sirve para indicar la codificación de alfabeto del fichero que se va a importar, y se ha de usar si dicho fichero contiene palabras con letras acentuadas o caracteres especiales y su codificación no coincide con la que espera nuestro ordenador: lo notaremos porque si importamos el fichero sin especificar este parámetro, los acentos se importan mal. Como los ficheros externos que usamos en este curso están codificados en utf8, los usuarios de Windows de vez en cuando tendrán que usar <code>encoding="latin1"</code>. Avisaremos cada vez que sea necesario.</p></li>
</ul>
<p>Para otros parámetros, podéis consultar la Ayuda de <code>read.table</code>.</p>
<p>Vamos a ilustrar el uso de esta función con los ficheros los dos <em>urls</em> siguientes:</p>
<ul>
<li><a href="http://aprender.uib.es/Rdir/NotaHermanos.txt">http://aprender.uib.es/Rdir/NotaHermanos.txt</a></li>
<li><a href="http://aprender.uib.es/Rdir/NotaHermanosc.txt">http://aprender.uib.es/Rdir/NotaHermanosc.txt</a></li>
</ul>
<p>Ambos ficheros son básicamente la misma tabla de datos, que recoge, para algunos estudiantes de primer curso de la UIB de hace unos años, el grado en el que estaban matriculados (Biología, <em>BL</em>, o Bioquímica, <em>BQ</em>), su número de hermanos y la nota que obtuvieron en un determinado examen; la diferencia es que, en el primero, “NotaHermanos.txt”, las columnas están separadas por espacios en blanco, y en el segundo, “NotaHermanos<em>c</em>.txt”, por comas. Ambos ficheros contienen una primera fila con los nombres de las variables. Están codificados en utf8, pero como no contienen letras acentuadas ni caracteres especiales, no tenéis que preocuparos por su codificación.</p>
<p>Para crear un <em>data frame</em> llamado <code>NH1</code> a partir del fichero <code>NotaHermanos.txt</code>, basta aplicar la función <code>read.table</code> a su <em>url</em> entre comillas y especificar <code>header=TRUE</code>. Naturalmente, para poder importar un fichero de Internet, hay que estar conectados a Internet, el servidor que aloja el fichero tiene que funcionar, y además no tiene que requerir una palabra clave para acceder.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true"></a>NH1=<span class="kw">read.table</span>(<span class="st">&quot;http://aprender.uib.es/Rdir/NotaHermanos.txt&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p>Es una buena costumbre, una vez definido un <em>data frame</em> a partir de un fichero externo, comprobar que se ha importado bien. Como una tabla de datos puede tener muchas filas, verla entera en la consola puede ser poco práctico; lo mejor es usar las funciones <code>str</code> y <code>View</code> o <code>head</code>. Os aconsejamos que, siempre que vayáis a trabajar con un <em>data frame</em>, le echéis antes un vistazo con estas funciones para comprobar su estructura, los nombres de sus variables, los tipos de sus datos, etc. Esto es especialmente importante cuando se trata de <em>data frames</em> importados, porque si no hemos especificado los parámetros adecuados, puede que en el proceso de lectura y definición del <em>data frame</em> se hayan perdido los nombres de las variables o la estructura de columnas.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true"></a><span class="kw">head</span>(NH1)</span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true"></a><span class="co">#&gt;   Grado Hermanos Nota</span></span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true"></a><span class="co">#&gt; 1    BQ        1   93</span></span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true"></a><span class="co">#&gt; 2    BL        1   35</span></span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true"></a><span class="co">#&gt; 3    BL        1   55</span></span>
<span id="cb268-6"><a href="#cb268-6" aria-hidden="true"></a><span class="co">#&gt; 4    BL        1   77</span></span>
<span id="cb268-7"><a href="#cb268-7" aria-hidden="true"></a><span class="co">#&gt; 5    BL        2   81</span></span>
<span id="cb268-8"><a href="#cb268-8" aria-hidden="true"></a><span class="co">#&gt; 6    BQ        0   86</span></span>
<span id="cb268-9"><a href="#cb268-9" aria-hidden="true"></a><span class="kw">str</span>(NH1)</span>
<span id="cb268-10"><a href="#cb268-10" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    87 obs. of  3 variables:</span></span>
<span id="cb268-11"><a href="#cb268-11" aria-hidden="true"></a><span class="co">#&gt;  $ Grado   : chr  &quot;BQ&quot; &quot;BL&quot; &quot;BL&quot; &quot;BL&quot; ...</span></span>
<span id="cb268-12"><a href="#cb268-12" aria-hidden="true"></a><span class="co">#&gt;  $ Hermanos: int  1 1 1 1 2 0 1 1 1 1 ...</span></span>
<span id="cb268-13"><a href="#cb268-13" aria-hidden="true"></a><span class="co">#&gt;  $ Nota    : int  93 35 55 77 81 86 97 40 16 31 ...</span></span></code></pre></div>
<p>Si no hubiéramos especificado <code>header=TRUE</code>, el formato del <em>data frame</em> resultante no habría sido el adecuado.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true"></a>NH1.mal=<span class="kw">read.table</span>(<span class="st">&quot;http://aprender.uib.es/Rdir/NotaHermanos.txt&quot;</span>)</span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true"></a><span class="kw">str</span>(NH1.mal)</span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    88 obs. of  3 variables:</span></span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true"></a><span class="co">#&gt;  $ V1: chr  &quot;Grado&quot; &quot;BQ&quot; &quot;BL&quot; &quot;BL&quot; ...</span></span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true"></a><span class="co">#&gt;  $ V2: chr  &quot;Hermanos&quot; &quot;1&quot; &quot;1&quot; &quot;1&quot; ...</span></span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true"></a><span class="co">#&gt;  $ V3: chr  &quot;Nota&quot; &quot;93&quot; &quot;35&quot; &quot;55&quot; ...</span></span></code></pre></div>
<p>Sin el parámetro <code>header=TRUE</code>, R ha entendido que <code>Grado</code>, <code>Hermanos</code> y <code>Nota</code> son elementos de sus columnas respectivas, y no sus nombres; en consecuencia, por un lado, ha llamado por defecto <code>V1</code>, <code>V2</code> y <code>V3</code> a las columnas del <em>data frame</em>, y por otro, como <code>Grado</code>, <code>Hermanos</code> y <code>Nota</code> son palabras y los datos de cada variable de un <em>data frame</em> han de ser del mismo tipo, ha considerado que todas las entradas de cada columna eran palabras. Finalmente, como, al crear un <em>data frame</em>, R transforma los vectores de palabras en factores si no especificamos lo contrario, hemos obtenido un <em>data frame</em> formado por tres factores, y hemos perdido la información numérica que contenían las columnas con el número de hermanos y la nota.</p>
<p>Para importar el fichero <code>NotaHermanosc.txt</code>, donde las columnas están separadas por comas, hay que usar el parámetro <code>sep=","</code>.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true"></a>NH2=<span class="kw">read.table</span>(<span class="st">&quot;http://aprender.uib.es/Rdir/NotaHermanosc.txt&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">sep=</span><span class="st">&quot;,&quot;</span>)</span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true"></a><span class="kw">str</span>(NH2)</span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    87 obs. of  3 variables:</span></span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true"></a><span class="co">#&gt;  $ Grado   : chr  &quot;BQ&quot; &quot;BL&quot; &quot;BL&quot; &quot;BL&quot; ...</span></span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true"></a><span class="co">#&gt;  $ Hermanos: int  1 1 1 1 2 0 1 1 1 1 ...</span></span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true"></a><span class="co">#&gt;  $ Nota    : int  93 35 55 77 81 86 97 40 16 31 ...</span></span></code></pre></div>
<p>Sin este parámetro, R hubiera entendido cada fila como una sola palabra.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true"></a>NH2.mal=<span class="kw">read.table</span>(<span class="st">&quot;http://aprender.uib.es/Rdir/NotaHermanosc.txt&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>)</span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true"></a><span class="kw">str</span>(NH2.mal)</span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    87 obs. of  1 variable:</span></span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true"></a><span class="co">#&gt;  $ Grado.Hermanos.Nota: chr  &quot;BQ,1,93&quot; &quot;BL,1,35&quot; &quot;BL,1,55&quot; &quot;BL,1,77&quot; ...</span></span></code></pre></div>
<p>Veamos el efecto de <code>stringsAsFactors=FALSE</code>:</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true"></a>NH3=<span class="kw">read.table</span>(<span class="st">&quot;http://aprender.uib.es/Rdir/NotaHermanosc.txt&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>, </span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true"></a>               <span class="dt">sep=</span><span class="st">&quot;,&quot;</span>, <span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>)</span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true"></a><span class="kw">str</span>(NH3)</span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    87 obs. of  3 variables:</span></span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true"></a><span class="co">#&gt;  $ Grado   : chr  &quot;BQ&quot; &quot;BL&quot; &quot;BL&quot; &quot;BL&quot; ...</span></span>
<span id="cb272-6"><a href="#cb272-6" aria-hidden="true"></a><span class="co">#&gt;  $ Hermanos: int  1 1 1 1 2 0 1 1 1 1 ...</span></span>
<span id="cb272-7"><a href="#cb272-7" aria-hidden="true"></a><span class="co">#&gt;  $ Nota    : int  93 35 55 77 81 86 97 40 16 31 ...</span></span></code></pre></div>
<p>La variable <code>Grado</code> se ha importado como un vector de palabras: lo indica el <code>chr</code>, de <em>character</em>, en la fila correspondiente del resultado de <code>str</code>.</p>
<p>Para importar versiones locales de estos ficheros, tendríamos que usar las mismas instrucciones, cambiando el <em>url</em> por el nombre del fichero, siempre entre comillas. Por ejemplo, si disponemos de una copia del fichero <code>NotaHermanos.txt</code> en nuestro escritorio de trabajo, lo podemos cargar con la instrucción:</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true"></a>NH4=<span class="kw">read.table</span>(<span class="st">&quot;NotaHermanos.txt&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>)</span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true"></a><span class="kw">str</span>(NH4)</span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    87 obs. of  3 variables:</span></span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true"></a><span class="co">#&gt;  $ Grado   : chr  &quot;BQ&quot; &quot;BL&quot; &quot;BL&quot; &quot;BL&quot; ...</span></span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true"></a><span class="co">#&gt;  $ Hermanos: int  1 1 1 1 2 0 1 1 1 1 ...</span></span>
<span id="cb273-6"><a href="#cb273-6" aria-hidden="true"></a><span class="co">#&gt;  $ Nota    : int  93 35 55 77 81 86 97 40 16 31 ...</span></span></code></pre></div>
<p>Para importar tablas de datos también se puede usar el menú <em>Import Dataset</em> de la pestaña <strong>Environment</strong>, y de hecho esta es la opción más aconsejable cuando usamos R de manera interactiva. Este menú dispone de varias opciones, según el tipo de fichero (texto simple, Excel, SPSS …) y según que esté en el ordenador o en un <em>url</em> (si entráis un <em>url</em> pulsad a continuación el botón <em>Update</em> para que se conecte). Según la opción que escojáis, puede ser que tengáis que instalar algún paquete, como <strong>readr</strong> o <strong>readxl</strong>, ya os avisará <em>RStudio</em> con un mensaje de error. En cada caso, se os presentarán diversas opciones que os permitirán, por ejemplo, poner nombre al <em>data frame</em> (en el campo <em>Name</em>), indicar si tiene una primera fila con los nombres de las variables (seleccionando <em>Yes</em> en el campo <em>Heading</em> o marcando el botón <em>First Row as Names</em>, según la opción del menú que hayáis elegido), especificar el signo que separa las columnas (<em>Separator</em> o <em>Delimiter</em>, de nuevo según la opción del menú que hayáis elegido) y cómo aparecen identificados los valores <code>NA</code> en el fichero, etc. La ventaja de estos menús es que podéis ver el aspecto del <em>data frame</em> que crearéis con nuestras elecciones. Su inconveniente es que, si queréis que vuestro análisis de datos sea reproducible por otras personas, es necesario incluir en el documento que publiquéis la instrucción usada para cargar los datos. Por suerte, en la mayoría de opciones de este menú podéis ver las instrucciones que se usan y podéis copiarlas. En las Figuras @ref(fig:ID1) y @ref(fig:ID2) mostramos las ventanas que aparecen usando en el menú <em>Import Dataset</em> las opciones <em>From Text (base)…</em> (para importar con <code>read.table</code> un fichero local) y <em>From Text (readr)…</em> (para importar con funciones del paquete <strong>readr</strong> ficheros locales o en línea) para importar el fichero “NotaHemanosc.txt”. En esta última, observad que en el campo inferior derecho (<em>Code Preview</em>) aparecen las instrucciones que usará R y que podéis copiar (no copiéis el <code>View</code>, naturalmente).</p>
<div class="figure" style="text-align: center">
<img src="AprendeR-Parte-I_files/figure-html/figID1.png" alt="Importador de tablas de datos del *Rstudio* usando *From Text (base)...*." width="90%" />
<p class="caption">
(#fig:ID1)Importador de tablas de datos del <em>Rstudio</em> usando <em>From Text (base)…</em>.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="AprendeR-Parte-I_files/figure-html/figID2.png" alt="Importador de tablas de datos del *Rstudio* usando *From Text (readr)...*." width="90%" />
<p class="caption">
(#fig:ID2)Importador de tablas de datos del <em>Rstudio</em> usando <em>From Text (readr)…</em>.
</p>
</div>
<p>Podemos exportar un <em>data frame</em> a un fichero usando la función <code>write.table</code>. Su sintaxis básica es</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true"></a><span class="kw">write.table</span>(data frame, <span class="dt">file=</span><span class="st">&quot;nombre del fichero&quot;</span>)</span></code></pre></div>
<p>Esta función crea un fichero, en el directorio de trabajo de R, que contiene el <em>data frame</em> que hemos especificado en el argumento, y lo llama el nombre que hemos especificado entrecomillado en <code>file</code>. Además, por ejemplo, podemos usar el parámetro <code>sep</code> para indicar el signo de separación de columnas en el fichero que creemos.</p>
<p>Así, por ejemplo, vamos a crear un <em>data frame</em> llamado <code>A</code> con un trozo de <code>iris</code>.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true"></a>A=iris[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]</span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true"></a>A</span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true"></a><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true"></a><span class="co">#&gt; 1          5.1         3.5          1.4         0.2</span></span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true"></a><span class="co">#&gt; 2          4.9         3.0          1.4         0.2</span></span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true"></a><span class="co">#&gt; 3          4.7         3.2          1.3         0.2</span></span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true"></a><span class="co">#&gt; 4          4.6         3.1          1.5         0.2</span></span>
<span id="cb275-8"><a href="#cb275-8" aria-hidden="true"></a><span class="co">#&gt; 5          5.0         3.6          1.4         0.2</span></span></code></pre></div>
<p>Para guardar este <em>data frame</em> <code>A</code> en un fichero llamado <code>trozoiris.txt</code> donde las columnas aparezcan separadas con signos de punto y coma, entramos:</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true"></a><span class="kw">write.table</span>(A, <span class="dt">file=</span><span class="st">&quot;trozoiris.txt&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;;&quot;</span>)</span></code></pre></div>
<p>Y ahora podemos volver a importar este fichero con un <code>read.table</code> adecuado:</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true"></a>B=<span class="kw">read.table</span>(<span class="st">&quot;trozoiris.txt&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">sep=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true"></a>B</span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true"></a><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true"></a><span class="co">#&gt; 1          5.1         3.5          1.4         0.2</span></span>
<span id="cb277-5"><a href="#cb277-5" aria-hidden="true"></a><span class="co">#&gt; 2          4.9         3.0          1.4         0.2</span></span>
<span id="cb277-6"><a href="#cb277-6" aria-hidden="true"></a><span class="co">#&gt; 3          4.7         3.2          1.3         0.2</span></span>
<span id="cb277-7"><a href="#cb277-7" aria-hidden="true"></a><span class="co">#&gt; 4          4.6         3.1          1.5         0.2</span></span>
<span id="cb277-8"><a href="#cb277-8" aria-hidden="true"></a><span class="co">#&gt; 5          5.0         3.6          1.4         0.2</span></span></code></pre></div>
<p>Para terminar, una última instrucción para importar tablas, basada en funciones del paquete <strong>readr</strong>. Podéis seleccionar y copiar toda el contenido de una tabla de datos en el portapapeles con la combinación de teclas que corresponda en vuestro sistema operativo y “pegarlo” en un <em>data frame</em> con la siguiente instrucción (tras cargar primero el paquete <strong>readr</strong> si es necesario):</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true"></a>Nombre=<span class="kw">read_delim</span>(<span class="kw">clipboard</span>(),<span class="dt">delim=</span>...)</span></code></pre></div>
<p>donde <code>Nombre</code> refiere al nombre que queréis dar al <em>data frame</em> y en el parámetro <code>delim</code> tenéis que especificar el separador de columnas de manera similar a cómo usamos <code>sep</code> en <code>read.table</code>; la función <code>clipboard()</code> de <strong>readr</strong> devuelve el contenido del portapapeles. Leed la Ayuda de la función <code>read_delim</code> para conocer otros parámetros que podéis especificar.</p>
</div>
<div id="cómo-crear-data-frames" class="section level2" number="6.3">
<h2 number="6.3"><span class="header-section-number">6.3</span> Cómo crear <em>data frames</em></h2>
<p>Además de trabajar con <em>data frames</em> importados o predefinidos, también podemos crearlos; para ello, organizaremos en forma de tabla algunos vectores, cada uno de los cuales contendrá las observaciones de una variable para un conjunto de individuos o casos, y de manera que los datos en todos estos vectores estén en el mismo orden de los individuos: es decir, que la primera entrada de cada vector corresponda a un mismo individuo, la segunda entrada de cada vector corresponda a otro mismo individuo, y así sucesivamente.</p>
<p>Para construir un <em>data frame</em> a partir de unos vectores, se usa la función <code>data.frame</code> aplicada a los vectores en el orden en el que queramos disponer las columnas de la tabla;
de esta manera, las variables tomarán los nombres de los vectores. Estos nombres también se pueden especificar en el argumento de la función <code>data.frame</code>, entrando cada columna con una construcción de la forma</p>
<pre><code>Nombre de la variable=Vector con el contenido de la variable</code></pre>
<p>Vamos a ilustrar esta función con un ejemplo sencillo, que arrastraremos durante buena parte de lo que queda de lección. Vamos a construir un <em>data frame</em> que contenga algunos datos sobre estudiantes; concretamente, este <em>data frame</em> tendrá tres variables: una primera columna con el sexo del estudiante, la segunda columna con su edad en años y la tercera con su número de hermanos. Como ejemplo de la construcción anterior, a los vectores conteniendo las dos primeras variables les pondremos de entrada nombres razonables, que mantendremos en el <em>data frame</em>, y al vector con los números de hermanos lo llamaremos <code>X</code> y le asignaremos el nombre <code>Hermanos</code> al crear el <em>data frame</em>.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true"></a>Sexo=<span class="kw">c</span>(<span class="st">&quot;Hombre&quot;</span>,<span class="st">&quot;Hombre&quot;</span>,<span class="st">&quot;Mujer&quot;</span>,<span class="st">&quot;Hombre&quot;</span>,<span class="st">&quot;Hombre&quot;</span>,<span class="st">&quot;Hombre&quot;</span>,<span class="st">&quot;Mujer&quot;</span>)</span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true"></a>Edad=<span class="kw">c</span>(<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">18</span>,<span class="dv">18</span>,<span class="dv">18</span>,<span class="dv">19</span>)</span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true"></a>X=<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true"></a>d.f1=<span class="kw">data.frame</span>(Sexo, Edad, <span class="dt">Hermanos=</span>X)</span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true"></a>d.f1</span>
<span id="cb280-6"><a href="#cb280-6" aria-hidden="true"></a><span class="co">#&gt;     Sexo Edad Hermanos</span></span>
<span id="cb280-7"><a href="#cb280-7" aria-hidden="true"></a><span class="co">#&gt; 1 Hombre   17        2</span></span>
<span id="cb280-8"><a href="#cb280-8" aria-hidden="true"></a><span class="co">#&gt; 2 Hombre   18        0</span></span>
<span id="cb280-9"><a href="#cb280-9" aria-hidden="true"></a><span class="co">#&gt; 3  Mujer   20        0</span></span>
<span id="cb280-10"><a href="#cb280-10" aria-hidden="true"></a><span class="co">#&gt; 4 Hombre   18        1</span></span>
<span id="cb280-11"><a href="#cb280-11" aria-hidden="true"></a><span class="co">#&gt; 5 Hombre   18        1</span></span>
<span id="cb280-12"><a href="#cb280-12" aria-hidden="true"></a><span class="co">#&gt; 6 Hombre   18        1</span></span>
<span id="cb280-13"><a href="#cb280-13" aria-hidden="true"></a><span class="co">#&gt; 7  Mujer   19        0</span></span></code></pre></div>
<p>Puesto que iremos modificando este <em>data frame</em>, vamos a guardar una copia de seguridad (un <em>backup</em>) en <code>d.f1bk</code> para poder recuperar su estado original si lo necesitamos.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true"></a>d.f1bk=d.f1</span></code></pre></div>
<p>Es muy prudente y recomendable que guardéis siempre copias de seguridad de los <em>data frames</em> que generéis si vais a manipularlos, porque hay cambios en un <em>data frame</em> que son irreversibles y, por lo tanto, si os arrepentís de haber hecho algún cambio, bien podría ser que no lo pudierais deshacer.</p>
<p>Vamos a consultar algunas características del <em>data frame</em> <code>d.f1</code>.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true"></a><span class="kw">str</span>(d.f1)</span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    7 obs. of  3 variables:</span></span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true"></a><span class="co">#&gt;  $ Sexo    : chr  &quot;Hombre&quot; &quot;Hombre&quot; &quot;Mujer&quot; &quot;Hombre&quot; ...</span></span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true"></a><span class="co">#&gt;  $ Edad    : num  17 18 20 18 18 18 19</span></span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true"></a><span class="co">#&gt;  $ Hermanos: num  2 0 0 1 1 1 0</span></span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true"></a><span class="kw">rownames</span>(d.f1)</span>
<span id="cb282-7"><a href="#cb282-7" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; &quot;6&quot; &quot;7&quot;</span></span></code></pre></div>
<p>Vemos que la primera variable es un factor con dos niveles, y las otras dos son vectores numéricos (<code>num</code>). Vemos también que R ha asignado como identificadores de las filas los números del 1 al 7, pero los considera palabras.</p>
<p>La función <code>data.frame</code> dispone de algunos parámetros que permiten ajustar a nuestras necesidades el <em>data frame</em> que creamos. Los más útiles son los siguientes:</p>
<ul>
<li><p><code>row.names</code>. Sirve para especificar los identificadores de las filas.</p></li>
<li><p><code>stringsAsFactors</code>. Por defecto, <code>data.frame</code> convierte los vectores de palabras en factores. Con <code>stringsAsFactors=FALSE</code>, imponemos que los vectores de palabras se mantengan como tales en el <em>data frame</em></p></li>
</ul>
<p>Veamos un ejemplo de aplicación de estos dos parámetros.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true"></a>d.f2=<span class="kw">data.frame</span>(Sexo, Edad, <span class="dt">Hermanos=</span>X, <span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>, </span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true"></a>  <span class="dt">row.names=</span><span class="kw">c</span>(<span class="st">&quot;E1&quot;</span>,<span class="st">&quot;E2&quot;</span>,<span class="st">&quot;E3&quot;</span>,<span class="st">&quot;E4&quot;</span>,<span class="st">&quot;E5&quot;</span>,<span class="st">&quot;E6&quot;</span>,<span class="st">&quot;E7&quot;</span>))</span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true"></a>d.f2</span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true"></a><span class="co">#&gt;      Sexo Edad Hermanos</span></span>
<span id="cb283-5"><a href="#cb283-5" aria-hidden="true"></a><span class="co">#&gt; E1 Hombre   17        2</span></span>
<span id="cb283-6"><a href="#cb283-6" aria-hidden="true"></a><span class="co">#&gt; E2 Hombre   18        0</span></span>
<span id="cb283-7"><a href="#cb283-7" aria-hidden="true"></a><span class="co">#&gt; E3  Mujer   20        0</span></span>
<span id="cb283-8"><a href="#cb283-8" aria-hidden="true"></a><span class="co">#&gt; E4 Hombre   18        1</span></span>
<span id="cb283-9"><a href="#cb283-9" aria-hidden="true"></a><span class="co">#&gt; E5 Hombre   18        1</span></span>
<span id="cb283-10"><a href="#cb283-10" aria-hidden="true"></a><span class="co">#&gt; E6 Hombre   18        1</span></span>
<span id="cb283-11"><a href="#cb283-11" aria-hidden="true"></a><span class="co">#&gt; E7  Mujer   19        0</span></span>
<span id="cb283-12"><a href="#cb283-12" aria-hidden="true"></a><span class="kw">str</span>(d.f2)</span>
<span id="cb283-13"><a href="#cb283-13" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    7 obs. of  3 variables:</span></span>
<span id="cb283-14"><a href="#cb283-14" aria-hidden="true"></a><span class="co">#&gt;  $ Sexo    : chr  &quot;Hombre&quot; &quot;Hombre&quot; &quot;Mujer&quot; &quot;Hombre&quot; ...</span></span>
<span id="cb283-15"><a href="#cb283-15" aria-hidden="true"></a><span class="co">#&gt;  $ Edad    : num  17 18 20 18 18 18 19</span></span>
<span id="cb283-16"><a href="#cb283-16" aria-hidden="true"></a><span class="co">#&gt;  $ Hermanos: num  2 0 0 1 1 1 0</span></span>
<span id="cb283-17"><a href="#cb283-17" aria-hidden="true"></a>d.f2<span class="op">$</span>Sexo</span>
<span id="cb283-18"><a href="#cb283-18" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;Hombre&quot; &quot;Hombre&quot; &quot;Mujer&quot;  &quot;Hombre&quot; &quot;Hombre&quot; &quot;Hombre&quot; &quot;Mujer&quot;</span></span></code></pre></div>
<p>Como vemos, el efecto de <code>stringsAsFactors=FALSE</code> ha sido que la variable <code>Sexo</code> es ahora un vector de palabras, y el del parámetro <code>row.names</code> ha sido llamar <code>E1,E2,...,E7</code> a las filas.</p>
<p>Si hemos asignado identificadores a las filas, podemos usarlos para extraer subtablas del <em>data frame</em> (aunque también podemos seguir usando los números de las filas). Recordad que, si usáis los identificadores, como son palabras, hay que escribirlos entre comillas.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true"></a>d.f2[<span class="kw">c</span>(<span class="st">&quot;E1&quot;</span>,<span class="st">&quot;E2&quot;</span>), ] <span class="co">#Subtabla con las filas E1 y E2</span></span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true"></a><span class="co">#&gt;      Sexo Edad Hermanos</span></span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true"></a><span class="co">#&gt; E1 Hombre   17        2</span></span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true"></a><span class="co">#&gt; E2 Hombre   18        0</span></span></code></pre></div>
<p>Para crear un <em>data frame</em> a partir de cero, entrando los datos en una tabla, lo más práctico es usar un programa externo, por ejemplo <em>Open Office</em>, para crear la tabla de datos, y luego importar la tabla con el menú <em>Import Dataset</em> tal y como explicábamos en la sección anterior.</p>
</div>
<div id="sec:moddf" class="section level2" number="6.4">
<h2 number="6.4"><span class="header-section-number">6.4</span> Cómo modificar un <em>data frame</em></h2>
<p>En esta sección veremos la manera de modificar un <em>data frame</em> una vez creado o importado.</p>
<p>Para cambiar los nombres de las variables, podemos usar la instrucción</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true"></a><span class="kw">names</span>(data frame)=vector con los nombres de las variables</span></code></pre></div>
<p>Volvamos al <code>d.f1</code>. Tras recordar su estructura, cambiaremos los nombres de sus variables, sustituyéndolos por sus iniciales, y volveremos a consultar su estructura para ver cómo han cambiado estos nombres.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true"></a><span class="kw">str</span>(d.f1)</span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    7 obs. of  3 variables:</span></span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true"></a><span class="co">#&gt;  $ Sexo    : chr  &quot;Hombre&quot; &quot;Hombre&quot; &quot;Mujer&quot; &quot;Hombre&quot; ...</span></span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true"></a><span class="co">#&gt;  $ Edad    : num  17 18 20 18 18 18 19</span></span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true"></a><span class="co">#&gt;  $ Hermanos: num  2 0 0 1 1 1 0</span></span>
<span id="cb286-6"><a href="#cb286-6" aria-hidden="true"></a><span class="kw">names</span>(d.f1)=<span class="kw">c</span>(<span class="st">&quot;S&quot;</span>,<span class="st">&quot;E&quot;</span>,<span class="st">&quot;H&quot;</span>)</span>
<span id="cb286-7"><a href="#cb286-7" aria-hidden="true"></a><span class="kw">str</span>(d.f1)</span>
<span id="cb286-8"><a href="#cb286-8" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    7 obs. of  3 variables:</span></span>
<span id="cb286-9"><a href="#cb286-9" aria-hidden="true"></a><span class="co">#&gt;  $ S: chr  &quot;Hombre&quot; &quot;Hombre&quot; &quot;Mujer&quot; &quot;Hombre&quot; ...</span></span>
<span id="cb286-10"><a href="#cb286-10" aria-hidden="true"></a><span class="co">#&gt;  $ E: num  17 18 20 18 18 18 19</span></span>
<span id="cb286-11"><a href="#cb286-11" aria-hidden="true"></a><span class="co">#&gt;  $ H: num  2 0 0 1 1 1 0</span></span></code></pre></div>
<p>Si sólo queremos cambiar el nombre de algunas variables, basta redefinir el trozo correspondiente del vector <code>names</code>. Así, si en la nueva copia de <code>d.f1</code> quisiéramos volver a cambiar el nombre de la variable <code>E</code> por <code>Edad</code>, podríamos usar una de las dos instrucciones siguientes:</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true"></a><span class="kw">names</span>(d.f1)[<span class="dv">2</span>]=<span class="st">&quot;Edad&quot;</span></span></code></pre></div>
<p>o</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true"></a><span class="kw">names</span>(d.f1)[<span class="kw">names</span>(d.f1)<span class="op">==</span><span class="st">&quot;E&quot;</span>]=<span class="st">&quot;Edad&quot;</span></span></code></pre></div>
<p>Con la primera, cambiaríamos el nombre de la segunda variable por <code>Edad</code>; con la segunda, cambiaríamos el nombre de la variable llamada <code>E</code> por <code>Edad</code>. En los dos casos, la estructura del <em>data frame</em> resultante es la siguiente:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true"></a><span class="kw">str</span>(d.f1)</span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    7 obs. of  3 variables:</span></span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true"></a><span class="co">#&gt;  $ S   : chr  &quot;Hombre&quot; &quot;Hombre&quot; &quot;Mujer&quot; &quot;Hombre&quot; ...</span></span>
<span id="cb289-4"><a href="#cb289-4" aria-hidden="true"></a><span class="co">#&gt;  $ Edad: num  17 18 20 18 18 18 19</span></span>
<span id="cb289-5"><a href="#cb289-5" aria-hidden="true"></a><span class="co">#&gt;  $ H   : num  2 0 0 1 1 1 0</span></span></code></pre></div>
<p>Para modificar los identificadores de las filas, podemos usar la instrucción</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true"></a><span class="kw">rownames</span>(data frame)=vector con los nombres de las filas</span></code></pre></div>
<p>Como cada identificador ha de determinar el individuo al que corresponde la fila, conviene que estos identificadores sean todos diferentes.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true"></a><span class="kw">rownames</span>(d.f1)=<span class="kw">paste</span>(<span class="st">&quot;Alumno&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true"></a>d.f1</span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true"></a><span class="co">#&gt;              S Edad H</span></span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true"></a><span class="co">#&gt; Alumno1 Hombre   17 2</span></span>
<span id="cb291-5"><a href="#cb291-5" aria-hidden="true"></a><span class="co">#&gt; Alumno2 Hombre   18 0</span></span>
<span id="cb291-6"><a href="#cb291-6" aria-hidden="true"></a><span class="co">#&gt; Alumno3  Mujer   20 0</span></span>
<span id="cb291-7"><a href="#cb291-7" aria-hidden="true"></a><span class="co">#&gt; Alumno4 Hombre   18 1</span></span>
<span id="cb291-8"><a href="#cb291-8" aria-hidden="true"></a><span class="co">#&gt; Alumno5 Hombre   18 1</span></span>
<span id="cb291-9"><a href="#cb291-9" aria-hidden="true"></a><span class="co">#&gt; Alumno6 Hombre   18 1</span></span>
<span id="cb291-10"><a href="#cb291-10" aria-hidden="true"></a><span class="co">#&gt; Alumno7  Mujer   19 0</span></span></code></pre></div>
<p>Como podéis deducir de su efecto, la función <code>paste</code> <em>pega</em> vectores, entrada a entrada, usando como separador el valor del parámetro <code>sep</code>. El separador por defecto es un espacio en blanco, nosotros hemos optado por no usar nada para separar la palabra “Alumno” del número, y por eso hemos especificado <code>sep=""</code> (entre las comillas no hay nada, ni siquiera un espacio en blanco). Fiajos en que si en lugar de pegar un vector pegamos un elemento, éste se entiende como un vector constante formado por el número adecuado de copias.</p>
<p>Podemos modificar los nombres de las filas y de las columnas simultáneamente con la instrucción</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true"></a><span class="kw">dimnames</span>(dataframe)=<span class="kw">list</span>(vector con los nombres de las filas, vector con los nombres de las columnas)</span></code></pre></div>
<p>Por ejemplo, vamos a cambiar de golpe en <code>d.f1</code> los identificadores de las filas, para que ahora sean números romanos, y los nombres de las variables, para que pasen a ser “Var1”, “Var2” y “Var3”:</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true"></a><span class="kw">dimnames</span>(d.f1)=<span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;I&quot;</span>,<span class="st">&quot;II&quot;</span>,<span class="st">&quot;III&quot;</span>,<span class="st">&quot;IV&quot;</span>,<span class="st">&quot;V&quot;</span>,<span class="st">&quot;VI&quot;</span>,<span class="st">&quot;VII&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;Var1&quot;</span>,<span class="st">&quot;Var2&quot;</span>,<span class="st">&quot;Var3&quot;</span>))</span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true"></a>d.f1</span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true"></a><span class="co">#&gt;       Var1 Var2 Var3</span></span>
<span id="cb293-4"><a href="#cb293-4" aria-hidden="true"></a><span class="co">#&gt; I   Hombre   17    2</span></span>
<span id="cb293-5"><a href="#cb293-5" aria-hidden="true"></a><span class="co">#&gt; II  Hombre   18    0</span></span>
<span id="cb293-6"><a href="#cb293-6" aria-hidden="true"></a><span class="co">#&gt; III  Mujer   20    0</span></span>
<span id="cb293-7"><a href="#cb293-7" aria-hidden="true"></a><span class="co">#&gt; IV  Hombre   18    1</span></span>
<span id="cb293-8"><a href="#cb293-8" aria-hidden="true"></a><span class="co">#&gt; V   Hombre   18    1</span></span>
<span id="cb293-9"><a href="#cb293-9" aria-hidden="true"></a><span class="co">#&gt; VI  Hombre   18    1</span></span>
<span id="cb293-10"><a href="#cb293-10" aria-hidden="true"></a><span class="co">#&gt; VII  Mujer   19    0</span></span></code></pre></div>
<p>En lugar del vector con los números romanos, hubiéramos podido usar la función <code>as.roman</code> para traducir números arábigos a romanos:</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true"></a><span class="kw">as.roman</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(d.f1)[<span class="dv">1</span>])</span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true"></a><span class="co">#&gt; [1] I   II  III IV  V   VI  VII</span></span></code></pre></div>
<p>Para modificar entradas concretas de un <em>data frame</em>, podemos usar instrucciones similares a las que usábamos en los vectores y las matrices para modificar entradas. Por ejemplo, vamos a volver a la copia guardada de <code>d.f1</code> y vamos a cambiar en ella la primera entrada de la tercera columna, es decir, la entrada (1,3), por un 3:</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true"></a>d.f1=d.f1bk </span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true"></a>d.f1</span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true"></a><span class="co">#&gt;     Sexo Edad Hermanos</span></span>
<span id="cb295-4"><a href="#cb295-4" aria-hidden="true"></a><span class="co">#&gt; 1 Hombre   17        2</span></span>
<span id="cb295-5"><a href="#cb295-5" aria-hidden="true"></a><span class="co">#&gt; 2 Hombre   18        0</span></span>
<span id="cb295-6"><a href="#cb295-6" aria-hidden="true"></a><span class="co">#&gt; 3  Mujer   20        0</span></span>
<span id="cb295-7"><a href="#cb295-7" aria-hidden="true"></a><span class="co">#&gt; 4 Hombre   18        1</span></span>
<span id="cb295-8"><a href="#cb295-8" aria-hidden="true"></a><span class="co">#&gt; 5 Hombre   18        1</span></span>
<span id="cb295-9"><a href="#cb295-9" aria-hidden="true"></a><span class="co">#&gt; 6 Hombre   18        1</span></span>
<span id="cb295-10"><a href="#cb295-10" aria-hidden="true"></a><span class="co">#&gt; 7  Mujer   19        0</span></span></code></pre></div>
<p>Para referirnos a la entrada (1,3) de un <em>data frame</em> usamos la misma construcción que usábamos en las matrices:</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true"></a>d.f1[<span class="dv">1</span>,<span class="dv">3</span>]=<span class="dv">3</span></span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true"></a>d.f1</span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true"></a><span class="co">#&gt;     Sexo Edad Hermanos</span></span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true"></a><span class="co">#&gt; 1 Hombre   17        3</span></span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true"></a><span class="co">#&gt; 2 Hombre   18        0</span></span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true"></a><span class="co">#&gt; 3  Mujer   20        0</span></span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true"></a><span class="co">#&gt; 4 Hombre   18        1</span></span>
<span id="cb296-8"><a href="#cb296-8" aria-hidden="true"></a><span class="co">#&gt; 5 Hombre   18        1</span></span>
<span id="cb296-9"><a href="#cb296-9" aria-hidden="true"></a><span class="co">#&gt; 6 Hombre   18        1</span></span>
<span id="cb296-10"><a href="#cb296-10" aria-hidden="true"></a><span class="co">#&gt; 7  Mujer   19        0</span></span></code></pre></div>
<p>Otra posibilidad hubiera sido modificar directamente la variable con:</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true"></a>d.f1<span class="op">$</span>Hermanos[<span class="dv">1</span>]=<span class="dv">3</span></span></code></pre></div>
<p>Pero fijaos en que la modificamos invocándola con su “nombre compuesto” <code>dataframe$variable</code>; usar solo el nombre de la variable hubiera sido un error:</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true"></a>Hermanos[<span class="dv">1</span>]=<span class="dv">3</span></span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true"></a><span class="co">#&gt; Error in Hermanos[1] = 3: objeto &#39;Hermanos&#39; no encontrado</span></span></code></pre></div>
<p>En este caso hemos tenido suerte porque como la variable <code>Hermanos</code> no existe en el entorno global de R, hemos obtenido un mensaje de error. Pero por ejemplo con</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true"></a>Edad[<span class="dv">1</span>]=<span class="dv">28</span></span></code></pre></div>
<p>no obtenemos ningún error, porque el vector <code>Edad</code> que hemos modificado existe fuera del <em>data frame</em>, pero no hemos modificado el <em>data frame</em>:</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true"></a>d.f1</span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true"></a><span class="co">#&gt;     Sexo Edad Hermanos</span></span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true"></a><span class="co">#&gt; 1 Hombre   17        3</span></span>
<span id="cb300-4"><a href="#cb300-4" aria-hidden="true"></a><span class="co">#&gt; 2 Hombre   18        0</span></span>
<span id="cb300-5"><a href="#cb300-5" aria-hidden="true"></a><span class="co">#&gt; 3  Mujer   20        0</span></span>
<span id="cb300-6"><a href="#cb300-6" aria-hidden="true"></a><span class="co">#&gt; 4 Hombre   18        1</span></span>
<span id="cb300-7"><a href="#cb300-7" aria-hidden="true"></a><span class="co">#&gt; 5 Hombre   18        1</span></span>
<span id="cb300-8"><a href="#cb300-8" aria-hidden="true"></a><span class="co">#&gt; 6 Hombre   18        1</span></span>
<span id="cb300-9"><a href="#cb300-9" aria-hidden="true"></a><span class="co">#&gt; 7  Mujer   19        0</span></span>
<span id="cb300-10"><a href="#cb300-10" aria-hidden="true"></a>Edad</span>
<span id="cb300-11"><a href="#cb300-11" aria-hidden="true"></a><span class="co">#&gt; [1] 28 18 20 18 18 18 19</span></span></code></pre></div>
<p>Otra posibilidad es usar el editor de datos del que ya hemos hablado en la Lección @ref(chap:vect). Recordaréis que, para abrir un objeto de datos con este editor, se le aplica la función <code>fix</code>. R abre entonces el objeto en una nueva ventana de edición. Los cambios que realicemos en un objeto con el editor de datos se guardarán cuando cerremos esta ventana. Es muy probable que para abrir <em>data frames</em> con el editor de datos de <em>Rstudio</em> tengáis que instalar algún programa auxiliar. Por ejemplo, en el caso del Mac OS X, se tiene que tener instalada la última versión de <em>XQuartz</em>, que será el programa en el que se abrirá el editor; el instalador de <em>XQuartz</em> se puede descargar de <a href="http://xquartz.macosforge.org">http://xquartz.macosforge.org</a>.</p>
<p>Así, para realizar el cambio anterior, hubiéramos entrado</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true"></a><span class="kw">fix</span>(d.f1)</span></code></pre></div>
<p>y se hubiera abierto una ventana como la que muestra la Figura @ref(fig:edit), donde podríais efectuar los cambios que quisiérais.</p>
<div class="figure" style="text-align: center">
<img src="AprendeR-Parte-I_files/figure-html/dataeditordf2.png" alt="Editor de *data frames*  de `Rstudio` en  Mac OS X." width="90%" />
<p class="caption">
(#fig:edit)Editor de <em>data frames</em> de <code>Rstudio</code> en Mac OS X.
</p>
</div>
<!--
\begin{figure}[htb]
\abovecaptionskip=-1ex
\begin{center}
\includegraphics[width=0.5\linewidth]{dataeditordf2.pdf}
\end{center}
\caption{Editor de *data frames* \ del `Rstudio` de Mac OS X.}\label{fig:edit}
\end{figure}
-->
<p>Veamos otro ejemplo. Volvemos de nuevo a la copia guardada de <code>d.f1</code> y ahora vamos a substituir su entrada (2,2) (la segunda entrada de la segunda columna) por la palabra “Joven”:</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true"></a>d.f1=d.f1bk </span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true"></a>d.f1[<span class="dv">2</span>,<span class="dv">2</span>]=<span class="st">&quot;Joven&quot;</span> </span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true"></a>d.f1</span>
<span id="cb302-4"><a href="#cb302-4" aria-hidden="true"></a><span class="co">#&gt;     Sexo  Edad Hermanos</span></span>
<span id="cb302-5"><a href="#cb302-5" aria-hidden="true"></a><span class="co">#&gt; 1 Hombre    17        2</span></span>
<span id="cb302-6"><a href="#cb302-6" aria-hidden="true"></a><span class="co">#&gt; 2 Hombre Joven        0</span></span>
<span id="cb302-7"><a href="#cb302-7" aria-hidden="true"></a><span class="co">#&gt; 3  Mujer    20        0</span></span>
<span id="cb302-8"><a href="#cb302-8" aria-hidden="true"></a><span class="co">#&gt; 4 Hombre    18        1</span></span>
<span id="cb302-9"><a href="#cb302-9" aria-hidden="true"></a><span class="co">#&gt; 5 Hombre    18        1</span></span>
<span id="cb302-10"><a href="#cb302-10" aria-hidden="true"></a><span class="co">#&gt; 6 Hombre    18        1</span></span>
<span id="cb302-11"><a href="#cb302-11" aria-hidden="true"></a><span class="co">#&gt; 7  Mujer    19        0</span></span>
<span id="cb302-12"><a href="#cb302-12" aria-hidden="true"></a><span class="kw">str</span>(d.f1)</span>
<span id="cb302-13"><a href="#cb302-13" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    7 obs. of  3 variables:</span></span>
<span id="cb302-14"><a href="#cb302-14" aria-hidden="true"></a><span class="co">#&gt;  $ Sexo    : chr  &quot;Hombre&quot; &quot;Hombre&quot; &quot;Mujer&quot; &quot;Hombre&quot; ...</span></span>
<span id="cb302-15"><a href="#cb302-15" aria-hidden="true"></a><span class="co">#&gt;  $ Edad    : chr  &quot;17&quot; &quot;Joven&quot; &quot;20&quot; &quot;18&quot; ...</span></span>
<span id="cb302-16"><a href="#cb302-16" aria-hidden="true"></a><span class="co">#&gt;  $ Hermanos: num  2 0 0 1 1 1 0</span></span></code></pre></div>
<p>¡Vaya! Al introducir un dato de tipo palabra en la variable <code>Edad</code>, toda la columna ha pasado a ser un vector de palabras: recordemos que R considera del mismo tipo de datos todas las entradas de una columna de un <em>data frame</em>. Y ahora ya no lo podemos arreglar volviendo a poner un número:</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true"></a>d.f1[<span class="dv">2</span>,<span class="dv">2</span>]=<span class="dv">18</span></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true"></a><span class="kw">str</span>(d.f1)</span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    7 obs. of  3 variables:</span></span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true"></a><span class="co">#&gt;  $ Sexo    : chr  &quot;Hombre&quot; &quot;Hombre&quot; &quot;Mujer&quot; &quot;Hombre&quot; ...</span></span>
<span id="cb303-5"><a href="#cb303-5" aria-hidden="true"></a><span class="co">#&gt;  $ Edad    : chr  &quot;17&quot; &quot;18&quot; &quot;20&quot; &quot;18&quot; ...</span></span>
<span id="cb303-6"><a href="#cb303-6" aria-hidden="true"></a><span class="co">#&gt;  $ Hermanos: num  2 0 0 1 1 1 0</span></span></code></pre></div>
<p>Parece que hemos estropeado definitivamente el <em>data frame</em> <code>d.f1</code>. Por suerte, no es así: simplemente tenemos que volver a redefinir la variable <code>Edad</code> como un vector numérico.</p>
<p>Para modificar una columna entera, hay que igualar su nombre completo (que, recordemos, se especifica añadiendo al nombre del <em>data frame</em> el sufijo formado por el signo <code>$</code> seguido del nombre de la variable dentro del <em>data frame</em>) a su nuevo valor:</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true"></a>data frame<span class="op">$</span>variable=nuevo valor</span></code></pre></div>
<p>Este nuevo valor puede ser el resultado de un cambio de tipo de datos aplicado a la variable. R dispone de una serie de funciones de la forma <code>as.tipo_de_objeto</code>, que convierten el objeto al tipo que expresa el nombre de la función. Ya hemos visto en la Sección @ref(subsec:factor) la función <code>as.factor</code>, que transforma un vector en un factor. Otras funciones de este estilo son <code>as.character</code>, <code>as.integer</code> o <code>as.numeric</code>, que transforman todos los datos de un objeto en palabras, números enteros o números reales, respectivamente.</p>
<p>Un error típico al intentar modificar la variable <code>Edad</code> es entrar sólo</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true"></a><span class="kw">as.numeric</span>(d.f1<span class="op">$</span>Edad)</span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true"></a><span class="co">#&gt; [1] 17 18 20 18 18 18 19</span></span></code></pre></div>
<p>Con esta instrucción, hemos obtenido la variable <code>Edad</code> transformada en números, pero no hemos modificado el <em>data frame</em>:</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true"></a><span class="kw">str</span>(d.f1)</span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    7 obs. of  3 variables:</span></span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true"></a><span class="co">#&gt;  $ Sexo    : chr  &quot;Hombre&quot; &quot;Hombre&quot; &quot;Mujer&quot; &quot;Hombre&quot; ...</span></span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true"></a><span class="co">#&gt;  $ Edad    : chr  &quot;17&quot; &quot;18&quot; &quot;20&quot; &quot;18&quot; ...</span></span>
<span id="cb306-5"><a href="#cb306-5" aria-hidden="true"></a><span class="co">#&gt;  $ Hermanos: num  2 0 0 1 1 1 0</span></span></code></pre></div>
<p>Tampoco sirve entrar</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true"></a>Edad=<span class="kw">as.numeric</span>(d.f1<span class="op">$</span>Edad)</span></code></pre></div>
<p>porque esto define un vector llamado <code>Edad</code> de entradas 17, 18, 20, 18, 18, 18, 19, pero sigue sin modificar la variable <code>Edad</code> del <em>data frame</em>:</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true"></a>Edad</span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true"></a><span class="co">#&gt; [1] 17 18 20 18 18 18 19</span></span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true"></a><span class="kw">str</span>(d.f1)</span>
<span id="cb308-4"><a href="#cb308-4" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    7 obs. of  3 variables:</span></span>
<span id="cb308-5"><a href="#cb308-5" aria-hidden="true"></a><span class="co">#&gt;  $ Sexo    : chr  &quot;Hombre&quot; &quot;Hombre&quot; &quot;Mujer&quot; &quot;Hombre&quot; ...</span></span>
<span id="cb308-6"><a href="#cb308-6" aria-hidden="true"></a><span class="co">#&gt;  $ Edad    : chr  &quot;17&quot; &quot;18&quot; &quot;20&quot; &quot;18&quot; ...</span></span>
<span id="cb308-7"><a href="#cb308-7" aria-hidden="true"></a><span class="co">#&gt;  $ Hermanos: num  2 0 0 1 1 1 0</span></span></code></pre></div>
<p>La manera correcta de hacerlo es redefinir la variable del <em>data frame</em> con:</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true"></a>d.f1<span class="op">$</span>Edad=<span class="kw">as.numeric</span>(d.f1<span class="op">$</span>Edad)</span></code></pre></div>
<p>Comprobemos que ahora sí que ha funcionado:</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true"></a><span class="kw">str</span>(d.f1)</span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    7 obs. of  3 variables:</span></span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true"></a><span class="co">#&gt;  $ Sexo    : chr  &quot;Hombre&quot; &quot;Hombre&quot; &quot;Mujer&quot; &quot;Hombre&quot; ...</span></span>
<span id="cb310-4"><a href="#cb310-4" aria-hidden="true"></a><span class="co">#&gt;  $ Edad    : num  17 18 20 18 18 18 19</span></span>
<span id="cb310-5"><a href="#cb310-5" aria-hidden="true"></a><span class="co">#&gt;  $ Hermanos: num  2 0 0 1 1 1 0</span></span></code></pre></div>
<p>Veamos otros ejemplos. Vamos a convertir la variable <code>Sexo</code> en un vector de palabras:</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true"></a>d.f1<span class="op">$</span>Sexo=<span class="kw">as.character</span>(d.f1<span class="op">$</span>Sexo)</span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true"></a><span class="kw">str</span>(d.f1)</span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    7 obs. of  3 variables:</span></span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true"></a><span class="co">#&gt;  $ Sexo    : chr  &quot;Hombre&quot; &quot;Hombre&quot; &quot;Mujer&quot; &quot;Hombre&quot; ...</span></span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true"></a><span class="co">#&gt;  $ Edad    : num  17 18 20 18 18 18 19</span></span>
<span id="cb311-6"><a href="#cb311-6" aria-hidden="true"></a><span class="co">#&gt;  $ Hermanos: num  2 0 0 1 1 1 0</span></span></code></pre></div>
<p>Y ahora vamos a convertir la variable <code>Hermanos</code> en un factor ordenado:</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true"></a>d.f1<span class="op">$</span>Hermanos=<span class="kw">ordered</span>(d.f1<span class="op">$</span>Hermanos, <span class="dt">levels=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true"></a><span class="kw">str</span>(d.f1)</span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    7 obs. of  3 variables:</span></span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true"></a><span class="co">#&gt;  $ Sexo    : chr  &quot;Hombre&quot; &quot;Hombre&quot; &quot;Mujer&quot; &quot;Hombre&quot; ...</span></span>
<span id="cb312-5"><a href="#cb312-5" aria-hidden="true"></a><span class="co">#&gt;  $ Edad    : num  17 18 20 18 18 18 19</span></span>
<span id="cb312-6"><a href="#cb312-6" aria-hidden="true"></a><span class="co">#&gt;  $ Hermanos: Ord.factor w/ 3 levels &quot;0&quot;&lt;&quot;1&quot;&lt;&quot;2&quot;: 3 1 1 2 2 2 1</span></span></code></pre></div>
<p>Naturalmente, podemos cambiar el contenido de toda una variable de otras maneras que no sea sólo modificar su tipo de datos: basta igualarla a su nuevo valor. Por ejemplo, vamos a substituir todas las entrada de la variable <code>Edad</code> por “Joven”:</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true"></a>d.f1<span class="op">$</span>Edad=<span class="st">&quot;Joven&quot;</span></span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true"></a>d.f1</span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true"></a><span class="co">#&gt;     Sexo  Edad Hermanos</span></span>
<span id="cb313-4"><a href="#cb313-4" aria-hidden="true"></a><span class="co">#&gt; 1 Hombre Joven        2</span></span>
<span id="cb313-5"><a href="#cb313-5" aria-hidden="true"></a><span class="co">#&gt; 2 Hombre Joven        0</span></span>
<span id="cb313-6"><a href="#cb313-6" aria-hidden="true"></a><span class="co">#&gt; 3  Mujer Joven        0</span></span>
<span id="cb313-7"><a href="#cb313-7" aria-hidden="true"></a><span class="co">#&gt; 4 Hombre Joven        1</span></span>
<span id="cb313-8"><a href="#cb313-8" aria-hidden="true"></a><span class="co">#&gt; 5 Hombre Joven        1</span></span>
<span id="cb313-9"><a href="#cb313-9" aria-hidden="true"></a><span class="co">#&gt; 6 Hombre Joven        1</span></span>
<span id="cb313-10"><a href="#cb313-10" aria-hidden="true"></a><span class="co">#&gt; 7  Mujer Joven        0</span></span></code></pre></div>
<p>Al igualar la variable <code>Edad</code> a la palabra “Joven”, la ha substituido por el correspondiente vector constante.</p>
</div>
<div id="sec:dfaf" class="section level2" number="6.5">
<h2 number="6.5"><span class="header-section-number">6.5</span> Cómo añadir filas y columnas a un <em>data frame</em></h2>
<p>La mejor manera de añadir filas a un <em>data frame</em> es organizándolas en un nuevo <em>data frame</em> con los mismos nombres de las variables, y a continuación concatenarlas al <em>data frame</em> usando la función <code>rbind</code> que ya usábamos para matrices.</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true"></a>d.f1=d.f1bk  <span class="co">#Volvemos a la copia original</span></span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true"></a>d.f1</span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true"></a><span class="co">#&gt;     Sexo Edad Hermanos</span></span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true"></a><span class="co">#&gt; 1 Hombre   17        2</span></span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true"></a><span class="co">#&gt; 2 Hombre   18        0</span></span>
<span id="cb314-6"><a href="#cb314-6" aria-hidden="true"></a><span class="co">#&gt; 3  Mujer   20        0</span></span>
<span id="cb314-7"><a href="#cb314-7" aria-hidden="true"></a><span class="co">#&gt; 4 Hombre   18        1</span></span>
<span id="cb314-8"><a href="#cb314-8" aria-hidden="true"></a><span class="co">#&gt; 5 Hombre   18        1</span></span>
<span id="cb314-9"><a href="#cb314-9" aria-hidden="true"></a><span class="co">#&gt; 6 Hombre   18        1</span></span>
<span id="cb314-10"><a href="#cb314-10" aria-hidden="true"></a><span class="co">#&gt; 7  Mujer   19        0</span></span>
<span id="cb314-11"><a href="#cb314-11" aria-hidden="true"></a>nuevas.filas=<span class="kw">data.frame</span>(<span class="dt">Sexo=</span><span class="kw">c</span>(<span class="st">&quot;Hombre&quot;</span>,<span class="st">&quot;Hombre&quot;</span>), <span class="dt">Edad=</span><span class="kw">c</span>(<span class="dv">18</span>,<span class="dv">18</span>), <span class="dt">Hermanos=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb314-12"><a href="#cb314-12" aria-hidden="true"></a>d.f1=<span class="kw">rbind</span>(d.f1, nuevas.filas)</span>
<span id="cb314-13"><a href="#cb314-13" aria-hidden="true"></a>d.f1</span>
<span id="cb314-14"><a href="#cb314-14" aria-hidden="true"></a><span class="co">#&gt;     Sexo Edad Hermanos</span></span>
<span id="cb314-15"><a href="#cb314-15" aria-hidden="true"></a><span class="co">#&gt; 1 Hombre   17        2</span></span>
<span id="cb314-16"><a href="#cb314-16" aria-hidden="true"></a><span class="co">#&gt; 2 Hombre   18        0</span></span>
<span id="cb314-17"><a href="#cb314-17" aria-hidden="true"></a><span class="co">#&gt; 3  Mujer   20        0</span></span>
<span id="cb314-18"><a href="#cb314-18" aria-hidden="true"></a><span class="co">#&gt; 4 Hombre   18        1</span></span>
<span id="cb314-19"><a href="#cb314-19" aria-hidden="true"></a><span class="co">#&gt; 5 Hombre   18        1</span></span>
<span id="cb314-20"><a href="#cb314-20" aria-hidden="true"></a><span class="co">#&gt; 6 Hombre   18        1</span></span>
<span id="cb314-21"><a href="#cb314-21" aria-hidden="true"></a><span class="co">#&gt; 7  Mujer   19        0</span></span>
<span id="cb314-22"><a href="#cb314-22" aria-hidden="true"></a><span class="co">#&gt; 8 Hombre   18        1</span></span>
<span id="cb314-23"><a href="#cb314-23" aria-hidden="true"></a><span class="co">#&gt; 9 Hombre   18        2</span></span>
<span id="cb314-24"><a href="#cb314-24" aria-hidden="true"></a><span class="kw">str</span>(d.f1)</span>
<span id="cb314-25"><a href="#cb314-25" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    9 obs. of  3 variables:</span></span>
<span id="cb314-26"><a href="#cb314-26" aria-hidden="true"></a><span class="co">#&gt;  $ Sexo    : chr  &quot;Hombre&quot; &quot;Hombre&quot; &quot;Mujer&quot; &quot;Hombre&quot; ...</span></span>
<span id="cb314-27"><a href="#cb314-27" aria-hidden="true"></a><span class="co">#&gt;  $ Edad    : num  17 18 20 18 18 18 19 18 18</span></span>
<span id="cb314-28"><a href="#cb314-28" aria-hidden="true"></a><span class="co">#&gt;  $ Hermanos: num  2 0 0 1 1 1 0 1 2</span></span></code></pre></div>
<p>Para añadir una variable, basta especificar el valor de la columna correspondiente; por ejemplo, vamos a añadir a <code>d.f1</code> una nueva variable llamada <code>Nueva</code> con el producto de la edad por el número de hermanos:</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true"></a>d.f1<span class="op">$</span>Nueva=d.f1<span class="op">$</span>Edad<span class="op">*</span>d.f1<span class="op">$</span>Hermanos</span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true"></a>d.f1</span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true"></a><span class="co">#&gt;     Sexo Edad Hermanos Nueva</span></span>
<span id="cb315-4"><a href="#cb315-4" aria-hidden="true"></a><span class="co">#&gt; 1 Hombre   17        2    34</span></span>
<span id="cb315-5"><a href="#cb315-5" aria-hidden="true"></a><span class="co">#&gt; 2 Hombre   18        0     0</span></span>
<span id="cb315-6"><a href="#cb315-6" aria-hidden="true"></a><span class="co">#&gt; 3  Mujer   20        0     0</span></span>
<span id="cb315-7"><a href="#cb315-7" aria-hidden="true"></a><span class="co">#&gt; 4 Hombre   18        1    18</span></span>
<span id="cb315-8"><a href="#cb315-8" aria-hidden="true"></a><span class="co">#&gt; 5 Hombre   18        1    18</span></span>
<span id="cb315-9"><a href="#cb315-9" aria-hidden="true"></a><span class="co">#&gt; 6 Hombre   18        1    18</span></span>
<span id="cb315-10"><a href="#cb315-10" aria-hidden="true"></a><span class="co">#&gt; 7  Mujer   19        0     0</span></span>
<span id="cb315-11"><a href="#cb315-11" aria-hidden="true"></a><span class="co">#&gt; 8 Hombre   18        1    18</span></span>
<span id="cb315-12"><a href="#cb315-12" aria-hidden="true"></a><span class="co">#&gt; 9 Hombre   18        2    36</span></span></code></pre></div>
<p>También podemos añadir columnas a la derecha de un <em>data frame</em> usando la función <code>cbind</code>; en este caso, se puede añadir directamente la columna, sin necesidad de convertirla previamente en un <em>data frame</em>. Por ejemplo:</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true"></a>d.f1=<span class="kw">cbind</span>(d.f1, <span class="dt">Grado=</span><span class="kw">rep</span>(<span class="st">&quot;Biología&quot;</span>, <span class="dv">9</span>))</span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true"></a>d.f1</span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true"></a><span class="co">#&gt;     Sexo Edad Hermanos Nueva    Grado</span></span>
<span id="cb316-4"><a href="#cb316-4" aria-hidden="true"></a><span class="co">#&gt; 1 Hombre   17        2    34 Biología</span></span>
<span id="cb316-5"><a href="#cb316-5" aria-hidden="true"></a><span class="co">#&gt; 2 Hombre   18        0     0 Biología</span></span>
<span id="cb316-6"><a href="#cb316-6" aria-hidden="true"></a><span class="co">#&gt; 3  Mujer   20        0     0 Biología</span></span>
<span id="cb316-7"><a href="#cb316-7" aria-hidden="true"></a><span class="co">#&gt; 4 Hombre   18        1    18 Biología</span></span>
<span id="cb316-8"><a href="#cb316-8" aria-hidden="true"></a><span class="co">#&gt; 5 Hombre   18        1    18 Biología</span></span>
<span id="cb316-9"><a href="#cb316-9" aria-hidden="true"></a><span class="co">#&gt; 6 Hombre   18        1    18 Biología</span></span>
<span id="cb316-10"><a href="#cb316-10" aria-hidden="true"></a><span class="co">#&gt; 7  Mujer   19        0     0 Biología</span></span>
<span id="cb316-11"><a href="#cb316-11" aria-hidden="true"></a><span class="co">#&gt; 8 Hombre   18        1    18 Biología</span></span>
<span id="cb316-12"><a href="#cb316-12" aria-hidden="true"></a><span class="co">#&gt; 9 Hombre   18        2    36 Biología</span></span>
<span id="cb316-13"><a href="#cb316-13" aria-hidden="true"></a><span class="kw">str</span>(d.f1)</span>
<span id="cb316-14"><a href="#cb316-14" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    9 obs. of  5 variables:</span></span>
<span id="cb316-15"><a href="#cb316-15" aria-hidden="true"></a><span class="co">#&gt;  $ Sexo    : chr  &quot;Hombre&quot; &quot;Hombre&quot; &quot;Mujer&quot; &quot;Hombre&quot; ...</span></span>
<span id="cb316-16"><a href="#cb316-16" aria-hidden="true"></a><span class="co">#&gt;  $ Edad    : num  17 18 20 18 18 18 19 18 18</span></span>
<span id="cb316-17"><a href="#cb316-17" aria-hidden="true"></a><span class="co">#&gt;  $ Hermanos: num  2 0 0 1 1 1 0 1 2</span></span>
<span id="cb316-18"><a href="#cb316-18" aria-hidden="true"></a><span class="co">#&gt;  $ Nueva   : num  34 0 0 18 18 18 0 18 36</span></span>
<span id="cb316-19"><a href="#cb316-19" aria-hidden="true"></a><span class="co">#&gt;  $ Grado   : chr  &quot;Biología&quot; &quot;Biología&quot; &quot;Biología&quot; &quot;Biología&quot; ...</span></span></code></pre></div>
<p>Tanto en un caso como en otro, la variable añadida ha de tener la misma longitud que las variables del <em>data frame</em> original: en última instancia, se trata de nuevas observaciones sobre los sujetos a los que correspondían las filas del <em>data frame</em> original.</p>
<p>Finalmente, hay que recordar que también podemos usar el editor de datos para añadir (o eliminar) filas o columnas a un <em>data frame</em>, abriéndolo con la función <code>fix</code> y manipulándolo.</p>
</div>
<div id="cómo-seleccionar-trozos-de-un-data-frame" class="section level2" number="6.6">
<h2 number="6.6"><span class="header-section-number">6.6</span> Cómo seleccionar trozos de un <em>data frame</em></h2>
<p>Veamos ahora con más detalle cómo podemos extraer trozos de un <em>data frame</em>; el método básico es similar al que usábamos en las matrices. De hecho, para seleccionar un trozo de un <em>data frame</em>, podemos hacerlo exactamente como en las matrices, especificando los índices de las filas y columnas que nos interesen entre corchetes. Pero como los individuos y las variables tienen nombres, también podemos usarlos para especificar filas y columnas.</p>
<p>Por ejemplo, supongamos que queremos crear un nuevo <em>data frame</em> formado por las dos primeras filas de <code>d.f1</code>; podríamos hacerlo, al menos, de las tres maneras siguientes:</p>
<ul>
<li>Con los índices de las filas:</li>
</ul>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true"></a>d.f1[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, ]</span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true"></a><span class="co">#&gt;     Sexo Edad Hermanos Nueva    Grado</span></span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true"></a><span class="co">#&gt; 1 Hombre   17        2    34 Biología</span></span>
<span id="cb317-4"><a href="#cb317-4" aria-hidden="true"></a><span class="co">#&gt; 2 Hombre   18        0     0 Biología</span></span></code></pre></div>
<ul>
<li>Con los identificadores de las filas:</li>
</ul>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true"></a>d.f1[<span class="kw">c</span>(<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>), ] </span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true"></a><span class="co">#&gt;     Sexo Edad Hermanos Nueva    Grado</span></span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true"></a><span class="co">#&gt; 1 Hombre   17        2    34 Biología</span></span>
<span id="cb318-4"><a href="#cb318-4" aria-hidden="true"></a><span class="co">#&gt; 2 Hombre   18        0     0 Biología</span></span></code></pre></div>
<ul>
<li>Con un subvector del vector de identificadores de las filas:</li>
</ul>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true"></a>d.f1[<span class="kw">rownames</span>(d.f1)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], ]</span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true"></a><span class="co">#&gt;     Sexo Edad Hermanos Nueva    Grado</span></span>
<span id="cb319-3"><a href="#cb319-3" aria-hidden="true"></a><span class="co">#&gt; 1 Hombre   17        2    34 Biología</span></span>
<span id="cb319-4"><a href="#cb319-4" aria-hidden="true"></a><span class="co">#&gt; 2 Hombre   18        0     0 Biología</span></span></code></pre></div>
<p>Podemos usar este tipo de instrucciones para obtener las filas en un orden diferente del que presentan en el <em>data frame</em> original:</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true"></a>d.f1[<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>), ]</span>
<span id="cb320-2"><a href="#cb320-2" aria-hidden="true"></a><span class="co">#&gt;     Sexo Edad Hermanos Nueva    Grado</span></span>
<span id="cb320-3"><a href="#cb320-3" aria-hidden="true"></a><span class="co">#&gt; 2 Hombre   18        0     0 Biología</span></span>
<span id="cb320-4"><a href="#cb320-4" aria-hidden="true"></a><span class="co">#&gt; 3  Mujer   20        0     0 Biología</span></span>
<span id="cb320-5"><a href="#cb320-5" aria-hidden="true"></a><span class="co">#&gt; 1 Hombre   17        2    34 Biología</span></span></code></pre></div>
<p>También podemos seleccionar filas de un <em>data frame</em> mediante una condición lógica; en este caso, nos quedaremos sólo con los individuos que satisfagan esta condición. Por ejemplo, si queremos seleccionar los estudiantes de <code>d.f1</code> de menos de 19 años, podemos usar la construcción siguiente:</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true"></a>d.f1[d.f1<span class="op">$</span>Edad<span class="op">&lt;</span><span class="dv">19</span>, ]</span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true"></a><span class="co">#&gt;     Sexo Edad Hermanos Nueva    Grado</span></span>
<span id="cb321-3"><a href="#cb321-3" aria-hidden="true"></a><span class="co">#&gt; 1 Hombre   17        2    34 Biología</span></span>
<span id="cb321-4"><a href="#cb321-4" aria-hidden="true"></a><span class="co">#&gt; 2 Hombre   18        0     0 Biología</span></span>
<span id="cb321-5"><a href="#cb321-5" aria-hidden="true"></a><span class="co">#&gt; 4 Hombre   18        1    18 Biología</span></span>
<span id="cb321-6"><a href="#cb321-6" aria-hidden="true"></a><span class="co">#&gt; 5 Hombre   18        1    18 Biología</span></span>
<span id="cb321-7"><a href="#cb321-7" aria-hidden="true"></a><span class="co">#&gt; 6 Hombre   18        1    18 Biología</span></span>
<span id="cb321-8"><a href="#cb321-8" aria-hidden="true"></a><span class="co">#&gt; 8 Hombre   18        1    18 Biología</span></span>
<span id="cb321-9"><a href="#cb321-9" aria-hidden="true"></a><span class="co">#&gt; 9 Hombre   18        2    36 Biología</span></span></code></pre></div>
<p>Esta condición lógica puede involucrar más de una variable. Por ejemplo, para seleccionar las filas correspondientes a los estudiantes de menos de 19 años y con un solo hermano, podríamos entrar:</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true"></a>d.f1[d.f1<span class="op">$</span>Edad<span class="op">&lt;</span><span class="dv">19</span> <span class="op">&amp;</span><span class="st"> </span>d.f1<span class="op">$</span>Hermanos<span class="op">==</span><span class="dv">1</span>, ]</span>
<span id="cb322-2"><a href="#cb322-2" aria-hidden="true"></a><span class="co">#&gt;     Sexo Edad Hermanos Nueva    Grado</span></span>
<span id="cb322-3"><a href="#cb322-3" aria-hidden="true"></a><span class="co">#&gt; 4 Hombre   18        1    18 Biología</span></span>
<span id="cb322-4"><a href="#cb322-4" aria-hidden="true"></a><span class="co">#&gt; 5 Hombre   18        1    18 Biología</span></span>
<span id="cb322-5"><a href="#cb322-5" aria-hidden="true"></a><span class="co">#&gt; 6 Hombre   18        1    18 Biología</span></span>
<span id="cb322-6"><a href="#cb322-6" aria-hidden="true"></a><span class="co">#&gt; 8 Hombre   18        1    18 Biología</span></span></code></pre></div>
<p>En cada caso, hemos obtenido un <em>data frame</em>. Vamos a llamar <code>d.f.18</code> al primero.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true"></a>d.f<span class="fl">.18</span>=d.f1[d.f1<span class="op">$</span>Edad<span class="op">&lt;</span><span class="dv">19</span>, ]</span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true"></a>d.f<span class="fl">.18</span></span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true"></a><span class="co">#&gt;     Sexo Edad Hermanos Nueva    Grado</span></span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true"></a><span class="co">#&gt; 1 Hombre   17        2    34 Biología</span></span>
<span id="cb323-5"><a href="#cb323-5" aria-hidden="true"></a><span class="co">#&gt; 2 Hombre   18        0     0 Biología</span></span>
<span id="cb323-6"><a href="#cb323-6" aria-hidden="true"></a><span class="co">#&gt; 4 Hombre   18        1    18 Biología</span></span>
<span id="cb323-7"><a href="#cb323-7" aria-hidden="true"></a><span class="co">#&gt; 5 Hombre   18        1    18 Biología</span></span>
<span id="cb323-8"><a href="#cb323-8" aria-hidden="true"></a><span class="co">#&gt; 6 Hombre   18        1    18 Biología</span></span>
<span id="cb323-9"><a href="#cb323-9" aria-hidden="true"></a><span class="co">#&gt; 8 Hombre   18        1    18 Biología</span></span>
<span id="cb323-10"><a href="#cb323-10" aria-hidden="true"></a><span class="co">#&gt; 9 Hombre   18        2    36 Biología</span></span>
<span id="cb323-11"><a href="#cb323-11" aria-hidden="true"></a><span class="kw">str</span>(d.f<span class="fl">.18</span>)</span>
<span id="cb323-12"><a href="#cb323-12" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    7 obs. of  5 variables:</span></span>
<span id="cb323-13"><a href="#cb323-13" aria-hidden="true"></a><span class="co">#&gt;  $ Sexo    : chr  &quot;Hombre&quot; &quot;Hombre&quot; &quot;Hombre&quot; &quot;Hombre&quot; ...</span></span>
<span id="cb323-14"><a href="#cb323-14" aria-hidden="true"></a><span class="co">#&gt;  $ Edad    : num  17 18 18 18 18 18 18</span></span>
<span id="cb323-15"><a href="#cb323-15" aria-hidden="true"></a><span class="co">#&gt;  $ Hermanos: num  2 0 1 1 1 1 2</span></span>
<span id="cb323-16"><a href="#cb323-16" aria-hidden="true"></a><span class="co">#&gt;  $ Nueva   : num  34 0 18 18 18 18 36</span></span>
<span id="cb323-17"><a href="#cb323-17" aria-hidden="true"></a><span class="co">#&gt;  $ Grado   : chr  &quot;Biología&quot; &quot;Biología&quot; &quot;Biología&quot; &quot;Biología&quot; ...</span></span></code></pre></div>
<p>Como vemos, las columnas que son factores heredan en estos sub <em>data frames</em> todos los niveles del factor original, aunque no aparezcan en el trozo que hemos extraído. Podemos borrar los niveles sobrantes de todos los factores redefiniendo el <em>data frame</em> como el resultado de aplicarle la función
<code>droplevels</code>.</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true"></a>d.f<span class="fl">.18</span>=<span class="kw">droplevels</span>(d.f<span class="fl">.18</span>)</span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true"></a><span class="kw">str</span>(d.f<span class="fl">.18</span>)</span>
<span id="cb324-3"><a href="#cb324-3" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    7 obs. of  5 variables:</span></span>
<span id="cb324-4"><a href="#cb324-4" aria-hidden="true"></a><span class="co">#&gt;  $ Sexo    : chr  &quot;Hombre&quot; &quot;Hombre&quot; &quot;Hombre&quot; &quot;Hombre&quot; ...</span></span>
<span id="cb324-5"><a href="#cb324-5" aria-hidden="true"></a><span class="co">#&gt;  $ Edad    : num  17 18 18 18 18 18 18</span></span>
<span id="cb324-6"><a href="#cb324-6" aria-hidden="true"></a><span class="co">#&gt;  $ Hermanos: num  2 0 1 1 1 1 2</span></span>
<span id="cb324-7"><a href="#cb324-7" aria-hidden="true"></a><span class="co">#&gt;  $ Nueva   : num  34 0 18 18 18 18 36</span></span>
<span id="cb324-8"><a href="#cb324-8" aria-hidden="true"></a><span class="co">#&gt;  $ Grado   : chr  &quot;Biología&quot; &quot;Biología&quot; &quot;Biología&quot; &quot;Biología&quot; ...</span></span></code></pre></div>
<p>Naturalmente, el mismo tipo de construcción se puede utilizar para definir un <em>data frame</em> formado sólo por algunas variables de la tabla original, o incluso por sólo algunas filas y columnas. Si sólo queremos definir la subtabla quedándonos con algunas variables, basta aplicar el nombre del <em>data frame</em> al vector de variables entre corchetes. Contrariamente a lo que pasa con las matrices, en los <em>data frames</em> no hay necesidad de dejar el espacio en blanco seguido de una coma que serviría para indicar que nos referimos a columnas y no a filas. Por ejemplo, con las cuatro instrucciones siguientes obtenemos cada vez el mismo resultado, un <em>data frame</em> formado por las dos primeras variables de <code>d.f1</code>:</p>
<ul>
<li>Con la coma:</li>
</ul>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true"></a>d.f1[ ,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]</span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true"></a><span class="co">#&gt;     Sexo Edad</span></span>
<span id="cb325-3"><a href="#cb325-3" aria-hidden="true"></a><span class="co">#&gt; 1 Hombre   17</span></span>
<span id="cb325-4"><a href="#cb325-4" aria-hidden="true"></a><span class="co">#&gt; 2 Hombre   18</span></span>
<span id="cb325-5"><a href="#cb325-5" aria-hidden="true"></a><span class="co">#&gt; 3  Mujer   20</span></span>
<span id="cb325-6"><a href="#cb325-6" aria-hidden="true"></a><span class="co">#&gt; 4 Hombre   18</span></span>
<span id="cb325-7"><a href="#cb325-7" aria-hidden="true"></a><span class="co">#&gt; 5 Hombre   18</span></span>
<span id="cb325-8"><a href="#cb325-8" aria-hidden="true"></a><span class="co">#&gt; 6 Hombre   18</span></span>
<span id="cb325-9"><a href="#cb325-9" aria-hidden="true"></a><span class="co">#&gt; 7  Mujer   19</span></span>
<span id="cb325-10"><a href="#cb325-10" aria-hidden="true"></a><span class="co">#&gt; 8 Hombre   18</span></span>
<span id="cb325-11"><a href="#cb325-11" aria-hidden="true"></a><span class="co">#&gt; 9 Hombre   18</span></span></code></pre></div>
<ul>
<li>Sin la coma</li>
</ul>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true"></a>d.f1[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]</span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true"></a><span class="co">#&gt;     Sexo Edad</span></span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true"></a><span class="co">#&gt; 1 Hombre   17</span></span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true"></a><span class="co">#&gt; 2 Hombre   18</span></span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true"></a><span class="co">#&gt; 3  Mujer   20</span></span>
<span id="cb326-6"><a href="#cb326-6" aria-hidden="true"></a><span class="co">#&gt; 4 Hombre   18</span></span>
<span id="cb326-7"><a href="#cb326-7" aria-hidden="true"></a><span class="co">#&gt; 5 Hombre   18</span></span>
<span id="cb326-8"><a href="#cb326-8" aria-hidden="true"></a><span class="co">#&gt; 6 Hombre   18</span></span>
<span id="cb326-9"><a href="#cb326-9" aria-hidden="true"></a><span class="co">#&gt; 7  Mujer   19</span></span>
<span id="cb326-10"><a href="#cb326-10" aria-hidden="true"></a><span class="co">#&gt; 8 Hombre   18</span></span>
<span id="cb326-11"><a href="#cb326-11" aria-hidden="true"></a><span class="co">#&gt; 9 Hombre   18</span></span></code></pre></div>
<ul>
<li>Eliminando las tres últimas columnas:</li>
</ul>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true"></a>d.f1[<span class="op">-</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">5</span>)]</span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true"></a><span class="co">#&gt;     Sexo Edad</span></span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true"></a><span class="co">#&gt; 1 Hombre   17</span></span>
<span id="cb327-4"><a href="#cb327-4" aria-hidden="true"></a><span class="co">#&gt; 2 Hombre   18</span></span>
<span id="cb327-5"><a href="#cb327-5" aria-hidden="true"></a><span class="co">#&gt; 3  Mujer   20</span></span>
<span id="cb327-6"><a href="#cb327-6" aria-hidden="true"></a><span class="co">#&gt; 4 Hombre   18</span></span>
<span id="cb327-7"><a href="#cb327-7" aria-hidden="true"></a><span class="co">#&gt; 5 Hombre   18</span></span>
<span id="cb327-8"><a href="#cb327-8" aria-hidden="true"></a><span class="co">#&gt; 6 Hombre   18</span></span>
<span id="cb327-9"><a href="#cb327-9" aria-hidden="true"></a><span class="co">#&gt; 7  Mujer   19</span></span>
<span id="cb327-10"><a href="#cb327-10" aria-hidden="true"></a><span class="co">#&gt; 8 Hombre   18</span></span>
<span id="cb327-11"><a href="#cb327-11" aria-hidden="true"></a><span class="co">#&gt; 9 Hombre   18</span></span></code></pre></div>
<ul>
<li>Usando los nombres de las variables:</li>
</ul>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true"></a>d.f1[<span class="kw">c</span>(<span class="st">&quot;Sexo&quot;</span>,<span class="st">&quot;Edad&quot;</span>)]</span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true"></a><span class="co">#&gt;     Sexo Edad</span></span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true"></a><span class="co">#&gt; 1 Hombre   17</span></span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true"></a><span class="co">#&gt; 2 Hombre   18</span></span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true"></a><span class="co">#&gt; 3  Mujer   20</span></span>
<span id="cb328-6"><a href="#cb328-6" aria-hidden="true"></a><span class="co">#&gt; 4 Hombre   18</span></span>
<span id="cb328-7"><a href="#cb328-7" aria-hidden="true"></a><span class="co">#&gt; 5 Hombre   18</span></span>
<span id="cb328-8"><a href="#cb328-8" aria-hidden="true"></a><span class="co">#&gt; 6 Hombre   18</span></span>
<span id="cb328-9"><a href="#cb328-9" aria-hidden="true"></a><span class="co">#&gt; 7  Mujer   19</span></span>
<span id="cb328-10"><a href="#cb328-10" aria-hidden="true"></a><span class="co">#&gt; 8 Hombre   18</span></span>
<span id="cb328-11"><a href="#cb328-11" aria-hidden="true"></a><span class="co">#&gt; 9 Hombre   18</span></span></code></pre></div>
<p>Esta construcción se puede usar también para reordenar las columnas de un <em>data frame</em>; por ejemplo:</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true"></a>d.f1=d.f1[<span class="kw">c</span>(<span class="st">&quot;Edad&quot;</span>,<span class="st">&quot;Hermanos&quot;</span>,<span class="st">&quot;Sexo&quot;</span>)]</span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true"></a>d.f1</span>
<span id="cb329-3"><a href="#cb329-3" aria-hidden="true"></a><span class="co">#&gt;   Edad Hermanos   Sexo</span></span>
<span id="cb329-4"><a href="#cb329-4" aria-hidden="true"></a><span class="co">#&gt; 1   17        2 Hombre</span></span>
<span id="cb329-5"><a href="#cb329-5" aria-hidden="true"></a><span class="co">#&gt; 2   18        0 Hombre</span></span>
<span id="cb329-6"><a href="#cb329-6" aria-hidden="true"></a><span class="co">#&gt; 3   20        0  Mujer</span></span>
<span id="cb329-7"><a href="#cb329-7" aria-hidden="true"></a><span class="co">#&gt; 4   18        1 Hombre</span></span>
<span id="cb329-8"><a href="#cb329-8" aria-hidden="true"></a><span class="co">#&gt; 5   18        1 Hombre</span></span>
<span id="cb329-9"><a href="#cb329-9" aria-hidden="true"></a><span class="co">#&gt; 6   18        1 Hombre</span></span>
<span id="cb329-10"><a href="#cb329-10" aria-hidden="true"></a><span class="co">#&gt; 7   19        0  Mujer</span></span>
<span id="cb329-11"><a href="#cb329-11" aria-hidden="true"></a><span class="co">#&gt; 8   18        1 Hombre</span></span>
<span id="cb329-12"><a href="#cb329-12" aria-hidden="true"></a><span class="co">#&gt; 9   18        2 Hombre</span></span></code></pre></div>
<p>El paquete <code>dplyr</code> incluye la función <code>select</code> que amplía las posibilidades para especificar las variables que queremos extraer de un <em>data frame</em>; por ejemplo:</p>
<ul>
<li><code>select(data frame, starts_with("x"))</code> extrae del <em>data frame</em> las variables cuyo nombre empieza con la palabra <code>x</code>.</li>
<li><code>select(data frame, ends_with("x"))</code> extrae del <em>data frame</em> las variables cuyo nombre termina con la palabra <code>x</code>.</li>
<li><code>select(data frame, contains("x"))</code> extrae del <em>data frame</em> las variables cuyo nombre contiene en algún sitio la palabra <code>x</code>.</li>
</ul>
<p>Veamos algunos ejemplos:</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true"></a>iris_Petal=<span class="kw">select</span>(iris, <span class="kw">starts_with</span>(<span class="st">&quot;Petal&quot;</span>)) </span>
<span id="cb330-3"><a href="#cb330-3" aria-hidden="true"></a><span class="kw">head</span>(iris_Petal, <span class="dv">4</span>)</span>
<span id="cb330-4"><a href="#cb330-4" aria-hidden="true"></a><span class="co">#&gt;   Petal.Length Petal.Width</span></span>
<span id="cb330-5"><a href="#cb330-5" aria-hidden="true"></a><span class="co">#&gt; 1          1.4         0.2</span></span>
<span id="cb330-6"><a href="#cb330-6" aria-hidden="true"></a><span class="co">#&gt; 2          1.4         0.2</span></span>
<span id="cb330-7"><a href="#cb330-7" aria-hidden="true"></a><span class="co">#&gt; 3          1.3         0.2</span></span>
<span id="cb330-8"><a href="#cb330-8" aria-hidden="true"></a><span class="co">#&gt; 4          1.5         0.2</span></span>
<span id="cb330-9"><a href="#cb330-9" aria-hidden="true"></a>iris_Length=<span class="kw">select</span>(iris, <span class="kw">ends_with</span>(<span class="st">&quot;Length&quot;</span>))</span>
<span id="cb330-10"><a href="#cb330-10" aria-hidden="true"></a><span class="kw">head</span>(iris_Length, <span class="dv">4</span>)</span>
<span id="cb330-11"><a href="#cb330-11" aria-hidden="true"></a><span class="co">#&gt;   Sepal.Length Petal.Length</span></span>
<span id="cb330-12"><a href="#cb330-12" aria-hidden="true"></a><span class="co">#&gt; 1          5.1          1.4</span></span>
<span id="cb330-13"><a href="#cb330-13" aria-hidden="true"></a><span class="co">#&gt; 2          4.9          1.4</span></span>
<span id="cb330-14"><a href="#cb330-14" aria-hidden="true"></a><span class="co">#&gt; 3          4.7          1.3</span></span>
<span id="cb330-15"><a href="#cb330-15" aria-hidden="true"></a><span class="co">#&gt; 4          4.6          1.5</span></span></code></pre></div>
<p>Para más información sobre otras habilidades de la función <code>select</code>, podéis consultar su Ayuda.</p>
<p>Como podéis constatar, hay muchas maneras de extraer una misma subtabla de un <em>data frame</em> dado; veamos una última posibilidad, usando la función <code>subset</code>. La instrucción</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true"></a><span class="kw">subset</span>(data frame, condición, <span class="dt">select=</span>columnas)</span></code></pre></div>
<p>extrae del <em>data frame</em> las filas que cumplen la <code>condición</code> y las columnas especificadas en el <code>select</code>; si queremos todas las filas, no hay que especificar ninguna condición, y si queremos todas las columnas, no hace falta especificar el parámetro <code>select</code>.</p>
<p>Así, si del <em>data frame</em> <code>iris</code> queremos extraer un <em>data frame</em> formado sólo por las variables numéricas de las plantas de especie <code>virginica</code>, podemos usar la instrucción siguiente:</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true"></a>iris.vir=<span class="kw">subset</span>(iris, Species<span class="op">==</span><span class="st">&quot;virginica&quot;</span>, <span class="dt">select=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true"></a><span class="kw">head</span>(iris.vir, <span class="dv">5</span>)</span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true"></a><span class="co">#&gt;     Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true"></a><span class="co">#&gt; 101          6.3         3.3          6.0         2.5</span></span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true"></a><span class="co">#&gt; 102          5.8         2.7          5.1         1.9</span></span>
<span id="cb332-6"><a href="#cb332-6" aria-hidden="true"></a><span class="co">#&gt; 103          7.1         3.0          5.9         2.1</span></span>
<span id="cb332-7"><a href="#cb332-7" aria-hidden="true"></a><span class="co">#&gt; 104          6.3         2.9          5.6         1.8</span></span>
<span id="cb332-8"><a href="#cb332-8" aria-hidden="true"></a><span class="co">#&gt; 105          6.5         3.0          5.8         2.2</span></span></code></pre></div>
<p>Fijaos en que las variables en la condición que usamos para seleccionar las filas se especifican con su nombre, sin añadir antes el nombre del <em>data frame</em></p>
<p>Las filas de este <em>data frame</em> han heredado los identificadores del <em>data frame</em> <code>iris</code>. Si esto nos molesta, los podemos cambiar.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true"></a><span class="kw">rownames</span>(iris.vir)=<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(<span class="kw">rownames</span>(iris.vir))</span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true"></a><span class="kw">head</span>(iris.vir, <span class="dv">5</span>)</span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true"></a><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width</span></span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true"></a><span class="co">#&gt; 1          6.3         3.3          6.0         2.5</span></span>
<span id="cb333-5"><a href="#cb333-5" aria-hidden="true"></a><span class="co">#&gt; 2          5.8         2.7          5.1         1.9</span></span>
<span id="cb333-6"><a href="#cb333-6" aria-hidden="true"></a><span class="co">#&gt; 3          7.1         3.0          5.9         2.1</span></span>
<span id="cb333-7"><a href="#cb333-7" aria-hidden="true"></a><span class="co">#&gt; 4          6.3         2.9          5.6         1.8</span></span>
<span id="cb333-8"><a href="#cb333-8" aria-hidden="true"></a><span class="co">#&gt; 5          6.5         3.0          5.8         2.2</span></span></code></pre></div>
</div>
<div id="cómo-aplicar-una-función-a-las-variables-de-un-data-frame" class="section level2" number="6.7">
<h2 number="6.7"><span class="header-section-number">6.7</span> Cómo aplicar una función a las variables de un <em>data frame</em></h2>
<p>La mejor manera de aplicar una función a todas las columnas de un <em>data frame</em> en un solo paso es por medio de la instrucción</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true"></a><span class="kw">sapply</span>(data frame, <span class="dt">FUN=</span>función)</span></code></pre></div>
<p>A modo de ejemplo, vamos a aplicar algunas funciones a las columnas numéricas del <em>data frame</em> <code>iris</code>:</p>
<ul>
<li>Para calcular las medias de sus variables numéricas:</li>
</ul>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true"></a><span class="kw">sapply</span>(iris[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">FUN=</span>mean)</span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true"></a><span class="co">#&gt; Sepal.Length  Sepal.Width Petal.Length  Petal.Width </span></span>
<span id="cb335-3"><a href="#cb335-3" aria-hidden="true"></a><span class="co">#&gt;     5.843333     3.057333     3.758000     1.199333</span></span></code></pre></div>
<ul>
<li>Para calcular las sumas de sus variables numéricas</li>
</ul>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true"></a><span class="kw">sapply</span>(iris[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">FUN=</span>sum) </span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true"></a><span class="co">#&gt; Sepal.Length  Sepal.Width Petal.Length  Petal.Width </span></span>
<span id="cb336-3"><a href="#cb336-3" aria-hidden="true"></a><span class="co">#&gt;        876.5        458.6        563.7        179.9</span></span></code></pre></div>
<ul>
<li>Para calcular las normas euclídeas de sus variables numéricas</li>
</ul>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true"></a>f=<span class="cf">function</span>(x){<span class="kw">sqrt</span>(<span class="kw">sum</span>(x<span class="op">^</span><span class="dv">2</span>))} </span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true"></a><span class="kw">sapply</span>(iris[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">FUN=</span>f) </span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true"></a><span class="co">#&gt; Sepal.Length  Sepal.Width Petal.Length  Petal.Width </span></span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true"></a><span class="co">#&gt;     72.27621     37.82063     50.82037     17.38764</span></span></code></pre></div>
<p>Es conveniente añadir en el argumento de <code>sapply</code> el parámetro <code>na.rm=TRUE</code>, sin el cual el valor que devolverá la función para las columnas que contengan algún <code>NA</code> será <code>NA</code>. Veamos un ejemplo:</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true"></a>D=<span class="kw">data.frame</span>(<span class="dt">V1=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="ot">NA</span>,<span class="dv">3</span>), <span class="dt">V2=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="ot">NA</span>))</span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true"></a>D</span>
<span id="cb338-3"><a href="#cb338-3" aria-hidden="true"></a><span class="co">#&gt;   V1 V2</span></span>
<span id="cb338-4"><a href="#cb338-4" aria-hidden="true"></a><span class="co">#&gt; 1  1  2</span></span>
<span id="cb338-5"><a href="#cb338-5" aria-hidden="true"></a><span class="co">#&gt; 2  2  5</span></span>
<span id="cb338-6"><a href="#cb338-6" aria-hidden="true"></a><span class="co">#&gt; 3 NA  2</span></span>
<span id="cb338-7"><a href="#cb338-7" aria-hidden="true"></a><span class="co">#&gt; 4  3 NA</span></span>
<span id="cb338-8"><a href="#cb338-8" aria-hidden="true"></a><span class="kw">sapply</span>(D, <span class="dt">FUN=</span>mean)</span>
<span id="cb338-9"><a href="#cb338-9" aria-hidden="true"></a><span class="co">#&gt; V1 V2 </span></span>
<span id="cb338-10"><a href="#cb338-10" aria-hidden="true"></a><span class="co">#&gt; NA NA</span></span>
<span id="cb338-11"><a href="#cb338-11" aria-hidden="true"></a><span class="kw">sapply</span>(D, <span class="dt">FUN=</span>mean, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</span>
<span id="cb338-12"><a href="#cb338-12" aria-hidden="true"></a><span class="co">#&gt; V1 V2 </span></span>
<span id="cb338-13"><a href="#cb338-13" aria-hidden="true"></a><span class="co">#&gt;  2  3</span></span></code></pre></div>
<p>A menudo querremos aplicar una función a variables de un <em>data frame</em> clasificadas por los niveles de un, o más de un, factor; esto se puede hacer con la instrucción <code>aggregate</code>, cuya sintaxis básica es</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true"></a><span class="kw">aggregate</span>(<span class="kw">variable</span>(s)<span class="op">~</span><span class="kw">factor</span>(es), <span class="dt">data=</span>data frame, <span class="dt">FUN=</span>función)</span></code></pre></div>
<p>El resultado será un <em>data frame</em></p>
<p>Por ejemplo, si queremos calcular las medias de las longitudes de los pétalos de las flores de cada una de las tres especies representadas en la tabla <code>iris</code>, podemos entrar la instrucción siguiente:</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true"></a><span class="kw">aggregate</span>(Petal.Length<span class="op">~</span>Species, <span class="dt">data=</span>iris, <span class="dt">FUN=</span>mean, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true"></a><span class="co">#&gt;      Species Petal.Length</span></span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true"></a><span class="co">#&gt; 1     setosa        1.462</span></span>
<span id="cb340-4"><a href="#cb340-4" aria-hidden="true"></a><span class="co">#&gt; 2 versicolor        4.260</span></span>
<span id="cb340-5"><a href="#cb340-5" aria-hidden="true"></a><span class="co">#&gt; 3  virginica        5.552</span></span></code></pre></div>
<p>Hemos añadido <code>na.rm=TRUE</code> dentro del <code>aggregate</code> para que no tenga en cuenta los <code>NA</code> al calcular la media, por si acaso. Observad que el resultado es un <em>data frame</em> con variables <code>Species</code> y <code>Petal.Length</code>. Cada fila corresponde a un nivel del factor <code>Species</code>.</p>
<p>Si queremos aplicar la función a más de una variable, tenemos que agruparlas a la izquierda de la tilde con <code>cbind</code>.</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true"></a><span class="kw">aggregate</span>(<span class="kw">cbind</span>(Petal.Length, Petal.Width)<span class="op">~</span>Species, <span class="dt">data=</span>iris, <span class="dt">FUN=</span>mean)</span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true"></a><span class="co">#&gt;      Species Petal.Length Petal.Width</span></span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true"></a><span class="co">#&gt; 1     setosa        1.462       0.246</span></span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true"></a><span class="co">#&gt; 2 versicolor        4.260       1.326</span></span>
<span id="cb341-5"><a href="#cb341-5" aria-hidden="true"></a><span class="co">#&gt; 3  virginica        5.552       2.026</span></span></code></pre></div>
<p>Si queremos separar las variables mediante más de un factor, tenemos que agruparlos a la derecha de la tilde con signos de suma, <code>+</code>. Veamos un ejemplo. El paquete <strong>alr4</strong> contiene la tabla de datos <code>Rateprof</code>, con los resultados globales de la evaluación de un grupo de profesores universitarios por parte de sus estudiantes. Algunas de sus variables son: <code>gender</code>, el sexo del profesor; <code>pepper</code>, que indica si en las encuestas se le ha considerado mayoritariamente atractivo o no; y <code>clarity</code> y <code>easiness</code>, que valoran, entre 1 y 5, la claridad de exposición y la accesibilidad del profesor, respectivamente. Vamos a calcular las medias de estas dos últimas variables agrupándolas por sexo y atractivo.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true"></a><span class="kw">library</span>(alr4)</span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true"></a><span class="kw">aggregate</span>(<span class="kw">cbind</span>(clarity,easiness)<span class="op">~</span>gender<span class="op">+</span>pepper, <span class="dt">data=</span>Rateprof, <span class="dt">FUN=</span>mean)</span>
<span id="cb342-3"><a href="#cb342-3" aria-hidden="true"></a><span class="co">#&gt;   gender pepper  clarity easiness</span></span>
<span id="cb342-4"><a href="#cb342-4" aria-hidden="true"></a><span class="co">#&gt; 1 female     no 3.341391 3.147606</span></span>
<span id="cb342-5"><a href="#cb342-5" aria-hidden="true"></a><span class="co">#&gt; 2   male     no 3.451456 2.999056</span></span>
<span id="cb342-6"><a href="#cb342-6" aria-hidden="true"></a><span class="co">#&gt; 3 female    yes 4.345082 3.599128</span></span>
<span id="cb342-7"><a href="#cb342-7" aria-hidden="true"></a><span class="co">#&gt; 4   male    yes 4.371824 3.689741</span></span></code></pre></div>
<p>Observamos que tanto la claridad como la accesibilidad medias de los profesores atractivos de ambos sexos son considerablemente mayores que las de sus colegas considerados no atractivos. Además, en promedio, se considera a los profesores no atractivos menos accesibles que a las profesoras no atractivas, y a los profesores atractivos <em>más</em> accesibles que a las profesoras atractivas.</p>
</div>
<div id="sub:attach" class="section level2" number="6.8">
<h2 number="6.8"><span class="header-section-number">6.8</span> Cómo añadir las variables de un <em>data frame</em> al entorno global</h2>
<p>Hasta ahora, cada vez que queríamos referirnos a una variable de un <em>data frame</em>, teníamos que escribir el nombre del <em>data frame</em> seguido de <code>$</code> y el nombre de la variable. Aplicando <code>attach</code> a un <em>data frame</em>, hacemos que R entienda sus variables como globales y que las podamos usar por su nombre, sin necesidad de añadir delante el nombre del <em>data frame</em> y el signo <code>$</code>; esto puede ser útil para no tener que escribir mucho.</p>
<p>A modo de ejemplo, vamos a añadir las variables del <em>data frame</em> <code>iris</code> al entorno global de R. Comprobemos en primer lugar que no tenemos definida ninguna variable llamada <code>Petal.Length</code>:</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true"></a>Petal.Length</span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;Petal.Length&#39; no encontrado</span></span></code></pre></div>
<p>Ahora sí que la habrá:</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true"></a><span class="kw">attach</span>(iris)</span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true"></a>Petal.Length[<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>]</span>
<span id="cb344-3"><a href="#cb344-3" aria-hidden="true"></a><span class="co">#&gt;  [1] 1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 1.5 1.6 1.4 1.1 1.2 1.5 1.3 1.4 1.7</span></span>
<span id="cb344-4"><a href="#cb344-4" aria-hidden="true"></a><span class="co">#&gt; [20] 1.5 1.7 1.5 1.0 1.7 1.9 1.6 1.6 1.5 1.4 1.6</span></span></code></pre></div>
<p>Si ya hubiera existido una variable definida con el mismo nombre que una variable del <em>data frame</em> al que aplicamos <code>attach</code>, hubiéramos obtenido un mensaje de error al ejecutar esta función, y no se hubiera reescrito la variable global original.</p>
<p>La función <code>detach</code> devuelve la situación original, eliminando del entorno global las variables del <em>data frame</em>.</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true"></a><span class="kw">detach</span>(iris)</span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true"></a>Petal.Length</span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;Petal.Length&#39; no encontrado</span></span></code></pre></div>
<!--

## <<*Big data*>> *frames* con `data.table` (opcional).

 Aunque  la manera usual de trabajar en R con  tablas de datos es en forma de *data frame*,  
su estructura interna los hace poco eficientes a la hora de manejar las tablas de datos de millones de entradas que empiezan a ser habituales en estos tiempos de proyectos *big data*.
Una solución es usar la clase de objetos para definir tablas de datos que incorpora el paquete  `data.table`; para distinguirlos de los *data frame*,  llamaremos a estos objetos *data tables*. 

Un *data table* vendría a ser un *data frame* enriquecido, con la particularidad de que sus filas no tienen   identificadores; en particular  se pueden usar con ellos todas las construcciones y funciones para *data frames*, pero esto no es lo recomendable, puesto que entonces no se gana nada usándolos. Los *data tables* ofrecen unas construcciones específicas para extraer subtablas, añadir, borrar o modificar variables, y aplicar operaciones a variables, que son mucho más eficientes que las propias de los  *data frames* ; su sintaxis es muy diferente de la usada en matrices o *data frames*, pero vale la pena <<cambiar el chip>> si necesitáis trabajar con tablas realmente grandes.

Se puede crear un  *data table* de varias maneras:

* Aplicando la función  `data.table` a un conjunto de vectores, exactamente igual como si usáramos `data.frame`.
* Aplicando la función  `data.table` a un *data frame* Como hemos comentado, las filas de los *data tables* no tienen identificadores; si las del *data frame*  tenían identificadores que no fueran números correlativos, se copian como una variable extra llamada `rn` (de *rownames*).


* Importando un fichero externo con la función  `fread`, exactamente igual  como si usáramos `read.table`.
Algunas ventajas de `fread` son que detecta automáticamente los separadores de columnas y si el fichero contiene o no una primera fila con los nombres de las variables, aunque su ventaja principal es la rapidez: tablas de varios Gb, que con `read.table` tardan varias  horas en importarse, con  `fread` tardan pocos minutos. Es importante tener en cuenta que, al contrario que `read.table`, la función  `fread` importa por defecto las columnas de palabras como tales, y no como factores: esto se puede cambiar añadiendo `stringsAsFactors=TRUE`. 

Vamos a crear  un *data table* para ilustrar su manejo básico.

```r
#Instalamos y cargamos el paquete "data.table"
#...
library(data.table)
Letras=c("A","B","A","A","B","A","C","C","A","A")
Var1=c(3,7,5,9,3,6,5,2,4,9)
Var2=c(2.3,5.2,6.4,-2.2,1.6,7.1,3.2,-3.5,-2.7,1.8)
Var3=c(6.8,6.4,5.5,6.2,5.3,7.8,6.3,6.3,6.3,7.5)
DT=data.table(Letras,Var1,Var2,Var3)
DT
#>     Letras Var1 Var2 Var3
#>  1:      A    3  2.3  6.8
#>  2:      B    7  5.2  6.4
#>  3:      A    5  6.4  5.5
#>  4:      A    9 -2.2  6.2
#>  5:      B    3  1.6  5.3
#>  6:      A    6  7.1  7.8
#>  7:      C    5  3.2  6.3
#>  8:      C    2 -3.5  6.3
#>  9:      A    4 -2.7  6.3
#> 10:      A    9  1.8  7.5
str(DT)
#> Classes 'data.table' and 'data.frame':   10 obs. of  4 variables:
#>  $ Letras: chr  "A" "B" "A" "A" ...
#>  $ Var1  : num  3 7 5 9 3 6 5 2 4 9
#>  $ Var2  : num  2.3 5.2 6.4 -2.2 1.6 7.1 3.2 -3.5 -2.7 1.8
#>  $ Var3  : num  6.8 6.4 5.5 6.2 5.3 7.8 6.3 6.3 6.3 7.5
#>  - attr(*, ".internal.selfref")=<externalptr>
```


Una de las operaciones específicas más útiles para  *data tables* es la creación de índices (*keys*) a partir de una o varias variables; estos índices sirven para identificar las filas y agilizan las búsquedas y extracciones de filas. La manera de indexar un   *data table* es mediante la instrucción

`setkey(`*data table*`, `*variable1*`, `*variable2*`, ...)`.

El resultado visible de esta instrucción es que R reordena las filas del *data table* en orden creciente de la *variable1* y, en caso de empate, de la *variable2*, y así sucesivamente; las variables se han de entrar  con su nombre sin entrecomillar. Fijaos también en que `no igualamos`  el *data table* al resultado de `setkey`, simplemente le aplicamos esta función.


```r
setkey(DT,Letras,Var3)
DT
#>     Letras Var1 Var2 Var3
#>  1:      A    5  6.4  5.5
#>  2:      A    9 -2.2  6.2
#>  3:      A    4 -2.7  6.3
#>  4:      A    3  2.3  6.8
#>  5:      A    9  1.8  7.5
#>  6:      A    6  7.1  7.8
#>  7:      B    3  1.6  5.3
#>  8:      B    7  5.2  6.4
#>  9:      C    5  3.2  6.3
#> 10:      C    2 -3.5  6.3
```
Vemos que las filas se han ordenado según su entrada en la variable `Letras` y, en los empates,  según su entrada en `Var3`. A partir de ahora, las búsquedas de filas con valores concretos en estas variables se realizaría mediante búsqueda binaria usando esta ordenación. Este método es mucho más eficiente que el  que usaría un *data frame* : visitaría toda la primera variable y generaría un vector de valores lógicos que indicara, para cada entrada, si cumple o no la condición;  visitaría toda la segunda variable y generaría un segundo vector de valores lógicos que indicara, para cada entrada, si cumple o no la condición; generaría un tercer vector que tuviera un `TRUE` en aquellas entradas que lo tuvieran en cada uno de los vectores anteriores; finalmente, daría las filas correspondientes a los `TRUE` en este último vector.

Una vez hemos indexado un *data table*, podemos usar las variables que hemos definido como índices para extraer filas. La conjunción de varias condiciones se indica con la función `J`; veamos varios ejemplos, observad la sintaxis:


```r
DT["B"]   #Filas con una B en Letras
#>    Letras Var1 Var2 Var3
#> 1:      B    3  1.6  5.3
#> 2:      B    7  5.2  6.4
DT[c("B","C")]  #Filas con una B o una C en Letras
#>    Letras Var1 Var2 Var3
#> 1:      B    3  1.6  5.3
#> 2:      B    7  5.2  6.4
#> 3:      C    5  3.2  6.3
#> 4:      C    2 -3.5  6.3
DT[Letras>"A"]  #Filas con entrada mayor que A en Letras
#>    Letras Var1 Var2 Var3
#> 1:      B    3  1.6  5.3
#> 2:      B    7  5.2  6.4
#> 3:      C    5  3.2  6.3
#> 4:      C    2 -3.5  6.3
DT[J("A",c(6.2,6.3))]  #Filas con A en Letras y 6.2 o 6.3 en Var3
#>    Letras Var1 Var2 Var3
#> 1:      A    9 -2.2  6.2
#> 2:      A    4 -2.7  6.3
```


La construcción `[\ ]` en los  *data tables* tiene un significado, y, por lo tanto, un uso diferente que en los *data frames* ; en general, el argumento dentro de los corchetes aplicados a un *data table* tiene tres partes, separadas por comas:

* La primera indica las filas, como ya hemos visto. Normalmente, para que el proceso sea eficiente, impondremos condiciones sobre las filas usando las variables definidas para indexar la tabla. Si dejamos esta posición vacía, se toman todas las filas.

* La segunda parte indica columnas, o, más en general, expresiones aplicadas a columnas, incluyendo operaciones u otro tipo de funciones: `plot`, `lm`\ldots\ Podemos usar los nombres de las variables, sin entrecomillar, o su número de orden: en este último caso, se ha de añadir `with=FALSE` en la tercera posición.
Si queremos extraer varias columnas de un  *data table* o efectuar varias operaciones, hay que especificarlas en esta segunda posición dentro de una  `list`. Si queremos sólo la primera o la última fila de una subtabla, se ha de especificar en esta segunda posición con \verb?mult="first"? o \verb?mult="last"?, respectivamente.

* La tercera precisa la expresión en la segunda posición: por ejemplo, si se ha de aplicar agrupando los datos (con el parámetro `by`) o cómo se han indicado las variables (con el parámetro `with`). Si queremos agrupar según una combinación de variables, tenemos que especificarlas en esta tercera posición dentro de una  `list`.

En resumen,

`DT[X, Y, by=Z]`

equivale a: <<En el *data table* `DT`, extrae las filas `X` y ejecuta  `Y` sobre sus columnas agrupando las filas según `Z`>>.


Veamos varios ejemplos:


```r
DT[ ,Var1]  #El contenido de Var1
#>  [1] 5 9 4 3 9 6 3 7 5 2
DT[ ,2]  #Esto no es la segunda variable
#>     Var1
#>  1:    5
#>  2:    9
#>  3:    4
#>  4:    3
#>  5:    9
#>  6:    6
#>  7:    3
#>  8:    7
#>  9:    5
#> 10:    2
DT[ ,2,with=FALSE] #Esto sí
#>     Var1
#>  1:    5
#>  2:    9
#>  3:    4
#>  4:    3
#>  5:    9
#>  6:    6
#>  7:    3
#>  8:    7
#>  9:    5
#> 10:    2
DT[ ,list(Var1,Var2)]  #Un data table con las variables Var1 y Var2
#>     Var1 Var2
#>  1:    5  6.4
#>  2:    9 -2.2
#>  3:    4 -2.7
#>  4:    3  2.3
#>  5:    9  1.8
#>  6:    6  7.1
#>  7:    3  1.6
#>  8:    7  5.2
#>  9:    5  3.2
#> 10:    2 -3.5
DT["A",mult="first"] #La primera fila con A en Letras
#>    Letras Var1 Var2 Var3
#> 1:      A    5  6.4  5.5
DT["A",mult="last"] #La última fila con A en Letras
#>    Letras Var1 Var2 Var3
#> 1:      A    6  7.1  7.8
DT["A",sum(Var1)]  #Suma de Var1 de las filas con una A en Letras
#> [1] 36
DT[ ,sum(Var1),by=Letras]  #Suma de Var1 agrupando según el valor de Letras
#>    Letras V1
#> 1:      A 36
#> 2:      B 10
#> 3:      C  7
DT[ ,list(sumas1=sum(Var1),medias1=mean(Var2)), 
  by=list(Letras,Var3)] #Suma de Var1 y media de Var2, agrupando según Letras y Var3
#>    Letras Var3 sumas1 medias1
#> 1:      A  5.5      5    6.40
#> 2:      A  6.2      9   -2.20
#> 3:      A  6.3      4   -2.70
#> 4:      A  6.8      3    2.30
#> 5:      A  7.5      9    1.80
#> 6:      A  7.8      6    7.10
#> 7:      B  5.3      3    1.60
#> 8:      B  6.4      7    5.20
#> 9:      C  6.3      7   -0.15
```
Para más ejemplos, consultad `example(data.table)`.

Para modificar una variable, o añadir una variable, podemos usar la construcción

`nombre` `:=``valor` 

en la segunda posición dentro de los corchetes; esta construcción sirve también para eliminar una variable, igualándola a `NULL`.

```r
DT[ ,Var4:=2*Var1+Var2]  #Añadimos esta nueva columna Var4
DT
#>     Letras Var1 Var2 Var3 Var4
#>  1:      A    5  6.4  5.5 16.4
#>  2:      A    9 -2.2  6.2 15.8
#>  3:      A    4 -2.7  6.3  5.3
#>  4:      A    3  2.3  6.8  8.3
#>  5:      A    9  1.8  7.5 19.8
#>  6:      A    6  7.1  7.8 19.1
#>  7:      B    3  1.6  5.3  7.6
#>  8:      B    7  5.2  6.4 19.2
#>  9:      C    5  3.2  6.3 13.2
#> 10:      C    2 -3.5  6.3  0.5
DT["A",Var5:=3*Var4]   #Añadimos esta nueva columna Var5, sólo en las filas con una A en Letras
DT
#>     Letras Var1 Var2 Var3 Var4 Var5
#>  1:      A    5  6.4  5.5 16.4 49.2
#>  2:      A    9 -2.2  6.2 15.8 47.4
#>  3:      A    4 -2.7  6.3  5.3 15.9
#>  4:      A    3  2.3  6.8  8.3 24.9
#>  5:      A    9  1.8  7.5 19.8 59.4
#>  6:      A    6  7.1  7.8 19.1 57.3
#>  7:      B    3  1.6  5.3  7.6   NA
#>  8:      B    7  5.2  6.4 19.2   NA
#>  9:      C    5  3.2  6.3 13.2   NA
#> 10:      C    2 -3.5  6.3  0.5   NA
```
-->
</div>
<div id="guía-rápida-de-funciones-2" class="section level2" number="6.9">
<h2 number="6.9"><span class="header-section-number">6.9</span> Guía rápida de funciones</h2>
<ul>
<li><code>data()</code> produce una lista con los objetos de datos a los que tenemos acceso.</li>
<li><code>View</code> muestra el <em>data frame</em> al que se aplica en la ventana de ficheros.</li>
<li><code>head</code> aplicado a un <em>data frame</em> y un número <em>n</em>, nos muestra las <em>n</em> primeras filas del <em>data frame</em> (por defecto, 6).</li>
<li><code>tail</code> aplicado a un <em>data frame</em> y un número <em>n</em>, nos muestra las <em>n</em> últimas filas del <em>data frame</em> (por defecto, 6).</li>
<li><code>str</code> da la estructura global de un objeto de datos.</li>
<li><code>names</code> sirve para obtener un vector con los nombres de las columnas de un <em>data frame</em>, y también para modificar estos nombres.</li>
<li><code>rownames</code> sirve para obtener un vector con los identificadores de las filas de un <em>data frame</em>, y también para modificar estos identificadores.</li>
<li><code>dimnames</code> sirve para obtener una <code>list</code> formada por el vector de los identificadores de las filas y el vector de los nombres de las columnas de un <em>data frame</em>, y también para modificar estos vectores simultáneamente.</li>
<li><code>dim</code> da el número de filas y el número de columnas de un <em>data frame</em>.</li>
<li><code>read.table</code> permite importar un fichero externo en formato texto simple en un <em>data frame</em>. Algunos parámetros importantes:
<ul>
<li><code>sep</code>: sirve para indicar los separadores de las columnas.</li>
<li><code>header</code>: sirve para indicar si el fichero a importar tiene una primera fila con los nombres de las variables o no.</li>
<li><code>dec</code>: sirve para especificar el separador decimal.</li>
<li><code>stringsAsFactors</code>: igualado a <code>FALSE</code>, impone que las columnas de palabras se importen como tales, y no como factores.</li>
<li><code>encoding</code>: indica la codificación de alfabeto del fichero externo.</li>
</ul></li>
<li><code>write.table(data frame, file="fichero")</code> exporta el <em>data frame</em> al <em>fichero</em> externo.</li>
<li><code>data.frame</code> crea un <em>data frame</em> con los vectores a los que se aplica. Algunos parámetros importantes:
<ul>
<li><code>rownames</code>: sirve para especificar los identificadores de las filas.</li>
<li><code>stringsAsFactors</code>: como en <code>read.table</code>.</li>
</ul></li>
<li><code>fix</code> abre un objeto de datos en el editor de datos.</li>
<li><code>paste(x,y,..., sep="separador")</code> pega los vectores <code>x</code>, <code>y</code> … entrada a entrada, usando como separador el valor del parámetro <code>sep</code>.</li>
<li><code>as.character</code> transforma todos los datos de un objeto en palabras.</li>
<li><code>as.integer</code> transforma todos los datos de un objeto en números enteros.</li>
<li><code>as.numeric</code> transforma todos los datos de un objeto en números reales.</li>
<li><code>as.roman</code> transforma números enteros en números romanos.</li>
<li><code>droplevels</code> borra todos los niveles sobrantes de todos los factores de un <em>data frame</em>.</li>
<li><code>select</code>, del paquete <code>dplyr</code>, permite definir un <em>data frame</em> con todas las variables de un <em>data frame</em> que empiecen por una secuencia de letras dada (con el parámetro <code>starts_with</code>), que terminen por una secuencia de letras dada (con el parámetro <code>ends_with</code>), o que contengan una secuencia de letras dada (con el parámetro <code>contains</code>).</li>
<li><code>subset(data frame, condición, select=columnas)</code> define un <em>data frame</em> con las filas del <em>data frame</em> que cumplen la <code>condición</code> y las columnas especificadas en el parámetro <code>select</code>.</li>
<li><code>sapply(data frame, FUN=función)</code> aplica la <code>función</code> a las columnas de un <em>data frame</em>.</li>
<li><code>aggregate</code> sirve para aplicar una función a una o varias variables de un <em>data frame</em> agrupando sus entradas por los niveles de uno o varios factores.</li>
<li><code>attach</code> añade las variables de un <em>data frame</em> al entorno global de R.</li>
<li><code>detach</code> deshace el efecto de <code>attach</code>.</li>
<li><code>clipboard()</code>, del paquete <strong>readr</strong> , da el contenido del Portapapeles.
<!--
* `data.table`, del paquete `data.table`, crea un *data table* a partir de vectores o de un *data frame*
* `fread`, del paquete `data.table`,  permite importar un fichero externo en un *data table*.
* `setkey`, del paquete `data.table`,  indexa un *data table*.
* `[1, 2, by=3]`, aplicado a un  `data.table`, extrae las filas especificadas en la posición `1` y ejecuta  la expresión `2` sobre sus columnas, agrupando las filas según la condición `3`.

--></li>
</ul>
</div>
<div id="ejercicios-4" class="section level2" number="6.10">
<h2 number="6.10"><span class="header-section-number">6.10</span> Ejercicios</h2>
<div id="test-3" class="section level3 unnumbered">
<h3 class="unnumbered">Test</h3>
<p><em>(1)</em> El data frame <code>CO2</code> es uno de los que lleva predefinidos R. ¿Qué vale la variable <code>conc</code> para la observación correspondiente a la cuadragésima quinta fila? Dad su valor, no cómo lo habéis obtenido.</p>
<p><em>(2)</em> Suponed que tenéis un <em>data frame</em> llamado <code>Datos1</code>. Dad una instrucción que muestre su estructura.</p>
<p><em>(3)</em> Suponed que tenéis un <em>data frame</em> llamado <code>Datos1</code> que tiene una variable llamada <code>Temp</code> de tipo entero (<code>int</code>). Dad una instrucción, lo más sencilla posible, que redefina este <em>data frame</em> de forma que ahora su variable “Temp” sea de tipo numérico (<code>num</code>).</p>
<p><em>(4)</em> El <em>data frame</em> <code>DNase</code> es uno de los que lleva predefinidos R. Cread un nuevo <em>data frame</em> añadiéndole una nueva fila donde la variable <code>Run</code> tome el valor 5, la variable <code>conc</code> tome el valor 0.5 y la variable <code>density</code> tome el valor 2.3. ¿Qué vale la media, redondeada a 4 cifras decimales, de los valores de la variable <code>density</code> en las filas del data frame resultante cuyo valor de la variable <code>Run</code> sea 5? Tenéis que dar el resultado final, no cómo lo habéis obtenido.</p>
<p><em>(5)</em> Definid un <em>data frame</em> con la tabla contenida en el <em>url</em> <a href="http://aprender.uib.es/Rdir/heartatk4R.txt">http://aprender.uib.es/Rdir/heartatk4R.txt</a> y calculad el valor máximo de la variable <code>AGE</code> entre los individuos cuya variable <code>SEX</code> valga <code>F</code>. Tenéis que dar el resultado final, no cómo lo habéis obtenido.</p>
<p><em>(6)</em> Definid un <em>data frame</em> con la tabla contenida en el <em>url</em> <a href="http://aprender.uib.es/Rdir/ESD.txt">http://aprender.uib.es/Rdir/ESD.txt</a> y calculad, redondeado a 2 cifras decimales, el valor medio de la variable <code>MB</code>. Tenéis que dar el resultado final, no cómo lo habéis obtenido.</p>
<p><em>(7)</em> Definid un <em>data frame</em> con la tabla contenida en el <em>url</em> <a href="http://aprender.uib.es/Rdir/ESD.txt">http://aprender.uib.es/Rdir/ESD.txt</a> y dad el valor de la variable <code>Year</code> para el cual el valor medio de la variable <code>BH</code> sea mayor. Tenéis que dar el resultado final, no como lo habéis obtenido.</p>
<p><em>(8)</em> Dad una instrucción que use la función <code>read.table</code> para importar en un <em>data frame</em> llamado <code>Datos</code> un fichero llamado “datos.txt” situado en la carpeta de trabajo de R. Las separaciones entre columnas en este fichero son tabuladores y tiene una primera fila con los nombres de las columnas.</p>
</div>
<div id="ejercicio-4" class="section level3 unnumbered">
<h3 class="unnumbered">Ejercicio</h3>
<p>La tabla de datos <code>pulse.txt</code> que encontraréis en <a href="http://aprender.uib.es/Rdir/pulse.txt">http://aprender.uib.es/Rdir/pulse.txt</a> recoge una serie de informaciones de tipo general (altura, peso, sexo, si corren, si fuman y su nivel de actividad física: 1 si es bajo, 2 si es moderado y 3 si es alto) sobre algunos estudiantes matriculados en un curso de estadística de la Universidad Estatal de Pensilvania hace unos años. A estos estudiantes se les pidió que lanzasen una moneda al aire: a los que sacaron cara, se les hizo correr un minuto sin moverse del sitio, y los que sacaron cruz, descansaron un minuto. Todos los estudiantes (tanto los que corrieron como los que no) midieron sus pulsaciones por minuto antes y después de este minuto de ejercicio o descanso, y estas medidas también aparecen en esta tabla (en las variables <code>PuBefor</code> y <code>PuAfter</code>, respectivamente).</p>
<ol style="list-style-type: lower-alpha">
<li><p>¿Cuántos estudiantes tomaron parte en este estudio? ¿Cuántos son hombres y cuántas mujeres?</p></li>
<li><p>Calculad el porcentaje medio de variación en el número de pulsaciones tras el minuto de ejercicio o descanso de los estudiantes que corrieron (se indica con el valor <code>yes</code> en la variable <code>Ran.</code>) y de los que no. ¿Hay mucha diferencia?</p></li>
<li><p>Calculad el porcentaje medio de incremento en el número de pulsaciones tras el minuto de ejercicio sólo para los estudiantes que corrieron, pero ahora distinguiendo los hombres de las mujeres. ¿Cuál de los dos incrementos medios es mayor?</p></li>
<li><p>Calculad el porcentaje medio de incremento en el número de pulsaciones tras el minuto de ejercicio para los estudiantes que corrieron, pero ahora distinguiendo los estudiantes que fuman de los que no. ¿Cuál de los dos incrementos medios es mayor?</p></li>
<li><p>Calculad el número medio de pulsaciones antes del minuto de ejercicio o descanso de todos los estudiantes, separados según su nivel de actividad física. ¿Se observa alguna diferencia significativa?</p></li>
</ol>
</div>
<div id="respuestas-al-test-3" class="section level3 unnumbered">
<h3 class="unnumbered">Respuestas al test</h3>
<p><em>(1)</em> 250</p>
<p><em>(2)</em> <code>str(Datos1)</code></p>
<p><em>(3)</em> <code>Datos1$Temp=as.numeric(Datos1$Temp)</code></p>
<p><em>(4)</em> 0.7985</p>
<p><em>(5)</em> 102</p>
<p><em>(6)</em> 133.97</p>
<p><em>(7)</em> -1850</p>
<p><em>(8)</em> <code>Datos=read.table("datos.txt",sep="\t",header=TRUE)</code></p>
<!--chapter:end:06chap05_Data_frames.Rmd-->
</div>
</div>
</div>
<div id="chap:plot" class="section level1" number="7">
<h1 number="7"><span class="header-section-number">7</span> Gráficos básicos</h1>
<p>El objetivo de esta lección es introducir los aspectos básicos de los gráficos que se obtienen por medio de la función <code>plot</code>. Muchos de los parámetros y funciones auxiliares que explicamos en esta lección se podrán usar más adelante en otras funciones que producen tipos específicos de gráficos en estadística descriptiva.</p>
<div id="la-función-plot" class="section level2" number="7.1">
<h2 number="7.1"><span class="header-section-number">7.1</span> La función <code>plot</code></h2>
<p>Dada una familia de puntos
<span class="math display">\[
(x_1, y_1), \ldots, (x_n, y_n), 
\]</span>
podemos usar la función <code>plot</code> para dibujar su gráfico. La construcción básica para hacerlo es</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true"></a><span class="kw">plot</span>(x, y)</span></code></pre></div>
<p>donde <span class="math inline">\(x=(x_1, \ldots, x_n)\)</span> es el vector de las primeras coordenadas de los puntos e <span class="math inline">\(y=(y_1, \ldots, y_n)\)</span> el vector de sus segundas coordenadas. Por ejemplo, para dibujar el gráfico de los puntos</p>
<p style="text-align:center">
(2, 1), (5, 7), (6, 3), (3, 2), (4, 1),
</p>
<p>basta entrar</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true"></a>x=<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true"></a>y=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true"></a><span class="kw">plot</span>(x, y)</span></code></pre></div>
<p>y obtenemos la Figura @ref(fig:F501).
<!--
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.45\textwidth]{ex1.pdf}
\end{center}
\caption{Gráfico básico de los puntos $(2, 1)$, $(5, 7)$, $(6, 3)$, $(3, 2)$, $(4, 1)$.}\label{fig:5.1}  
\end{figure}
--></p>
<div class="figure" style="text-align: center">
<img src="07chap06_Graficos_I_files/figure-html/F501-1.png" alt="Gráfico básico de los puntos (2,1), (5,7), (6,3), (3,2), (4,1)." width="90%" />
<p class="caption">
(#fig:F501)Gráfico básico de los puntos (2,1), (5,7), (6,3), (3,2), (4,1).
</p>
</div>
<p>Cuando aplicamos <code>plot</code> a un solo vector <span class="math inline">\((x_1, \ldots, x_n)\)</span>, R produce el gráfico de los puntos
<span class="math display">\[
(1, x_1), \ldots, (n, x_n).
\]</span>
Es decir, si el vector tiene longitud <span class="math inline">\(n\)</span>, <code>plot(x)</code> es una abreviatura de <code>plot(1:n, x)</code>. Así, la Figura @ref(fig:F50105) se obtiene con la siguiente instrucción:</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true"></a><span class="kw">plot</span>(<span class="dv">2</span><span class="op">^</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>))</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="07chap06_Graficos_I_files/figure-html/F50105-1.png" alt="Gráfico básico de las diez primeras potencias de 2." width="90%" />
<p class="caption">
(#fig:F50105)Gráfico básico de las diez primeras potencias de 2.
</p>
</div>
<!--
\begin{figure}[h]
\begin{center}
\includegraphics[width=0.45\textwidth]{ex15.pdf}
\end{center}
\caption{Gráfico básico de los valores $(2^n)_{n=1, \ldots, 5}$.}\label{fig:5.1.5}  
\end{figure}
-->
<p>La función <code>plot</code> también sirve para dibujar el gráfico de una función definida mediante <code>function</code>.
Por ejemplo, el código siguiente produce la gráfica de la parábola <span class="math inline">\(y=x^2\)</span> entre <span class="math inline">\(x=0\)</span> y <span class="math inline">\(x=1\)</span> de la Figura @ref(fig:x2):</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true"></a>f=<span class="cf">function</span>(x){x<span class="op">^</span><span class="dv">2</span>}</span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true"></a><span class="kw">plot</span>(f)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="07chap06_Graficos_I_files/figure-html/x2-1.png" alt="Gráfico básico de la curva $y=x^2$." width="90%" />
<p class="caption">
(#fig:x2)Gráfico básico de la curva <span class="math inline">\(y=x^2\)</span>.
</p>
</div>
<!--
\begin{figure}[h]
\begin{center}
\includegraphics[width=0.45\textwidth]{ex-x2.pdf}
\end{center}
\caption{Gráfico básico de la función $y=x^2$.}\label{fig:x2}  
\end{figure}
-->
</div>
<div id="parámetros-de-plot" class="section level2" number="7.2">
<h2 number="7.2"><span class="header-section-number">7.2</span> Parámetros de <code>plot</code></h2>
<p>El aspecto de los gráficos que produce <code>plot</code> se puede modificar especificando parámetros en su argumento. Por ejemplo, ya vimos en la Lección @ref(chap:lm) el parámetro <code>log</code>, que sirve para indicar si queremos algún eje en escala logarítmica.</p>
<p>Un primer grupo de parámetros permiten modificar el aspecto <em>exterior</em> del gráfico:</p>
<ul>
<li>Para poner un título al gráfico, tenemos que especificarlo con el parámetro <code>main</code>.</li>
<li>Para modificar las etiquetas de los ejes de coordenadas, tenemos que usar los parámetros <code>xlab</code> e <code>ylab</code>.</li>
</ul>
<p>Los valores de estos parámetros se tienen que entrar entre comillas o, si son fórmulas matemáticas, aplicarles la función <code>expression</code>, para que aparezcan en un formato matemático más adecuado.</p>
<p>Por ejemplo, suponemos que conocéis la sucesión <span class="math inline">\((F_n)_{n\geqslant 0}\)</span> de los números de Fibonacci</p>
<p style="text-align:center">
1, 1, 2, 3, 5, 8, 13, 21 …
</p>
<p>que empieza con <span class="math inline">\(F_0=F_1=1\)</span> y a partir de aquí cada término es la suma de los dos anteriores. Esta sucesión está definida, para todo <span class="math inline">\(n\geqslant 0\)</span>, por la fórmula
<span class="math display">\[
F_n=\frac{1}{\sqrt{5}}\cdot\Biggl(
\Bigl(\frac{1+\sqrt{5}}{2}\Bigr)^{n+1}-
\Bigl(\frac{1-\sqrt{5}}{2}\Bigr)^{n+1}\Biggl).
\]</span>
Para comprobarlo para algunos valores, vamos a generar la parte inicial <span class="math inline">\((F_n)_{n=0, \ldots, 30}\)</span> de la sucesión definida por esta fórmula.</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true"></a>n=<span class="dv">0</span><span class="op">:</span><span class="dv">30</span></span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true"></a>Fib=(<span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">5</span>))<span class="op">*</span>(((<span class="dv">1</span><span class="op">+</span><span class="kw">sqrt</span>(<span class="dv">5</span>))<span class="op">/</span><span class="dv">2</span>)<span class="op">^</span>(n<span class="op">+</span><span class="dv">1</span>)<span class="op">-</span>((<span class="dv">1</span><span class="op">-</span><span class="kw">sqrt</span>(<span class="dv">5</span>))<span class="op">/</span><span class="dv">2</span>)<span class="op">^</span>(n<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true"></a>Fib</span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true"></a><span class="co">#&gt;  [1]       1       1       2       3       5       8      13      21      34</span></span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true"></a><span class="co">#&gt; [10]      55      89     144     233     377     610     987    1597    2584</span></span>
<span id="cb350-6"><a href="#cb350-6" aria-hidden="true"></a><span class="co">#&gt; [19]    4181    6765   10946   17711   28657   46368   75025  121393  196418</span></span>
<span id="cb350-7"><a href="#cb350-7" aria-hidden="true"></a><span class="co">#&gt; [28]  317811  514229  832040 1346269</span></span></code></pre></div>
<p>Para dibujar los pares <span class="math inline">\((n, F_n)_{n=0, \ldots, 30}\)</span> en un gráfico titulado “Números de Fibonacci”, con el eje de abscisas etiquetado con <span class="math inline">\(n\)</span> y el eje de ordenadas etiquetado con <span class="math inline">\(F_n\)</span> igualado a su fórmula explícita, podemos entrar la instrucción siguiente. El resultado es la Figura @ref(fig:F402).</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true"></a><span class="kw">plot</span>(n, Fib, <span class="dt">xlab=</span><span class="st">&quot;n&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Números de Fibonacci&quot;</span>, </span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true"></a>  <span class="dt">ylab=</span><span class="kw">expression</span>(F[n]<span class="op">==</span>(<span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">5</span>))<span class="op">*</span>(((<span class="dv">1</span><span class="op">+</span><span class="kw">sqrt</span>(<span class="dv">5</span>))<span class="op">/</span><span class="dv">2</span>)<span class="op">^</span>(n<span class="op">+</span><span class="dv">1</span>)<span class="op">-</span>((<span class="dv">1</span><span class="op">-</span><span class="kw">sqrt</span>(<span class="dv">5</span>))<span class="op">/</span><span class="dv">2</span>)<span class="op">^</span>(n<span class="op">+</span><span class="dv">1</span>))))</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="07chap06_Graficos_I_files/figure-html/F402-1.png" alt="Gráfico de los 31 valores iniciales $F_n$ de la sucesión de Fibonacci." width="90%" />
<p class="caption">
(#fig:F402)Gráfico de los 31 valores iniciales <span class="math inline">\(F_n\)</span> de la sucesión de Fibonacci.
</p>
</div>
<p>Si os interesa información sobre cómo escribir las fórmulas dentro de <code>expression</code>, podéis consultar la Ayuda de <code>plotmath</code>.</p>
<!--
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.45\textwidth]{Fplot3.pdf}
\end{center}
\caption{Gráfico de los 31 valores iniciales $F_n$ de la sucesión de Fibonacci.}\label{fig:4.2} 
\end{figure}

Vale, hemos hecho trampa. Si habéis ejecutado la instrucción anterior tal cual, la etiqueta del eje de ordenadas os habrá quedado demasiado cerca del borde, y, por ejemplo, no se verá la línea horizontal superior de las raíces cuadradas. Para solucionarlo, hemos modificado los márgenes de la figura. Estos márgenes, especificados en números de líneas, se controlan con el parámetro  `mar`, pero este parámetro no se puede especificar dentro de `plot`, sino antes, como argumento de la función `par`, que sirve para modificar el aspecto general de los gráficos. Así que en realidad, las instrucciones que han producido el gráfico
han sido:

```
viejo.par=par() #Guardamos los valores antiguos de par
par(mar=c(5, 4.5, 4, 2)+0.1)  #Modificamos los márgenes
plot(n, Fib, xlab="n", main="Números de Fibonacci", 
     ylab=expression(F[n]==(1/sqrt(5))*((1+sqrt(5))/2)^(n+1)
                     -(1/sqrt(5))*((1-sqrt(5))/2)^(n+1)))
par=viejo.par  #Volvemos a los valores anteriores de par
```
Consultad la Ayuda de `par` para conocer cómo modificar otros parámetros gráficos.
-->
<p>Cómo podéis ver, por defecto <code>plot</code> dibuja los puntos como círculos vacíos. Esto se puede cambiar con el parámetro <code>pch</code>, que puede tomar como valor cualquier número natural entre 0 y 25. Con <code>pch=0</code> obtenemos cuadrados, <code>pch=1</code> produce los círculos que ya habéis visto (es el valor por defecto), <code>pch=2</code> produce triángulos, etc. La Figura
@ref(fig:F403) muestra los signos correspondientes a los valores de <code>pch</code>. También se pueden usar letras para representar los puntos: hay que especificarlo igualando el parámetro <code>pch</code> a la letra entre comillas.</p>
<div class="figure" style="text-align: center">
<img src="AprendeR-Parte-I_files/figure-html/pchh.png" alt="Signos correspondientes a los diferentes valores de `pch`." width="90%" />
<p class="caption">
(#fig:F403)Signos correspondientes a los diferentes valores de <code>pch</code>.
</p>
</div>
<!--
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.7\textwidth]{pchh.pdf}
\end{center}
\caption{Signos correspondientes a los diferentes valores de `pch`.}\label{fig:4.3}
\end{figure}
-->
<p>El tamaño de estos signos se puede modificar mediante el parámetro <code>cex</code> igualado al factor de escalado: <code>cex=2</code> produce signos el doble de grandes que los que obtenemos por defecto, <code>cex=0.5</code> produce signos de la mitad de tamaño, etc. Por ejemplo, el siguiente código produce la Figura @ref(fig:cex).</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true"></a><span class="kw">plot</span>(x, y, <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">cex=</span><span class="dv">3</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="07chap06_Graficos_I_files/figure-html/cex-1.png" alt="Gráfico de los puntos (2,1), (5,7), (6,3), (3,2), (4,1) con puntos de tamaño triple." width="90%" />
<p class="caption">
(#fig:cex)Gráfico de los puntos (2,1), (5,7), (6,3), (3,2), (4,1) con puntos de tamaño triple.
</p>
</div>
<!--
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.45\textwidth]{plotcex.pdf}
\end{center}
\caption{Gráfico de los puntos $(2, 1)$, $(5, 7)$, $(6, 3)$, $(3, 2)$, $(4, 1)$ con puntos de tamaño triple.}\label{fig:cex}
\end{figure}
-->
<p>El color de los puntos se puede especificar mediante el parámetro <code>col</code> igualado al nombre del color en inglés. La paleta de colores de R consta de 502 colores diferentes. Podéis encontrar una presentación muy clara de esta paleta en el documento <em>Rcolor.pdf</em> que encontraréis en el <code>url</code> <a href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf">http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf</a></p>
<p>Así, por ejemplo, la función siguiente produce la Figura @ref(fig:F402051):</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true"></a><span class="kw">plot</span>(x, y, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">pch=</span><span class="dv">15</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="07chap06_Graficos_I_files/figure-html/F402051-1.png" alt="Gráfico de los puntos (2,1), (5,7), (6,3), (3,2), (4,1) como cuadrados rojos." width="90%" />
<p class="caption">
(#fig:F402051)Gráfico de los puntos (2,1), (5,7), (6,3), (3,2), (4,1) como cuadrados rojos.
</p>
</div>
<!--
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.45\textwidth]{Plotcol1.pdf}\
\includegraphics[width=0.45\textwidth]{Plotbg.pdf}
\end{center}
\caption{Dos gráficos de los puntos $(2, 1)$, $(5, 7)$, $(6, 3)$, $(3, 2)$, $(4, 1)$.}\label{fig:4.2.5} 
\end{figure}
-->
<p>Los puntos que se obtienen con <code>pch</code> de 21 a 25 admiten un color para el borde (que se especifica con <code>col</code>) y uno de diferente para el relleno, que se especifica con <code>bg</code>. A modo de ejemplo, el gráfico de la Figura @ref(fig:F402052) se obtiene con el código siguiente:</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true"></a><span class="kw">plot</span>(x, y, <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">bg=</span><span class="st">&quot;red&quot;</span>, <span class="dt">cex=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="07chap06_Graficos_I_files/figure-html/F402052-1.png" alt="Gráfico de los puntos (2,1), (5,7), (6,3), (3,2), (4,1) bicolores." width="90%" />
<p class="caption">
(#fig:F402052)Gráfico de los puntos (2,1), (5,7), (6,3), (3,2), (4,1) bicolores.
</p>
</div>
<p>El parámetro <code>type</code> permite indicar el tipo de gráfico que queremos producir. El valor del parámetro se tiene que entrar entre comillas y puede ser:</p>
<ul>
<li><code>"p"</code>, para dibujar los puntos como simples puntos, como hasta ahora; es el valor por defecto.</li>
<li><code>"l"</code>, para dibujar los puntos unidos por líneas rectas sin que se vean los puntos.</li>
<li><code>"b"</code>, para dibujar los puntos unidos por líneas rectas de manera que se vean los puntos (los dibuja ambos, <em>both</em>: rectas y puntos), pero sin que las rectas entren dentro de los signos que representan los puntos.</li>
<li><code>"o"</code>, que es como <code>"b"</code>, pero ahora las rectas sí que entran dentro de los puntos.</li>
<li><code>"h"</code>, para dibujar líneas verticales desde el eje de abscisas a cada punto (un <strong>histograma de líneas</strong>).</li>
<li><code>"s"</code>, para dibujar un diagrama de escalones.</li>
<li><code>"n"</code>, para no dibujar los puntos, sólo el exterior del gráfico (ejes, título, etc.).</li>
</ul>
<p>Veamos el efecto de los diferentes valores de <code>type</code>:</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true"></a>X=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">11</span>)</span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true"></a>Y=<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">3</span>)</span>
<span id="cb355-3"><a href="#cb355-3" aria-hidden="true"></a><span class="kw">plot</span>(X, Y, <span class="dt">type=</span><span class="st">&quot;p&quot;</span>)  <span class="co">#Tipo por defecto</span></span></code></pre></div>
<p><img src="07chap06_Graficos_I_files/figure-html/unnamed-chunk-5-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true"></a><span class="kw">plot</span>(X, Y, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="07chap06_Graficos_I_files/figure-html/unnamed-chunk-6-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true"></a><span class="kw">plot</span>(X, Y, <span class="dt">type=</span><span class="st">&quot;b&quot;</span>)</span></code></pre></div>
<p><img src="07chap06_Graficos_I_files/figure-html/unnamed-chunk-7-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true"></a><span class="kw">plot</span>(X, Y, <span class="dt">type=</span><span class="st">&quot;o&quot;</span>)</span></code></pre></div>
<p><img src="07chap06_Graficos_I_files/figure-html/unnamed-chunk-8-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true"></a><span class="kw">plot</span>(X, Y, <span class="dt">type=</span><span class="st">&quot;h&quot;</span>)</span></code></pre></div>
<p><img src="07chap06_Graficos_I_files/figure-html/unnamed-chunk-9-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true"></a><span class="kw">plot</span>(X, Y, <span class="dt">type=</span><span class="st">&quot;s&quot;</span>)</span></code></pre></div>
<p><img src="07chap06_Graficos_I_files/figure-html/unnamed-chunk-10-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true"></a><span class="kw">plot</span>(X, Y, <span class="dt">type=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="07chap06_Graficos_I_files/figure-html/unnamed-chunk-11-1.png" width="90%" style="display: block; margin: auto;" /></p>
<!--
\begin{figure}[p]
\begin{center}
\includegraphics[width=0.35\linewidth]{plot-p.pdf}\
\includegraphics[width=0.35\linewidth]{plot-l.pdf}\\[-2ex]
\includegraphics[width=0.35\linewidth]{plot-b.pdf}\
\includegraphics[width=0.35\linewidth]{plot-o.pdf}\\[-2ex]
\includegraphics[width=0.35\linewidth]{plot-h.pdf}\
\includegraphics[width=0.35\linewidth]{plot-s.pdf}\\[-2ex]
\includegraphics[width=0.35\linewidth]{plot-n.pdf}
\end{center}
\caption{Gráficos de los puntos $(1, 2)$, $(3, 8)$, $(5, 4)$, $(7, 6)$, $(11, 3)$ con los distintos valores del parámetro `type`.}\label{fig:5.2} 
\end{figure}
-->
<p>La función <code>plot</code> aplicada a una función <span class="math inline">\(f\)</span> en realidad produce el gráfico de tipo <code>"l"</code> de una familia de puntos <span class="math inline">\((x, f(x))\)</span> (por defecto, 101 puntos distribuidos uniformemente a lo largo del dominio; este valor se puede modificar con el parámetro <code>n</code>).</p>
<p>El estilo de las líneas usadas por <code>plot</code> se puede modificar con los parámetros siguientes:</p>
<ul>
<li><p>El parámetro <code>col</code> especifica el color tanto de los puntos como de las líneas.</p></li>
<li><p>El tipo de línea se puede especificar con el parámetro <code>lty</code> igualado a uno de los valores siguientes: <code>"solid"</code>, o <code>1</code>, (el valor por defecto, que produce una línea continua); <code>"dashed"</code>, o <code>2</code>, (que produce una línea discontinua); <code>"dotted"</code>, o <code>3</code>, (que produce una línea de puntos); <code>"dotdash"</code>, o <code>4</code>, (que produce una línea que alterna puntos y rayas).</p></li>
<li><p>El grosor se puede especificar con el parámetro <code>lwd</code>, que igualado a <em>r</em> hace que el grosor de las líneas sea <span class="math inline">\(r\)</span> veces su valor por defecto.</p></li>
</ul>
<p>Veamos dos ejemplos:</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true"></a><span class="kw">plot</span>(X, Y, <span class="dt">type=</span><span class="st">&quot;o&quot;</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">lty=</span><span class="st">&quot;dotted&quot;</span>)</span></code></pre></div>
<p><img src="07chap06_Graficos_I_files/figure-html/unnamed-chunk-12-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true"></a><span class="kw">plot</span>(X, Y, <span class="dt">type=</span><span class="st">&quot;o&quot;</span>, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">lty=</span><span class="st">&quot;dashed&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="07chap06_Graficos_I_files/figure-html/unnamed-chunk-13-1.png" width="90%" style="display: block; margin: auto;" /></p>
<!--
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.45\textwidth]{plotlty1.pdf}\quad
\includegraphics[width=0.45\textwidth]{plotlty2.pdf}\
\end{center}
\caption{Gráficos de los puntos $(1, 2)$, $(3, 8)$, $(5, 4)$, $(7, 6)$, $(11, 3)$ con distintos valores de los parámetros `lty` y  `lwd`.}\label{fig:lwd} 
\end{figure}
-->
<p>Si el argumento de <code>plot</code> son dos vectores, por norma general los rangos de los ejes de coordenadas van, por defecto, del mínimo al máximo de los vectores correspondientes. Si su argumento es una función <span class="math inline">\(f\)</span>, por defecto el rango del eje de abscisas es el intervalo <span class="math inline">\([0, 1]\)</span> y el rango del eje de ordenadas va del valor mínimo de <span class="math inline">\(f\)</span> sobre el rango de las abscisas al máximo. Si queremos modificar estos rangos, tenemos que usar los parámetros <code>xlim</code> e <code>ylim</code>, igualados cada uno a un vector de entradas los extremos del rango.</p>
<p>Veamos un ejemplo de uso de estos parámetros. Vamos a dibujar tres gráficas de la función <span class="math inline">\(f(x)=x\ln(x)\)</span>, variando los rangos de sus ejes.</p>
<ul>
<li>Con los rangos por defecto:</li>
</ul>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true"></a>f=<span class="cf">function</span>(x){x<span class="op">*</span><span class="kw">log</span>(x)}</span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true"></a><span class="kw">plot</span>(f)    </span></code></pre></div>
<p><img src="07chap06_Graficos_I_files/figure-html/unnamed-chunk-14-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ul>
<li>Modificando el rango del eje de abscisas:</li>
</ul>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true"></a><span class="kw">plot</span>(f, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>))    </span></code></pre></div>
<p><img src="07chap06_Graficos_I_files/figure-html/unnamed-chunk-15-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ul>
<li>Modificando los rangos de ambos ejes:</li>
</ul>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true"></a><span class="kw">plot</span>(f, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">50</span>))  </span></code></pre></div>
<p><img src="07chap06_Graficos_I_files/figure-html/unnamed-chunk-16-1.png" width="90%" style="display: block; margin: auto;" /></p>
<!--
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.32\linewidth]{ylim1.pdf}\
\includegraphics[width=0.32\linewidth]{ylim2.pdf}\
\includegraphics[width=0.32\linewidth]{ylim3.pdf}\
\end{center}
\caption{Gráficas de la función $f(x)=x\log{x}$ con diferentes rangos de coordenadas de los ejes.}\label{fig:xlim} 
\end{figure}
-->
<p>Para modificar las posiciones de las marcas en los ejes de abscisas y ordenadas podemos usar los parámetros <code>xaxp</code> e <code>yaxp</code>, respectivamente. Mediante la expresión <code>xaxp=c(a, b, m)</code>, imponemos que R dibuje <span class="math inline">\(m+1\)</span> marcas igualmente espaciadas entre los puntos <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span> del eje de abscisas. La sintaxis para <code>yaxp</code> es la misma. Estas instrucciones no definen los rangos de los ejes de coordenadas, que se han de especificar con <code>xlim</code> e <code>ylim</code> si se quieren modificar. Veamos tres ejemplos:</p>
<ul>
<li>Con las marcas por defecto:</li>
</ul>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true"></a><span class="kw">plot</span>(f, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>))</span></code></pre></div>
<p><img src="07chap06_Graficos_I_files/figure-html/unnamed-chunk-17-1.png" width="90%" style="display: block; margin: auto;" />
* Definiendo las marcas sobre el eje de abscisas:</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true"></a><span class="kw">plot</span>(f, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">xaxp=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">9</span>))</span></code></pre></div>
<p><img src="07chap06_Graficos_I_files/figure-html/unnamed-chunk-18-1.png" width="90%" style="display: block; margin: auto;" />
* Definiendo las marcas sobre ambos ejes:</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true"></a><span class="kw">plot</span>(f, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">xaxp=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">9</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">25</span>), <span class="dt">yaxp=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">25</span>, <span class="dv">10</span>))</span></code></pre></div>
<p><img src="07chap06_Graficos_I_files/figure-html/unnamed-chunk-19-1.png" width="90%" style="display: block; margin: auto;" /></p>
<!--
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.32\linewidth]{ylim2.pdf}\
\includegraphics[width=0.32\linewidth]{xaxp1.pdf}\
\includegraphics[width=0.32\linewidth]{xaxp2.pdf}\
\end{center}
\caption{Gráficas de la función $f(x)=x\log{x}$ con diferentes posiciones de las marcas en los ejes.}\label{fig:xaxp}  
\end{figure}
-->
<p>La función <code>plot</code> dispone de muchos otros parámetros, que podéis consultar en la Ayuda de <code>plot</code> y las de las funciones que se citan en su sección <em>See Also</em>. Son especialmente útiles los parámetros que se explican en la Ayuda de <code>par</code>.</p>
</div>
<div id="cómo-añadir-elementos-a-un-gráfico" class="section level2" number="7.3">
<h2 number="7.3"><span class="header-section-number">7.3</span> Cómo añadir elementos a un gráfico</h2>
<p>La función <code>plot</code> permite dibujar una sola cosa (una familia de puntos o una función) con un único estilo. Si queremos dibujar varios objetos en un gráfico, los tenemos que añadir uno a uno, usando las funciones adecuadas. En esta sección veremos algunas funciones que permiten añadir elementos a un gráfico.</p>
<p>Antes de empezar, queremos avisaros de algo muy importante. Cuando añadimos objetos a un gráfico, ya no podemos modificar su diseño general. Por ejemplo, los rangos de coordenadas de los ejes del gráfico final o sus etiquetas serán los del primer gráfico, aunque especifiquemos valores nuevos en el argumento de las funciones que usemos para añadir objetos.</p>
<p>La instrucción</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true"></a><span class="kw">points</span>(x, y)</span></code></pre></div>
<p>añade un punto de coordenadas <span class="math inline">\((x, y)\)</span> al gráfico activo si <code>x</code> e <code>y</code> son números. Podemos declarar el color de este punto, el signo que lo represente, etc. mediante los parámetros usuales. Por ejemplo,</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true"></a>f=<span class="cf">function</span>(x){x<span class="op">^</span><span class="dv">2</span>}</span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true"></a><span class="kw">plot</span>(f, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true"></a><span class="kw">points</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dt">pch=</span><span class="dv">19</span>)</span></code></pre></div>
<p>produce la Figura @ref(fig:ex1punt), en la que hemos dibujado la parábola <span class="math inline">\(y=x^2\)</span> y hemos marcado su vértice con un punto.</p>
<div class="figure" style="text-align: center">
<img src="07chap06_Graficos_I_files/figure-html/ex1punt-1.png" alt="Gráfica de una parábola con su vértice marcado." width="90%" />
<p class="caption">
(#fig:ex1punt)Gráfica de una parábola con su vértice marcado.
</p>
</div>
<!--
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.45\textwidth]{ex2.pdf}
\end{center}
\caption{Gráfica de la función $f(x)=x^2$ con su vértice marcado.}\label{fig:ex1punt}  
\end{figure}
-->
<p>La función <code>points</code> también sirve para añadir una familia de puntos. En
este caso, hay que entrar como <code>x</code> el vector de sus primeras coordenadas y como <code>y</code> el de sus segundas coordenadas, como lo haríamos en <code>plot</code>.</p>
<p>Veamos algunos ejemplos. El código</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true"></a>f=<span class="cf">function</span>(x){x<span class="op">^</span><span class="dv">2</span>}</span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true"></a><span class="kw">plot</span>(f, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true"></a><span class="kw">points</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>, (<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>)<span class="op">^</span><span class="dv">2</span>, <span class="dt">pch=</span><span class="dv">19</span>)</span></code></pre></div>
<p>dibuja un trozo de la parábola <span class="math inline">\(y=x^2\)</span> y añade los puntos
<span class="math inline">\((n, n^2)_{n=0, \ldots, 10}\)</span>, produciendo la Figura @ref(fig:expoints1).</p>
<div class="figure" style="text-align: center">
<img src="07chap06_Graficos_I_files/figure-html/expoints1-1.png" alt="Gráfico de la función $f(x)=x^2$ con varios puntos marcados" width="90%" />
<p class="caption">
(#fig:expoints1)Gráfico de la función <span class="math inline">\(f(x)=x^2\)</span> con varios puntos marcados
</p>
</div>
<p>Por su parte, el código</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true"></a>n=<span class="dv">0</span><span class="op">:</span><span class="dv">20</span></span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true"></a>x=<span class="fl">1.3</span><span class="op">^</span>n<span class="dv">-2</span><span class="op">*</span><span class="fl">0.8</span><span class="op">^</span>n</span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true"></a>y=<span class="fl">0.2</span><span class="op">*</span><span class="fl">1.3</span><span class="op">^</span>n<span class="fl">+1.7</span><span class="op">*</span><span class="fl">0.8</span><span class="op">^</span>n</span>
<span id="cb373-4"><a href="#cb373-4" aria-hidden="true"></a><span class="kw">plot</span>(n, x, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb373-5"><a href="#cb373-5" aria-hidden="true"></a><span class="kw">points</span>(n, y, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p>primero dibuja los puntos <span class="math inline">\((n, 1.3^n-2\cdot 0.8^n)_{n=0, \ldots, 20}\)</span> como circulitos azules vacíos, y después añade los puntos <span class="math inline">\((n, 0.2\cdot 1.3^n+1.7 \cdot 0.8^n)_{n=0, \ldots, 20}\)</span> como circulitos rojos llenos, produciendo la Figura @ref(fig:expoints2).</p>
<div class="figure" style="text-align: center">
<img src="07chap06_Graficos_I_files/figure-html/expoints2-1.png" alt="Gráfico de dos trozos de sucesiones." width="90%" />
<p class="caption">
(#fig:expoints2)Gráfico de dos trozos de sucesiones.
</p>
</div>
<!--
\begin{figure}[htb]
\abovecaptionskip=-1ex
\begin{center}
\begin{tabular}{cc}
\includegraphics[width=0.45\textwidth]{expoints1.pdf} &
\includegraphics[width=0.45\textwidth]{expoints2.pdf}\\
(a) & (b)
\end{tabular}
\end{center}
\caption{(a) Gráfico de la función $y=x^2$ y los puntos $(n, n^2)_{n=0, \ldots, 10}$; (b) Gráfico de las familias de puntos $(n, 1.3^n-2\cdot 0.8^n)_{n=0, \ldots, 20}$ y $(n, 0.2\cdot 1.3^n+1.7 \cdot 0.8^n)_{n=0, \ldots, 20}$ usando diferentes signos para cada familia.}\label{fig:expoints} 
\end{figure}
-->
<p>La función <code>abline</code> sirve para añadir una recta; ya la usamos en la Lección @ref(chap:lm) para añadir a un gráfico una recta de regresión calculada con <code>lm</code>. Esta función tiene tres
variantes:</p>
<ul>
<li><code>abline(a, b)</code> añade la recta <span class="math inline">\(y=a+bx\)</span>.</li>
<li><code>abline(v=a)</code> añade la recta vertical <span class="math inline">\(x=a\)</span>.</li>
<li><code>abline(h=a)</code> añade la recta horizontal <span class="math inline">\(y=a\)</span>.</li>
</ul>
<p>Podemos especificar las características de estas rectas, como su grosor, su estilo o su color, mediante los
parámetros pertinentes. Por ejemplo,</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true"></a>f=<span class="cf">function</span>(x){x<span class="op">^</span><span class="dv">2</span>}</span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true"></a><span class="kw">plot</span>(f, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb374-3"><a href="#cb374-3" aria-hidden="true"></a><span class="kw">points</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb374-4"><a href="#cb374-4" aria-hidden="true"></a><span class="kw">points</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb374-5"><a href="#cb374-5" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">1</span>, <span class="dt">lty=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb374-6"><a href="#cb374-6" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">lty=</span><span class="st">&quot;dotted&quot;</span>)</span>
<span id="cb374-7"><a href="#cb374-7" aria-hidden="true"></a><span class="kw">abline</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>, <span class="dt">lty=</span><span class="st">&quot;dotdash&quot;</span>)</span></code></pre></div>
<p>produce la Figura @ref(fig:F10014). En este caso, hemos añadido a la gráfica de la parábola <span class="math inline">\(y=x^2\)</span>, dos puntos en (0, 0) y (1, 1), la recta horizontal <span class="math inline">\(y=0\)</span> de puntos, la recta vertical <span class="math inline">\(x=1\)</span> discontinua y la recta <span class="math inline">\(y=-1+2x\)</span> de puntos y rayas.</p>
<div class="figure" style="text-align: center">
<img src="07chap06_Graficos_I_files/figure-html/F10014-1.png" alt="Gráfica conjunta de una parábola, dos puntos y tres rectas." width="90%" />
<p class="caption">
(#fig:F10014)Gráfica conjunta de una parábola, dos puntos y tres rectas.
</p>
</div>
<!--
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.45\textwidth]{ex3.pdf}
\end{center}
\caption{Gráfica de la función $f(x)=x^2$, los puntos $(0, 0)$ y $(1, 1)$ y  las rectas $x=1$, $y=0$ e $y=2x-1$.}\label{fig:10.14}  
\end{figure}
-->
<p>Los parámetros <code>v</code> y <code>h</code> de <code>abline</code> se pueden igualar a vectores numéricos, en cuyo caso la instrucción añade en un solo paso todas las rectas verticales u horizontales correspondientes, todas del mismo estilo. Incluso se pueden combinar los parámetros <code>v</code> y <code>h</code> en una misma función. Por ejemplo, el código siguiente produce la Figura @ref(fig:multivh):</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true"></a>f=<span class="cf">function</span>(x){x<span class="op">^</span><span class="dv">2</span>}</span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true"></a><span class="kw">plot</span>(f, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span><span class="op">:</span><span class="dv">9</span>, <span class="dt">v=</span><span class="op">-</span><span class="dv">3</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">lty=</span><span class="st">&quot;dotted&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="07chap06_Graficos_I_files/figure-html/multivh-1.png" alt="Gráfica de una parábola y una rejilla de rectas horizontales y verticales." width="90%" />
<p class="caption">
(#fig:multivh)Gráfica de una parábola y una rejilla de rectas horizontales y verticales.
</p>
</div>
<!--
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.45\textwidth]{multivh.pdf}
\end{center}
\caption{Gráfica de la función $f(x)=x^2$ y una rejilla de rectas horizontales y verticales.}\label{fig:multivh}  
\end{figure}
-->
<p>La instrucción</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true"></a><span class="kw">text</span>(x, y, <span class="dt">labels=</span>...)</span></code></pre></div>
<p>añade en el punto de coordenadas <span class="math inline">\((x, y)\)</span> el texto especificado como argumento de <code>labels</code>. El texto se puede entrar entre comillas o en una <code>expression</code>. La función <code>text</code> admite un parámetro opcional, <code>pos</code>, que puede tomar valores 1, 2, 3 o 4 y permite indicar la posición del texto alrededor de las coordenadas <span class="math inline">\((x, y)\)</span>: 1 significa abajo, 2 a la izquierda, 3 arriba y 4 a la derecha. Sin especificar <code>pos</code> (o, equivalentemente, especificando <code>pos=NULL</code>, que es su valor por defecto), el texto se sitúa centrado en el punto <span class="math inline">\((x, y)\)</span>. El efecto de <code>pos</code> se ilustra en la Figura @ref(fig:F10015), producida con el código siguiente:</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true"></a><span class="kw">plot</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dt">labels=</span><span class="st">&quot;pos 1&quot;</span>, <span class="dt">pos=</span><span class="dv">1</span>)</span>
<span id="cb377-3"><a href="#cb377-3" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dt">labels=</span><span class="st">&quot;pos 2&quot;</span>, <span class="dt">pos=</span><span class="dv">2</span>)</span>
<span id="cb377-4"><a href="#cb377-4" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dt">labels=</span><span class="st">&quot;pos 3&quot;</span>, <span class="dt">pos=</span><span class="dv">3</span>)</span>
<span id="cb377-5"><a href="#cb377-5" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dt">labels=</span><span class="st">&quot;pos 4&quot;</span>, <span class="dt">pos=</span><span class="dv">4</span>)</span>
<span id="cb377-6"><a href="#cb377-6" aria-hidden="true"></a><span class="kw">points</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dt">pch=</span><span class="dv">19</span>)</span>
<span id="cb377-7"><a href="#cb377-7" aria-hidden="true"></a><span class="kw">text</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dt">labels=</span><span class="st">&quot;no pos&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="07chap06_Graficos_I_files/figure-html/F10015-1.png" alt="Significado del parámetro `pos` de la función `text`." width="90%" />
<p class="caption">
(#fig:F10015)Significado del parámetro <code>pos</code> de la función <code>text</code>.
</p>
</div>
<!--
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.45\textwidth]{ex4.pdf}
\end{center}
\caption{Significado del parámetro `pos` de la función `text`.}\label{fig:10.15} 
\end{figure}
-->
<p>La función <code>text</code> se puede usar para añadir varios textos en un solo paso. En este caso, <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span> han de ser los vectores de abscisas y ordenadas de los puntos donde se añadirán los textos, <code>labels</code> el vector de textos, y <code>pos</code> el vector de sus posiciones; en este vector, los textos que queremos centrados en su posición se han de indicar con <code>NULL</code>. Así, la Figura @ref(fig:F10015) también se hubiera podido obtener con el código siguiente, como podréis comprobar si lo ejecutáis:</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true"></a><span class="kw">plot</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true"></a><span class="kw">points</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dt">pch=</span><span class="dv">19</span>)</span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true"></a><span class="kw">text</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="fl">0.5</span>), <span class="dt">pos=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="ot">NULL</span>), </span>
<span id="cb378-4"><a href="#cb378-4" aria-hidden="true"></a>     <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;pos 1&quot;</span>, <span class="st">&quot;pos 2&quot;</span>, <span class="st">&quot;pos 3&quot;</span>, <span class="st">&quot;pos 4&quot;</span>, <span class="st">&quot;no pos&quot;</span>))</span></code></pre></div>
<p>La instrucción</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true"></a><span class="kw">lines</span>(x, y)</span></code></pre></div>
<p>donde <span class="math inline">\(x=(x_i)_{i=1, \ldots, n}\)</span> e <span class="math inline">\(y=(y_i)_{i=1, \ldots, n}\)</span> son dos vectores numéricos de la misma longitud, añade al gráfico una línea poligonal que une los puntos <span class="math inline">\((x_i, y_i)\)</span> sucesivos. El efecto es como si añadiéramos un</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true"></a><span class="kw">plot</span>(x, y, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p>Naturalmente, la apariencia de las líneas la podemos modificar con los parámetros usuales de grosor, color, estilo, etc. A modo de ejemplo, la Figura @ref(fig:F10016) se obtiene con el código siguiente:</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true"></a>f=<span class="cf">function</span>(x){x<span class="op">^</span><span class="dv">2</span>}</span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true"></a><span class="kw">plot</span>(f, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">9</span>))</span>
<span id="cb381-3"><a href="#cb381-3" aria-hidden="true"></a><span class="kw">lines</span>(<span class="dv">3</span><span class="op">*</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">3</span>), (<span class="dv">3</span><span class="op">*</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">3</span>))<span class="op">^</span><span class="dv">2</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">lty=</span><span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="07chap06_Graficos_I_files/figure-html/F10016-1.png" alt="Gráfica conjunta de una función y una línea poligonal inscrita." width="90%" />
<p class="caption">
(#fig:F10016)Gráfica conjunta de una función y una línea poligonal inscrita.
</p>
</div>
<!--
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.45\textwidth]{exlines.pdf}
\end{center}
\caption{Gráfica de la función $f(x)=x^2$ junto a la línea poligonal que une los puntos $(3.33n, (3.33n)^2)_{n=0, \ldots, 3}$.}\label{fig:10.16} 
\end{figure}
-->
<p>La instrucción <code>curve</code> con el parámetro <code>add=TRUE</code> permite añadir la gráfica de una curva a un gráfico anterior. La curva se puede especificar mediante una expresión algebraica con variable <span class="math inline">\(x\)</span>, o mediante su nombre si la hemos definido antes. Por ejemplo, el código siguiente produce el gráfico de la Figura @ref(fig:mons).</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true"></a>f=<span class="cf">function</span>(x){x<span class="op">^</span><span class="dv">2</span>}</span>
<span id="cb382-2"><a href="#cb382-2" aria-hidden="true"></a><span class="kw">plot</span>(f, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>), <span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>)</span>
<span id="cb382-3"><a href="#cb382-3" aria-hidden="true"></a><span class="kw">curve</span>(x<span class="op">^</span><span class="dv">3</span>, <span class="dt">lty=</span><span class="st">&quot;dashed&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</span>
<span id="cb382-4"><a href="#cb382-4" aria-hidden="true"></a><span class="kw">curve</span>(x<span class="op">^</span><span class="dv">4</span>, <span class="dt">lty=</span><span class="st">&quot;dotted&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>) </span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="07chap06_Graficos_I_files/figure-html/mons-1.png" alt="Gráfica conjunta de diferentes monomios." width="90%" />
<p class="caption">
(#fig:mons)Gráfica conjunta de diferentes monomios.
</p>
</div>
<!--
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.45\textwidth]{monomis.pdf}
\end{center}
\caption{Gráficas de diferentes monomios.}\label{fig:mons} 
\end{figure}
-->
<p>Las funciones <code>points</code>, <code>abline</code>, <code>lines</code> o <code>text</code> sólo sirven para <em>añadir</em> elementos a un gráfico. En cambio, la función <code>curve</code> también se puede usar para producir la gráfica de una función, como <code>plot</code>, con la ventaja sobre esta última que no sólo se puede aplicar a una función definida con <code>function</code>, sino también a una expresión algebraica. Además, la función <code>curve</code> admite todos los parámetros de <code>plot</code>. Así, el gráfico de la Figura @ref(fig:mons) también se obtiene con el código siguiente:</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true"></a><span class="kw">curve</span>(x<span class="op">^</span><span class="dv">2</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>), <span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>)</span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true"></a><span class="kw">curve</span>(x<span class="op">^</span><span class="dv">3</span>, <span class="dt">lty=</span><span class="st">&quot;dashed&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</span>
<span id="cb383-3"><a href="#cb383-3" aria-hidden="true"></a><span class="kw">curve</span>(x<span class="op">^</span><span class="dv">4</span>, <span class="dt">lty=</span><span class="st">&quot;dotted&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>) </span></code></pre></div>
<p>Cuando dibujamos varias funciones en un gráfico, como el de la Figura @ref(fig:mons), es conveniente usar una <em>leyenda</em> para distinguirlas. Para añadirla, se ha de usar la instrucción</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true"></a><span class="kw">legend</span>(posición, <span class="dt">legend=</span>vector de nombres de las curvas, </span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true"></a>       parámetro=vector de  valores del parámetro, ..., </span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true"></a>       parámetro=vector de  valores del parámetro)</span></code></pre></div>
<p>donde:</p>
<ul>
<li><p>La <em>posición</em> indica dónde queremos situar la leyenda, y puede ser o bien dos números para especificar las coordenadas de su esquina superior izquierda, o bien una de las palabras siguientes: <code>"bottomright"</code> (esquina inferior derecha), <code>"bottom"</code> (centrada abajo), <code>"bottomleft"</code> (esquina inferior izquierda), <code>"left"</code> (centrada a la izquierda), <code>"topleft"</code> (esquina superior izquierda), <code>"top"</code> (centrada arriba), <code>"topright"</code> (esquina superior derecha), <code>"right"</code> (centrada a la derecha) o <code>"center"</code> (en el centro del gráfico).</p></li>
<li><p>El vector <code>legend</code> contiene los nombres (entre comillas o aplicándoles <code>expression</code>) con los que queremos identificar las curvas dentro de la leyenda.</p></li>
<li><p>Cada <em>parámetro</em> se usará para especificar el vector de sus valores sobre las diferentes curvas, en el orden en el que aparecen en el vector <code>legend</code> e incluyendo los valores por defecto. Se pueden usar varios parámetros. Si se quieren distinguir las curvas por su color, obligatoriamente también se ha de especificar algún otro parámetro, y en particular si sólo se distinguen por el color, se ha de añadir <code>lty</code> igualado al tipo de línea; por defecto, <code>"solid"</code>.</p></li>
<li><p>Se puede usar también el parámetro <code>cex</code> dentro de la función <code>legend</code> para especificar el factor que queremos que se aplique al tamaño de la leyenda, si queremos modificar este último.</p></li>
</ul>
<p>Por ejemplo,</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true"></a><span class="kw">curve</span>(x<span class="op">^</span><span class="dv">2</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>), <span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>)</span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true"></a><span class="kw">curve</span>(x<span class="op">^</span><span class="dv">3</span>, <span class="dt">lty=</span><span class="st">&quot;dashed&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</span>
<span id="cb385-3"><a href="#cb385-3" aria-hidden="true"></a><span class="kw">curve</span>(x<span class="op">^</span><span class="dv">4</span>, <span class="dt">lty=</span><span class="st">&quot;dotted&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>) </span>
<span id="cb385-4"><a href="#cb385-4" aria-hidden="true"></a><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="kw">expression</span>(x<span class="op">^</span><span class="dv">2</span>), <span class="kw">expression</span>(x<span class="op">^</span><span class="dv">3</span>), <span class="kw">expression</span>(x<span class="op">^</span><span class="dv">4</span>)), </span>
<span id="cb385-5"><a href="#cb385-5" aria-hidden="true"></a>       <span class="dt">lty=</span><span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;dotted&quot;</span>))</span></code></pre></div>
<p>produce el gráfico de la Figura @ref(fig:mons21). Observad que, aunque en el primer <code>curve</code> no hemos especificado el parámetro <code>lty</code>, y ha tomado su valor por defecto, en el parámetro <code>lty</code> del <code>legend</code> sí que hemos especificado su valor para la primera función.</p>
<div class="figure" style="text-align: center">
<img src="07chap06_Graficos_I_files/figure-html/mons21-1.png" alt="Ejemplo de gráfica conjunta de diferentes funciones con una leyenda." width="90%" />
<p class="caption">
(#fig:mons21)Ejemplo de gráfica conjunta de diferentes funciones con una leyenda.
</p>
</div>
<p>Veamos otro ejemplo:</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true"></a><span class="kw">curve</span>(<span class="dv">2</span><span class="op">*</span>x<span class="op">+</span><span class="dv">3</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>), <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true"></a><span class="kw">curve</span>(<span class="dv">2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">3</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</span>
<span id="cb386-3"><a href="#cb386-3" aria-hidden="true"></a><span class="kw">curve</span>(<span class="dv">2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">3</span><span class="op">+</span><span class="dv">3</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</span>
<span id="cb386-4"><a href="#cb386-4" aria-hidden="true"></a><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="kw">expression</span>(<span class="dv">2</span><span class="op">*</span>x<span class="op">+</span><span class="dv">3</span>), <span class="kw">expression</span>(<span class="dv">2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">3</span>), <span class="kw">expression</span>(<span class="dv">2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">3</span><span class="op">+</span><span class="dv">3</span>)), </span>
<span id="cb386-5"><a href="#cb386-5" aria-hidden="true"></a>       <span class="dt">lwd=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dt">cex=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p>produce el gráfico de la Figura @ref(fig:mons22). Observad el efecto del parámetro <code>cex</code> comparando esta leyenda con la de la Figura @ref(fig:mons21).</p>
<div class="figure" style="text-align: center">
<img src="07chap06_Graficos_I_files/figure-html/mons22-1.png" alt="Ejemplo de gráfica conjunta de diferentes funciones con una leyenda reducida." width="90%" />
<p class="caption">
(#fig:mons22)Ejemplo de gráfica conjunta de diferentes funciones con una leyenda reducida.
</p>
</div>
<!--
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.45\textwidth]{monomis2.pdf}\qquad
\includegraphics[width=0.45\textwidth]{legcol.pdf}\qquad
\end{center}
\caption{Gráficas de diferentes funciones usando como leyenda el tipo de línea (izquierda) o el color y el grosor (derecha).}\label{fig:mons2} 
\end{figure}
-->
<p>El código siguiente produce la Figura @ref(fig:caca); en ella podemos observar que si el único parámetro que especificamos dentro del <code>legend</code> es el color, no se ven las líneas dentro de la leyenda.</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true"></a><span class="kw">curve</span>(<span class="dv">2</span><span class="op">*</span>x<span class="op">+</span><span class="dv">3</span>, <span class="dv">-10</span>, <span class="dv">10</span>, <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true"></a><span class="kw">curve</span>(<span class="dv">2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">3</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</span>
<span id="cb387-3"><a href="#cb387-3" aria-hidden="true"></a><span class="kw">curve</span>(<span class="dv">2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">3</span><span class="op">+</span><span class="dv">3</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</span>
<span id="cb387-4"><a href="#cb387-4" aria-hidden="true"></a><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="kw">expression</span>(<span class="dv">2</span><span class="op">*</span>x<span class="op">+</span><span class="dv">3</span>), <span class="kw">expression</span>(<span class="dv">2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">3</span>), </span>
<span id="cb387-5"><a href="#cb387-5" aria-hidden="true"></a>                           <span class="kw">expression</span>(<span class="dv">2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">3</span><span class="op">+</span><span class="dv">3</span>)), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="07chap06_Graficos_I_files/figure-html/caca-1.png" alt="Ejemplo de gráfica conjunta de diferentes funciones con una leyenda inútil" width="90%" />
<p class="caption">
(#fig:caca)Ejemplo de gráfica conjunta de diferentes funciones con una leyenda inútil
</p>
</div>
<!--
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.45\textwidth]{caca.pdf}
\end{center}
\caption{Gráficas de diferentes monomios usando como leyenda el color y su expresión, pero no el tipo de línea.}\label{fig:caca} 
\end{figure}
-->
<p>Si os interesan, también disponéis de las funciones <code>segments</code> (para
añadir segmentos), <code>arrows</code> (para añadir flechas), <code>symbols</code>
(para añadir signos, como estrellas, termómetros, …), <code>polygon</code>
(para añadir polígonos cerrados especificando sus vértices), etc.
Consultad las Ayudas de estas instrucciones para los detalles sobre cómo se
usan.</p>
</div>
<div id="guía-rápida-3" class="section level2" number="7.4">
<h2 number="7.4"><span class="header-section-number">7.4</span> Guía rápida</h2>
<ul>
<li><p><code>expression</code> sirve para producir textos matemáticamente bien formateados.</p></li>
<li><p><code>par</code> sirve para modificar el aspecto general de los gráficos. Consultad su Ayuda para conocer todos los parámetros que se pueden especificar en esta función.</p></li>
<li><p><code>plot</code> es la función genérica para producir gráficos. Sus dos usos principales (por el momento) son:</p>
<ul>
<li><code>plot(x, y)</code>, que dibuja el gráfico de los puntos con vector de primeras coordenadas <code>x</code> y vector de segundas coordenadas <code>y</code>.</li>
<li><code>plot(función)</code>, que dibuja la gráfica de la <code>función</code>.</li>
</ul>
<p>Algunos parámetros importantes:</p>
<ul>
<li><code>main</code>: sirve para especificar el título.</li>
<li><code>xlab</code> e <code>ylab</code>: sirven para especificar las etiquetas de los ejes de coordenadas.</li>
<li><code>xlim</code> e <code>ylim</code>: sirven para especificar los rangos de los ejes de coordenadas.</li>
<li><code>xaxp</code> e <code>yaxp</code>: sirven para especificar las marcas en los ejes de coordenadas.</li>
<li><code>log</code>: sirve para especificar los ejes de coordenadas que estarán en escala logarítmica.</li>
<li><code>type</code>: sirve para especificar el tipo de gráfico.</li>
<li><code>pch</code>: sirve para especificar el estilo de los puntos.</li>
<li><code>cex</code>: sirve para especificar el tamaño de los puntos.</li>
<li><code>col</code>: sirve para especificar el color del gráfico.</li>
<li><code>bg</code>: sirve para especificar el color de relleno de los puntos de estilos <code>pch</code> de 21 a 25.</li>
<li><code>lty</code>: sirve para especificar el tipo de las líneas.</li>
<li><code>lwd</code>: sirve para especificar el grosor de la líneas.</li>
</ul>
<p>Los parámetros <code>pch</code>, <code>cex</code>, <code>col</code>, <code>bg</code>, <code>type</code>, <code>lty</code> y <code>lwd</code> también se pueden usar en las funciones que siguen.</p></li>
<li><p><code>points</code> añade puntos al gráfico activo.</p></li>
<li><p><code>abline</code> añade una recta al gráfico activo. Algunos parámetros específicos importantes:</p>
<ul>
<li><code>v</code>: la abscisa de una recta vertical.</li>
<li><code>h</code>: la ordenada de una recta horizontal.</li>
</ul></li>
<li><p><code>lines</code> añade una línea poligonal al gráfico activo.</p></li>
<li><p><code>text</code> añade textos al gráfico activo. Algunos parámetros específicos importantes:</p>
<ul>
<li><code>pos</code>: la posición del texto con respecto a sus coordenadas.</li>
<li><code>labels</code>: el texto.</li>
</ul></li>
<li><p><code>legend</code> añade una leyenda al gráfico activo.</p></li>
<li><p><code>curve</code>, con el parámetro <code>add=TRUE</code>, sirve para añadir la gráfica de una función al gráfico activo. Esta función admite todos los parámetros de <code>plot</code>.</p></li>
</ul>
</div>
<div id="ejercicios-5" class="section level2" number="7.5">
<h2 number="7.5"><span class="header-section-number">7.5</span> Ejercicios</h2>
<div id="test-4" class="section level3 unnumbered">
<h3 class="unnumbered">Test</h3>
<p><em>(1)</em> Dad una sola instrucción que dibuje un histograma de líneas de los puntos <span class="math inline">\((5\cdot 3^n)_{n=10,\ldots,20}\)</span> (con las operaciones escritas exactamente en este orden). No dejéis espacios en blanco innecesarios. (Y antes de contestar, comprobad con R que la instrucción que dais hace el que os pedimos.)</p>
<p><em>(2)</em> Dad dos instrucciones sucesivas, separadas por puntos y coma seguidos de un espacio en blanco, que definan la función <span class="math inline">\(f(x)=x^3-3x^2+5\)</span> (con las operaciones en el orden dado) y a continuación dibujen su gráfica (usando la función <code>plot</code>) para <span class="math inline">\(x\)</span> entre -15 y 15 y le pongan el título “Una cúbica”. No dejéis espacios en blanco innecesarios. (Y antes de contestar, comprobad con R que la instrucción que dais funciona.)</p>
<p><em>(3)</em> Dad una sola instrucción (usando la función <code>curve</code>) que dibuje una gráfica de la función <span class="math inline">\(y=x^3-3x^2+5\)</span> (con las operaciones en el orden dado) para <span class="math inline">\(x\)</span> entre -15 y 15, deje sin etiquetar el eje de abscisas, etiquete con una <em>y</em> el eje de ordenadas y le ponga título “Una cúbica”. Los parámetros se tienen que especificar en el orden dado en el enunciado. No dejéis espacios en blanco innecesarios. (Y antes de contestar, comprobad con R que la instrucción que donau funciona.)</p>
<p><em>(4)</em> Dad tres instrucciones sucesivas, separadas por puntos y coma seguidos de un espacio en blanco, de manera que las dos primeras dibujen (usando ambas la función <code>curve</code>) una gráfica conjunta de las rectas <span class="math inline">\(y=2x\)</span> e <span class="math inline">\(y=3x\)</span> para <span class="math inline">\(x\)</span> entre -20 y 20, con ambos ejes de coordenadas sin etiquetar, con la primera recta roja y la segunda azul, y a continuación la tercera instrucción añada al gráfico producido por las dos primeras una leyenda en la esquina superior izquierda que indique que la función <span class="math inline">\(2x\)</span> es roja y la <span class="math inline">\(3x\)</span> azul. No dejéis espacios en blanco innecesarios. (Y antes de contestar, comprobad con R que las instrucciones que dais funcionan.)</p>
<p><em>(5)</em> Dad dos instrucciones sucesivas, separadas por puntos y coma seguidos de un espacio en blanco, que dibujen un gráfico conjunto de las secuencias de puntos <span class="math inline">\((n,2n^2)_{n=5,\ldots,10}\)</span> y <span class="math inline">\((n,3n^3)_{n=0,\ldots,5}\)</span>, con ambos ejes de coordenadas sin etiquetar y el rango del eje de ordenadas entre 0 y 500, con los puntos de la primera secuencia de estilo <code>pch=18</code> y los de la segunda de estilo <code>pch=20</code>. No dejéis espacios en blanco innecesarios. (Y antes de contestar, comprobad con R que las instrucciones que dais hacen el que os pedimos.)</p>
<p><em>(6)</em> Dad una instrucción que añada al gráfico inmediatamente anterior un punto en las coordenadas (2,3) de estilo <code>pch=15</code>. No dejéis espacios en blanco innecesarios.</p>
<p><em>(7)</em> Dad una instrucción que añada al gráfico inmediatamente anterior la recta <span class="math inline">\(y=3x+5\)</span> de triple grosor. No dejéis espacios en blanco innecesarios.</p>
<p><em>(8)</em> Dad una instrucción que añad al gráfico inmediatamente anterior la recta horizontal <span class="math inline">\(y=2\)</span> de color rojo. No dejéis espacios en blanco innecesarios.</p>
<p><em>(9)</em> Dad una instrucción que añada al gráfico inmediatamente anterior el texto “(2,3)” a la derecha de las coordenadas (2,3). No dejéis espacios en blanco innecesarios.</p>
</div>
<div id="ejercicio-5" class="section level3 unnumbered">
<h3 class="unnumbered">Ejercicio</h3>
<p>La <em>función de Gompertz</em> es <span class="math inline">\(G(t)=ae^{-be^{-ct}}\)</span>, con <span class="math inline">\(a, b, c\in \mathbb{R}\)</span> estrictamente positivos, y se usa para modelar
el crecimiento de tumores o de poblaciones con recursos limitados. Vamos a analizar gráficamente el efecto de los parámetros <span class="math inline">\(a, b, c\)</span>.</p>
<ul>
<li>La recta <span class="math inline">\(y=a\)</span> es una asíntota horizontal de <span class="math inline">\(G(t)\)</span>. Comprobadlo dibujando en un mismo gráfico dos funciones de Gompertz con los mismos valores de <span class="math inline">\(b\)</span> y <span class="math inline">\(c\)</span> y diferentes valores de <span class="math inline">\(a\)</span>, y las rectas horizontales definidas por estos valores de <span class="math inline">\(a\)</span>. Usad colores, tipos de líneas, textos, leyenda, todo lo que consideréis necesario para ayudar a que el gráfico muestre la información que se desea.</li>
<li>Para estudiar el efecto de <span class="math inline">\(b\)</span>, dibujad en un mismo gráfico tres funciones de Gompertz con los mismos valores de <span class="math inline">\(a\)</span> y <span class="math inline">\(c\)</span> y diferentes valores de <span class="math inline">\(b\)</span>. De nuevo, usad todo lo que consideréis necesario para mejorar la comprensión del gráfico.
A partir de este gráfico, ¿qué efecto diríais que tiene el parámetro <span class="math inline">\(b\)</span> sobre la gráfica de la función?</li>
<li>Para estudiar el efecto de <span class="math inline">\(c\)</span>, dibujad en un mismo gráfico tres funciones de Gompertz con los mismos valores de <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span> y diferentes valores de <span class="math inline">\(c\)</span>. De nuevo, usad todo lo que consideréis necesario para mejorar la comprensión del gráfico. A partir de este gráfico, ¿qué efecto diríais que tiene el parámetro <span class="math inline">\(c\)</span> sobre la gráfica de la función?</li>
</ul>
</div>
<div id="respuestas-al-test-4" class="section level3 unnumbered">
<h3 class="unnumbered">Respuestas al test</h3>
<p><em>(1)</em> <code>plot(10:20,5*3^(10:20),type="h")</code></p>
<p><em>(2)</em> <code>f=function(x){x^3-3*x^2+5}; plot(f,xlim=c(-15,15),main="Una cúbica")</code></p>
<p><em>(3)</em> <code>curve(x^3-3*x^2+5,xlim=c(-15,15),xlab="",ylab="y",main="Una cúbica")</code></p>
<p><em>(4)</em> <code>curve(2*x,xlim=c(-20,20),xlab="",ylab="",col="red"); curve(3*x, col="blue",add=TRUE); legend("topleft",legend=c("2x","3x"),lty=c(1,1),col=c("red","blue"))</code></p>
<p><em>(5)</em> <code>plot(5:10,2*(5:10)^2,xlim=c(0,10),ylim=c(0,1000),xlab="",ylab="",pch=18); points(0:5,3*(0:5)^3,pch=20)</code></p>
<p><em>(6)</em> <code>points(2,3,pch=15)</code></p>
<p><em>(7)</em> <code>abline(5,3,lwd=3)</code></p>
<p><em>(8)</em> <code>abline(h=2,col="red")</code></p>
<p><em>(9)</em> <code>text(2,3,labels="(2,3)",pos=4)</code></p>
<!--chapter:end:07chap06_Graficos_I.Rmd-->
</div>
</div>
</div>
<div id="chap:for" class="section level1" number="8">
<h1 number="8"><span class="header-section-number">8</span> Estructuras de control básicas</h1>
<p>Una de las grandes ventajas de R es su capacidad de <strong>vectorizar construcciones</strong>, es decir, la posibilidad de aplicar de golpe una función a todo un vector, o a todas las entradas de un vector, o a todas las filas o columnas de un <em>data frame</em> o una matriz. Por ejemplo, para calcular la suma de todos los elementos de un vector, en muchos lenguajes de programación tendríamos que llevar a cabo un proceso recurrente como el que sigue:</p>
<ol style="list-style-type: decimal">
<li>Iniciar una variable “Suma” igual al primer elemento del vector</li>
<li>Para cada posición <em>i</em> entre 2 y la longitud del vector, redefinir “Suma” como la suma de su valor actual y el elemento <em>i</em>-ésimo del vector</li>
<li>Al llegar al final del vector, dar el valor final de “Suma”</li>
</ol>
<p>En cambio, como sabéis, con R basta entrar <code>sum(vector)</code>.</p>
<p>De manera similar, para calcular todos los cuadrados de números naturales del 1 al 100, con R basta entrar <code>(1:100)^2</code>, mientras que en muchos lenguajes de programación tendríamos que llevar a cabo un proceso similar al anterior:</p>
<ol style="list-style-type: decimal">
<li>Definir un vector “Cuadrados” vacío</li>
<li>Para cada n entre 1 y 100, añadir al final del vector “Cuadrados” el valor de n<sup>2</sup></li>
<li>Al terminar, dar el contenido final del vector “Cuadrados”</li>
</ol>
<p>Incluso para construcciones más complicadas que elevar al cuadrado, R dispone de funciones, genéricamente llamadas <strong>funciones de tipo apply</strong> que permiten aplicar una función a todos los elementos de un objeto. Algunas de estas funciones ya han aparecido en lecciones anteriores:</p>
<ul>
<li><p><code>apply</code>, para aplicar una función a todas las filas o a todas las columnas de una matriz</p></li>
<li><p><code>aggregate</code>, para aplicar una función a todos los grupos formados al clasificar una variable según un factor</p></li>
<li><p><code>lapply</code>, para aplicar una función a todos los elementos de un objeto y dar el resultado en forma de <em>list</em></p></li>
<li><p><code>sapply</code>, para aplicar una función a todos los elementos de un objeto y dar el resultado con una estructura lo más sencilla posible (por ejemplo, si el resultado es una lista de números, forma con ellos un vector)</p></li>
</ul>
<p>Las normas usuales de “buena práctica de la programación” en R fomentan el uso de la vectorización de cálculos usando funciones de tipo <em>apply</em> u otras funciones específicas tipo <code>sum</code> cuando existen. Pero hay ocasiones en que es necesario, o nos puede convenir por algún motivo, escribir un pequeño <strong>bucle</strong> (un proceso que repite varias veces una misma secuencia de operaciones) del estilo de los que hemos explicado. En esta lección explicamos cómo usar en R los dos tipos de bucles más sencillos: los bucles de tipo <strong>for</strong> y de tipo <strong>while</strong>. Completamos la lección introduciendo otro tipo de estructura de control muy común: las estructuras condicionales.</p>
<div id="bucles-de-tipo-for" class="section level2" number="8.1">
<h2 number="8.1"><span class="header-section-number">8.1</span> Bucles de tipo “for”</h2>
<p>Un <strong>bucle de tipo “for”</strong> es una estructura del tipo “Para todo … haz …” en la que se repite una determinada operación o secuencia de operaciones para todos los elementos de un vector (también puede ser de una list, pero para simplificar aquí siempre tomaremos un vector). Con R, este tipo de bucles se especifican con una instrucción de la forma</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true"></a><span class="cf">for</span>(índice <span class="cf">in</span> vector){acción}</span></code></pre></div>
<p>Esta sintaxis indica a R que</p>
<blockquote>
<p>para todo <code>índice</code> que pertenezca al <code>vector</code>, efectúe la <code>acción</code> especificada entre las llaves.</p>
</blockquote>
<p>En esta instrucción el <code>índice</code> juega un papel de variable interna, como las variables entre los paréntesis en la definición de funciones.</p>
<p>Así, por ejemplo, para construir el vector de los cuadrados de números naturales del 1 al 10 por medio de un bucle de tipo “for” entraríamos</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true"></a><span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){Cuadrados[n]=n<span class="op">^</span><span class="dv">2</span>}</span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true"></a><span class="co">#&gt; Error in eval(expr, envir, enclos): objeto &#39;Cuadrados&#39; no encontrado</span></span></code></pre></div>
<p>Bueno, ya veis que no. Esta construcción solo implementa el paso 2 del proceso descrito en la introducción de la lección. Antes, hay que efectuar el paso 1: definir el vector de Cuadrados y darle un valor inicial, aunque sea igualarlo a un vector vacío, para que luego R lo vaya construyendo:</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true"></a>Cuadrados=<span class="kw">c</span>()  <span class="co">#Iniciamos Cuadrados como un vector vacío</span></span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true"></a><span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){Cuadrados[n]=n<span class="op">^</span><span class="dv">2</span>}</span>
<span id="cb390-3"><a href="#cb390-3" aria-hidden="true"></a>Cuadrados</span>
<span id="cb390-4"><a href="#cb390-4" aria-hidden="true"></a><span class="co">#&gt;  [1]   1   4   9  16  25  36  49  64  81 100</span></span></code></pre></div>
<p>En vez de empezar con el vector <code>Cuadrados</code> vacío, podríamos iniciarlo con su primera entrada, 1. Y en vez de ir definiendo las entradas sucesivas de este vector en las diferentes iteraciones del bucle, también podríamos ir añadiéndolas al final:</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true"></a>Cuadrados=<span class="kw">c</span>(<span class="dv">1</span>)  </span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true"></a><span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="dv">10</span>){Cuadrados=<span class="kw">c</span>(Cuadrados,n<span class="op">^</span><span class="dv">2</span>)}</span>
<span id="cb391-3"><a href="#cb391-3" aria-hidden="true"></a>Cuadrados</span>
<span id="cb391-4"><a href="#cb391-4" aria-hidden="true"></a><span class="co">#&gt;  [1]   1   4   9  16  25  36  49  64  81 100</span></span></code></pre></div>
<p>Desde el punto de vista de R, estos dos bucles de tipo “for” tienen un defecto: como cada iteración del bucle cambia la dimensión del vector <code>Cuadrados</code>, en cada iteración R define un nuevo objeto “Cuadrados” en el que copia el contenido del <code>Cuadrados</code> anterior y le añade el nuevo elemento. En bucles más complicados, esto podría ralentizar el cálculo. La manera correcta de definir este bucle en R es iniciar el vector <code>Cuadrados</code> como un vector de la longitud que va a tener al final, 10 en nuestro caso, y con el contenido que queramos, por ejemplo constante, y entonces ir modificando sus entradas una a una:</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true"></a>Cuadrados=<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">10</span>)  </span>
<span id="cb392-2"><a href="#cb392-2" aria-hidden="true"></a><span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="dv">10</span>){Cuadrados[n]=n<span class="op">^</span><span class="dv">2</span>}</span>
<span id="cb392-3"><a href="#cb392-3" aria-hidden="true"></a>Cuadrados</span>
<span id="cb392-4"><a href="#cb392-4" aria-hidden="true"></a><span class="co">#&gt;  [1]   1   4   9  16  25  36  49  64  81 100</span></span></code></pre></div>

<div class="example">
<p><span id="exm:fib1" class="example"><strong>(#exm:fib1) </strong></span>Estamos seguros de que conocéis la sucesión de Fibonacci <span class="math inline">\(F_n\)</span>,
<span class="math display">\[
1, 1, 2, 3, 5, 8, 13, 21, 34, 55, \ldots,
\]</span>
donde cada término es la suma de los dos anteriores. Esto corresponde a la recurrencia
<span class="math display">\[
F_{n}=F_{n-2}+F_{n-1},
\]</span>
que, junto con las condiciones iniciales <span class="math inline">\(F_1=F_2=1\)</span>, determina completamente la sucesión:
<span class="math display">\[
\begin{array}{l}
F_3=F_1+F_2=2\\
F_4=F_2+F_3=3\\
F_5=F_3+F_4=5\\
\quad\vdots
\end{array}
\]</span></p>
</div>
<p>Vamos a calcular los 20 primeros números de Fibonacci, <span class="math inline">\((F_n)_{n=1,\ldots,20}\)</span>. Para ello, usaremos un bucle de tipo “for” que traduzca la construcción “para cada n de 3 a 20, <span class="math inline">\(F_n\)</span> es la suma de <span class="math inline">\(F_{n-1}\)</span> y <span class="math inline">\(F_{n-2}\)</span>”. Como <span class="math inline">\(F_1=F_2=1\)</span>, iniciaremos el vector que al final contendrá nuestros números de Fibonacci como un vector formado por veinte unos, y con el bucle redefniremos sus entradas a partir de la tercera:</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true"></a>Fib=<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">20</span>) </span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true"></a><span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">3</span><span class="op">:</span><span class="dv">20</span>){Fib[n]=Fib[n<span class="dv">-1</span>]<span class="op">+</span>Fib[n<span class="dv">-2</span>]} </span>
<span id="cb393-3"><a href="#cb393-3" aria-hidden="true"></a>Fib</span>
<span id="cb393-4"><a href="#cb393-4" aria-hidden="true"></a><span class="co">#&gt;  [1]    1    1    2    3    5    8   13   21   34   55   89  144  233  377  610</span></span>
<span id="cb393-5"><a href="#cb393-5" aria-hidden="true"></a><span class="co">#&gt; [16]  987 1597 2584 4181 6765</span></span></code></pre></div>
<p>Como en la definición de funciones, si la construcción que queremos realizar en cada paso de un bucle, sea de tipo “for” o, en la siguiente sección, de tipo “while”, requiere de más de una instrucción, las podemos separar dentro de las llaves mediante signos de punto y coma o simplemente escribiéndolas en líneas aparte. Además, podéis anidar instrucciones <code>for</code> si necesitáis que el conjunto de índices sea multidimensional.</p>

<div class="example">
<p><span id="exm:unnamed-chunk-7" class="example"><strong>(#exm:unnamed-chunk-7) </strong></span>Supongamos que queremos definir una función SimM que, aplicada a una matriz cuadrada A, la <em>simetrice</em>, es decir, substituya cada entrada (i,j) de A fuera de su diagonal principal por la media de las entradas (i,j) y (j,i). Para ello lo que haremos será, dada la matriz A, si n indica sus números de filas y de columnas:</p>
</div>
<ol style="list-style-type: decimal">
<li>Definir una copia AA de A</li>
<li>Para cada i entre 1 y n-1 y para cada j entre i+1 y n, redefinir AA[i,j] y AA[j,i] como (A[i,j]+A[j,i])/2</li>
<li>Dar como resultado la matriz simétrica AA resultante</li>
</ol>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true"></a>SimM=<span class="cf">function</span>(A){</span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true"></a>  n=<span class="kw">dim</span>(A)[<span class="dv">1</span>]</span>
<span id="cb394-3"><a href="#cb394-3" aria-hidden="true"></a>  AA=A</span>
<span id="cb394-4"><a href="#cb394-4" aria-hidden="true"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb394-5"><a href="#cb394-5" aria-hidden="true"></a>    <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n){</span>
<span id="cb394-6"><a href="#cb394-6" aria-hidden="true"></a>      AA[i,j]=(A[i,j]<span class="op">+</span>A[j,i])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb394-7"><a href="#cb394-7" aria-hidden="true"></a>      AA[j,i]=(A[i,j]<span class="op">+</span>A[j,i])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb394-8"><a href="#cb394-8" aria-hidden="true"></a>    }</span>
<span id="cb394-9"><a href="#cb394-9" aria-hidden="true"></a>  }</span>
<span id="cb394-10"><a href="#cb394-10" aria-hidden="true"></a>AA</span>
<span id="cb394-11"><a href="#cb394-11" aria-hidden="true"></a>}</span></code></pre></div>
<p>Veamos con un ejemplo si funciona:</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true"></a>A=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true"></a>A</span>
<span id="cb395-3"><a href="#cb395-3" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb395-4"><a href="#cb395-4" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    2    3</span></span>
<span id="cb395-5"><a href="#cb395-5" aria-hidden="true"></a><span class="co">#&gt; [2,]    4    5    6</span></span>
<span id="cb395-6"><a href="#cb395-6" aria-hidden="true"></a><span class="co">#&gt; [3,]    7    8    9</span></span>
<span id="cb395-7"><a href="#cb395-7" aria-hidden="true"></a><span class="kw">SimM</span>(A)</span>
<span id="cb395-8"><a href="#cb395-8" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb395-9"><a href="#cb395-9" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    3    5</span></span>
<span id="cb395-10"><a href="#cb395-10" aria-hidden="true"></a><span class="co">#&gt; [2,]    3    5    7</span></span>
<span id="cb395-11"><a href="#cb395-11" aria-hidden="true"></a><span class="co">#&gt; [3,]    5    7    9</span></span></code></pre></div>
<p>Naturalmente, y como casi siempre con R, no hacía falta usar bucles de tipo “for” para definir esta función:</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true"></a>SimM2=<span class="cf">function</span>(A){(A<span class="op">+</span><span class="kw">t</span>(A))<span class="op">/</span><span class="dv">2</span>}</span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true"></a><span class="kw">SimM2</span>(A)</span>
<span id="cb396-3"><a href="#cb396-3" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb396-4"><a href="#cb396-4" aria-hidden="true"></a><span class="co">#&gt; [1,]    1    3    5</span></span>
<span id="cb396-5"><a href="#cb396-5" aria-hidden="true"></a><span class="co">#&gt; [2,]    3    5    7</span></span>
<span id="cb396-6"><a href="#cb396-6" aria-hidden="true"></a><span class="co">#&gt; [3,]    5    7    9</span></span></code></pre></div>
</div>
<div id="bucles-de-tipo-while" class="section level2" number="8.2">
<h2 number="8.2"><span class="header-section-number">8.2</span> Bucles de tipo “while”</h2>
<p>Los <strong>bucles de tipo “while”</strong> repiten una determinada secuencia de operaciones mientras (<em>while</em>) una cierta condición lógica se satisfaga. Su sintaxis es</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true"></a><span class="cf">while</span>(condición){acción}</span></code></pre></div>
<p>e indica a R que</p>
<blockquote>
<p>antes de efectuar por primera vez la <code>acción</code> especificada entre las llaves y tras cada ejecución de la misma, compruebe si la <code>condición</code> especificada entre paréntesis se satisface; en caso afirmativo, vuelva a efectuar la acción, y en caso negativo pare la ejecución del bucle.</p>
</blockquote>
<p>Por ejemplo, el bucle</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true"></a>Cuadrados=<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">10</span>)</span>
<span id="cb398-2"><a href="#cb398-2" aria-hidden="true"></a><span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){Cuadrados[n]=n<span class="op">^</span><span class="dv">2</span>}</span>
<span id="cb398-3"><a href="#cb398-3" aria-hidden="true"></a>Cuadrados</span>
<span id="cb398-4"><a href="#cb398-4" aria-hidden="true"></a><span class="co">#&gt;  [1]   1   4   9  16  25  36  49  64  81 100</span></span></code></pre></div>
<p>se podría reescribir como un <code>while</code> de la manera siguiente</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true"></a>n=<span class="dv">1</span> <span class="co">#Iniciamos un contador</span></span>
<span id="cb399-2"><a href="#cb399-2" aria-hidden="true"></a>Cuadrados=<span class="kw">c</span>() <span class="co">#Iniciamos el vector</span></span>
<span id="cb399-3"><a href="#cb399-3" aria-hidden="true"></a><span class="cf">while</span>(n<span class="op">&lt;=</span><span class="dv">10</span>){ <span class="co">#Mientras n sea menor o igual a 10...</span></span>
<span id="cb399-4"><a href="#cb399-4" aria-hidden="true"></a>  Cuadrados[n]=n<span class="op">^</span><span class="dv">2</span> <span class="co">#añadimos n^2 al vector de Cuadrados...</span></span>
<span id="cb399-5"><a href="#cb399-5" aria-hidden="true"></a>  n=n<span class="op">+</span><span class="dv">1</span> <span class="co">#y aumentamos en 1 el contador n</span></span>
<span id="cb399-6"><a href="#cb399-6" aria-hidden="true"></a>}</span>
<span id="cb399-7"><a href="#cb399-7" aria-hidden="true"></a>Cuadrados</span>
<span id="cb399-8"><a href="#cb399-8" aria-hidden="true"></a><span class="co">#&gt;  [1]   1   4   9  16  25  36  49  64  81 100</span></span></code></pre></div>
<p>Este bucle:</p>
<ul>
<li>Como <span class="math inline">\(1\leqslant 10\)</span>, definirá Cuadrados[1]=1 y redefinirá n=2;</li>
<li>Comprobará que <span class="math inline">\(2\leqslant 10\)</span>, y entonces definirá Cuadrados[2]=4 y redefinirá n=3;</li>
<li>Comprobará que <span class="math inline">\(3\leqslant 10\)</span>, y entonces definirá Cuadrados[3]=9 y redefinirá n=4;</li>
<li>…</li>
<li>Comprobará que <span class="math inline">\(10\leqslant 10\)</span>, y entonces definirá Cuadrados[10]=100 y redefinirá n=11;</li>
<li>Comprobará que <span class="math inline">\(11&gt;10\)</span> y parará.</li>
</ul>
<p>Veamos otro ejemplo. Supongamos que queremos calcular los números de Fibonacci menores o iguales a 100. Podemos usar un bucle de tipo “while” de la manera siguiente:</p>
<ol style="list-style-type: decimal">
<li>Iniciaremos un vector con los dos primeros números de Fibonacci</li>
<li>Mientras la suma de los dos últimos números de Fibonacci calculados sea menor o igual a 100, añadiremos esta suma al final del vector, como siguiente número de Fibonacci</li>
</ol>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true"></a>Fib=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>) </span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true"></a><span class="cf">while</span>(Fib[<span class="kw">length</span>(Fib)]<span class="op">+</span>Fib[<span class="kw">length</span>(Fib)<span class="op">-</span><span class="dv">1</span>]<span class="op">&lt;=</span><span class="dv">100</span>){</span>
<span id="cb400-3"><a href="#cb400-3" aria-hidden="true"></a>  Fib[<span class="kw">length</span>(Fib)<span class="op">+</span><span class="dv">1</span>]=Fib[<span class="kw">length</span>(Fib)]<span class="op">+</span>Fib[<span class="kw">length</span>(Fib)<span class="op">-</span><span class="dv">1</span>] </span>
<span id="cb400-4"><a href="#cb400-4" aria-hidden="true"></a>  } </span>
<span id="cb400-5"><a href="#cb400-5" aria-hidden="true"></a>Fib</span>
<span id="cb400-6"><a href="#cb400-6" aria-hidden="true"></a><span class="co">#&gt;  [1]  1  1  2  3  5  8 13 21 34 55 89</span></span></code></pre></div>
<p>El siguiente número de Fibonacci ya sería mayor que 100:</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true"></a>Fib[<span class="kw">length</span>(Fib)]<span class="op">+</span>Fib[<span class="kw">length</span>(Fib)<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true"></a><span class="co">#&gt; [1] 144</span></span></code></pre></div>
</div>
<div id="estructuras-condicionales" class="section level2" number="8.3">
<h2 number="8.3"><span class="header-section-number">8.3</span> Estructuras condicionales</h2>
<p>Las <strong>estructuras de control condicionales</strong> (o <strong>condicionales</strong> a secas) permiten que un programa decida de manera automática entre varias opciones en función de si se cumplen o no determinadas condiciones. Estas estructuras tienen en R la misma estructura que en casi todos los otros lenguajes de programación. Por un lado, tenemos la estructura</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true"></a><span class="cf">if</span>(condición){acción}</span></code></pre></div>
<p>que indica a R que</p>
<blockquote>
<p>si se satisface la <code>condición</code> especificada entre paréntesis, se lleve a cabo la <code>acción</code> especificada entre llaves y luego se continúe con el programa, mientras que si no se satisface dicha <code>condición</code>, se continúe con el programa sin efectuar la <code>acción</code>.</p>
</blockquote>
<p>Por otro lado, tenemos la estructura</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true"></a><span class="cf">if</span>(condición){acción1} <span class="cf">else</span> {acción2}</span></code></pre></div>
<p>que indica a R que</p>
<blockquote>
<p>si se satisface la <code>condición</code> se lleve a cabo la <code>acción1</code> y si no se satisface dicha <code>condición</code> se lleve a cabo la <code>acción2</code> (y luego, en ambos casos se continúe con el programa).</p>
</blockquote>
<p>Por ejemplo, si quisiéramos definir una función que valiera <span class="math inline">\(x^2\)</span> si <span class="math inline">\(x\leqslant 0\)</span> y <span class="math inline">\(x^3\)</span> si <span class="math inline">\(x\geqslant 0\)</span>, tendríamos que usar un condicional:</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true"></a>f=<span class="cf">function</span>(x){</span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true"></a>  <span class="cf">if</span>(x<span class="op">&lt;=</span><span class="dv">0</span>){x<span class="op">^</span><span class="dv">2</span>} <span class="cf">else</span> {x<span class="op">^</span><span class="dv">3</span>}</span>
<span id="cb404-3"><a href="#cb404-3" aria-hidden="true"></a>}</span>
<span id="cb404-4"><a href="#cb404-4" aria-hidden="true"></a><span class="kw">f</span>(<span class="op">-</span><span class="dv">3</span>)</span>
<span id="cb404-5"><a href="#cb404-5" aria-hidden="true"></a><span class="co">#&gt; [1] 9</span></span>
<span id="cb404-6"><a href="#cb404-6" aria-hidden="true"></a><span class="kw">f</span>(<span class="dv">3</span>)</span>
<span id="cb404-7"><a href="#cb404-7" aria-hidden="true"></a><span class="co">#&gt; [1] 27</span></span></code></pre></div>
<p>Vamos a definir una función más complicada, que usará varios condicionales y un bucle. Se trata de una función que usa la <strong>criba de Eratóstenes</strong> (un número natural <span class="math inline">\(n\)</span> mayor que 1 es primo si, y solo si, no es divisible por ningún número natural entre 2 y <span class="math inline">\(n-1\)</span>) para decidir si un número natural es primo o no, indicándolo con los valores lógicos usuales <code>TRUE</code> y <code>FALSE</code>. En esta función:</p>
<ol style="list-style-type: decimal">
<li><p>En primer lugar usaremos un condicional para que si la entrada no es un número natural nos dé un mensaje de error y si es un número natural proceda con la criba de Eratóstenes.</p></li>
<li><p>A continuación, con un segundo condicional separaremos las entradas 0 y 1, que no son primos, del resto.</p></li>
<li><p>Luego, con un tercer condicional separaremos la entrada 2, que es un número primo, de las mayores o iguales que 3.</p></li>
<li><p>Finalmente, para un número <span class="math inline">\(n\geqslant 3\)</span>, con un bucle de tipo “for” probaremos todos los divisores naturales entre 2 y <span class="math inline">\(n-1\)</span>: si algún resto de la división entera da resto 0 (un cuarto condicional), el número entrado no es primo, y si todos los restos son diferentes de 0, sí que es primo.</p></li>
</ol>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true"></a>Es.Primo=<span class="cf">function</span>(n){</span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true"></a>  <span class="cf">if</span> (n<span class="op">!=</span><span class="kw">round</span>(n) <span class="op">|</span><span class="st"> </span>n<span class="op">&lt;</span><span class="dv">0</span>){ <span class="co">#Si n no es entero o si es negativo...</span></span>
<span id="cb405-3"><a href="#cb405-3" aria-hidden="true"></a>    <span class="kw">stop</span>(<span class="st">&quot;El argumento no es un número natural&quot;</span>)  <span class="co">#da error y para</span></span>
<span id="cb405-4"><a href="#cb405-4" aria-hidden="true"></a>  } <span class="cf">else</span> {</span>
<span id="cb405-5"><a href="#cb405-5" aria-hidden="true"></a>    <span class="cf">if</span> (n<span class="op">==</span><span class="dv">0</span> <span class="op">|</span><span class="st"> </span>n<span class="op">==</span><span class="dv">1</span>){</span>
<span id="cb405-6"><a href="#cb405-6" aria-hidden="true"></a>          Primo=<span class="ot">FALSE</span></span>
<span id="cb405-7"><a href="#cb405-7" aria-hidden="true"></a>    } <span class="cf">else</span> {</span>
<span id="cb405-8"><a href="#cb405-8" aria-hidden="true"></a>      Primo=<span class="ot">TRUE</span></span>
<span id="cb405-9"><a href="#cb405-9" aria-hidden="true"></a>      <span class="cf">if</span> (n<span class="op">&gt;=</span><span class="dv">3</span>){</span>
<span id="cb405-10"><a href="#cb405-10" aria-hidden="true"></a>           <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb405-11"><a href="#cb405-11" aria-hidden="true"></a>          <span class="cf">if</span> ((n <span class="op">%%</span><span class="st"> </span>i) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) {</span>
<span id="cb405-12"><a href="#cb405-12" aria-hidden="true"></a>            Primo=<span class="ot">FALSE</span></span>
<span id="cb405-13"><a href="#cb405-13" aria-hidden="true"></a>          } </span>
<span id="cb405-14"><a href="#cb405-14" aria-hidden="true"></a>}</span>
<span id="cb405-15"><a href="#cb405-15" aria-hidden="true"></a>}</span>
<span id="cb405-16"><a href="#cb405-16" aria-hidden="true"></a>} </span>
<span id="cb405-17"><a href="#cb405-17" aria-hidden="true"></a>Primo</span>
<span id="cb405-18"><a href="#cb405-18" aria-hidden="true"></a>}</span>
<span id="cb405-19"><a href="#cb405-19" aria-hidden="true"></a>}</span></code></pre></div>
<p>Veamos un ejemplo que dé error:</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true"></a><span class="kw">Es.Primo</span>(<span class="op">-</span><span class="dv">3</span>)</span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true"></a><span class="co">#&gt; Error in Es.Primo(-3): El argumento no es un número natural</span></span></code></pre></div>
<p>Y ahora vamos a aplicar esta función a todos los números naturales entre 0 y 20. No, no usaremos un <code>for</code>, usaremos <code>sapply</code>.</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true"></a><span class="kw">sapply</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">20</span>,<span class="dt">FUN=</span>Es.Primo)</span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true"></a><span class="co">#&gt;  [1] FALSE FALSE  TRUE  TRUE FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE  TRUE</span></span>
<span id="cb407-3"><a href="#cb407-3" aria-hidden="true"></a><span class="co">#&gt; [13] FALSE  TRUE FALSE FALSE FALSE  TRUE FALSE  TRUE FALSE</span></span></code></pre></div>
</div>
<div id="guía-rápida-de-funciones-3" class="section level2" number="8.4">
<h2 number="8.4"><span class="header-section-number">8.4</span> Guía rápida de funciones</h2>
<ul>
<li><p><code>apply</code> aplica una función a todas las filas o a todas las columnas de una matriz</p></li>
<li><p><code>aggregate</code> aplica una función a todos los grupos formados al clasificar una variable según un factor</p></li>
<li><p><code>lapply</code> aplica una función a todos los elementos de un objeto y da el resultado en forma de <em>list</em></p></li>
<li><p><code>sapply</code> aplica una función a todos los elementos de un objeto y simplifca la estructura el resultado</p></li>
<li><p><code>for(índice in vector){acción}</code> implementa un bucle de tipo “for”</p></li>
<li><p><code>while(condición){acción}</code> implementa un bucle de tipo “while”</p></li>
<li><p><code>if(condición){acción}</code> implementa un condicional “if…then”</p></li>
<li><p><code>if(condición){acción1} else {acción2}</code> implementa un condicional “if…then…else”</p></li>
<li><p><code>stop</code> para una ejecución y da un mensaje de error</p></li>
</ul>
</div>
<div id="ejercicios-6" class="section level2" number="8.5">
<h2 number="8.5"><span class="header-section-number">8.5</span> Ejercicios</h2>
<div id="test-5" class="section level3 unnumbered">
<h3 class="unnumbered">Test</h3>
<p><em>(1)</em> Dad el valor del término <span class="math inline">\(x_{100}\)</span> de la sucesión <span class="math inline">\(x_n\)</span> definida por <span class="math inline">\(x_1=1\)</span>, <span class="math inline">\(x_2=2\)</span> y <span class="math inline">\(x_{n}=2x_{n-1}-x_{n-2}+\lfloor n/2\rfloor\)</span> para todo <span class="math inline">\(n\geqslant 3\)</span>.</p>
<p><em>(2)</em> Tenemos dos sucesiones <span class="math inline">\(x_n\)</span> y <span class="math inline">\(y_n\)</span> que evolucionan de manera conjunta siguiendo las ecuaciones <span class="math inline">\(x_{n+1}=2x_n-3y_n\)</span> e <span class="math inline">\(y_{n+1}=x_n+(-1)^ny_n\)</span>. Si partimos de <span class="math inline">\(x_1=10\)</span> y <span class="math inline">\(y_1=1\)</span>, ¿qué vale <span class="math inline">\(y_n\)</span> para el primer <span class="math inline">\(n\)</span> tal que <span class="math inline">\(x_n&gt;10^6\)</span>?</p>
</div>
<div id="ejercicio-6" class="section level3 unnumbered">
<h3 class="unnumbered">Ejercicio</h3>
<p>La <strong>conjetura de Collatz</strong> es una de las más misteriosas de la matemática actual. Dice lo siguiente.</p>
<blockquote>
<p>Empezando con un número natural mayor o igual que 1 cualquiera, iterad el proceso siguiente: si el número es par, lo dividimos por 2, y si es impar, lo multiplicamos por 3 y le sumamos 1, y vuelta a empezar. Esto proceso terminará por producir, más pronto o más tarde, siempre un 1.</p>
</blockquote>
<p>Por ejemplo, empecemos con 7.</p>
<ol style="list-style-type: decimal">
<li><p>Como 7 es impar, lo multiplicamos por 3 y le sumamos 1: 22.</p></li>
<li><p>Como 22 es par, lo dividimos por 2: 11.</p></li>
<li><p>Como 11 es impar, lo multiplicamos por 3 y le sumamos 1: 34.</p></li>
<li><p>Como 34 es par, lo dividimos por 2: 17.</p></li>
<li><p>Como 17 es impar, lo multiplicamos por 3 y le sumamos 1: 52</p></li>
<li><p>Como 52 es par, lo dividimos por 2: 26.</p></li>
<li><p>Como 26 es par, lo dividimos por 2: 13.</p></li>
<li><p>Como 13 es impar, lo multiplicamos por 3 y le sumamos 1: 40.</p></li>
<li><p>Como 40 es par, lo dividimos por 2: 20.</p></li>
<li><p>Como 20 es par, lo dividimos por 2: 10.</p></li>
<li><p>Como 10 es par, lo dividimos por 2: 5.</p></li>
<li><p>Como 5 es impar, lo multiplicamos por 3 y le sumamos 1: 16.</p></li>
<li><p>Como 16 es par, lo dividimos por 2: 8.</p></li>
<li><p>Como 8 es par, lo dividimos por 2: 4.</p></li>
<li><p>Como 4 es par, lo dividimos por 2: 2.</p></li>
<li><p>Como 2 es par, lo dividimos por 2: <strong>1</strong>.</p></li>
</ol>
<p>Fijaos que al llegar al 1, entraríamos en un bucle. Como es impar, lo multiplicaríamos por 3 y le sumaríamos 1, daría 4; como es par, lo dividiríamos por 2, daría 2; como es par, lo dividiríamos por 2, daría 1; y volveríamos al 4.</p>
<p><em>(1)</em> Definid una función que, aplicada a un número natural no nulo n, produzca la secuencia que se obtiene con este procedimiento empezando con n hasta llegar a un 1.</p>
<p><em>(2)</em> Definid una función que, aplicada a dos números naturales no nulos n y N, produzca la secuencia que se obtiene con este procedimiento empezando con n hasta llegar a un 1, o que pare si han efectuado N pasos sin alcanzarlo y entonces escriba en la consola “Tras N pasos no hemos llegado a un 1” (con N el número que se ha entrado). Para esto último podéis usar la función <code>paste</code>; consultad su Ayuda. Además, la función ha de dar algún mensaje de error si la n a la que se aplique no es un número natural mayor que 0.</p>
<p><em>(3)</em> ¿Cuál es el primer número natural para el que, tras 250 pasos, no se ha llegado a 1?</p>
</div>
<div id="respuestas-al-test-5" class="section level3 unnumbered">
<h3 class="unnumbered">Respuestas al test</h3>
<p><em>(1)</em> 8.4576^{4}</p>
<p><em>(2)</em> 1.56941^{5}</p>
<!--chapter:end:08chap07_Control.Rmd-->
</div>
</div>
</div>
<div id="chap:distr" class="section level1" number="9">
<h1 number="9"><span class="header-section-number">9</span> Distribuciones de probabilidad</h1>
<p>R conoce los tipos de distribución de probabilidad más importantes, incluyendo las que mostramos en la tabla siguiente:</p>
<p><span class="math display">\[
\begin{array}{lll}
\hline
\textbf{Distribución} &amp; {\textbf{Nombre en R}} &amp; {\textbf{Parámetros}}\\ \hline
\mbox{Binomial} &amp;{\texttt{binom}} &amp; \mbox{tamaño de la muestra $n$, probabilidad $p$}\\
\mbox{Geométrica} &amp; {\texttt{geom}} &amp; \mbox{$p$}\\
\mbox{Hipergeométrica} &amp; {\texttt{hyper}} &amp; \mbox{tamaño de la población $N$, número poblacional}\\[-0.75ex] 
&amp; &amp; \mbox{de éxitos $M$, tamaño de la muestra $n$}\\
\mbox{Poisson} &amp; {\texttt{pois}} &amp; \mbox{esperanza $\lambda$}\\
\mbox{Uniforme} &amp; {\texttt{unif}} &amp; \mbox{mínimo, máximo}\\
\mbox{Exponencial} &amp; {\texttt{exp}} &amp; \lambda\\
\mbox{Normal} &amp; {\texttt{norm}} &amp; \mbox{media $\mu$, desviación típica $\sigma$}\\
\mbox{Khi cuadrado} &amp; {\texttt{chisq}} &amp; \mbox{número de grados de libertad $df$}\\
\mbox{t de Student} &amp; {\texttt{t}} &amp; \mbox{número de grados de libertad $df$}\\
\mbox{F de Fisher} &amp; {\texttt{f}} &amp; \mbox{los dos números de  grados de libertad}
\\ \hline
\end{array}
\]</span></p>
<p>Para cada una de estas distribuciones, R sabe calcular cuatro funciones, que se obtienen añadiendo un prefijo al nombre de la distribución:</p>
<ul>
<li><p>La función de densidad, con el prefijo <strong>d</strong>.</p></li>
<li><p>La función de distribución de probabilidad, con el prefijo <strong>p</strong>; esta función dispone además del parámetro <code>lower.tail</code> que igualado a <code>FALSE</code> calcula la <strong>función de distribución de cola superior</strong>: la probabilidad de que una variable aleatoria con esta distribución de probabilidad tome un valor estrictamente mayor que uno dado.</p></li>
<li><p>Los cuantiles, con el prefijo <strong>q</strong>.</p></li>
<li><p>Vectores de números aleatorios con esta distribución, con el prefijo <strong>r</strong>.</p></li>
</ul>
<p>La función correspondiente se aplica entonces al valor sobre el que queremos calcular la función y a los parámetros de la distribución (en este orden, y los parámetros en el orden en que los damos en la tabla anterior, cuando hay más de uno).</p>
<p>Por ejemplo, sea <span class="math inline">\(X\)</span> una variable aleatoria binomial <span class="math inline">\(B(20,0.3)\)</span>, es decir, de tamaño <span class="math inline">\(n=20\)</span> y probabilidad <span class="math inline">\(p=0.3\)</span>, y sean <span class="math inline">\(f_X\)</span> su función de densidad y <span class="math inline">\(F_X\)</span> su función de distribución. Calculemos algunos valores de funciones asociadas a esta variable aleatoria.</p>
<ul>
<li><span class="math inline">\(f_X(5)=P(X=5)\)</span>:</li>
</ul>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true"></a><span class="kw">dbinom</span>(<span class="dv">5</span>,<span class="dv">20</span>,<span class="fl">0.3</span>)</span>
<span id="cb408-2"><a href="#cb408-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.1788631</span></span></code></pre></div>
<div class="line-block">       Comprobémoslo, recordando que si <span class="math inline">\(X\sim B(n,k)\)</span>, entonces <span class="math inline">\(P(X=k)=\binom{n}{k}p^k(1-p)^{n-k}\)</span>:</div>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true"></a><span class="kw">choose</span>(<span class="dv">20</span>,<span class="dv">5</span>)<span class="op">*</span><span class="fl">0.3</span><span class="op">^</span><span class="dv">5</span><span class="op">*</span><span class="fl">0.7</span><span class="op">^</span><span class="dv">15</span></span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.1788631</span></span></code></pre></div>
<ul>
<li><span class="math inline">\(f_X(8)=P(X=8)\)</span>:</li>
</ul>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true"></a><span class="kw">dbinom</span>(<span class="dv">8</span>,<span class="dv">20</span>,<span class="fl">0.3</span>)  </span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.1143967</span></span></code></pre></div>
<ul>
<li><span class="math inline">\(F_X(5)=P(X\leqslant 5)\)</span>:</li>
</ul>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true"></a><span class="kw">pbinom</span>(<span class="dv">5</span>,<span class="dv">20</span>,<span class="fl">0.3</span>)  </span>
<span id="cb411-2"><a href="#cb411-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.4163708</span></span></code></pre></div>
<div class="line-block">       Comprobémoslo, usando que <span class="math inline">\(P(X\leqslant 5)=\sum_{k=0}^5 P(X=k)\)</span>:</div>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true"></a><span class="kw">sum</span>(<span class="kw">dbinom</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">20</span>,<span class="fl">0.3</span>))</span>
<span id="cb412-2"><a href="#cb412-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.4163708</span></span></code></pre></div>
<ul>
<li><span class="math inline">\(F_X(8)=P(X\leqslant 8)\)</span>:</li>
</ul>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true"></a><span class="kw">pbinom</span>(<span class="dv">8</span>,<span class="dv">20</span>,<span class="fl">0.3</span>)  </span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.8866685</span></span></code></pre></div>
<ul>
<li><span class="math inline">\(P(X&gt;8)\)</span></li>
</ul>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true"></a><span class="kw">pbinom</span>(<span class="dv">8</span>,<span class="dv">20</span>,<span class="fl">0.3</span>,<span class="dt">lower.tail=</span><span class="ot">FALSE</span>)</span>
<span id="cb414-2"><a href="#cb414-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.1133315</span></span></code></pre></div>
<div class="line-block">       En efecto:</div>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true"></a></span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true"></a><span class="dv">1</span><span class="op">-</span><span class="kw">pbinom</span>(<span class="dv">8</span>,<span class="dv">20</span>,<span class="fl">0.3</span>)</span>
<span id="cb415-3"><a href="#cb415-3" aria-hidden="true"></a><span class="co">#&gt; [1] 0.1133315</span></span></code></pre></div>
<ul>
<li>El cuantil de orden <span class="math inline">\(0.5\)</span> de <span class="math inline">\(X\)</span>, o sea, su <strong>mediana</strong>: el valor <span class="math inline">\(x\)</span> más pequeño tal que <span class="math inline">\(P(X\leqslant x)\geqslant 0.5\)</span></li>
</ul>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true"></a><span class="kw">qbinom</span>(<span class="fl">0.5</span>,<span class="dv">20</span>,<span class="fl">0.3</span>)  </span>
<span id="cb416-2"><a href="#cb416-2" aria-hidden="true"></a><span class="co">#&gt; [1] 6</span></span></code></pre></div>
<div class="line-block">       Comprobemos que <span class="math inline">\(P(X\leqslant 6)\geqslant 0.5\)</span> y en cambio <span class="math inline">\(P(X\leqslant 5)&lt; 0.5\)</span>:</div>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true"></a><span class="kw">pbinom</span>(<span class="dv">6</span>,<span class="dv">20</span>,<span class="fl">0.3</span>) </span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.6080098</span></span>
<span id="cb417-3"><a href="#cb417-3" aria-hidden="true"></a><span class="kw">pbinom</span>(<span class="dv">5</span>,<span class="dv">20</span>,<span class="fl">0.3</span>) </span>
<span id="cb417-4"><a href="#cb417-4" aria-hidden="true"></a><span class="co">#&gt; [1] 0.4163708</span></span></code></pre></div>
<ul>
<li>El cuantil de orden <span class="math inline">\(0.25\)</span> de <span class="math inline">\(X\)</span>, es decir, su <strong>primer cuartil</strong>:</li>
</ul>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true"></a><span class="kw">qbinom</span>(<span class="fl">0.25</span>,<span class="dv">20</span>,<span class="fl">0.3</span>)  </span>
<span id="cb418-2"><a href="#cb418-2" aria-hidden="true"></a><span class="co">#&gt; [1] 5</span></span></code></pre></div>
<ul>
<li>Un vector aleatorio de 10 valores generado con la variable aleatoria <span class="math inline">\(X\)</span>:</li>
</ul>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true"></a><span class="kw">rbinom</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="fl">0.3</span>)</span>
<span id="cb419-2"><a href="#cb419-2" aria-hidden="true"></a><span class="co">#&gt;  [1] 8 8 8 8 2 8 2 4 7 8</span></span></code></pre></div>
<ul>
<li>Dos vectores aleatorios más, de 10 valores cada uno, generados con la variable aleatoria <span class="math inline">\(X\)</span>:</li>
</ul>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true"></a><span class="kw">rbinom</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="fl">0.3</span>) </span>
<span id="cb420-2"><a href="#cb420-2" aria-hidden="true"></a><span class="co">#&gt;  [1]  7  5 10  5  9  3  6  3  9  3</span></span>
<span id="cb420-3"><a href="#cb420-3" aria-hidden="true"></a><span class="kw">rbinom</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="fl">0.3</span>)</span>
<span id="cb420-4"><a href="#cb420-4" aria-hidden="true"></a><span class="co">#&gt;  [1] 7 4 6 6 7 4 7 6 8 9</span></span></code></pre></div>
<p>Del mismo modo, si estamos trabajando con una variable aleatoria <span class="math inline">\(Y\)</span> de Poisson con parámetro <span class="math inline">\(\lambda=5\)</span>:</p>
<ul>
<li><span class="math inline">\(P(Y=8)\)</span>:</li>
</ul>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true"></a><span class="kw">dpois</span>(<span class="dv">8</span>,<span class="dv">5</span>) </span>
<span id="cb421-2"><a href="#cb421-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.06527804</span></span></code></pre></div>
<ul>
<li><span class="math inline">\(P(Y\leqslant 8)\)</span>:</li>
</ul>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true"></a><span class="kw">ppois</span>(<span class="dv">8</span>,<span class="dv">5</span>) </span>
<span id="cb422-2"><a href="#cb422-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.9319064</span></span></code></pre></div>
<ul>
<li>El cuantil de orden 0.6 de <span class="math inline">\(Y\)</span>:</li>
</ul>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true"></a><span class="kw">qpois</span>(<span class="fl">0.6</span>,<span class="dv">5</span>)</span>
<span id="cb423-2"><a href="#cb423-2" aria-hidden="true"></a><span class="co">#&gt; [1] 5</span></span></code></pre></div>
<ul>
<li>Un vector aleatorio de 20 valores generado con la variable aleatoria <span class="math inline">\(Y\)</span>:</li>
</ul>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true"></a><span class="kw">rpois</span>(<span class="dv">20</span>,<span class="dv">5</span>)</span>
<span id="cb424-2"><a href="#cb424-2" aria-hidden="true"></a><span class="co">#&gt;  [1]  2  5  4  4  3  5  3  5 10  5  7  4  3  4  4  5  6  3  8  4</span></span></code></pre></div>
<p>Si no entramos ningún parámetro en las funciones asociadas a la distribución normal, R entiende que se trata de la normal estándar (con media <span class="math inline">\(\mu=0\)</span> y desviación típica <span class="math inline">\(\sigma=1\)</span>): por ejemplo, las dos instrucciones siguientes nos dan el valor <span class="math inline">\(f_Z(0.3)\)</span> de la función densidad de una normal estándar <span class="math inline">\(Z\)</span> aplicada a 0.3 (que <em>no</em> es igual a <span class="math inline">\(P(Z=0.3)\)</span>):</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true"></a><span class="kw">dnorm</span>(<span class="fl">0.3</span>)</span>
<span id="cb425-2"><a href="#cb425-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.3813878</span></span>
<span id="cb425-3"><a href="#cb425-3" aria-hidden="true"></a><span class="kw">dnorm</span>(<span class="fl">0.3</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb425-4"><a href="#cb425-4" aria-hidden="true"></a><span class="co">#&gt; [1] 0.3813878</span></span></code></pre></div>
<p>Las funciones densidad y distribución de una variable aleatoria se pueden dibujar con la función <code>curve</code>. Así, la función siguiente dibuja la gráfica de la densidad de una variable normal estándar de la Figura @ref(fig:dnorm):</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true"></a><span class="kw">curve</span>(<span class="kw">dnorm</span>(x,<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">main=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="09chap08_Distribuciones_files/figure-html/dnorm-1.png" alt="Función densidad de una variable *N*(0,1)." width="90%" />
<p class="caption">
(#fig:dnorm)Función densidad de una variable <em>N</em>(0,1).
</p>
</div>
<p>De manera similar, la función siguiente dibuja la gráfica de la función de distribución de una variable normal estándar de la Figura @ref(fig:pnorm):</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true"></a><span class="kw">curve</span>(<span class="kw">pnorm</span>(x,<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">main=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="09chap08_Distribuciones_files/figure-html/pnorm-1.png" alt="Función distribución de una variable *N*(0,1)." width="90%" />
<p class="caption">
(#fig:pnorm)Función distribución de una variable <em>N</em>(0,1).
</p>
</div>
<div id="ejercicios-7" class="section level2" number="9.1">
<h2 number="9.1"><span class="header-section-number">9.1</span> Ejercicios</h2>
<div id="test-6" class="section level3 unnumbered">
<h3 class="unnumbered">Test</h3>
<p><em>(1)</em> Sea <span class="math inline">\(f\)</span> la función de densidad de una variable aleatoria normal con <span class="math inline">\(\mu=0.2\)</span> y <span class="math inline">\(\sigma=1.2\)</span>. Dad el valor de <span class="math inline">\(f(0.5)\)</span> redondeado a 4 cifras decimales.</p>
<p><em>(2)</em> Sea <span class="math inline">\(X\)</span> una variable aleatoria normal con <span class="math inline">\(\mu=0.2\)</span> y <span class="math inline">\(\sigma=1.2\)</span>. Dad el valor de <span class="math inline">\(P(3\leqslant X\leqslant 7)\)</span> redondeado a 4 cifras decimales.</p>
<p><em>(3)</em> Sea <span class="math inline">\(X\)</span> una variable aleatoria <span class="math inline">\(B(10,0.2)\)</span>. Dad el valor de <span class="math inline">\(P(3\leqslant X\leqslant 7)\)</span> redondeado a 4 cifras decimales.</p>
<p><em>(4)</em> Dad una instrucción que calcule la mediana de una lista de 20 números aleatorios generados con distribución <span class="math inline">\(B(10,0.2)\)</span>. No deis el resultado, solo la instrucción.</p>
</div>
<div id="problemas" class="section level3 unnumbered">
<h3 class="unnumbered">Problemas</h3>
<p><strong>(1)</strong> Según <a href="https://tall.life/height-percentile-calculator-age-country/">la página web de <em>Tall.Life</em></a>, la altura de los hombres españoles adultos sigue una distribución aproximadamente normal de media 173.1 cm y desviación típica 7.42 cm, mientras que la de las mujeres españolas adultas sigue una distribución también aproximadamente normal, pero de media 160.3 cm y desviación típica 7.11 cm.
Por otro lado, según <a href="https://www.cia.gov/library/publications/the-world-factbook/geos/sp.html">el último <em>FactBook</em> sobre España de la CIA</a>, aproximadamente un 51% de los españoles adultos son mujeres. Vamos a tomar todos estos datos como exactos y verdaderos.</p>
<p><em>(a)</em> ¿Qué es más probable, que un hombre adulto español sea más alto que Víctor Claver (2.05 m) o que una mujer adulta española sea más alta que Alba Torrens (1.90 m)?</p>
<p><em>(b)</em> Si tomamos un español adulto (hombre o mujer) al azar, ¿qué es más probable, que sea más alto que Marc Gasol (2.11 m) o que sea más bajo que Peter Dinklage (1.35m)?</p>
<p><strong>(2)</strong> He lanzado un dado de 6 caras 100 veces, y he obtenido 24 veces un 6. Suponed que el dado es honrado. Considerad la variable aleatoria <span class="math inline">\(X\)</span> dada por el número de veces que obtenemos un 6 al lanzar el dado 100 veces al aire.</p>
<p><em>(a)</em> ¿Qué distribución de probabilidad tiene <span class="math inline">\(X\)</span>? Tenéis que dar el tipo de distribución y sus parámetros.</p>
<p><em>(b)</em> ¿Qué vale <span class="math inline">\(P(X=24)\)</span>? Es decir, ¿cuál es la probabilidad de sacar exactamente 24 seises en 100 lanzamientos del dado?</p>
<p><em>(c)</em> ¿Cuál es la probabilidad de sacar 24 seises o más en 100 lanzamientos del dado?</p>
<p><em>(d)</em> Simulad con R una secuencia aleatoria de 1000 realizaciones de <span class="math inline">\(X\)</span>: es decir, generad un vector de 1000 números aleatorios con la distribución de probabilidades de <span class="math inline">\(X\)</span>. Vamos a suponer que este vector nos da los números de seises obtenidos en 1000 secuencias de 100 lanzamientos del dado cada una. ¿En qué porcentaje de estas secuencias habéis obtenido exactamente 24 seises? ¿En qué porcentaje habéis obtenido al menos 24 seises? ¿Son consistentes estos resultados con los valores obtenidos en <em>(b)</em> y <em>(c)</em>?</p>
<!--**(1)** Como sabéis, si $X$ es una variable aleatoria Bernoulli $Be(p)$, es decir, de probabilidad de éxito $p$, e $Y$ es la variable aleatoria que nos da el número de fracasos antes de obtener el primer éxito en una secuencia de repeticiones independientes de $X$, entonce $Y$ sigue una  **distribución geométrica** $Ge(p)$.  

Por lo tanto, si efectuamos una serie de lanzamientos independientes de una moneda no trucada, las longitudes de las **rachas de cruces** (las secuencias de cruces entre pares de caras consecutivas) que nos salgan seguirán una distribución geométrica $Ge(0.5)$, porque nos dan los números de cruces (fracasos) obtenidos antes de sacar una cara (éxito) en repeticiones independientes de una v.a. $Be(0.5)$, reiniciando el contador en cada cara. Vamos a comprobarlo a mediante una simulación sencilla. 

*(a)* Generad un vector aleatorio binario $X$ de longitud 10^6^ con distribución Bernoulli $Be(0.5)$, que representará un millón de lanzamientos de una moneda honrada (0 cruz, 1 cara). Quedaos con el vector que va de su primer 1 a su último 1, y seguid llamándole $X$ al vector resultante.

*(b)* Calculad las longitudes de todas las secuencias maximales de 0s en $X$ (es decir, de las secuencias de 0s que separan pares de 1s consecutivos). Por lo que hemos explicado, estas longitudes deberían seguir una distribución geométrica $Ge(0.5)$.

*(c)* Dibujad un histograma de líneas de las frecuencias relativas de las longitudes de cadenas maximales de ceros obtenidas de esta manera, y superponed un diagrama poligonal de las probabilidades de dichas longitudes según la distribución $Ge(0.5)$. Para mejorar la visibilidad del gráfico, representad solo las longitudes $k$ cuya probabilidad bajo una distribución $Ge(0.5)$ sea al menos  0.0001. Comentad el gráfico obtenido.
-->
</div>
<div id="respuestas-al-test-6" class="section level3 unnumbered">
<h3 class="unnumbered">Respuestas al test</h3>
<p><em>(1)</em> 0.3222</p>
<p>Nosotros lo hemos calculado con</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">dnorm</span>(<span class="fl">0.5</span>,<span class="fl">0.2</span>,<span class="fl">1.2</span>),<span class="dv">4</span>)</span>
<span id="cb428-2"><a href="#cb428-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.3222</span></span></code></pre></div>
<p><em>(2)</em> 0.0098</p>
<p>Nosotros lo hemos calculado con</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="#cb429-1" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">pnorm</span>(<span class="dv">7</span>,<span class="fl">0.2</span>,<span class="fl">1.2</span>)<span class="op">-</span><span class="kw">pnorm</span>(<span class="dv">3</span>,<span class="fl">0.2</span>,<span class="fl">1.2</span>),<span class="dv">4</span>)</span>
<span id="cb429-2"><a href="#cb429-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.0098</span></span></code></pre></div>
<p><em>(3)</em> 0.3221</p>
<p>Nosotros lo hemos calculado con</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">pbinom</span>(<span class="dv">7</span>,<span class="dv">10</span>,<span class="fl">0.2</span>)<span class="op">-</span><span class="kw">pbinom</span>(<span class="dv">2</span>,<span class="dv">10</span>,<span class="fl">0.2</span>),<span class="dv">4</span>)</span>
<span id="cb430-2"><a href="#cb430-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.3221</span></span></code></pre></div>
<p>También se obtiene el resultado correcto con</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">sum</span>(<span class="kw">dbinom</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">7</span>,<span class="dv">10</span>,<span class="fl">0.2</span>)),<span class="dv">4</span>)</span>
<span id="cb431-2"><a href="#cb431-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.3221</span></span></code></pre></div>
<p>En cambio, con</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">pbinom</span>(<span class="dv">7</span>,<span class="dv">10</span>,<span class="fl">0.2</span>)<span class="op">-</span><span class="kw">pbinom</span>(<span class="dv">3</span>,<span class="dv">10</span>,<span class="fl">0.2</span>),<span class="dv">4</span>)</span>
<span id="cb432-2"><a href="#cb432-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.1208</span></span></code></pre></div>
<p>no se obtiene el resultado correcto. Pensad por qué aquí hay que restar <code>pbinom(2,10,0.2)</code> y en la pregunta anterior restábamos <code>pnorm(3,0.2,1.2)</code>.</p>
<p><em>(4)</em> <code>median(rbinom(20,10,0.2))</code></p>
<p>También sería correcto <code>median(rbinom(20,size=10,prob=0.2))</code>, pero no es necesario dar los nombres de los parámetros si entráis sus valores en el orden correcto, y por eso no los hemos explicado.</p>
</div>
<div id="soluciones-sucintas-de-los-problemas" class="section level3 unnumbered">
<h3 class="unnumbered">Soluciones sucintas de los problemas</h3>
<p><strong>(1)</strong> <em>(a)</em> La probabilidad que un hombre adulto español sea más alto que Víctor Claver es</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true"></a><span class="kw">pnorm</span>(<span class="dv">205</span>,<span class="fl">173.1</span>,<span class="fl">7.42</span>,<span class="dt">lower.tail=</span><span class="ot">FALSE</span>)</span>
<span id="cb433-2"><a href="#cb433-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.00000857112</span></span></code></pre></div>
<p>y la probabilidad de que una mujer adulta española sea más alta que Alba Torrens es</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true"></a><span class="kw">pnorm</span>(<span class="dv">190</span>,<span class="fl">160.3</span>,<span class="fl">7.11</span>,<span class="dt">lower.tail=</span><span class="ot">FALSE</span>)</span>
<span id="cb434-2"><a href="#cb434-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.00001475499</span></span></code></pre></div>
<p><em>(b)</em> La probabilidad de que un español adulto sea más alto (o alta) que Marc Gasol es</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true"></a><span class="fl">0.49</span><span class="op">*</span><span class="kw">pnorm</span>(<span class="dv">211</span>,<span class="fl">173.1</span>,<span class="fl">7.42</span>,<span class="dt">lower.tail=</span><span class="ot">FALSE</span>)<span class="op">+</span><span class="fl">0.51</span><span class="op">*</span><span class="kw">pnorm</span>(<span class="dv">211</span>,<span class="fl">160.3</span>,<span class="fl">7.11</span>,<span class="dt">lower.tail=</span><span class="ot">FALSE</span>)</span>
<span id="cb435-2"><a href="#cb435-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.00000007984638</span></span></code></pre></div>
<p>y la probabilidad de que un español adulto sea más bajo (o baja) que Peter Dinklage es</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true"></a><span class="fl">0.49</span><span class="op">*</span><span class="kw">pnorm</span>(<span class="dv">135</span>,<span class="fl">173.1</span>,<span class="fl">7.42</span>)<span class="op">+</span><span class="fl">0.51</span><span class="op">*</span><span class="kw">pnorm</span>(<span class="dv">135</span>,<span class="fl">160.3</span>,<span class="fl">7.11</span>)</span>
<span id="cb436-2"><a href="#cb436-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.00009522642</span></span></code></pre></div>
<p><strong>(2)</strong> <em>(a)</em> Binomial <span class="math inline">\(B(100,1/6)\)</span></p>
<p><em>(b)</em> <code>dbinom(24,100,1/6)</code>=0.016161</p>
<p><em>(c)</em> <code>1-pbinom(23,100,1/6)</code>=0.0378644</p>
<p><em>(d)</em> El vector siguiente contiene una simulación como la pedida</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="#cb437-1" aria-hidden="true"></a>Simulación=<span class="kw">rbinom</span>(<span class="dv">1000</span>,<span class="dv">100</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">6</span>)</span></code></pre></div>
<p>En este vector, el porcentaje de entradas iguales a 24 es</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true"></a><span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span><span class="kw">length</span>(Simulación[Simulación<span class="op">==</span><span class="dv">24</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">1</span>)</span>
<span id="cb438-2"><a href="#cb438-2" aria-hidden="true"></a><span class="co">#&gt; [1] 1.9</span></span></code></pre></div>
<p>y el porcentaje de entradas mayores o iguales a 24 es</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true"></a><span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span><span class="kw">length</span>(Simulación[Simulación<span class="op">&gt;=</span><span class="dv">24</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">1</span>)</span>
<span id="cb439-2"><a href="#cb439-2" aria-hidden="true"></a><span class="co">#&gt; [1] 3.8</span></span></code></pre></div>
<p>Naturalmente, en cada simulación puede dar valores diferentes. Por ejemplo, si repetimos de nuevo la simulación</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="#cb440-1" aria-hidden="true"></a>Simulación2=<span class="kw">rbinom</span>(<span class="dv">1000</span>,<span class="dv">100</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">6</span>)</span></code></pre></div>
<p>obtenemos:</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true"></a><span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span><span class="kw">length</span>(Simulación2[Simulación2<span class="op">==</span><span class="dv">24</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">1</span>)</span>
<span id="cb441-2"><a href="#cb441-2" aria-hidden="true"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb441-3"><a href="#cb441-3" aria-hidden="true"></a><span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span><span class="kw">length</span>(Simulación2[Simulación2<span class="op">&gt;=</span><span class="dv">24</span>])<span class="op">/</span><span class="dv">1000</span>,<span class="dv">1</span>)</span>
<span id="cb441-4"><a href="#cb441-4" aria-hidden="true"></a><span class="co">#&gt; [1] 3.3</span></span></code></pre></div>
<!--
**(1)** *(a)* Como la distribución $Be(p)$ es la distribución binomial $B(1,p)$, podemos construir $X$ por medio de: 

```r
X=rbinom(10^6,1,0.5)
X=X[min(which(X==1)):max(which(X==1))]
```

*(b)* Las longitudes de cadenas maximales de 0s en $X$ serán las diferencias entre posiciones consecutivas de 1s en $X$, menos 1 (si, digamos, hay un 1 en la posición 5a y el siguiente 1 está en la posición 13a, en medio hay $13-5-1=7$ 0s). Por lo tanto, el vector $Y$ de longitudes de cadenas maximales de 0s en $X$ se puede calcular con:

```r
Exitos=which(X==1)
Y=diff(Exitos)-1
```

*(c)* Calculemos el mayor número natural $M$ tal que si $Y$ es una v.a. $Ge(0.5)$, $P(Y=M)\geq 10^{-4}$:

```r
M=max(which(dgeom(0:100,0.5)>=10^(-4)))-1
M
#> [1] 12
```

El gráfico pedido es entonces:

```r
n=0:M
plot(prop.table(table(Y)[n]),col="blue",type="h",xlab="Longitudes de cadenas maximales de 0s",ylab="Probabilidades")
points(n,dgeom(n,0.5),col="red",type="o",pch=20,cex=0.5)
```

<img src="09chap08_Distribuciones_files/figure-html/unnamed-chunk-39-1.png" width="90%" style="display: block; margin: auto;" />
-->
<!--chapter:end:09chap08_Distribuciones.Rmd-->
</div>
</div>
</div>
<div id="part-parte-ii-estadística-descriptiva" class="section level1 unnumbered">
<h1 class="unnumbered">(PART*) Parte II: Estadística descriptiva</h1>
</div>
<div id="chap:edqual" class="section level1" number="10">
<h1 number="10"><span class="header-section-number">10</span> Descripción de datos cualitativos</h1>
<p>Los <strong>datos cualitativos</strong> corresponden a observaciones sobre cualidades de un objeto o individuo, tales como su especie o su sexo, que pueden ser iguales o diferentes, pero que no admiten ningún otro tipo de comparación significativa: por ejemplo, datos para los que no tenga ningún sentido preguntarse si uno es más grande que otro, ni efectuar operaciones aritméticas con ellos, aunque estén representados por números. Llamaremos <strong>variable cualitativa</strong> a una lista de observaciones de un tipo de datos cualitativos sobre un conjunto concreto de objetos, y <strong>niveles</strong>, como en los factores, a los diferentes valores que pueden tomar estos datos; por ejemplo, los dos niveles de una variable <em>Sexo</em> serían “Macho” y “Hembra”, o sinónimos.</p>
<p>Con R, usaremos vectores y factores para representar variables cualitativas. Los factores nos servirán para agrupar las observaciones según los niveles de la variable. De esta manera podremos segmentar la población que representa la variable en grupos o subpoblaciones, asignando un grupo a cada nivel, y podremos comparar el comportamiento de otras variables sobre estos grupos.</p>
<div id="sec:edqual" class="section level2" number="10.1">
<h2 number="10.1"><span class="header-section-number">10.1</span> Frecuencias</h2>
<p>Los estadísticos básicos para datos cualitativos son sencillos: dada una variable
cualitativa, para cada uno de sus niveles podemos contar cuántos datos hay en ese nivel (la <strong>frecuencia absoluta</strong> del nivel) y qué fracción del total representan (la <strong>frecuencia relativa</strong> del nivel) y nada más.</p>

<div class="example">
<p><span id="exm:ex1601" class="example"><strong>(#exm:ex1601) </strong></span>Supongamos que se ha realizado un seguimiento a 20 personas ingresadas en un geriátrico. Uno de los datos que se han recogido sobre estas personas ha sido su sexo. El resultado ha sido una variable cualitativa formada por las 20 observaciones siguientes:</p>
</div>
<p style="text-align:center">
Mujer, Mujer, Hombre, Mujer, Mujer, Mujer, Mujer, Mujer, Hombre, Mujer
Hombre, Hombre, Mujer, Mujer, Hombre, Mujer, Mujer, Mujer, Mujer, Hombre.
</p>
<p>Sus dos niveles son <em>Hombre</em> y <em>Mujer</em>. En esta variable
hay 14 mujeres y 6 hombres. Por lo tanto, éstas son las frecuencias absolutas de estos niveles. Puesto que en total hay 20 individuos, sus frecuencias relativas son</p>
<p style="text-align:center">
<em>Hombre</em>: 6/20=0.3, <em>Mujer</em>: 14/20=0.7.
</p>
<p>En general, supongamos que tenemos un tipo de datos cualitativos con niveles
<span class="math display">\[
l_1, l_2, \ldots, l_k.
\]</span>
Efectuamos <span class="math inline">\(n\)</span> observaciones de este tipo de datos, y sean
<span class="math display">\[
x_1, x_2, \ldots, x_n
\]</span></p>
<p>los resultados que obtenemos.
Cada una de estas observaciones <span class="math inline">\(x_j\)</span> toma como valor alguno de los niveles <span class="math inline">\(l_i\)</span>. Estas observaciones forman una <strong>variable cualitativa</strong>.</p>
<p>Así, en el ejemplo anterior tendríamos que <span class="math inline">\(l_1\)</span>=<em>Hombre</em> y <span class="math inline">\(l_2\)</span>=<em>Mujer</em>,
que <span class="math inline">\(n=20\)</span> (el número de observaciones efectuadas), y <span class="math inline">\(x_1, \ldots, x_{20}\)</span> formarían la muestra de sexos.</p>
<p>Con estas notaciones:</p>
<ul>
<li><p>La <strong>frecuencia absoluta</strong> del nivel <span class="math inline">\(l_j\)</span> en esta variable cualitativa, que denotaremos por <span class="math inline">\(n_j\)</span>, es el número de observaciones en las que el resultado <span class="math inline">\(x_i\)</span> es igual al nivel <span class="math inline">\(l_j\)</span>.</p></li>
<li><p>La <strong>frecuencia relativa</strong> del nivel <span class="math inline">\(l_j\)</span> en esta variable cualitativa es la fracción <span class="math inline">\(f_j={n_j}/{n}\)</span>. Es decir, la fracción (en tanto por uno) de observaciones que corresponden a este nivel. El tanto por ciento de observaciones del nivel <span class="math inline">\(l_j\)</span> es entonces <span class="math inline">\(f_j\cdot 100\%\)</span>.</p></li>
<li><p>La <strong>moda</strong> de esta variable cualitativa es su nivel, o niveles, de mayor frecuencia (absoluta o relativa, tanto da).</p></li>
</ul>
<p>La tabla siguiente resume las frecuencias absolutas y relativas de la variable cualitativa del Ejemplo @ref(exm:ex1601), con las notaciones que acabamos de introducir. Su moda es el nivel <em>Mujer</em>.</p>
<p><span class="math display">\[
\begin{array}{|c||rrr|}
\hline \mathbf{Sexo} &amp; n_j &amp; f_j &amp; \% \\\hline\hline
\mbox{Hombre} &amp; 6 &amp; 0.3 &amp; 30\% \\
\mbox{Mujer} &amp; 14 &amp; 0.7 &amp; 70 \% \\\hline
Total &amp; 20 &amp; 1 &amp; 100\% \\\hline
\end{array}
\]</span></p>
</div>
<div id="tablas-unidimensionales-de-frecuencias" class="section level2" number="10.2">
<h2 number="10.2"><span class="header-section-number">10.2</span> Tablas unidimensionales de frecuencias</h2>
<p>Supongamos que tenemos una variable cualitativa guardada en un vector o un factor (para simplificar, en lo que queda de sección, diremos <strong>vector</strong> para referirnos genéricamente tanto a un vector como a un factor). Por ejemplo:</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true"></a>x=<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">2</span>)</span>
<span id="cb442-2"><a href="#cb442-2" aria-hidden="true"></a>x</span>
<span id="cb442-3"><a href="#cb442-3" aria-hidden="true"></a><span class="co">#&gt;  [1] 3 2 5 1 3 1 5 6 2 2 2 1 3 5 2</span></span>
<span id="cb442-4"><a href="#cb442-4" aria-hidden="true"></a>Respuestas=<span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;No&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Sí&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Sí&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Sí&quot;</span>))</span>
<span id="cb442-5"><a href="#cb442-5" aria-hidden="true"></a>Respuestas</span>
<span id="cb442-6"><a href="#cb442-6" aria-hidden="true"></a><span class="co">#&gt; [1] No No Sí No Sí No No Sí</span></span>
<span id="cb442-7"><a href="#cb442-7" aria-hidden="true"></a><span class="co">#&gt; Levels: No Sí</span></span></code></pre></div>
<p>Con R, la <strong>tabla de frecuencias absolutas</strong> de un vector que representa una variable cualitativa se calcula con la función <code>table</code>. En nuestros ejemplos:</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true"></a><span class="kw">table</span>(x)</span>
<span id="cb443-2"><a href="#cb443-2" aria-hidden="true"></a><span class="co">#&gt; x</span></span>
<span id="cb443-3"><a href="#cb443-3" aria-hidden="true"></a><span class="co">#&gt; 1 2 3 5 6 </span></span>
<span id="cb443-4"><a href="#cb443-4" aria-hidden="true"></a><span class="co">#&gt; 3 5 3 3 1</span></span>
<span id="cb443-5"><a href="#cb443-5" aria-hidden="true"></a><span class="kw">table</span>(Respuestas)</span>
<span id="cb443-6"><a href="#cb443-6" aria-hidden="true"></a><span class="co">#&gt; Respuestas</span></span>
<span id="cb443-7"><a href="#cb443-7" aria-hidden="true"></a><span class="co">#&gt; No Sí </span></span>
<span id="cb443-8"><a href="#cb443-8" aria-hidden="true"></a><span class="co">#&gt;  5  3</span></span></code></pre></div>
<p>El resultado de una función <code>table</code> es un objeto de datos de un tipo nuevo: una <strong>tabla de contingencia</strong>, una <em>table</em> en el argot de R. Como vemos, al aplicar <code>table</code> a un vector obtenemos una tabla unidimensional formada por una fila con los niveles de la variable y una segunda fila donde, debajo de cada nivel, aparece su frecuencia absoluta en el vector.</p>
<p>Los nombres de las columnas de una tabla unidimensional se obtienen con la función <code>names</code>.</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true"></a><span class="kw">names</span>(<span class="kw">table</span>(x))</span>
<span id="cb444-2"><a href="#cb444-2" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;5&quot; &quot;6&quot;</span></span>
<span id="cb444-3"><a href="#cb444-3" aria-hidden="true"></a><span class="kw">names</span>(<span class="kw">table</span>(Respuestas))</span>
<span id="cb444-4"><a href="#cb444-4" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;No&quot; &quot;Sí&quot;</span></span></code></pre></div>
<p>Habréis observado que en la <code>table</code> de un vector sólo aparecen los nombres de los niveles presentes en el vector. Si el tipo de datos cualitativos usado tenía más niveles y queremos que aparezcan explícitamente en la tabla (con frecuencia 0), hay que transformar el vector en un factor con los niveles deseados.</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true"></a>z=<span class="kw">factor</span>(x, <span class="dt">levels=</span><span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)  <span class="co">#Los niveles serán 1,2,3,4,5,6,7</span></span>
<span id="cb445-2"><a href="#cb445-2" aria-hidden="true"></a>z</span>
<span id="cb445-3"><a href="#cb445-3" aria-hidden="true"></a><span class="co">#&gt;  [1] 3 2 5 1 3 1 5 6 2 2 2 1 3 5 2</span></span>
<span id="cb445-4"><a href="#cb445-4" aria-hidden="true"></a><span class="co">#&gt; Levels: 1 2 3 4 5 6 7</span></span>
<span id="cb445-5"><a href="#cb445-5" aria-hidden="true"></a><span class="kw">table</span>(z)</span>
<span id="cb445-6"><a href="#cb445-6" aria-hidden="true"></a><span class="co">#&gt; z</span></span>
<span id="cb445-7"><a href="#cb445-7" aria-hidden="true"></a><span class="co">#&gt; 1 2 3 4 5 6 7 </span></span>
<span id="cb445-8"><a href="#cb445-8" aria-hidden="true"></a><span class="co">#&gt; 3 5 3 0 3 1 0</span></span></code></pre></div>
<p>A efectos prácticos, podemos pensar que una tabla unidimensional es como un vector de números donde cada entrada está identificada por un nombre: el de su columna. Para referirnos a una entrada de una tabla unidimensional, podemos usar tanto su posición como su nombre (entre comillas, aunque sea un número). Veamos algunos ejemplos.</p>
<ul>
<li>La cuarta columna de <code>table(x)</code>:</li>
</ul>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true"></a><span class="kw">table</span>(x)[<span class="dv">4</span>] </span>
<span id="cb446-2"><a href="#cb446-2" aria-hidden="true"></a><span class="co">#&gt; 5 </span></span>
<span id="cb446-3"><a href="#cb446-3" aria-hidden="true"></a><span class="co">#&gt; 3</span></span></code></pre></div>
<ul>
<li>La columna de <code>table(x)</code> correspondiente al nivel 5:</li>
</ul>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="#cb447-1" aria-hidden="true"></a><span class="kw">table</span>(x)[<span class="st">&quot;5&quot;</span>]</span>
<span id="cb447-2"><a href="#cb447-2" aria-hidden="true"></a><span class="co">#&gt; 5 </span></span>
<span id="cb447-3"><a href="#cb447-3" aria-hidden="true"></a><span class="co">#&gt; 3</span></span></code></pre></div>
<ul>
<li>El triple de la segunda columna de <code>table(x)</code>:</li>
</ul>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true"></a><span class="dv">3</span><span class="op">*</span><span class="kw">table</span>(x)[<span class="dv">2</span>]</span>
<span id="cb448-2"><a href="#cb448-2" aria-hidden="true"></a><span class="co">#&gt;  2 </span></span>
<span id="cb448-3"><a href="#cb448-3" aria-hidden="true"></a><span class="co">#&gt; 15</span></span></code></pre></div>
<p>Las tablas de contingencia aceptan la mayoría de las funciones explicadas para vectores. Por ejemplo:</p>
<ul>
<li>Suma de las entradas de <code>table(x)</code>:</li>
</ul>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true"></a><span class="kw">sum</span>(<span class="kw">table</span>(x))</span>
<span id="cb449-2"><a href="#cb449-2" aria-hidden="true"></a><span class="co">#&gt; [1] 15</span></span></code></pre></div>
<ul>
<li>Raíces cuadradas de las entradas de <code>table(Respuestas)</code>:</li>
</ul>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true"></a><span class="kw">sqrt</span>(<span class="kw">table</span>(Respuestas))</span>
<span id="cb450-2"><a href="#cb450-2" aria-hidden="true"></a><span class="co">#&gt; Respuestas</span></span>
<span id="cb450-3"><a href="#cb450-3" aria-hidden="true"></a><span class="co">#&gt;       No       Sí </span></span>
<span id="cb450-4"><a href="#cb450-4" aria-hidden="true"></a><span class="co">#&gt; 2.236068 1.732051</span></span></code></pre></div>
<p>La <strong>tabla de frecuencias relativas</strong> de un vector se puede calcular aplicando la función <code>prop.table</code> a su <code>table</code>. El resultado vuelve a ser una tabla de contingencia unidimensional.</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(x))</span>
<span id="cb451-2"><a href="#cb451-2" aria-hidden="true"></a><span class="co">#&gt; x</span></span>
<span id="cb451-3"><a href="#cb451-3" aria-hidden="true"></a><span class="co">#&gt;          1          2          3          5          6 </span></span>
<span id="cb451-4"><a href="#cb451-4" aria-hidden="true"></a><span class="co">#&gt; 0.20000000 0.33333333 0.20000000 0.20000000 0.06666667</span></span>
<span id="cb451-5"><a href="#cb451-5" aria-hidden="true"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(Respuestas))</span>
<span id="cb451-6"><a href="#cb451-6" aria-hidden="true"></a><span class="co">#&gt; Respuestas</span></span>
<span id="cb451-7"><a href="#cb451-7" aria-hidden="true"></a><span class="co">#&gt;    No    Sí </span></span>
<span id="cb451-8"><a href="#cb451-8" aria-hidden="true"></a><span class="co">#&gt; 0.625 0.375</span></span></code></pre></div>
<p><strong>¡Atención!</strong> La función <code>prop.table</code> se tiene que aplicar al resultado de <code>table</code>, no al vector original. Si aplicamos <code>prop.table</code> a un vector de palabras o a un factor, dará un error, pero si la aplicamos a un vector de números, nos dará una tabla. Esta tabla <em>no es la tabla de frecuencias relativas</em> de la variable cualitativa representada por el vector, sino la de una variable que tuviera como tabla de frecuencias absolutas este vector de números, entendiendo que cada entrada del vector representa la frecuencia de un nivel diferente. Por ejemplo, aplicando <code>prop.table</code> a nuestro vector <code>x</code> obtenemos:</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true"></a><span class="kw">prop.table</span>(x)</span>
<span id="cb452-2"><a href="#cb452-2" aria-hidden="true"></a><span class="co">#&gt;  [1] 0.06976744 0.04651163 0.11627907 0.02325581 0.06976744 0.02325581</span></span>
<span id="cb452-3"><a href="#cb452-3" aria-hidden="true"></a><span class="co">#&gt;  [7] 0.11627907 0.13953488 0.04651163 0.04651163 0.04651163 0.02325581</span></span>
<span id="cb452-4"><a href="#cb452-4" aria-hidden="true"></a><span class="co">#&gt; [13] 0.06976744 0.11627907 0.04651163</span></span></code></pre></div>
<p>que no es la tabla de frecuencias relativas de <code>x</code>. Veamos otro ejemplo aun más evidente:</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="#cb453-1" aria-hidden="true"></a>X=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb453-2"><a href="#cb453-2" aria-hidden="true"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(X))</span>
<span id="cb453-3"><a href="#cb453-3" aria-hidden="true"></a><span class="co">#&gt; X</span></span>
<span id="cb453-4"><a href="#cb453-4" aria-hidden="true"></a><span class="co">#&gt; 1 </span></span>
<span id="cb453-5"><a href="#cb453-5" aria-hidden="true"></a><span class="co">#&gt; 1</span></span>
<span id="cb453-6"><a href="#cb453-6" aria-hidden="true"></a><span class="kw">prop.table</span>(X)</span>
<span id="cb453-7"><a href="#cb453-7" aria-hidden="true"></a><span class="co">#&gt; [1] 0.3333333 0.3333333 0.3333333</span></span></code></pre></div>
<p>También podemos calcular la tabla de frecuencias relativas de un vector dividiendo el resultado de <code>table</code> por el número de observaciones.</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true"></a><span class="kw">table</span>(x)<span class="op">/</span><span class="kw">length</span>(x)</span>
<span id="cb454-2"><a href="#cb454-2" aria-hidden="true"></a><span class="co">#&gt; x</span></span>
<span id="cb454-3"><a href="#cb454-3" aria-hidden="true"></a><span class="co">#&gt;          1          2          3          5          6 </span></span>
<span id="cb454-4"><a href="#cb454-4" aria-hidden="true"></a><span class="co">#&gt; 0.20000000 0.33333333 0.20000000 0.20000000 0.06666667</span></span>
<span id="cb454-5"><a href="#cb454-5" aria-hidden="true"></a><span class="kw">table</span>(x)<span class="op">/</span><span class="kw">sum</span>(<span class="kw">table</span>(x))</span>
<span id="cb454-6"><a href="#cb454-6" aria-hidden="true"></a><span class="co">#&gt; x</span></span>
<span id="cb454-7"><a href="#cb454-7" aria-hidden="true"></a><span class="co">#&gt;          1          2          3          5          6 </span></span>
<span id="cb454-8"><a href="#cb454-8" aria-hidden="true"></a><span class="co">#&gt; 0.20000000 0.33333333 0.20000000 0.20000000 0.06666667</span></span></code></pre></div>
<p>Dados un vector <code>x</code> y un número natural <em>n</em>, la instrucción</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="#cb455-1" aria-hidden="true"></a><span class="kw">names</span>(<span class="kw">which</span>(<span class="kw">table</span>(x)<span class="op">==</span>n)</span></code></pre></div>
<p>nos da los niveles de <code>x</code> que tienen frecuencia absoluta <em>n</em>.</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true"></a><span class="kw">table</span>(x)</span>
<span id="cb456-2"><a href="#cb456-2" aria-hidden="true"></a><span class="co">#&gt; x</span></span>
<span id="cb456-3"><a href="#cb456-3" aria-hidden="true"></a><span class="co">#&gt; 1 2 3 5 6 </span></span>
<span id="cb456-4"><a href="#cb456-4" aria-hidden="true"></a><span class="co">#&gt; 3 5 3 3 1</span></span>
<span id="cb456-5"><a href="#cb456-5" aria-hidden="true"></a><span class="kw">names</span>(<span class="kw">which</span>(<span class="kw">table</span>(x)<span class="op">==</span><span class="dv">3</span>))</span>
<span id="cb456-6"><a href="#cb456-6" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;1&quot; &quot;3&quot; &quot;5&quot;</span></span>
<span id="cb456-7"><a href="#cb456-7" aria-hidden="true"></a><span class="kw">names</span>(<span class="kw">which</span>(<span class="kw">table</span>(x)<span class="op">==</span><span class="dv">2</span>))</span>
<span id="cb456-8"><a href="#cb456-8" aria-hidden="true"></a><span class="co">#&gt; character(0)</span></span></code></pre></div>
<p>En particular, por lo tanto,</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="#cb457-1" aria-hidden="true"></a><span class="kw">names</span>(<span class="kw">which</span>(<span class="kw">table</span>(x)<span class="op">==</span><span class="kw">max</span>(<span class="kw">table</span>(x))))</span></code></pre></div>
<p>nos da los niveles de frecuencia máxima en <code>x</code>: su <strong>moda</strong>.</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true"></a><span class="kw">names</span>(<span class="kw">which</span>(<span class="kw">table</span>(x)<span class="op">==</span><span class="kw">max</span>(<span class="kw">table</span>(x))))</span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;2&quot;</span></span>
<span id="cb458-3"><a href="#cb458-3" aria-hidden="true"></a><span class="kw">names</span>(<span class="kw">which</span>(<span class="kw">table</span>(Respuestas)<span class="op">==</span><span class="kw">max</span>(<span class="kw">table</span>(Respuestas))))</span>
<span id="cb458-4"><a href="#cb458-4" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;No&quot;</span></span></code></pre></div>

<div class="example">
<p><span id="exm:sexo" class="example"><strong>(#exm:sexo) </strong></span>Continuamos en la situación del Ejemplo @ref(exm:ex1601). Para calcular las frecuencias y la moda con R, definimos un vector con los datos y le aplicamos las funciones pertinentes:</p>
</div>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="#cb459-1" aria-hidden="true"></a>Sexo_Ger=<span class="kw">c</span>(<span class="st">&quot;Mujer&quot;</span>,<span class="st">&quot;Mujer&quot;</span>,<span class="st">&quot;Hombre&quot;</span>,<span class="st">&quot;Mujer&quot;</span>,<span class="st">&quot;Mujer&quot;</span>,<span class="st">&quot;Mujer&quot;</span>,<span class="st">&quot;Mujer&quot;</span>,<span class="st">&quot;Mujer&quot;</span>,<span class="st">&quot;Hombre&quot;</span>,</span>
<span id="cb459-2"><a href="#cb459-2" aria-hidden="true"></a>  <span class="st">&quot;Mujer&quot;</span>,<span class="st">&quot;Hombre&quot;</span>,<span class="st">&quot;Hombre&quot;</span>,<span class="st">&quot;Mujer&quot;</span>,<span class="st">&quot;Mujer&quot;</span>,<span class="st">&quot;Hombre&quot;</span>,<span class="st">&quot;Mujer&quot;</span>,<span class="st">&quot;Mujer&quot;</span>,<span class="st">&quot;Mujer&quot;</span>,<span class="st">&quot;Mujer&quot;</span>,<span class="st">&quot;Hombre&quot;</span>)</span>
<span id="cb459-3"><a href="#cb459-3" aria-hidden="true"></a><span class="kw">table</span>(Sexo_Ger)  <span class="co">#Tabla de frecuencias absolutas</span></span>
<span id="cb459-4"><a href="#cb459-4" aria-hidden="true"></a><span class="co">#&gt; Sexo_Ger</span></span>
<span id="cb459-5"><a href="#cb459-5" aria-hidden="true"></a><span class="co">#&gt; Hombre  Mujer </span></span>
<span id="cb459-6"><a href="#cb459-6" aria-hidden="true"></a><span class="co">#&gt;      6     14</span></span>
<span id="cb459-7"><a href="#cb459-7" aria-hidden="true"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(Sexo_Ger)) <span class="co">#Tabla de frecuencias relativas</span></span>
<span id="cb459-8"><a href="#cb459-8" aria-hidden="true"></a><span class="co">#&gt; Sexo_Ger</span></span>
<span id="cb459-9"><a href="#cb459-9" aria-hidden="true"></a><span class="co">#&gt; Hombre  Mujer </span></span>
<span id="cb459-10"><a href="#cb459-10" aria-hidden="true"></a><span class="co">#&gt;    0.3    0.7</span></span>
<span id="cb459-11"><a href="#cb459-11" aria-hidden="true"></a><span class="kw">names</span>(<span class="kw">which</span>(<span class="kw">table</span>(Sexo_Ger)<span class="op">==</span><span class="kw">max</span>(<span class="kw">table</span>(Sexo_Ger)))) <span class="co">#Moda</span></span>
<span id="cb459-12"><a href="#cb459-12" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;Mujer&quot;</span></span></code></pre></div>
</div>
<div id="tablas-bidimensionales-de-frecuencias" class="section level2" number="10.3">
<h2 number="10.3"><span class="header-section-number">10.3</span> Tablas bidimensionales de frecuencias</h2>
<p>La función <code>table</code> también permite construir tablas de frecuencias conjuntas de dos o más variables. A modo de ejemplo, supongamos que el vector <code>Respuestas</code>, de la sección anterior, contiene las respuestas a una pregunta dadas por unos individuos cuyos sexos tenemos almacenados en un vector <code>Sexo</code>, en el mismo orden que sus respuestas. En este caso, podemos construir una tabla que nos diga cuántos individuos de cada sexo han dado cada respuesta.</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true"></a>Respuestas=<span class="kw">c</span>(<span class="st">&quot;No&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Sí&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Sí&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Sí&quot;</span>)</span>
<span id="cb460-2"><a href="#cb460-2" aria-hidden="true"></a>Sexo=<span class="kw">c</span>(<span class="st">&quot;M&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>) <span class="co">#H es hombre, M es mujer</span></span>
<span id="cb460-3"><a href="#cb460-3" aria-hidden="true"></a><span class="kw">table</span>(Respuestas,Sexo)</span>
<span id="cb460-4"><a href="#cb460-4" aria-hidden="true"></a><span class="co">#&gt;           Sexo</span></span>
<span id="cb460-5"><a href="#cb460-5" aria-hidden="true"></a><span class="co">#&gt; Respuestas H M</span></span>
<span id="cb460-6"><a href="#cb460-6" aria-hidden="true"></a><span class="co">#&gt;         No 3 2</span></span>
<span id="cb460-7"><a href="#cb460-7" aria-hidden="true"></a><span class="co">#&gt;         Sí 2 1</span></span>
<span id="cb460-8"><a href="#cb460-8" aria-hidden="true"></a><span class="kw">table</span>(Sexo,Respuestas)</span>
<span id="cb460-9"><a href="#cb460-9" aria-hidden="true"></a><span class="co">#&gt;     Respuestas</span></span>
<span id="cb460-10"><a href="#cb460-10" aria-hidden="true"></a><span class="co">#&gt; Sexo No Sí</span></span>
<span id="cb460-11"><a href="#cb460-11" aria-hidden="true"></a><span class="co">#&gt;    H  3  2</span></span>
<span id="cb460-12"><a href="#cb460-12" aria-hidden="true"></a><span class="co">#&gt;    M  2  1</span></span></code></pre></div>
<p>El resultado es, en ambos casos, una tabla de contingencia como antes, pero ahora <strong>bidimensional</strong>, puesto que cada entrada tiene dos dimensiones, una por cada variable, como en una matriz.</p>
<p>Como podemos ver, en una tabla bidimensional producida aplicando <code>table</code> a dos vectores, los niveles del primer vector en el argumento definen las filas, y los del segundo, las columnas. Así, en <code>table(Respuestas,Sexo)</code>, las filas corresponden a las respuestas y las columnas a los sexos.
Para intercambiar filas por columnas, es decir, para “trasponer” la tabla sin tener que recalcularla, podemos usar la misma función <code>t</code> que usamos para trasponer matrices:</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="#cb461-1" aria-hidden="true"></a><span class="kw">t</span>(<span class="kw">table</span>(Respuestas,Sexo))</span>
<span id="cb461-2"><a href="#cb461-2" aria-hidden="true"></a><span class="co">#&gt;     Respuestas</span></span>
<span id="cb461-3"><a href="#cb461-3" aria-hidden="true"></a><span class="co">#&gt; Sexo No Sí</span></span>
<span id="cb461-4"><a href="#cb461-4" aria-hidden="true"></a><span class="co">#&gt;    H  3  2</span></span>
<span id="cb461-5"><a href="#cb461-5" aria-hidden="true"></a><span class="co">#&gt;    M  2  1</span></span></code></pre></div>
<p>En la práctica, tenéis que decidir si alguna de las asignaciones de variables a dimensiones es más conveniente que la otra. Por ejemplo, y teniendo en cuenta que nuestra manera natural de leer una tabla es por filas, si lo que nos interesa son las frecuencias de las respuestas entre las personas de cada sexo, seguramente lo más adecuado será elegir el sexo como variable para las filas.</p>
<p>Para referirnos a una entrada de una tabla bidimensional podemos usar corchetes como si estuviéramos en una matriz o un <em>data frame</em>. Dentro de los corchetes, tanto podemos usar los índices como los nombres (entre comillas) de los niveles.</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true"></a><span class="kw">table</span>(Respuestas,Sexo)[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb462-2"><a href="#cb462-2" aria-hidden="true"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb462-3"><a href="#cb462-3" aria-hidden="true"></a><span class="kw">table</span>(Respuestas,Sexo)[<span class="st">&quot;No&quot;</span>,<span class="st">&quot;M&quot;</span>]</span>
<span id="cb462-4"><a href="#cb462-4" aria-hidden="true"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb462-5"><a href="#cb462-5" aria-hidden="true"></a><span class="kw">table</span>(Sexo,Respuestas)[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb462-6"><a href="#cb462-6" aria-hidden="true"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb462-7"><a href="#cb462-7" aria-hidden="true"></a><span class="kw">table</span>(Sexo,Respuestas)[<span class="st">&quot;H&quot;</span>,<span class="st">&quot;Sí&quot;</span>]</span>
<span id="cb462-8"><a href="#cb462-8" aria-hidden="true"></a><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<p>Como en el caso unidimensional, la función <code>prop.table</code> sirve para calcular tablas bidimensionales de frecuencias relativas conjuntas de pares de variables. Pero en el caso bidimensional tenemos dos tipos de frecuencias relativas, que definen, para cada par de variables, tres tablas diferentes:</p>
<ul>
<li><p>Las frecuencias relativas <strong>globales</strong>: para cada par de niveles, uno de cada variable, la fracción de individuos que pertenecen a ambos niveles respecto del total de la muestra; por ejemplo, la fracción de mujeres que han contestado que sí respecto del total de la muestra sería la frecuencia relativa global del par (mujer, sí).</p></li>
<li><p>Las frecuencias relativas <strong>marginales</strong>: dentro de cada nivel de una variable, y para cada nivel de la otra,
la fracción de individuos que pertenecen al segundo nivel respecto del total de la subpoblación definida por el primer nivel; por ejemplo, la fracción de mujeres que han contestado que sí <em>respecto del total de mujeres</em> sería una frecuencia relativa marginal.</p></li>
</ul>
<p>Dadas dos variables, se pueden calcular dos familias de frecuencias relativas marginales, según cuál sea la variable que defina las subpoblaciones en las que calculemos las frecuencias relativas de los niveles de la otra variable; no es lo mismo la fracción de mujeres que han contestado que sí respecto del total de mujeres, que la fracción de mujeres que han contestado que sí respecto del total de personas que han dado esta misma respuesta.</p>
<p>La tabla de frecuencias relativas globales se calcula aplicando sin más la función <code>prop.table</code> a la <code>table</code>.
Por lo que se refiere a las frecuencias relativas marginales, la variable que define las subpoblaciones en las que las calculamos se indica con el parámetro <code>margin</code>. Es decir, con <code>margin=1</code> especificamos que la variable que define las subpoblaciones es la primera, y que, por lo tanto, las frecuencias relativas se calculan dentro de las filas; en cambio, con <code>margin=2</code> especificamos que la variable que define las subpoblaciones es la segunda, por lo que las frecuencias relativas se calculan por columnas; <code>margin=NULL</code> es su valor por defecto y, por lo tanto, equivalente a no especificar este parámetro.</p>
<p>Así:</p>
<ul>
<li>La tabla <code>prop.table(table(Sexo,Respuestas))</code> nos da la fracción del total que representa cada pareja (sexo, respuesta).</li>
</ul>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="#cb463-1" aria-hidden="true"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(Sexo,Respuestas))</span>
<span id="cb463-2"><a href="#cb463-2" aria-hidden="true"></a><span class="co">#&gt;     Respuestas</span></span>
<span id="cb463-3"><a href="#cb463-3" aria-hidden="true"></a><span class="co">#&gt; Sexo    No    Sí</span></span>
<span id="cb463-4"><a href="#cb463-4" aria-hidden="true"></a><span class="co">#&gt;    H 0.375 0.250</span></span>
<span id="cb463-5"><a href="#cb463-5" aria-hidden="true"></a><span class="co">#&gt;    M 0.250 0.125</span></span></code></pre></div>
<ul>
<li>La tabla <code>prop.table(table(Sexo,Respuestas), margin=1)</code> nos da la fracción que representa cada respuesta dentro de cada sexo.</li>
</ul>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(Sexo,Respuestas), <span class="dt">margin=</span><span class="dv">1</span>)</span>
<span id="cb464-2"><a href="#cb464-2" aria-hidden="true"></a><span class="co">#&gt;     Respuestas</span></span>
<span id="cb464-3"><a href="#cb464-3" aria-hidden="true"></a><span class="co">#&gt; Sexo        No        Sí</span></span>
<span id="cb464-4"><a href="#cb464-4" aria-hidden="true"></a><span class="co">#&gt;    H 0.6000000 0.4000000</span></span>
<span id="cb464-5"><a href="#cb464-5" aria-hidden="true"></a><span class="co">#&gt;    M 0.6666667 0.3333333</span></span></code></pre></div>
<ul>
<li>La tabla <code>prop.table(table(Sexo,Respuestas), margin=2)</code> nos da la fracción que representa cada sexo dentro de cada respuesta</li>
</ul>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="#cb465-1" aria-hidden="true"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(Sexo,Respuestas), <span class="dt">margin=</span><span class="dv">2</span>)</span>
<span id="cb465-2"><a href="#cb465-2" aria-hidden="true"></a><span class="co">#&gt;     Respuestas</span></span>
<span id="cb465-3"><a href="#cb465-3" aria-hidden="true"></a><span class="co">#&gt; Sexo        No        Sí</span></span>
<span id="cb465-4"><a href="#cb465-4" aria-hidden="true"></a><span class="co">#&gt;    H 0.6000000 0.6666667</span></span>
<span id="cb465-5"><a href="#cb465-5" aria-hidden="true"></a><span class="co">#&gt;    M 0.4000000 0.3333333</span></span></code></pre></div>
<p>De esta manera, por ejemplo, en la primera tabla podemos leer que un 25% del total de la muestra son mujeres que han contestado que no; en la segunda tabla, que un 66.67% de las mujeres han contestado que no; y en la tercera tabla, que las mujeres representan el 40% del total de las personas que han contestado que no.</p>
<p>La función <code>CrossTable</code> del paquete <code>gmodels</code> permite producir (especificando el parámetro <code>prop.chisq=FALSE</code>) un resumen de la tabla de frecuencias absolutas y las tres tablas de frecuencias relativas de dos variables en un formato adecuado para su visualización:</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true"></a><span class="kw">library</span>(gmodels) </span>
<span id="cb466-2"><a href="#cb466-2" aria-hidden="true"></a><span class="kw">CrossTable</span>(Sexo, Respuestas, <span class="dt">prop.chisq=</span><span class="ot">FALSE</span>)</span>
<span id="cb466-3"><a href="#cb466-3" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb466-4"><a href="#cb466-4" aria-hidden="true"></a><span class="co">#&gt;  </span></span>
<span id="cb466-5"><a href="#cb466-5" aria-hidden="true"></a><span class="co">#&gt;    Cell Contents</span></span>
<span id="cb466-6"><a href="#cb466-6" aria-hidden="true"></a><span class="co">#&gt; |-------------------------|</span></span>
<span id="cb466-7"><a href="#cb466-7" aria-hidden="true"></a><span class="co">#&gt; |                       N |</span></span>
<span id="cb466-8"><a href="#cb466-8" aria-hidden="true"></a><span class="co">#&gt; |           N / Row Total |</span></span>
<span id="cb466-9"><a href="#cb466-9" aria-hidden="true"></a><span class="co">#&gt; |           N / Col Total |</span></span>
<span id="cb466-10"><a href="#cb466-10" aria-hidden="true"></a><span class="co">#&gt; |         N / Table Total |</span></span>
<span id="cb466-11"><a href="#cb466-11" aria-hidden="true"></a><span class="co">#&gt; |-------------------------|</span></span>
<span id="cb466-12"><a href="#cb466-12" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb466-13"><a href="#cb466-13" aria-hidden="true"></a><span class="co">#&gt;  </span></span>
<span id="cb466-14"><a href="#cb466-14" aria-hidden="true"></a><span class="co">#&gt; Total Observations in Table:  8 </span></span>
<span id="cb466-15"><a href="#cb466-15" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb466-16"><a href="#cb466-16" aria-hidden="true"></a><span class="co">#&gt;  </span></span>
<span id="cb466-17"><a href="#cb466-17" aria-hidden="true"></a><span class="co">#&gt;              | Respuestas </span></span>
<span id="cb466-18"><a href="#cb466-18" aria-hidden="true"></a><span class="co">#&gt;         Sexo |        No |        Sí | Row Total | </span></span>
<span id="cb466-19"><a href="#cb466-19" aria-hidden="true"></a><span class="co">#&gt; -------------|-----------|-----------|-----------|</span></span>
<span id="cb466-20"><a href="#cb466-20" aria-hidden="true"></a><span class="co">#&gt;            H |         3 |         2 |         5 | </span></span>
<span id="cb466-21"><a href="#cb466-21" aria-hidden="true"></a><span class="co">#&gt;              |     0.600 |     0.400 |     0.625 | </span></span>
<span id="cb466-22"><a href="#cb466-22" aria-hidden="true"></a><span class="co">#&gt;              |     0.600 |     0.667 |           | </span></span>
<span id="cb466-23"><a href="#cb466-23" aria-hidden="true"></a><span class="co">#&gt;              |     0.375 |     0.250 |           | </span></span>
<span id="cb466-24"><a href="#cb466-24" aria-hidden="true"></a><span class="co">#&gt; -------------|-----------|-----------|-----------|</span></span>
<span id="cb466-25"><a href="#cb466-25" aria-hidden="true"></a><span class="co">#&gt;            M |         2 |         1 |         3 | </span></span>
<span id="cb466-26"><a href="#cb466-26" aria-hidden="true"></a><span class="co">#&gt;              |     0.667 |     0.333 |     0.375 | </span></span>
<span id="cb466-27"><a href="#cb466-27" aria-hidden="true"></a><span class="co">#&gt;              |     0.400 |     0.333 |           | </span></span>
<span id="cb466-28"><a href="#cb466-28" aria-hidden="true"></a><span class="co">#&gt;              |     0.250 |     0.125 |           | </span></span>
<span id="cb466-29"><a href="#cb466-29" aria-hidden="true"></a><span class="co">#&gt; -------------|-----------|-----------|-----------|</span></span>
<span id="cb466-30"><a href="#cb466-30" aria-hidden="true"></a><span class="co">#&gt; Column Total |         5 |         3 |         8 | </span></span>
<span id="cb466-31"><a href="#cb466-31" aria-hidden="true"></a><span class="co">#&gt;              |     0.625 |     0.375 |           | </span></span>
<span id="cb466-32"><a href="#cb466-32" aria-hidden="true"></a><span class="co">#&gt; -------------|-----------|-----------|-----------|</span></span>
<span id="cb466-33"><a href="#cb466-33" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb466-34"><a href="#cb466-34" aria-hidden="true"></a><span class="co">#&gt; </span></span></code></pre></div>
<p>La leyenda <code>Cell Contents</code> explica los contenidos de cada celda de la tabla: en este caso, y en orden descendente, la frecuencia absoluta <code>N</code>, la frecuencia relativa por filas, la frecuencia relativa por columnas, y la frecuencia relativa global. Asimismo, se muestran las celdas de los márgenes, con las frecuencias absolutas y relativas de cada fila (en la columna <em>Row Total</em>) y cada columna (en la fila <em>Column Total</em>). Esta función dispone de muchos parámetros que permiten modificar el contenido de las celdas y que podéis consultar en su Ayuda.</p>
<p>Una tabla de contingencia bidimensional es, a efectos prácticos, una matriz con algunos atributos extra. En particular, podemos usar sobre estas tablas la mayoría de las funciones para matrices que tengan sentido para tablas; por ejemplo, <code>rowSums</code> y <code>colSums</code> se pueden aplicar a una tabla y suman sus filas y sus columnas, respectivamente:</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="#cb467-1" aria-hidden="true"></a><span class="kw">table</span>(Sexo,Respuestas)</span>
<span id="cb467-2"><a href="#cb467-2" aria-hidden="true"></a><span class="co">#&gt;     Respuestas</span></span>
<span id="cb467-3"><a href="#cb467-3" aria-hidden="true"></a><span class="co">#&gt; Sexo No Sí</span></span>
<span id="cb467-4"><a href="#cb467-4" aria-hidden="true"></a><span class="co">#&gt;    H  3  2</span></span>
<span id="cb467-5"><a href="#cb467-5" aria-hidden="true"></a><span class="co">#&gt;    M  2  1</span></span>
<span id="cb467-6"><a href="#cb467-6" aria-hidden="true"></a><span class="kw">colSums</span>(<span class="kw">table</span>(Sexo,Respuestas))</span>
<span id="cb467-7"><a href="#cb467-7" aria-hidden="true"></a><span class="co">#&gt; No Sí </span></span>
<span id="cb467-8"><a href="#cb467-8" aria-hidden="true"></a><span class="co">#&gt;  5  3</span></span>
<span id="cb467-9"><a href="#cb467-9" aria-hidden="true"></a><span class="kw">rowSums</span>(<span class="kw">table</span>(Sexo,Respuestas))</span>
<span id="cb467-10"><a href="#cb467-10" aria-hidden="true"></a><span class="co">#&gt; H M </span></span>
<span id="cb467-11"><a href="#cb467-11" aria-hidden="true"></a><span class="co">#&gt; 5 3</span></span>
<span id="cb467-12"><a href="#cb467-12" aria-hidden="true"></a><span class="kw">colSums</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(Sexo,Respuestas)))</span>
<span id="cb467-13"><a href="#cb467-13" aria-hidden="true"></a><span class="co">#&gt;    No    Sí </span></span>
<span id="cb467-14"><a href="#cb467-14" aria-hidden="true"></a><span class="co">#&gt; 0.625 0.375</span></span>
<span id="cb467-15"><a href="#cb467-15" aria-hidden="true"></a><span class="kw">rowSums</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(Sexo,Respuestas)))</span>
<span id="cb467-16"><a href="#cb467-16" aria-hidden="true"></a><span class="co">#&gt;     H     M </span></span>
<span id="cb467-17"><a href="#cb467-17" aria-hidden="true"></a><span class="co">#&gt; 0.625 0.375</span></span></code></pre></div>
<p>También podemos usar sobre una tabla bidimensional (o, en general, multidimensional) la función <code>apply</code>
con la misma sintaxis que para matrices; véase la próxima sección.</p>
</div>
<div id="tablas-multidimensionales-de-frecuencias" class="section level2" number="10.4">
<h2 number="10.4"><span class="header-section-number">10.4</span> Tablas multidimensionales de frecuencias</h2>
<p>En general, podemos calcular tablas de frecuencias de cualquier número de variables, no sólo de una o dos. El manejo de estas tablas multidimensionales es similar al caso bidimensional, simplemente recordando que ahora hay más variables que tener en cuenta en el momento, por ejemplo, de especificar entradas o de calcular frecuencias relativas marginales.</p>
<p>Veamos un ejemplo tridimensional. Supongamos que, además de los vectores</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true"></a>Respuestas=<span class="kw">c</span>(<span class="st">&quot;No&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Sí&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Sí&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Sí&quot;</span>)</span>
<span id="cb468-2"><a href="#cb468-2" aria-hidden="true"></a>Sexo=<span class="kw">c</span>(<span class="st">&quot;M&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>) </span></code></pre></div>
<p>tenemos un tercer vector con las nacionalidades de los individuos representados en estos dos vectores:</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="#cb469-1" aria-hidden="true"></a>Pais=<span class="kw">c</span>(<span class="st">&quot;Francia&quot;</span>,<span class="st">&quot;Alemania&quot;</span>,<span class="st">&quot;Italia&quot;</span>,<span class="st">&quot;Italia&quot;</span>,<span class="st">&quot;Italia&quot;</span>,<span class="st">&quot;Italia&quot;</span>,<span class="st">&quot;Alemania&quot;</span>,<span class="st">&quot;Francia&quot;</span>)</span></code></pre></div>
<p>Podemos calcular entonces una tabla de frecuencias absolutas para las ternas (sexo, respuesta, país).</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true"></a><span class="kw">table</span>(Sexo,Respuestas,Pais)</span>
<span id="cb470-2"><a href="#cb470-2" aria-hidden="true"></a><span class="co">#&gt; , , Pais = Alemania</span></span>
<span id="cb470-3"><a href="#cb470-3" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb470-4"><a href="#cb470-4" aria-hidden="true"></a><span class="co">#&gt;     Respuestas</span></span>
<span id="cb470-5"><a href="#cb470-5" aria-hidden="true"></a><span class="co">#&gt; Sexo No Sí</span></span>
<span id="cb470-6"><a href="#cb470-6" aria-hidden="true"></a><span class="co">#&gt;    H  1  0</span></span>
<span id="cb470-7"><a href="#cb470-7" aria-hidden="true"></a><span class="co">#&gt;    M  1  0</span></span>
<span id="cb470-8"><a href="#cb470-8" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb470-9"><a href="#cb470-9" aria-hidden="true"></a><span class="co">#&gt; , , Pais = Francia</span></span>
<span id="cb470-10"><a href="#cb470-10" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb470-11"><a href="#cb470-11" aria-hidden="true"></a><span class="co">#&gt;     Respuestas</span></span>
<span id="cb470-12"><a href="#cb470-12" aria-hidden="true"></a><span class="co">#&gt; Sexo No Sí</span></span>
<span id="cb470-13"><a href="#cb470-13" aria-hidden="true"></a><span class="co">#&gt;    H  0  1</span></span>
<span id="cb470-14"><a href="#cb470-14" aria-hidden="true"></a><span class="co">#&gt;    M  1  0</span></span>
<span id="cb470-15"><a href="#cb470-15" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb470-16"><a href="#cb470-16" aria-hidden="true"></a><span class="co">#&gt; , , Pais = Italia</span></span>
<span id="cb470-17"><a href="#cb470-17" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb470-18"><a href="#cb470-18" aria-hidden="true"></a><span class="co">#&gt;     Respuestas</span></span>
<span id="cb470-19"><a href="#cb470-19" aria-hidden="true"></a><span class="co">#&gt; Sexo No Sí</span></span>
<span id="cb470-20"><a href="#cb470-20" aria-hidden="true"></a><span class="co">#&gt;    H  2  1</span></span>
<span id="cb470-21"><a href="#cb470-21" aria-hidden="true"></a><span class="co">#&gt;    M  0  1</span></span></code></pre></div>
<p>R muestra la <em>tabla tridimensional</em> que obtenemos como una lista de tablas bidimensionales <code>table(Sexo,Respuestas)</code>, separando la población según los niveles de la tercera variable. Si no os gusta esta manera de visualizar una tabla tridimensional, una alternativa es usar la función <code>ftable</code>, que la mostrará en lo que se llama <strong>formato plano</strong>:</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="#cb471-1" aria-hidden="true"></a><span class="kw">ftable</span>(Sexo,Respuestas,Pais)</span>
<span id="cb471-2"><a href="#cb471-2" aria-hidden="true"></a><span class="co">#&gt;                 Pais Alemania Francia Italia</span></span>
<span id="cb471-3"><a href="#cb471-3" aria-hidden="true"></a><span class="co">#&gt; Sexo Respuestas                             </span></span>
<span id="cb471-4"><a href="#cb471-4" aria-hidden="true"></a><span class="co">#&gt; H    No                     1       0      2</span></span>
<span id="cb471-5"><a href="#cb471-5" aria-hidden="true"></a><span class="co">#&gt;      Sí                     0       1      1</span></span>
<span id="cb471-6"><a href="#cb471-6" aria-hidden="true"></a><span class="co">#&gt; M    No                     1       1      0</span></span>
<span id="cb471-7"><a href="#cb471-7" aria-hidden="true"></a><span class="co">#&gt;      Sí                     0       0      1</span></span></code></pre></div>
<p>Los parámetros <code>row.vars</code> y <code>col.vars</code> de <code>ftable</code> permiten especificar qué variables queremos que aparezcan como filas o como columnas, respectivamente.</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="#cb472-1" aria-hidden="true"></a><span class="kw">ftable</span>(Sexo,Respuestas,Pais, <span class="dt">col.vars=</span><span class="kw">c</span>(<span class="st">&quot;Sexo&quot;</span>,<span class="st">&quot;Respuestas&quot;</span>))</span>
<span id="cb472-2"><a href="#cb472-2" aria-hidden="true"></a><span class="co">#&gt;          Sexo        H     M   </span></span>
<span id="cb472-3"><a href="#cb472-3" aria-hidden="true"></a><span class="co">#&gt;          Respuestas No Sí No Sí</span></span>
<span id="cb472-4"><a href="#cb472-4" aria-hidden="true"></a><span class="co">#&gt; Pais                           </span></span>
<span id="cb472-5"><a href="#cb472-5" aria-hidden="true"></a><span class="co">#&gt; Alemania             1  0  1  0</span></span>
<span id="cb472-6"><a href="#cb472-6" aria-hidden="true"></a><span class="co">#&gt; Francia              0  1  1  0</span></span>
<span id="cb472-7"><a href="#cb472-7" aria-hidden="true"></a><span class="co">#&gt; Italia               2  1  0  1</span></span></code></pre></div>
<p>Para referirnos a una entrada, o a una subtabla, de una tabla podemos usar corchetes.</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="#cb473-1" aria-hidden="true"></a><span class="kw">table</span>(Sexo,Respuestas,Pais)[<span class="st">&quot;H&quot;</span>,<span class="st">&quot;Sí&quot;</span>,<span class="st">&quot;Italia&quot;</span>]</span>
<span id="cb473-2"><a href="#cb473-2" aria-hidden="true"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb473-3"><a href="#cb473-3" aria-hidden="true"></a><span class="kw">table</span>(Sexo,Respuestas,Pais)[ , ,<span class="st">&quot;Italia&quot;</span>]</span>
<span id="cb473-4"><a href="#cb473-4" aria-hidden="true"></a><span class="co">#&gt;     Respuestas</span></span>
<span id="cb473-5"><a href="#cb473-5" aria-hidden="true"></a><span class="co">#&gt; Sexo No Sí</span></span>
<span id="cb473-6"><a href="#cb473-6" aria-hidden="true"></a><span class="co">#&gt;    H  2  1</span></span>
<span id="cb473-7"><a href="#cb473-7" aria-hidden="true"></a><span class="co">#&gt;    M  0  1</span></span>
<span id="cb473-8"><a href="#cb473-8" aria-hidden="true"></a><span class="kw">table</span>(Sexo,Respuestas,Pais)[  ,<span class="st">&quot;Sí&quot;</span>,<span class="st">&quot;Italia&quot;</span>]</span>
<span id="cb473-9"><a href="#cb473-9" aria-hidden="true"></a><span class="co">#&gt; H M </span></span>
<span id="cb473-10"><a href="#cb473-10" aria-hidden="true"></a><span class="co">#&gt; 1 1</span></span>
<span id="cb473-11"><a href="#cb473-11" aria-hidden="true"></a><span class="kw">table</span>(Sexo,Respuestas,Pais)[<span class="st">&quot;M&quot;</span>, ,<span class="st">&quot;Italia&quot;</span>]</span>
<span id="cb473-12"><a href="#cb473-12" aria-hidden="true"></a><span class="co">#&gt; No Sí </span></span>
<span id="cb473-13"><a href="#cb473-13" aria-hidden="true"></a><span class="co">#&gt;  0  1</span></span></code></pre></div>
<p>En una tabla multidimensional, podemos calcular frecuencias relativas marginales respecto de los niveles de una variable o respecto de combinaciones de niveles de varias variables: por ejemplo, las frecuencias relativas marginales de las respuestas en cada combinación (sexo, país). Como en el caso bidimensional, las tablas correspondientes se calculan aplicando <code>prop.table</code> a la tabla de frecuencias absolutas, y especificando con el parámetro <code>margin</code> las dimensiones, o combinaciones de dimensiones, respecto de las que calculamos las frecuencias relativas. Si no se especifica el parámetro <code>margin</code>, se obtiene la tabla de frecuencias relativas globales.</p>
<p>Así, por ejemplo:</p>
<ul>
<li>La tabla <code>prop.table(table(Sexo,Respuestas,Pais))</code> nos da la fracción que representa cada terna (sexo, respuesta, país) dentro del total de la muestra:</li>
</ul>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="#cb474-1" aria-hidden="true"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(Sexo,Respuestas,Pais)) </span>
<span id="cb474-2"><a href="#cb474-2" aria-hidden="true"></a><span class="co">#&gt; , , Pais = Alemania</span></span>
<span id="cb474-3"><a href="#cb474-3" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb474-4"><a href="#cb474-4" aria-hidden="true"></a><span class="co">#&gt;     Respuestas</span></span>
<span id="cb474-5"><a href="#cb474-5" aria-hidden="true"></a><span class="co">#&gt; Sexo    No    Sí</span></span>
<span id="cb474-6"><a href="#cb474-6" aria-hidden="true"></a><span class="co">#&gt;    H 0.125 0.000</span></span>
<span id="cb474-7"><a href="#cb474-7" aria-hidden="true"></a><span class="co">#&gt;    M 0.125 0.000</span></span>
<span id="cb474-8"><a href="#cb474-8" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb474-9"><a href="#cb474-9" aria-hidden="true"></a><span class="co">#&gt; , , Pais = Francia</span></span>
<span id="cb474-10"><a href="#cb474-10" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb474-11"><a href="#cb474-11" aria-hidden="true"></a><span class="co">#&gt;     Respuestas</span></span>
<span id="cb474-12"><a href="#cb474-12" aria-hidden="true"></a><span class="co">#&gt; Sexo    No    Sí</span></span>
<span id="cb474-13"><a href="#cb474-13" aria-hidden="true"></a><span class="co">#&gt;    H 0.000 0.125</span></span>
<span id="cb474-14"><a href="#cb474-14" aria-hidden="true"></a><span class="co">#&gt;    M 0.125 0.000</span></span>
<span id="cb474-15"><a href="#cb474-15" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb474-16"><a href="#cb474-16" aria-hidden="true"></a><span class="co">#&gt; , , Pais = Italia</span></span>
<span id="cb474-17"><a href="#cb474-17" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb474-18"><a href="#cb474-18" aria-hidden="true"></a><span class="co">#&gt;     Respuestas</span></span>
<span id="cb474-19"><a href="#cb474-19" aria-hidden="true"></a><span class="co">#&gt; Sexo    No    Sí</span></span>
<span id="cb474-20"><a href="#cb474-20" aria-hidden="true"></a><span class="co">#&gt;    H 0.250 0.125</span></span>
<span id="cb474-21"><a href="#cb474-21" aria-hidden="true"></a><span class="co">#&gt;    M 0.000 0.125</span></span></code></pre></div>
<ul>
<li>La tabla <code>prop.table(table(Sexo,Respuestas,Pais), margin=3)</code> nos da la fracción que representa cada pareja (sexo, respuesta) dentro de cada país:</li>
</ul>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="#cb475-1" aria-hidden="true"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(Sexo,Respuestas,Pais), <span class="dt">margin=</span><span class="dv">3</span>)</span>
<span id="cb475-2"><a href="#cb475-2" aria-hidden="true"></a><span class="co">#&gt; , , Pais = Alemania</span></span>
<span id="cb475-3"><a href="#cb475-3" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb475-4"><a href="#cb475-4" aria-hidden="true"></a><span class="co">#&gt;     Respuestas</span></span>
<span id="cb475-5"><a href="#cb475-5" aria-hidden="true"></a><span class="co">#&gt; Sexo   No   Sí</span></span>
<span id="cb475-6"><a href="#cb475-6" aria-hidden="true"></a><span class="co">#&gt;    H 0.50 0.00</span></span>
<span id="cb475-7"><a href="#cb475-7" aria-hidden="true"></a><span class="co">#&gt;    M 0.50 0.00</span></span>
<span id="cb475-8"><a href="#cb475-8" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb475-9"><a href="#cb475-9" aria-hidden="true"></a><span class="co">#&gt; , , Pais = Francia</span></span>
<span id="cb475-10"><a href="#cb475-10" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb475-11"><a href="#cb475-11" aria-hidden="true"></a><span class="co">#&gt;     Respuestas</span></span>
<span id="cb475-12"><a href="#cb475-12" aria-hidden="true"></a><span class="co">#&gt; Sexo   No   Sí</span></span>
<span id="cb475-13"><a href="#cb475-13" aria-hidden="true"></a><span class="co">#&gt;    H 0.00 0.50</span></span>
<span id="cb475-14"><a href="#cb475-14" aria-hidden="true"></a><span class="co">#&gt;    M 0.50 0.00</span></span>
<span id="cb475-15"><a href="#cb475-15" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb475-16"><a href="#cb475-16" aria-hidden="true"></a><span class="co">#&gt; , , Pais = Italia</span></span>
<span id="cb475-17"><a href="#cb475-17" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb475-18"><a href="#cb475-18" aria-hidden="true"></a><span class="co">#&gt;     Respuestas</span></span>
<span id="cb475-19"><a href="#cb475-19" aria-hidden="true"></a><span class="co">#&gt; Sexo   No   Sí</span></span>
<span id="cb475-20"><a href="#cb475-20" aria-hidden="true"></a><span class="co">#&gt;    H 0.50 0.25</span></span>
<span id="cb475-21"><a href="#cb475-21" aria-hidden="true"></a><span class="co">#&gt;    M 0.00 0.25</span></span></code></pre></div>
<ul>
<li>La tabla <code>prop.table(table(Sexo,Respuestas,Pais), margin=c(1,3))</code> nos da la fracción que representa cada respuesta dentro de cada combinación de (sexo, país):</li>
</ul>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="#cb476-1" aria-hidden="true"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(Sexo,Respuestas,Pais), <span class="dt">margin=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb476-2"><a href="#cb476-2" aria-hidden="true"></a><span class="co">#&gt; , , Pais = Alemania</span></span>
<span id="cb476-3"><a href="#cb476-3" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb476-4"><a href="#cb476-4" aria-hidden="true"></a><span class="co">#&gt;     Respuestas</span></span>
<span id="cb476-5"><a href="#cb476-5" aria-hidden="true"></a><span class="co">#&gt; Sexo        No        Sí</span></span>
<span id="cb476-6"><a href="#cb476-6" aria-hidden="true"></a><span class="co">#&gt;    H 1.0000000 0.0000000</span></span>
<span id="cb476-7"><a href="#cb476-7" aria-hidden="true"></a><span class="co">#&gt;    M 1.0000000 0.0000000</span></span>
<span id="cb476-8"><a href="#cb476-8" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb476-9"><a href="#cb476-9" aria-hidden="true"></a><span class="co">#&gt; , , Pais = Francia</span></span>
<span id="cb476-10"><a href="#cb476-10" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb476-11"><a href="#cb476-11" aria-hidden="true"></a><span class="co">#&gt;     Respuestas</span></span>
<span id="cb476-12"><a href="#cb476-12" aria-hidden="true"></a><span class="co">#&gt; Sexo        No        Sí</span></span>
<span id="cb476-13"><a href="#cb476-13" aria-hidden="true"></a><span class="co">#&gt;    H 0.0000000 1.0000000</span></span>
<span id="cb476-14"><a href="#cb476-14" aria-hidden="true"></a><span class="co">#&gt;    M 1.0000000 0.0000000</span></span>
<span id="cb476-15"><a href="#cb476-15" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb476-16"><a href="#cb476-16" aria-hidden="true"></a><span class="co">#&gt; , , Pais = Italia</span></span>
<span id="cb476-17"><a href="#cb476-17" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb476-18"><a href="#cb476-18" aria-hidden="true"></a><span class="co">#&gt;     Respuestas</span></span>
<span id="cb476-19"><a href="#cb476-19" aria-hidden="true"></a><span class="co">#&gt; Sexo        No        Sí</span></span>
<span id="cb476-20"><a href="#cb476-20" aria-hidden="true"></a><span class="co">#&gt;    H 0.6666667 0.3333333</span></span>
<span id="cb476-21"><a href="#cb476-21" aria-hidden="true"></a><span class="co">#&gt;    M 0.0000000 1.0000000</span></span></code></pre></div>
<p>De esta manera, por ejemplo, en la primera tabla podemos leer que los hombres españoles que han contestado afirmativamente forman un
12.5% del total de individuos; en la segunda, que los hombres que han contestado que sí representan un 25% del total de individuos españoles; y en la tercera, que un 33.33% del total de hombres españoles ha contestado que sí.</p>
<p>Al aplicar <code>prop.table</code> al resultado de una <code>ftable</code>, la tabla resultante sigue en formato plano:</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="#cb477-1" aria-hidden="true"></a><span class="kw">prop.table</span>(<span class="kw">ftable</span>(Sexo,Respuestas,Pais)) </span>
<span id="cb477-2"><a href="#cb477-2" aria-hidden="true"></a><span class="co">#&gt;                 Pais Alemania Francia Italia</span></span>
<span id="cb477-3"><a href="#cb477-3" aria-hidden="true"></a><span class="co">#&gt; Sexo Respuestas                             </span></span>
<span id="cb477-4"><a href="#cb477-4" aria-hidden="true"></a><span class="co">#&gt; H    No                 0.125   0.000  0.250</span></span>
<span id="cb477-5"><a href="#cb477-5" aria-hidden="true"></a><span class="co">#&gt;      Sí                 0.000   0.125  0.125</span></span>
<span id="cb477-6"><a href="#cb477-6" aria-hidden="true"></a><span class="co">#&gt; M    No                 0.125   0.125  0.000</span></span>
<span id="cb477-7"><a href="#cb477-7" aria-hidden="true"></a><span class="co">#&gt;      Sí                 0.000   0.000  0.125</span></span></code></pre></div>
<p>Podemos aplicar funciones a filas o columnas de una tabla multidimensional con la función <code>apply</code>, especificando en el parámetro <code>FUN</code> la función y en el parámetro <code>MARGIN</code> la variable o combinación de variables a la que aplicamos la función (son las variables que aparecerán en la tabla resultante). Observad las dos instrucciones siguientes y sus resultados:</p>
<ul>
<li>Sumamos los números de respuestas agrupando por combinaciones (sexo,país):</li>
</ul>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="#cb478-1" aria-hidden="true"></a><span class="kw">apply</span>(<span class="kw">table</span>(Sexo,Respuestas,Pais), <span class="dt">MARGIN=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">FUN=</span>sum)</span>
<span id="cb478-2"><a href="#cb478-2" aria-hidden="true"></a><span class="co">#&gt;     Pais</span></span>
<span id="cb478-3"><a href="#cb478-3" aria-hidden="true"></a><span class="co">#&gt; Sexo Alemania Francia Italia</span></span>
<span id="cb478-4"><a href="#cb478-4" aria-hidden="true"></a><span class="co">#&gt;    H        1       1      3</span></span>
<span id="cb478-5"><a href="#cb478-5" aria-hidden="true"></a><span class="co">#&gt;    M        1       1      1</span></span></code></pre></div>
<ul>
<li>Sumamos los números de respuestas agrupando por sexos:</li>
</ul>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="#cb479-1" aria-hidden="true"></a><span class="kw">apply</span>(<span class="kw">table</span>(Sexo,Respuestas,Pais), <span class="dt">MARGIN=</span><span class="dv">2</span>, <span class="dt">FUN=</span>sum)</span>
<span id="cb479-2"><a href="#cb479-2" aria-hidden="true"></a><span class="co">#&gt; No Sí </span></span>
<span id="cb479-3"><a href="#cb479-3" aria-hidden="true"></a><span class="co">#&gt;  5  3</span></span></code></pre></div>
<p>Hasta ahora hemos manipulado tablas de frecuencias que hemos construido nosotros mismos a partir de variables cualitativas. Todo lo que hemos hecho con estas tablas se puede también hacer con las tablas de frecuencias que lleva R predefinidas o que obtengamos de otra manera. Veamos un ejemplo.</p>

<div class="example">
<p><span id="exm:HairEyeColor" class="example"><strong>(#exm:HairEyeColor) </strong></span>El objeto de datos <code>HairEyeColor</code> que lleva predefinido R es una tabla las frecuencias absolutas, en una muestra de personas, de tres variables cualitativas: color de cabello, <code>Hair</code>, color de los ojos, <code>Eye</code>, y sexo, <code>Sex</code>, en este orden.</p>
</div>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="#cb480-1" aria-hidden="true"></a><span class="kw">str</span>(HairEyeColor)</span>
<span id="cb480-2"><a href="#cb480-2" aria-hidden="true"></a><span class="co">#&gt;  &#39;table&#39; num [1:4, 1:4, 1:2] 32 53 10 3 11 50 10 30 10 25 ...</span></span>
<span id="cb480-3"><a href="#cb480-3" aria-hidden="true"></a><span class="co">#&gt;  - attr(*, &quot;dimnames&quot;)=List of 3</span></span>
<span id="cb480-4"><a href="#cb480-4" aria-hidden="true"></a><span class="co">#&gt;   ..$ Hair: chr [1:4] &quot;Black&quot; &quot;Brown&quot; &quot;Red&quot; &quot;Blond&quot;</span></span>
<span id="cb480-5"><a href="#cb480-5" aria-hidden="true"></a><span class="co">#&gt;   ..$ Eye : chr [1:4] &quot;Brown&quot; &quot;Blue&quot; &quot;Hazel&quot; &quot;Green&quot;</span></span>
<span id="cb480-6"><a href="#cb480-6" aria-hidden="true"></a><span class="co">#&gt;   ..$ Sex : chr [1:2] &quot;Male&quot; &quot;Female&quot;</span></span>
<span id="cb480-7"><a href="#cb480-7" aria-hidden="true"></a><span class="kw">ftable</span>(HairEyeColor)</span>
<span id="cb480-8"><a href="#cb480-8" aria-hidden="true"></a><span class="co">#&gt;             Sex Male Female</span></span>
<span id="cb480-9"><a href="#cb480-9" aria-hidden="true"></a><span class="co">#&gt; Hair  Eye                  </span></span>
<span id="cb480-10"><a href="#cb480-10" aria-hidden="true"></a><span class="co">#&gt; Black Brown       32     36</span></span>
<span id="cb480-11"><a href="#cb480-11" aria-hidden="true"></a><span class="co">#&gt;       Blue        11      9</span></span>
<span id="cb480-12"><a href="#cb480-12" aria-hidden="true"></a><span class="co">#&gt;       Hazel       10      5</span></span>
<span id="cb480-13"><a href="#cb480-13" aria-hidden="true"></a><span class="co">#&gt;       Green        3      2</span></span>
<span id="cb480-14"><a href="#cb480-14" aria-hidden="true"></a><span class="co">#&gt; Brown Brown       53     66</span></span>
<span id="cb480-15"><a href="#cb480-15" aria-hidden="true"></a><span class="co">#&gt;       Blue        50     34</span></span>
<span id="cb480-16"><a href="#cb480-16" aria-hidden="true"></a><span class="co">#&gt;       Hazel       25     29</span></span>
<span id="cb480-17"><a href="#cb480-17" aria-hidden="true"></a><span class="co">#&gt;       Green       15     14</span></span>
<span id="cb480-18"><a href="#cb480-18" aria-hidden="true"></a><span class="co">#&gt; Red   Brown       10     16</span></span>
<span id="cb480-19"><a href="#cb480-19" aria-hidden="true"></a><span class="co">#&gt;       Blue        10      7</span></span>
<span id="cb480-20"><a href="#cb480-20" aria-hidden="true"></a><span class="co">#&gt;       Hazel        7      7</span></span>
<span id="cb480-21"><a href="#cb480-21" aria-hidden="true"></a><span class="co">#&gt;       Green        7      7</span></span>
<span id="cb480-22"><a href="#cb480-22" aria-hidden="true"></a><span class="co">#&gt; Blond Brown        3      4</span></span>
<span id="cb480-23"><a href="#cb480-23" aria-hidden="true"></a><span class="co">#&gt;       Blue        30     64</span></span>
<span id="cb480-24"><a href="#cb480-24" aria-hidden="true"></a><span class="co">#&gt;       Hazel        5      5</span></span>
<span id="cb480-25"><a href="#cb480-25" aria-hidden="true"></a><span class="co">#&gt;       Green        8      8</span></span></code></pre></div>
<p>Efectuemos algunas operaciones sobre esta tabla, para ilustrar como podemos trabajar con ella:</p>
<ul>
<li>Número total de individuos en la muestra:</li>
</ul>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="#cb481-1" aria-hidden="true"></a><span class="kw">sum</span>(HairEyeColor)</span>
<span id="cb481-2"><a href="#cb481-2" aria-hidden="true"></a><span class="co">#&gt; [1] 592</span></span></code></pre></div>
<ul>
<li>Subtabla de hombres:</li>
</ul>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="#cb482-1" aria-hidden="true"></a>HairEyeColor[ , ,<span class="st">&quot;Male&quot;</span>]</span>
<span id="cb482-2"><a href="#cb482-2" aria-hidden="true"></a><span class="co">#&gt;        Eye</span></span>
<span id="cb482-3"><a href="#cb482-3" aria-hidden="true"></a><span class="co">#&gt; Hair    Brown Blue Hazel Green</span></span>
<span id="cb482-4"><a href="#cb482-4" aria-hidden="true"></a><span class="co">#&gt;   Black    32   11    10     3</span></span>
<span id="cb482-5"><a href="#cb482-5" aria-hidden="true"></a><span class="co">#&gt;   Brown    53   50    25    15</span></span>
<span id="cb482-6"><a href="#cb482-6" aria-hidden="true"></a><span class="co">#&gt;   Red      10   10     7     7</span></span>
<span id="cb482-7"><a href="#cb482-7" aria-hidden="true"></a><span class="co">#&gt;   Blond     3   30     5     8</span></span></code></pre></div>
<ul>
<li>Frecuencias relativas de las combinaciones (color de cabello, color de ojos) en cada sexo:</li>
</ul>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="#cb483-1" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">prop.table</span>(HairEyeColor, <span class="dt">margin=</span><span class="dv">3</span>), <span class="dv">3</span>)</span>
<span id="cb483-2"><a href="#cb483-2" aria-hidden="true"></a><span class="co">#&gt; , , Sex = Male</span></span>
<span id="cb483-3"><a href="#cb483-3" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb483-4"><a href="#cb483-4" aria-hidden="true"></a><span class="co">#&gt;        Eye</span></span>
<span id="cb483-5"><a href="#cb483-5" aria-hidden="true"></a><span class="co">#&gt; Hair    Brown  Blue Hazel Green</span></span>
<span id="cb483-6"><a href="#cb483-6" aria-hidden="true"></a><span class="co">#&gt;   Black 0.115 0.039 0.036 0.011</span></span>
<span id="cb483-7"><a href="#cb483-7" aria-hidden="true"></a><span class="co">#&gt;   Brown 0.190 0.179 0.090 0.054</span></span>
<span id="cb483-8"><a href="#cb483-8" aria-hidden="true"></a><span class="co">#&gt;   Red   0.036 0.036 0.025 0.025</span></span>
<span id="cb483-9"><a href="#cb483-9" aria-hidden="true"></a><span class="co">#&gt;   Blond 0.011 0.108 0.018 0.029</span></span>
<span id="cb483-10"><a href="#cb483-10" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb483-11"><a href="#cb483-11" aria-hidden="true"></a><span class="co">#&gt; , , Sex = Female</span></span>
<span id="cb483-12"><a href="#cb483-12" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb483-13"><a href="#cb483-13" aria-hidden="true"></a><span class="co">#&gt;        Eye</span></span>
<span id="cb483-14"><a href="#cb483-14" aria-hidden="true"></a><span class="co">#&gt; Hair    Brown  Blue Hazel Green</span></span>
<span id="cb483-15"><a href="#cb483-15" aria-hidden="true"></a><span class="co">#&gt;   Black 0.115 0.029 0.016 0.006</span></span>
<span id="cb483-16"><a href="#cb483-16" aria-hidden="true"></a><span class="co">#&gt;   Brown 0.211 0.109 0.093 0.045</span></span>
<span id="cb483-17"><a href="#cb483-17" aria-hidden="true"></a><span class="co">#&gt;   Red   0.051 0.022 0.022 0.022</span></span>
<span id="cb483-18"><a href="#cb483-18" aria-hidden="true"></a><span class="co">#&gt;   Blond 0.013 0.204 0.016 0.026</span></span></code></pre></div>
<ul>
<li>Frecuencias relativas de los sexos en cada combinación (color de cabello, color de ojos)</li>
</ul>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="#cb484-1" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">prop.table</span>(HairEyeColor, <span class="dt">margin=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)), <span class="dv">3</span>)</span>
<span id="cb484-2"><a href="#cb484-2" aria-hidden="true"></a><span class="co">#&gt; , , Sex = Male</span></span>
<span id="cb484-3"><a href="#cb484-3" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb484-4"><a href="#cb484-4" aria-hidden="true"></a><span class="co">#&gt;        Eye</span></span>
<span id="cb484-5"><a href="#cb484-5" aria-hidden="true"></a><span class="co">#&gt; Hair    Brown  Blue Hazel Green</span></span>
<span id="cb484-6"><a href="#cb484-6" aria-hidden="true"></a><span class="co">#&gt;   Black 0.471 0.550 0.667 0.600</span></span>
<span id="cb484-7"><a href="#cb484-7" aria-hidden="true"></a><span class="co">#&gt;   Brown 0.445 0.595 0.463 0.517</span></span>
<span id="cb484-8"><a href="#cb484-8" aria-hidden="true"></a><span class="co">#&gt;   Red   0.385 0.588 0.500 0.500</span></span>
<span id="cb484-9"><a href="#cb484-9" aria-hidden="true"></a><span class="co">#&gt;   Blond 0.429 0.319 0.500 0.500</span></span>
<span id="cb484-10"><a href="#cb484-10" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb484-11"><a href="#cb484-11" aria-hidden="true"></a><span class="co">#&gt; , , Sex = Female</span></span>
<span id="cb484-12"><a href="#cb484-12" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb484-13"><a href="#cb484-13" aria-hidden="true"></a><span class="co">#&gt;        Eye</span></span>
<span id="cb484-14"><a href="#cb484-14" aria-hidden="true"></a><span class="co">#&gt; Hair    Brown  Blue Hazel Green</span></span>
<span id="cb484-15"><a href="#cb484-15" aria-hidden="true"></a><span class="co">#&gt;   Black 0.529 0.450 0.333 0.400</span></span>
<span id="cb484-16"><a href="#cb484-16" aria-hidden="true"></a><span class="co">#&gt;   Brown 0.555 0.405 0.537 0.483</span></span>
<span id="cb484-17"><a href="#cb484-17" aria-hidden="true"></a><span class="co">#&gt;   Red   0.615 0.412 0.500 0.500</span></span>
<span id="cb484-18"><a href="#cb484-18" aria-hidden="true"></a><span class="co">#&gt;   Blond 0.571 0.681 0.500 0.500</span></span></code></pre></div>
<p>Para cambiar el orden de las variables en una <code>tabla</code> multidimensional, se puede usar la instrucción</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="#cb485-1" aria-hidden="true"></a><span class="kw">aperm</span>(tabla, <span class="dt">perm=</span>...)</span></code></pre></div>
<p>igualando el parámetro <code>perm</code> a la lista de las variables en el orden deseado. Por ejemplo, si queremos una tabla equivalente a <code>HairEyeColor</code>, pero con primera variable <code>Sex</code>, segunda variable <code>Hair</code> y tercera variable <code>Eye</code>, podemos hacer:</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="#cb486-1" aria-hidden="true"></a><span class="kw">aperm</span>(HairEyeColor, <span class="dt">perm=</span><span class="kw">c</span>(<span class="st">&quot;Sex&quot;</span>, <span class="st">&quot;Hair&quot;</span>, <span class="st">&quot;Eye&quot;</span>))</span>
<span id="cb486-2"><a href="#cb486-2" aria-hidden="true"></a><span class="co">#&gt; , , Eye = Brown</span></span>
<span id="cb486-3"><a href="#cb486-3" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb486-4"><a href="#cb486-4" aria-hidden="true"></a><span class="co">#&gt;         Hair</span></span>
<span id="cb486-5"><a href="#cb486-5" aria-hidden="true"></a><span class="co">#&gt; Sex      Black Brown Red Blond</span></span>
<span id="cb486-6"><a href="#cb486-6" aria-hidden="true"></a><span class="co">#&gt;   Male      32    53  10     3</span></span>
<span id="cb486-7"><a href="#cb486-7" aria-hidden="true"></a><span class="co">#&gt;   Female    36    66  16     4</span></span>
<span id="cb486-8"><a href="#cb486-8" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb486-9"><a href="#cb486-9" aria-hidden="true"></a><span class="co">#&gt; , , Eye = Blue</span></span>
<span id="cb486-10"><a href="#cb486-10" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb486-11"><a href="#cb486-11" aria-hidden="true"></a><span class="co">#&gt;         Hair</span></span>
<span id="cb486-12"><a href="#cb486-12" aria-hidden="true"></a><span class="co">#&gt; Sex      Black Brown Red Blond</span></span>
<span id="cb486-13"><a href="#cb486-13" aria-hidden="true"></a><span class="co">#&gt;   Male      11    50  10    30</span></span>
<span id="cb486-14"><a href="#cb486-14" aria-hidden="true"></a><span class="co">#&gt;   Female     9    34   7    64</span></span>
<span id="cb486-15"><a href="#cb486-15" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb486-16"><a href="#cb486-16" aria-hidden="true"></a><span class="co">#&gt; , , Eye = Hazel</span></span>
<span id="cb486-17"><a href="#cb486-17" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb486-18"><a href="#cb486-18" aria-hidden="true"></a><span class="co">#&gt;         Hair</span></span>
<span id="cb486-19"><a href="#cb486-19" aria-hidden="true"></a><span class="co">#&gt; Sex      Black Brown Red Blond</span></span>
<span id="cb486-20"><a href="#cb486-20" aria-hidden="true"></a><span class="co">#&gt;   Male      10    25   7     5</span></span>
<span id="cb486-21"><a href="#cb486-21" aria-hidden="true"></a><span class="co">#&gt;   Female     5    29   7     5</span></span>
<span id="cb486-22"><a href="#cb486-22" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb486-23"><a href="#cb486-23" aria-hidden="true"></a><span class="co">#&gt; , , Eye = Green</span></span>
<span id="cb486-24"><a href="#cb486-24" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb486-25"><a href="#cb486-25" aria-hidden="true"></a><span class="co">#&gt;         Hair</span></span>
<span id="cb486-26"><a href="#cb486-26" aria-hidden="true"></a><span class="co">#&gt; Sex      Black Brown Red Blond</span></span>
<span id="cb486-27"><a href="#cb486-27" aria-hidden="true"></a><span class="co">#&gt;   Male       3    15   7     8</span></span>
<span id="cb486-28"><a href="#cb486-28" aria-hidden="true"></a><span class="co">#&gt;   Female     2    14   7     8</span></span></code></pre></div>
</div>
<div id="tablas-a-partir-de-data-frames-de-variables-cualitativas" class="section level2" number="10.5">
<h2 number="10.5"><span class="header-section-number">10.5</span> Tablas a partir de <em>data frames</em> de variables cualitativas</h2>
<p>Como ya hemos comentado en varias ocasiones, la manera natural de organizar datos multidimensionales en R es en forma de <em>data frame</em>. En esta sección explicaremos algunas instrucciones para calcular tablas de frecuencias absolutas a partir de un <em>data frame</em> de variables cualitativas. Para ilustrarla, usaremos el fichero que se encuentra en el <code>url</code> <a href="http://aprender.uib.es/Rdir/bebenerg.txt">http://aprender.uib.es/Rdir/bebenerg.txt</a>.</p>
<p>Este fichero consiste en una tabla de datos con la siguiente información sobre 122 estudiantes de la Escuela Politécnica Superior de la UIB: su sexo (variable <code>sexo</code>), el grado en el que están matriculados
(variable <code>estudio</code>) y si consumen habitualmente bebidas energéticas (variable <code>bebe</code>). Como contiene letras acentuadas, al llerla con <code>read.table</code> vamos a usar el parámetro <code>encoding</code>.</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="#cb487-1" aria-hidden="true"></a>Beb_Energ=<span class="kw">read.table</span>(<span class="st">&quot;http://aprender.uib.es/Rdir/bebenerg.txt&quot;</span>,  <span class="dt">header=</span><span class="ot">TRUE</span>, </span>
<span id="cb487-2"><a href="#cb487-2" aria-hidden="true"></a>                     <span class="dt">encoding=</span><span class="st">&quot;UTF-8&quot;</span>)</span>
<span id="cb487-3"><a href="#cb487-3" aria-hidden="true"></a><span class="kw">str</span>(Beb_Energ)</span>
<span id="cb487-4"><a href="#cb487-4" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    122 obs. of  3 variables:</span></span>
<span id="cb487-5"><a href="#cb487-5" aria-hidden="true"></a><span class="co">#&gt;  $ estudio: chr  &quot;Informática&quot; &quot;Matemáticas&quot; &quot;Ing.Industrial&quot; &quot;Informática&quot; ...</span></span>
<span id="cb487-6"><a href="#cb487-6" aria-hidden="true"></a><span class="co">#&gt;  $ bebe   : chr  &quot;No&quot; &quot;No&quot; &quot;Sí&quot; &quot;Sí&quot; ...</span></span>
<span id="cb487-7"><a href="#cb487-7" aria-hidden="true"></a><span class="co">#&gt;  $ sexo   : chr  &quot;Mujer&quot; &quot;Hombre&quot; &quot;Mujer&quot; &quot;Hombre&quot; ...</span></span>
<span id="cb487-8"><a href="#cb487-8" aria-hidden="true"></a><span class="kw">head</span>(Beb_Energ)</span>
<span id="cb487-9"><a href="#cb487-9" aria-hidden="true"></a><span class="co">#&gt;          estudio bebe   sexo</span></span>
<span id="cb487-10"><a href="#cb487-10" aria-hidden="true"></a><span class="co">#&gt; 1    Informática   No  Mujer</span></span>
<span id="cb487-11"><a href="#cb487-11" aria-hidden="true"></a><span class="co">#&gt; 2    Matemáticas   No Hombre</span></span>
<span id="cb487-12"><a href="#cb487-12" aria-hidden="true"></a><span class="co">#&gt; 3 Ing.Industrial   Sí  Mujer</span></span>
<span id="cb487-13"><a href="#cb487-13" aria-hidden="true"></a><span class="co">#&gt; 4    Informática   Sí Hombre</span></span>
<span id="cb487-14"><a href="#cb487-14" aria-hidden="true"></a><span class="co">#&gt; 5 Ing.Industrial   No  Mujer</span></span>
<span id="cb487-15"><a href="#cb487-15" aria-hidden="true"></a><span class="co">#&gt; 6    Matemáticas   No  Mujer</span></span></code></pre></div>
<p>Aplicando la función <code>summary</code> a un <em>data frame</em> de variables cualitativas, obtenemos, a modo de resumen, una tabla con las frecuencias absolutas de cada variable.</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="#cb488-1" aria-hidden="true"></a><span class="kw">summary</span>(Beb_Energ)</span>
<span id="cb488-2"><a href="#cb488-2" aria-hidden="true"></a><span class="co">#&gt;    estudio              bebe               sexo          </span></span>
<span id="cb488-3"><a href="#cb488-3" aria-hidden="true"></a><span class="co">#&gt;  Length:122         Length:122         Length:122        </span></span>
<span id="cb488-4"><a href="#cb488-4" aria-hidden="true"></a><span class="co">#&gt;  Class :character   Class :character   Class :character  </span></span>
<span id="cb488-5"><a href="#cb488-5" aria-hidden="true"></a><span class="co">#&gt;  Mode  :character   Mode  :character   Mode  :character</span></span></code></pre></div>
<p>Esta tabla sólo sirve para ver la información, porque sus entradas son palabras.</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="#cb489-1" aria-hidden="true"></a><span class="kw">summary</span>(Beb_Energ)[,<span class="dv">2</span>]</span>
<span id="cb489-2"><a href="#cb489-2" aria-hidden="true"></a><span class="co">#&gt;                                                                </span></span>
<span id="cb489-3"><a href="#cb489-3" aria-hidden="true"></a><span class="co">#&gt; &quot;Length:122        &quot; &quot;Class :character  &quot; &quot;Mode  :character  &quot;</span></span></code></pre></div>
<p>Para calcular en un solo paso la <code>table</code> de cada variable, podemos usar la función <code>sapply</code> de la manera siguiente:</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="#cb490-1" aria-hidden="true"></a><span class="kw">sapply</span>(Beb_Energ, <span class="dt">FUN=</span>table)</span>
<span id="cb490-2"><a href="#cb490-2" aria-hidden="true"></a><span class="co">#&gt; $estudio</span></span>
<span id="cb490-3"><a href="#cb490-3" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb490-4"><a href="#cb490-4" aria-hidden="true"></a><span class="co">#&gt;    Informática Ing.Industrial    Matemáticas     Telemática </span></span>
<span id="cb490-5"><a href="#cb490-5" aria-hidden="true"></a><span class="co">#&gt;             53             37             16             16 </span></span>
<span id="cb490-6"><a href="#cb490-6" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb490-7"><a href="#cb490-7" aria-hidden="true"></a><span class="co">#&gt; $bebe</span></span>
<span id="cb490-8"><a href="#cb490-8" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb490-9"><a href="#cb490-9" aria-hidden="true"></a><span class="co">#&gt; No Sí </span></span>
<span id="cb490-10"><a href="#cb490-10" aria-hidden="true"></a><span class="co">#&gt; 97 25 </span></span>
<span id="cb490-11"><a href="#cb490-11" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb490-12"><a href="#cb490-12" aria-hidden="true"></a><span class="co">#&gt; $sexo</span></span>
<span id="cb490-13"><a href="#cb490-13" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb490-14"><a href="#cb490-14" aria-hidden="true"></a><span class="co">#&gt; Hombre  Mujer </span></span>
<span id="cb490-15"><a href="#cb490-15" aria-hidden="true"></a><span class="co">#&gt;     83     39</span></span></code></pre></div>
<p>De esta manera, hemos obtenido una <code>list</code> cuyas componentes son las tablas que queríamos.</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="#cb491-1" aria-hidden="true"></a><span class="kw">sapply</span>(Beb_Energ, <span class="dt">FUN=</span>table)<span class="op">$</span>sexo</span>
<span id="cb491-2"><a href="#cb491-2" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb491-3"><a href="#cb491-3" aria-hidden="true"></a><span class="co">#&gt; Hombre  Mujer </span></span>
<span id="cb491-4"><a href="#cb491-4" aria-hidden="true"></a><span class="co">#&gt;     83     39</span></span>
<span id="cb491-5"><a href="#cb491-5" aria-hidden="true"></a><span class="kw">table</span>(Beb_Energ<span class="op">$</span>sexo)</span>
<span id="cb491-6"><a href="#cb491-6" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb491-7"><a href="#cb491-7" aria-hidden="true"></a><span class="co">#&gt; Hombre  Mujer </span></span>
<span id="cb491-8"><a href="#cb491-8" aria-hidden="true"></a><span class="co">#&gt;     83     39</span></span></code></pre></div>
<p>Si aplicamos la función <code>table</code> a un <em>data frame</em> de variables cualitativas, obtenemos su tabla de frecuencias absolutas, con las variables ordenadas tal y como aparecen en el <em>data frame</em></p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="#cb492-1" aria-hidden="true"></a><span class="kw">table</span>(Beb_Energ)</span>
<span id="cb492-2"><a href="#cb492-2" aria-hidden="true"></a><span class="co">#&gt; , , sexo = Hombre</span></span>
<span id="cb492-3"><a href="#cb492-3" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb492-4"><a href="#cb492-4" aria-hidden="true"></a><span class="co">#&gt;                 bebe</span></span>
<span id="cb492-5"><a href="#cb492-5" aria-hidden="true"></a><span class="co">#&gt; estudio          No Sí</span></span>
<span id="cb492-6"><a href="#cb492-6" aria-hidden="true"></a><span class="co">#&gt;   Informática    30  7</span></span>
<span id="cb492-7"><a href="#cb492-7" aria-hidden="true"></a><span class="co">#&gt;   Ing.Industrial 19  6</span></span>
<span id="cb492-8"><a href="#cb492-8" aria-hidden="true"></a><span class="co">#&gt;   Matemáticas     8  1</span></span>
<span id="cb492-9"><a href="#cb492-9" aria-hidden="true"></a><span class="co">#&gt;   Telemática     10  2</span></span>
<span id="cb492-10"><a href="#cb492-10" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb492-11"><a href="#cb492-11" aria-hidden="true"></a><span class="co">#&gt; , , sexo = Mujer</span></span>
<span id="cb492-12"><a href="#cb492-12" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb492-13"><a href="#cb492-13" aria-hidden="true"></a><span class="co">#&gt;                 bebe</span></span>
<span id="cb492-14"><a href="#cb492-14" aria-hidden="true"></a><span class="co">#&gt; estudio          No Sí</span></span>
<span id="cb492-15"><a href="#cb492-15" aria-hidden="true"></a><span class="co">#&gt;   Informática    11  5</span></span>
<span id="cb492-16"><a href="#cb492-16" aria-hidden="true"></a><span class="co">#&gt;   Ing.Industrial 10  2</span></span>
<span id="cb492-17"><a href="#cb492-17" aria-hidden="true"></a><span class="co">#&gt;   Matemáticas     6  1</span></span>
<span id="cb492-18"><a href="#cb492-18" aria-hidden="true"></a><span class="co">#&gt;   Telemática      3  1</span></span>
<span id="cb492-19"><a href="#cb492-19" aria-hidden="true"></a><span class="kw">table</span>(Beb_Energ[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)])</span>
<span id="cb492-20"><a href="#cb492-20" aria-hidden="true"></a><span class="co">#&gt;                 sexo</span></span>
<span id="cb492-21"><a href="#cb492-21" aria-hidden="true"></a><span class="co">#&gt; estudio          Hombre Mujer</span></span>
<span id="cb492-22"><a href="#cb492-22" aria-hidden="true"></a><span class="co">#&gt;   Informática        37    16</span></span>
<span id="cb492-23"><a href="#cb492-23" aria-hidden="true"></a><span class="co">#&gt;   Ing.Industrial     25    12</span></span>
<span id="cb492-24"><a href="#cb492-24" aria-hidden="true"></a><span class="co">#&gt;   Matemáticas         9     7</span></span>
<span id="cb492-25"><a href="#cb492-25" aria-hidden="true"></a><span class="co">#&gt;   Telemática         12     4</span></span></code></pre></div>
<p>Otra opción es usar la función <code>ftable</code>, que produce la misma tabla de frecuencias pero en formato plano.</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="#cb493-1" aria-hidden="true"></a><span class="kw">ftable</span>(Beb_Energ)</span>
<span id="cb493-2"><a href="#cb493-2" aria-hidden="true"></a><span class="co">#&gt;                     sexo Hombre Mujer</span></span>
<span id="cb493-3"><a href="#cb493-3" aria-hidden="true"></a><span class="co">#&gt; estudio        bebe                  </span></span>
<span id="cb493-4"><a href="#cb493-4" aria-hidden="true"></a><span class="co">#&gt; Informática    No            30    11</span></span>
<span id="cb493-5"><a href="#cb493-5" aria-hidden="true"></a><span class="co">#&gt;                Sí             7     5</span></span>
<span id="cb493-6"><a href="#cb493-6" aria-hidden="true"></a><span class="co">#&gt; Ing.Industrial No            19    10</span></span>
<span id="cb493-7"><a href="#cb493-7" aria-hidden="true"></a><span class="co">#&gt;                Sí             6     2</span></span>
<span id="cb493-8"><a href="#cb493-8" aria-hidden="true"></a><span class="co">#&gt; Matemáticas    No             8     6</span></span>
<span id="cb493-9"><a href="#cb493-9" aria-hidden="true"></a><span class="co">#&gt;                Sí             1     1</span></span>
<span id="cb493-10"><a href="#cb493-10" aria-hidden="true"></a><span class="co">#&gt; Telemática     No            10     3</span></span>
<span id="cb493-11"><a href="#cb493-11" aria-hidden="true"></a><span class="co">#&gt;                Sí             2     1</span></span></code></pre></div>
<p>Las frecuencias relativas globales y marginales se obtienen aplicando <code>prop.table</code> como hasta ahora. Por ejemplo, las frecuencias relativas de bebedores y no bebedores para cada combinación (sexo, estudio) se obtienen con la función siguiente. Observad cómo cambiamos el orden de las variables para facilitar la comprensión: la primera tabla son las frecuencias relativas de no bebedores, la segunda de sí bebedores.</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="#cb494-1" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">aperm</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(Beb_Energ), <span class="dt">margin=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>)), <span class="dt">perm=</span><span class="kw">c</span>(<span class="st">&quot;sexo&quot;</span>,<span class="st">&quot;estudio&quot;</span>,<span class="st">&quot;bebe&quot;</span>)), <span class="dv">3</span>)</span>
<span id="cb494-2"><a href="#cb494-2" aria-hidden="true"></a><span class="co">#&gt; , , bebe = No</span></span>
<span id="cb494-3"><a href="#cb494-3" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb494-4"><a href="#cb494-4" aria-hidden="true"></a><span class="co">#&gt;         estudio</span></span>
<span id="cb494-5"><a href="#cb494-5" aria-hidden="true"></a><span class="co">#&gt; sexo     Informática Ing.Industrial Matemáticas Telemática</span></span>
<span id="cb494-6"><a href="#cb494-6" aria-hidden="true"></a><span class="co">#&gt;   Hombre       0.811          0.760       0.889      0.833</span></span>
<span id="cb494-7"><a href="#cb494-7" aria-hidden="true"></a><span class="co">#&gt;   Mujer        0.688          0.833       0.857      0.750</span></span>
<span id="cb494-8"><a href="#cb494-8" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb494-9"><a href="#cb494-9" aria-hidden="true"></a><span class="co">#&gt; , , bebe = Sí</span></span>
<span id="cb494-10"><a href="#cb494-10" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb494-11"><a href="#cb494-11" aria-hidden="true"></a><span class="co">#&gt;         estudio</span></span>
<span id="cb494-12"><a href="#cb494-12" aria-hidden="true"></a><span class="co">#&gt; sexo     Informática Ing.Industrial Matemáticas Telemática</span></span>
<span id="cb494-13"><a href="#cb494-13" aria-hidden="true"></a><span class="co">#&gt;   Hombre       0.189          0.240       0.111      0.167</span></span>
<span id="cb494-14"><a href="#cb494-14" aria-hidden="true"></a><span class="co">#&gt;   Mujer        0.312          0.167       0.143      0.250</span></span></code></pre></div>
</div>
<div id="diagramas-de-barras" class="section level2" number="10.6">
<h2 number="10.6"><span class="header-section-number">10.6</span> Diagramas de barras</h2>
<p>El tipo de gráfico más usado para representar variables cualitativas son los diagramas de barras (<em>bar plots</em>). Como su nombre indica, un <strong>diagrama de barras</strong> contiene, para cada nivel de la variable cualitativa, una barra de altura su frecuencia; por ejemplo, la Figura @ref(fig:F1601) es un diagrama de barras de las frecuencias absolutas de los dos niveles de la muestra de sexos del Ejemplo @ref(exm:ex1601). El código que lo produce, y que explicaremos en esta sección, es el siguiente:</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="#cb495-1" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">table</span>(Sexo_Ger), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;lightblue&quot;</span>,<span class="st">&quot;pink&quot;</span>), </span>
<span id="cb495-2"><a href="#cb495-2" aria-hidden="true"></a>        <span class="dt">main=</span><span class="st">&quot;Diagrama de barras de las frecuencias absolutas</span><span class="ch">\n</span><span class="st"> de la variable </span><span class="ch">\&quot;</span><span class="st">Sexo_Ger</span><span class="ch">\&quot;</span><span class="st">&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="10chap10_Descripción_cualitativos_files/figure-html/F1601-1.png" alt="Diagrama de barras de las frecuencias absolutas de los datos  del Ejemplo \@ref(exm:ex1601)." width="90%" />
<p class="caption">
(#fig:F1601)Diagrama de barras de las frecuencias absolutas de los datos del Ejemplo @ref(exm:ex1601).
</p>
</div>
<p>Antes de continuar con los diagramas de barras, vamos a comentar dos <em>trucos</em> usados en el título de este gráfico. Por un laod, la marca <code>\n</code> dentro de una frase entrada entre comillas introduce un cambio de línea. El mismo efecto se obtiene con un cambio de línea. Id con cuidado, porque ambos efectos se acumulan, así que si cambiais de línea después del <code>\n</code>, obtendréis una línea en blanco. Por otro lado, <code>\\"</code> escribe unas comillas en el texto entrado entre comillas.</p>
<!--
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.45\textwidth]{01-001.pdf}
\end{center}
\caption{Diagrama de barras de las frecuencias absolutas de los datos  del Ejemplo \@ref(ex:16.1}.}\label{fig:16.1)
\end{figure}
-->
<p>La manera más sencilla de dibujar un diagrama de barras de las frecuencias absolutas o relativas de una variable cualitativa es usando la instrucción <code>barplot</code> aplicada a la tabla correspondiente. Veamos dos ejemplos más de diagramas de barras, uno de frecuencias absolutas y uno de relativas:</p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="#cb496-1" aria-hidden="true"></a>x=<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">2</span>)</span>
<span id="cb496-2"><a href="#cb496-2" aria-hidden="true"></a>Respuestas=<span class="kw">c</span>(<span class="st">&quot;No&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Sí&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Sí&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Sí&quot;</span>)</span>
<span id="cb496-3"><a href="#cb496-3" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">table</span>(x), <span class="dt">main=</span><span class="st">&quot;Diagrama de barras de frecuencias absolutas de la variable </span><span class="ch">\&quot;</span><span class="st">x</span><span class="ch">\&quot;</span><span class="st">&quot;</span>)</span></code></pre></div>
<p><img src="10chap10_Descripción_cualitativos_files/figure-html/unnamed-chunk-54-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="#cb497-1" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(Respuestas)), </span>
<span id="cb497-2"><a href="#cb497-2" aria-hidden="true"></a>        <span class="dt">main=</span><span class="st">&quot;Diagrama de barras de frecuencias relativas</span><span class="ch">\n</span><span class="st"> de la variable </span><span class="ch">\&quot;</span><span class="st">Respuestas</span><span class="ch">\&quot;</span><span class="st">&quot;</span>)</span></code></pre></div>
<p><img src="10chap10_Descripción_cualitativos_files/figure-html/unnamed-chunk-55-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong>¡Atención!</strong> Como pasaba con <code>prop.table</code>, el argumento de <code>barplot</code> ha de ser una tabla, y, por consiguiente, se ha de aplicar al resultado de <code>table</code> o de <code>prop.table</code>, nunca al vector de datos original.</p>
<p>Habréis observado que en las funciones <code>barplot</code> anteriores hemos usado el parámetro <code>main</code> para poner título a los diagramas; en general, la función <code>barplot</code> admite los parámetros de <code>plot</code> que tienen sentido en el contexto de los diagramas de barras: <code>xlab</code>, <code>ylab</code>, <code>main</code>, etc. Los parámetros disponibles se pueden consultar en la Ayuda de <code>barplot</code>. Aquí sólo vamos a comentar algunos.</p>
<p>Se pueden especificar los colores de las barras usando el parámetro <code>col</code>. Si se iguala a un solo color, todas las barras serán de este color, pero también se puede especificar un color para cada barra, igualando <code>col</code> a un vector de colores. Veamos un ejemplo de cada.</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="#cb498-1" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">table</span>(Respuestas), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;green&quot;</span>))</span></code></pre></div>
<p><img src="10chap10_Descripción_cualitativos_files/figure-html/unnamed-chunk-56-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="#cb499-1" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">table</span>(Respuestas), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>))</span></code></pre></div>
<p><img src="10chap10_Descripción_cualitativos_files/figure-html/unnamed-chunk-57-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>En un diagrama con muchas barras, es conveniente usar un esquema adecuado de colores para ellas. Para ello se puede usar el paquete <strong>RColorBrewer</strong>, del que hablaremos en detalle en la Sección @ref(sec:grmulti).</p>
<p>Una opción interesante es dibujar las barras horizontales en vez de verticales: para hacerlo, se tiene que añadir el parámetro <code>horiz=TRUE</code>. Así, la Figura @ref(fig:F1606) se obtiene con la siguiente instrucción:</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="#cb500-1" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">table</span>(x), <span class="dt">horiz=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="10chap10_Descripción_cualitativos_files/figure-html/F1606-1.png" alt="Un diagrama de barras horizontales." width="90%" />
<p class="caption">
(#fig:F1606)Un diagrama de barras horizontales.
</p>
</div>
<!--
\vspace*{-3ex}

\begin{figure}[ht]
\begin{center}
\includegraphics[width=0.45\textwidth]{barplotxhoriz}
\end{center}
\caption{Un diagrama de barras horizontales.}\label{fig:16.6}
\end{figure}
-->
<p>Si se aplica <code>barplot</code> a una tabla bidimensional, por defecto dibuja las barras de la segunda variable cortadas por la frecuencia de la primera variable: se le llama un <strong>diagrama de barras apiladas</strong>. Por ejemplo, la función <code>barplot</code> del bloque de código siguiente produce la Figura @ref(fig:F1607).</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="#cb501-1" aria-hidden="true"></a>Respuestas=<span class="kw">c</span>(<span class="st">&quot;No&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Sí&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Sí&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Sí&quot;</span>)</span>
<span id="cb501-2"><a href="#cb501-2" aria-hidden="true"></a>Sexo=<span class="kw">c</span>(<span class="st">&quot;M&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>)</span>
<span id="cb501-3"><a href="#cb501-3" aria-hidden="true"></a><span class="kw">table</span>(Sexo,Respuestas)</span>
<span id="cb501-4"><a href="#cb501-4" aria-hidden="true"></a><span class="co">#&gt;     Respuestas</span></span>
<span id="cb501-5"><a href="#cb501-5" aria-hidden="true"></a><span class="co">#&gt; Sexo No Sí</span></span>
<span id="cb501-6"><a href="#cb501-6" aria-hidden="true"></a><span class="co">#&gt;    H  3  2</span></span>
<span id="cb501-7"><a href="#cb501-7" aria-hidden="true"></a><span class="co">#&gt;    M  2  1</span></span>
<span id="cb501-8"><a href="#cb501-8" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">table</span>(Sexo,Respuestas))</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="10chap10_Descripción_cualitativos_files/figure-html/F1607-1.png" alt="Un diagrama de barras apiladas." width="90%" />
<p class="caption">
(#fig:F1607)Un diagrama de barras apiladas.
</p>
</div>
<p>En un diagrama de barras apiladas, las barras globales corresponden a los niveles de la variable que definen las columnas de la tabla, es decir, la segunda variable especificada dentro de <code>table</code>: en el de la Figura @ref(fig:F1607), se trata de la variable <code>Respuestas</code>, de niveles <code>No</code> y <code>Si</code>. Cada una de estas barras se divide verticalmente en sectores que representan los niveles de la otra variable, en orden ascendente: en el ejemplo que nos ocupa, la zona inferior de cada barra representa el nivel <code>H</code> de la variable <code>Sexo</code> y la zona superior su nivel <code>M</code>.</p>
<!--
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.45\textwidth]{barplotSy.pdf}
\end{center}
\caption{Diagrama de barras apiladas.}\label{fig:16.7}
\end{figure}
-->
<p>En vez de organizar las barras de la primera variable en una sola barra vertical, se pueden dibujar una junto a la otra añadiendo el parámetro <code>beside=TRUE</code>, obteniéndose de esta manera un <strong>diagrama de barras por bloques</strong>. Así,</p>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="#cb502-1" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">table</span>(Sexo,Respuestas), <span class="dt">beside=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p>produce el diagrama de barras de la Figura @ref(fig:F1608a).
En este diagrama, cada bloque de barras representa un nivel de la variable de las columnas (<code>No</code> y <code>Si</code>), y en cada uno de estos bloques las barras representan los niveles de las filas en su orden (en cada bloque, la barra de la izquierda corresponde a <code>H</code> y la de la derecha a <code>M</code>).</p>
<div class="figure" style="text-align: center">
<img src="10chap10_Descripción_cualitativos_files/figure-html/F1608a-1.png" alt="Un diagrama de barras por bloques." width="90%" />
<p class="caption">
(#fig:F1608a)Un diagrama de barras por bloques.
</p>
</div>
<p>Los diagramas de barras tienen que mostrar la información de la manera más adecuada. Por ejemplo, si lo que nos interesa es la distribución de las respuestas por sexo, los bloques de barras tienen que corresponder a los sexos y las barras dentro de cada bloque a las respuestas. En este caso, convendría cambiar el orden de los vectores dentro de la <code>table</code> a la que aplicamos <code>barplot</code>, o trasponer la tabla antes de aplicarle <code>barplot</code>.</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="#cb503-1" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">table</span>(Respuestas,Sexo), <span class="dt">beside=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="10chap10_Descripción_cualitativos_files/figure-html/unnamed-chunk-59-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Suele ser conveniente añadir a un diagrama de barras de dos variables una leyenda que indique qué nivel representa cada sector (en los diagramas de barras apiladas) o cada barra (en los diagramas de barras por bloques). Esto se puede realizar entrando el parámetro <code>legend.text</code> igualado a <code>TRUE</code>, si no queremos modificar los nombres de los niveles de las filas, o igualado a un vector con los nombres que les queremos asignar (en el orden que toque).
Por ejemplo,</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="#cb504-1" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">table</span>(Sexo,Respuestas), <span class="dt">beside=</span><span class="ot">TRUE</span>, <span class="dt">legend.text=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p>produce el diagrama de la Figura @ref(fig:F1608b), con el formato de leyenda por defecto.</p>
<div class="figure" style="text-align: center">
<img src="10chap10_Descripción_cualitativos_files/figure-html/F1608b-1.png" alt="Un diagrama de barras por bloques con una leyenda." width="90%" />
<p class="caption">
(#fig:F1608b)Un diagrama de barras por bloques con una leyenda.
</p>
</div>
<!--
\begin{figure}[ht]
\begin{center}
\includegraphics[width=0.45\textwidth]{barplotSybeside.pdf}\
\includegraphics[width=0.45\textwidth]{barplotSYbesidelegend.pdf}
\end{center}
\caption{Diagramas de barras por bloques.}\label{fig:16.8}
\end{figure}
-->
<p>La leyenda que genera R se puede modificar usando el parámetro <code>args.legend</code> igualado a una <code>list</code> con los parámetros que usaríamos en la función <code>legend</code> que explicamos en la Lección @ref(chap:plot): <code>x</code>, para indicar la posición de la leyenda, <code>cex</code> para indicar el factor por el cual se quiere multiplicar su tamaño, etc.
Podéis consultar los parámetros disponibles en la Ayuda de <code>legend</code>.</p>
<p>Se pueden cambiar los colores de las barras usando el parámetro <code>col</code> como en los diagramas de barras de tablas unidimensionales. La función <code>legend.text</code> importa estos colores, no hace falta especificarlos en el <code>args.legend</code>.</p>
<p>También puede ser conveniente poner nombres más informativos a los niveles de las variables. El parámetro <code>names</code> dentro de <code>barplot</code> permite cambiar los nombres de los niveles que muestra debajo del eje horizontal: en un diagrama de barras de una variable, los de sus niveles, y en un diagrama bidimensional, los de los niveles de la variable de las columnas.</p>
<p>Veamos un ejemplo usando <code>col</code> y con los nombres que se muestran de los niveles de ambas variables traducidos al inglés; el resultado es la Figura @ref(fig:F16011).</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="#cb505-1" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">table</span>(Respuestas,Sexo), <span class="dt">beside=</span><span class="ot">TRUE</span>, <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>,<span class="st">&quot;Women&quot;</span>),</span>
<span id="cb505-2"><a href="#cb505-2" aria-hidden="true"></a>        <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="dt">legend.text=</span><span class="kw">c</span>(<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Yes&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="10chap10_Descripción_cualitativos_files/figure-html/F16011-1.png" alt="Diagrama de barras para visualizar la distribución de las respuestas por sexo." width="90%" />
<p class="caption">
(#fig:F16011)Diagrama de barras para visualizar la distribución de las respuestas por sexo.
</p>
</div>
<!--
\begin{figure}[ht]
\begin{center}
\includegraphics[width=0.45\textwidth]{barplotyScorrecte.pdf}
\end{center}
\caption{Diagrama de barras para visualizar la distribución de las respuestas por sexo.}\label{fig:16.11}
\end{figure}
-->
</div>
<div id="otros-gráficos-para-datos-cualitativos" class="section level2" number="10.7">
<h2 number="10.7"><span class="header-section-number">10.7</span> Otros gráficos para datos cualitativos</h2>
<p>Un tipo muy popular de representación gráfica de variables cualitativas son los diagramas circulares. En un <strong>diagrama circular</strong> (<em>pie chart</em>) se representan los niveles de una variable cualitativa como sectores circulares de un círculo, de manera que el ángulo (o equivalentemente, el área) de cada sector sea proporcional a la frecuencia del nivel al que corresponde. Con R, este tipo de diagramas se producen con la instrucción <code>pie</code>, de nuevo aplicada a una tabla de frecuencias y no al vector original. La función <code>pie</code> admite muchos parámetros para modificar el resultado: se pueden cambiar los colores con <code>col</code>, se pueden cambiar los nombres de los niveles con <code>names</code>, se puede poner un título con <code>main</code>, etc.;
podéis consultar la lista completa de parámetros en su Ayuda.
Así, por ejemplo,</p>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="#cb506-1" aria-hidden="true"></a>Respuestas=<span class="kw">c</span>(<span class="st">&quot;No&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Sí&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Sí&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Sí&quot;</span>)</span>
<span id="cb506-2"><a href="#cb506-2" aria-hidden="true"></a><span class="kw">pie</span>(<span class="kw">table</span>(Respuestas), <span class="dt">main=</span><span class="st">&quot;Diagrama circular de la variable </span><span class="ch">\&quot;</span><span class="st">Respuestas</span><span class="ch">\&quot;</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>produce el diagrama de la Figura @ref(fig:F16012).</p>
<div class="figure" style="text-align: center">
<img src="10chap10_Descripción_cualitativos_files/figure-html/F16012-1.png" alt="Un diagrama circular." width="90%" />
<p class="caption">
(#fig:F16012)Un diagrama circular.
</p>
</div>
<!--
\begin{figure}[ht]
\begin{center}
\includegraphics[width=0.45\linewidth]{piex2.pdf}\quad
\includegraphics[width=0.45\linewidth]{piey2.pdf}
\end{center}
\caption{Diagramas circulares.}\label{fig:16.12}
\end{figure}
-->
<p>Pese a su popularidad, es poco recomendable usar diagramas circulares cuando manejamos más de dos niveles, porque a veces es difícil, a simple vista, comprender las relaciones entre las frecuencias que representan. Para convencerse, basta comparar los diagramas de barras y los diagramas circulares de la Figura @ref(fig:wiki) (extraída de la
<a href="http://en.wikipedia.org/wiki/Pie_chart">entrada sobre diagramas circulares de la <em>Wikipedia</em></a>).</p>
<div class="figure" style="text-align: center">
<img src="AprendeR-Parte-I_files/figure-html/wikipc.png" alt="Diagramas de barras *versus* diagramas circulares." width="90%" />
<p class="caption">
(#fig:wiki)Diagramas de barras <em>versus</em> diagramas circulares.
</p>
</div>
<!--
\begin{figure}[ht]
\abovecaptionskip=-1ex
\begin{center}
\includegraphics[width=0.55\linewidth]{wikipc.pdf}
\end{center}
\caption{Diagramas de barras *vs* diagramas circulares.}\label{fig:wiki}
\end{figure}
-->
<p>Otra representación de las tablas multidimensionales de frecuencias son los <strong>diagramas de mosaico</strong>. Estos gráficos se obtienen sustituyendo cada entrada de la tabla de frecuencias por una región rectangular de área proporcional a su valor. En concreto, para obtener el diagrama de mosaico de una tabla bidimensional, se parte de un cuadrado de lado 1,
primero se divide en barras verticales de amplitudes iguales a las frecuencias relativas de una variable, y luego cada barra se divide, a lo alto, en regiones de alturas proporcionales a las frecuencias relativas marginales de cada nivel de la otra variable dentro del nivel correspondiente de la primera variable.</p>
<p>Un diagrama de mosaico de una tabla se obtiene con R aplicando la función <code>plot</code> a la tabla, o también la función <code>mosaicplot</code>; esta última también se puede aplicar a matrices. Por ejemplo,</p>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="#cb507-1" aria-hidden="true"></a>Respuestas=<span class="kw">c</span>(<span class="st">&quot;No&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Sí&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Sí&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Sí&quot;</span>)</span>
<span id="cb507-2"><a href="#cb507-2" aria-hidden="true"></a>Sexo=<span class="kw">c</span>(<span class="st">&quot;M&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>)</span>
<span id="cb507-3"><a href="#cb507-3" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">table</span>(Sexo,Respuestas), <span class="dt">main=</span><span class="st">&quot;Diagrama de mosaico de las variables </span><span class="ch">\&quot;</span><span class="st">Sexo</span><span class="ch">\&quot;</span><span class="st"> y </span><span class="ch">\&quot;</span><span class="st">Respuestas</span><span class="ch">\&quot;</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>produce el diagrama de mosaico de la Figura @ref(fig:mosaic1a).</p>
<div class="figure" style="text-align: center">
<img src="10chap10_Descripción_cualitativos_files/figure-html/mosaic1a-1.png" alt="Un diagrama de mosaico bidimendiol." width="90%" />
<p class="caption">
(#fig:mosaic1a)Un diagrama de mosaico bidimendiol.
</p>
</div>
<p>En el diagrama de mosaico de una tabla tridimensional, primero se divide el cuadrado en barras verticales de amplitudes iguales a las frecuencias relativas de una variable; luego, cada barra se divide, a lo alto, en regiones de alturas proporcionales a las frecuencias relativas marginales de cada nivel de una segunda variable dentro del nivel correspondiente de la primera variable; y, finalmente, cada sector rectangular se vuelve a dividir a lo ancho en regiones de amplitudes proporcionales a las frecuencias relativas marginales de cada nivel de la tercera variable dentro de la combinación correspondiente de niveles de las otras dos. Por ejemplo,</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="#cb508-1" aria-hidden="true"></a><span class="kw">plot</span>(HairEyeColor,  <span class="dt">main=</span><span class="st">&quot;Diagrama de mosaico de la tabla </span><span class="ch">\&quot;</span><span class="st">HairEyeColor</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, </span>
<span id="cb508-2"><a href="#cb508-2" aria-hidden="true"></a>     <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;pink&quot;</span>,<span class="st">&quot;lightblue&quot;</span>))</span></code></pre></div>
<p>produce el gráfico de la Figura @ref(fig:mosaic1b).</p>
<div class="figure" style="text-align: center">
<img src="10chap10_Descripción_cualitativos_files/figure-html/mosaic1b-1.png" alt="Un diagrama de mosaico tridimendiol." width="90%" />
<p class="caption">
(#fig:mosaic1b)Un diagrama de mosaico tridimendiol.
</p>
</div>
<!--
\begin{figure}[ht]
\begin{center}
\includegraphics[width=0.45\linewidth]{mosaic1.pdf}\ 
\includegraphics[width=0.45\linewidth]{mosaic2.pdf}
\end{center}
\caption{Diagramas de mosaico bidimensional y tridimensional.}\label{fig:mosaic1}
\end{figure}
-->
<p>Además de sus parámetros usuales, la función <code>plot</code> admite algunos parámetros específicos
cuando se usa para producir el diagrama de mosaico de una tabla. Los más interesantes son:</p>
<ul>
<li><code>col</code>, que ya hemos usado en el diagrama de mosaico tridimensional anterior, asigna colores a los niveles de la última variable (en ese ejemplo, los sexos).</li>
<li><code>dir</code>, igualado a un vector de direcciones <code>"v"</code> (vertical) y <code>"h"</code> (horizontal), sirve para especificar la dirección de las barras de cada variable (por defecto, como hemos comentado, alternan vertical y horizontal, empezando por vertical).</li>
</ul>
<p>Estos y otros parámetros se pueden consultar en la Ayuda de <code>mosaicplot</code>.</p>
<p>El paquete <strong>vcd</strong> incorpora la función <code>mosaic</code> que sirve para producir diagramas de mosaico en los que se pueden controlar muchos más apsectos gráficos que con <code>plot</code>. Si la necesitáis, consultad su Ayuda.</p>
<!--

```r
library(vcd)
mosaic(HairEyeColor, dir=c("v","h","v"), highlighting="Sex",  
   highlighting_fill=c("pink","lightblue"))
```

<div class="figure" style="text-align: center">
<img src="10chap10_Descripción_cualitativos_files/figure-html/HCSvcd-1.png" alt="Diagrama de mosaico producido con `mosaic`." width="90%" />
<p class="caption">(\#fig:HCSvcd)Diagrama de mosaico producido con `mosaic`.</p>
</div>
El parámetro `dir` es el equivalente del parámetro homónimo en `mosaicplot` (y lo hemos especificado para obtener el gráfico equivalente al de la derecha de la Figura \@ref(fig:mosaic1}; por defecto, `mosaic` toma la primera variable en horizontal);  el parámetro `highlighting` sirve para destacar una variable; y el parámetro `highlighting_fill` para asignar colores a los niveles de la variable destacada. Esta función dispone de muchos más parámetros, que podéis consultar su Ayuda.

<!--
\begin{figure}[ht]
\begin{center}
\includegraphics[width=0.45\linewidth]{mosaicHCSvcd}
\end{center}
\caption{Gràfico de mosaico de obtenido con `mosaic`.}\label{fig:HCSvcd} 
\end{figure}
-->
<p>Este paquete <strong>vcd</strong> también incluye la función <code>cotabplot</code> que produce un diagrama de mosaico para cada nivel de la tercera variable. Por ejemplo,</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="#cb509-1" aria-hidden="true"></a><span class="kw">library</span>(vcd)</span>
<span id="cb509-2"><a href="#cb509-2" aria-hidden="true"></a><span class="kw">cotabplot</span>(<span class="kw">table</span>(Sexo,Respuestas,Pais))</span></code></pre></div>
produce el gráfico de la Figura @ref(fig:extresquala).
<div class="figure" style="text-align: center">
<img src="10chap10_Descripción_cualitativos_files/figure-html/extresquala-1.png" alt="Diagrama de mosaico producido con `cotabplot`." width="90%" />
<p class="caption">
(#fig:extresquala)Diagrama de mosaico producido con <code>cotabplot</code>.
</p>
</div>
<p>Finalmente, el paquete <strong>vcdExtra</strong> incluye la función <code>mosaic3d</code> que produce un diagrama de mosaico tridimensional en una ventana de una aplicación para gráficos 3D interactivos. Por ejemplo, el bloque de código</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="#cb510-1" aria-hidden="true"></a><span class="kw">library</span>(vcdExtra)</span>
<span id="cb510-2"><a href="#cb510-2" aria-hidden="true"></a><span class="kw">mosaic3d</span>(HairEyeColor, <span class="dt">type=</span><span class="st">&quot;expected&quot;</span>, <span class="dt">box=</span><span class="ot">TRUE</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;pink&quot;</span>,<span class="st">&quot;lightblue&quot;</span>))</span></code></pre></div>
<p>produce el gráfico 3D de la Figura @ref(fig:extresqualb) en una ventana de gráficos interactivos donde lo podréis rotar, ampliar, etc.</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="#cb511-1" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;AprendeR-Parte-I_files/figure-html/exmosaic3d.png&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="AprendeR-Parte-I_files/figure-html/exmosaic3d.png" alt="Diagrama de mosaico 3D producido con `mosaic3d`." width="90%" />
<p class="caption">
(#fig:extresqualb)Diagrama de mosaico 3D producido con <code>mosaic3d</code>.
</p>
</div>
<!--
\begin{figure}[ht]
\begin{center}
\includegraphics[width=0.45\linewidth]{cotabplot.pdf}\quad
\includegraphics[width=0.42\linewidth]{exmosaic3d.pdf}
\end{center}
\caption{Ejemplos de gráficos obtenido con `cotabplot` (izquierda) y `mosaic3d` (derecha).}\label{fig:extresqual} 
\end{figure}
-->
</div>
<div id="sec:exqual" class="section level2" number="10.8">
<h2 number="10.8"><span class="header-section-number">10.8</span> Un ejemplo completo</h2>
<p>Vamos a llevar a cabo un análisis completo de un ejemplo con lo que hemos aprendido en esta lección. Como ya hemos comentado, el objeto de datos <code>HairEyeColor</code> que lleva predefinido R es una tabla de frecuencias absolutas de tres variables cualitativas: <code>Hair</code>, <code>Eye</code> y <code>Sex</code>. Vamos a extraer de esta tabla una tabla bidimensional de frecuencias absolutas de las variables <code>Eye</code> y <code>Hair</code>, sin distinguir según el sexo. La manera más sencilla de obtener esta tabla es combinando la función <code>apply</code> con <code>as.table</code>, para que el resultado final sea una tabla de contingencia (sin esta instrucción, el resultado sería una matriz), de la manera siguiente:</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="#cb512-1" aria-hidden="true"></a>HEC=<span class="kw">as.table</span>(<span class="kw">apply</span>(HairEyeColor, <span class="dt">MARGIN=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">FUN=</span>sum))</span>
<span id="cb512-2"><a href="#cb512-2" aria-hidden="true"></a>HEC</span>
<span id="cb512-3"><a href="#cb512-3" aria-hidden="true"></a><span class="co">#&gt;        Eye</span></span>
<span id="cb512-4"><a href="#cb512-4" aria-hidden="true"></a><span class="co">#&gt; Hair    Brown Blue Hazel Green</span></span>
<span id="cb512-5"><a href="#cb512-5" aria-hidden="true"></a><span class="co">#&gt;   Black    68   20    15     5</span></span>
<span id="cb512-6"><a href="#cb512-6" aria-hidden="true"></a><span class="co">#&gt;   Brown   119   84    54    29</span></span>
<span id="cb512-7"><a href="#cb512-7" aria-hidden="true"></a><span class="co">#&gt;   Red      26   17    14    14</span></span>
<span id="cb512-8"><a href="#cb512-8" aria-hidden="true"></a><span class="co">#&gt;   Blond     7   94    10    16</span></span></code></pre></div>
<p>Vamos a traducir al castellano los nombres de las variables de esta tabla y de sus niveles. Esto lo podemos llevar a cabo en un solo paso con la función <code>dimnames</code> que ya usamos sobre <em>data frames</em>.
El resultado de aplicar esta función a una <code>table</code> es una <code>list</code> cuyas componentes son los niveles de cada variable.</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="#cb513-1" aria-hidden="true"></a><span class="kw">dimnames</span>(HEC)</span>
<span id="cb513-2"><a href="#cb513-2" aria-hidden="true"></a><span class="co">#&gt; $Hair</span></span>
<span id="cb513-3"><a href="#cb513-3" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;Black&quot; &quot;Brown&quot; &quot;Red&quot;   &quot;Blond&quot;</span></span>
<span id="cb513-4"><a href="#cb513-4" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb513-5"><a href="#cb513-5" aria-hidden="true"></a><span class="co">#&gt; $Eye</span></span>
<span id="cb513-6"><a href="#cb513-6" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;Brown&quot; &quot;Blue&quot;  &quot;Hazel&quot; &quot;Green&quot;</span></span></code></pre></div>
<p>Por lo tanto, para reescribir los nombres de las variables y sus niveles, basta redefinir esta <code>list</code> de la manera siguiente:</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="#cb514-1" aria-hidden="true"></a><span class="kw">dimnames</span>(HEC)=<span class="kw">list</span>(<span class="dt">Cabello=</span><span class="kw">c</span>(<span class="st">&quot;Negro&quot;</span>,<span class="st">&quot;Castaño&quot;</span>,<span class="st">&quot;Rojo&quot;</span>,<span class="st">&quot;Rubio&quot;</span>), <span class="dt">Ojos=</span><span class="kw">c</span>(<span class="st">&quot;Marrones&quot;</span>,<span class="st">&quot;Azules&quot;</span>,<span class="st">&quot;Pardos&quot;</span>,<span class="st">&quot;Verdes&quot;</span>))</span>
<span id="cb514-2"><a href="#cb514-2" aria-hidden="true"></a>HEC</span>
<span id="cb514-3"><a href="#cb514-3" aria-hidden="true"></a><span class="co">#&gt;          Ojos</span></span>
<span id="cb514-4"><a href="#cb514-4" aria-hidden="true"></a><span class="co">#&gt; Cabello   Marrones Azules Pardos Verdes</span></span>
<span id="cb514-5"><a href="#cb514-5" aria-hidden="true"></a><span class="co">#&gt;   Negro         68     20     15      5</span></span>
<span id="cb514-6"><a href="#cb514-6" aria-hidden="true"></a><span class="co">#&gt;   Castaño      119     84     54     29</span></span>
<span id="cb514-7"><a href="#cb514-7" aria-hidden="true"></a><span class="co">#&gt;   Rojo          26     17     14     14</span></span>
<span id="cb514-8"><a href="#cb514-8" aria-hidden="true"></a><span class="co">#&gt;   Rubio          7     94     10     16</span></span></code></pre></div>
<p>Vamos a dibujar un diagrama de mosaico de esta tabla.</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="#cb515-1" aria-hidden="true"></a><span class="kw">plot</span>(HEC,<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;lightblue&quot;</span>),</span>
<span id="cb515-2"><a href="#cb515-2" aria-hidden="true"></a>     <span class="dt">main=</span><span class="st">&quot;Diagrama de mosaico de la tabla bidimensional de frecuencias</span><span class="ch">\n</span><span class="st"> de colores de cabellos y ojos&quot;</span>)</span></code></pre></div>
<p><img src="10chap10_Descripción_cualitativos_files/figure-html/HECmosaic-1.png" width="90%" style="display: block; margin: auto;" />
A simple vista, vemos que las combinaciones de colores de cabellos y ojos más frecuentes son
los cabellos castaños con los ojos marrones, y los cabellos rubios con los ojos azules.</p>
<!--
\begin{figure}[ht]
\begin{center}
\includegraphics[width=0.45\textwidth]{HECmosaic}\
\end{center}
\caption{Diagrama de mosaico de las frecuencias conjuntas de colores de ojos y de cabellos en `HairEyeColor`.}\label{fig:HECmosaic}
\end{figure}
-->
<p>A continuación, vamos a calcular el número total de individuos representados en esta tabla, así como las tablas de frecuencias absolutas y relativas de cada variable, y representaremos estas últimas en sendos diagramas de barras.</p>
<ul>
<li>Número total de individuos:</li>
</ul>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="#cb516-1" aria-hidden="true"></a><span class="kw">sum</span>(HEC)</span>
<span id="cb516-2"><a href="#cb516-2" aria-hidden="true"></a><span class="co">#&gt; [1] 592</span></span></code></pre></div>
<ul>
<li>Tabla de frecuencias absolutas de colores de ojos:</li>
</ul>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="#cb517-1" aria-hidden="true"></a><span class="kw">colSums</span>(HEC)</span>
<span id="cb517-2"><a href="#cb517-2" aria-hidden="true"></a><span class="co">#&gt; Marrones   Azules   Pardos   Verdes </span></span>
<span id="cb517-3"><a href="#cb517-3" aria-hidden="true"></a><span class="co">#&gt;      220      215       93       64</span></span></code></pre></div>
<ul>
<li>Tabla de frecuencias absolutas de colores de cabello:</li>
</ul>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="#cb518-1" aria-hidden="true"></a><span class="kw">rowSums</span>(HEC)       </span>
<span id="cb518-2"><a href="#cb518-2" aria-hidden="true"></a><span class="co">#&gt;   Negro Castaño    Rojo   Rubio </span></span>
<span id="cb518-3"><a href="#cb518-3" aria-hidden="true"></a><span class="co">#&gt;     108     286      71     127</span></span></code></pre></div>
<ul>
<li>Tabla de frecuencias relativas de colores de ojos:</li>
</ul>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="#cb519-1" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">prop.table</span>(<span class="kw">colSums</span>(HEC)),<span class="dv">3</span>)</span>
<span id="cb519-2"><a href="#cb519-2" aria-hidden="true"></a><span class="co">#&gt; Marrones   Azules   Pardos   Verdes </span></span>
<span id="cb519-3"><a href="#cb519-3" aria-hidden="true"></a><span class="co">#&gt;    0.372    0.363    0.157    0.108</span></span></code></pre></div>
<ul>
<li>Tabla de frecuencias absolutas de colores de cabello:</li>
</ul>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="#cb520-1" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">prop.table</span>(<span class="kw">rowSums</span>(HEC)),<span class="dv">3</span>)   <span class="co">#Frec. rel. de Cabello</span></span>
<span id="cb520-2"><a href="#cb520-2" aria-hidden="true"></a><span class="co">#&gt;   Negro Castaño    Rojo   Rubio </span></span>
<span id="cb520-3"><a href="#cb520-3" aria-hidden="true"></a><span class="co">#&gt;   0.182   0.483   0.120   0.215</span></span></code></pre></div>
<ul>
<li>Diagrama de barras de frecuencias relativas de colores de ojos:</li>
</ul>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="#cb521-1" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">prop.table</span>(<span class="kw">colSums</span>(HEC)), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>),</span>
<span id="cb521-2"><a href="#cb521-2" aria-hidden="true"></a>  <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;burlywood4&quot;</span>,<span class="st">&quot;lightblue&quot;</span>,<span class="st">&quot;orange3&quot;</span>,<span class="st">&quot;lightgreen&quot;</span>))</span></code></pre></div>
<p><img src="10chap10_Descripción_cualitativos_files/figure-html/unnamed-chunk-74-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ul>
<li>Diagrama de barras de frecuencias relativas de colores de cabello:</li>
</ul>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="#cb522-1" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">prop.table</span>(<span class="kw">rowSums</span>(HEC)),</span>
<span id="cb522-2"><a href="#cb522-2" aria-hidden="true"></a>  <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;brown&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;gold&quot;</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="10chap10_Descripción_cualitativos_files/figure-html/unnamed-chunk-75-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Vemos que el color dominante de cabellos es el castaño, mientras que en el color de ojos el marrón y el azul están prácticamente empatados.</p>
<!--
\begin{figure}[ht]
\begin{center}
\includegraphics[width=0.45\textwidth]{HECEye}\
\includegraphics[width=0.45\textwidth]{HECHair}\
\end{center}
\caption{Diagrama de barras de frecuencias relativas de colores de ojos y de cabellos en `HairEyeColor`.}\label{fig:HECuni}
\end{figure}
-->
<p>Pasamos ahora a calcular las tablas de frecuencias relativas y dibujar los dos diagramas de barras de las frecuencias relativas marginales.</p>
<ul>
<li>Tabla de frecuencias relativas globales:</li>
</ul>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="#cb523-1" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">prop.table</span>(HEC), <span class="dv">3</span>)  </span>
<span id="cb523-2"><a href="#cb523-2" aria-hidden="true"></a><span class="co">#&gt;          Ojos</span></span>
<span id="cb523-3"><a href="#cb523-3" aria-hidden="true"></a><span class="co">#&gt; Cabello   Marrones Azules Pardos Verdes</span></span>
<span id="cb523-4"><a href="#cb523-4" aria-hidden="true"></a><span class="co">#&gt;   Negro      0.115  0.034  0.025  0.008</span></span>
<span id="cb523-5"><a href="#cb523-5" aria-hidden="true"></a><span class="co">#&gt;   Castaño    0.201  0.142  0.091  0.049</span></span>
<span id="cb523-6"><a href="#cb523-6" aria-hidden="true"></a><span class="co">#&gt;   Rojo       0.044  0.029  0.024  0.024</span></span>
<span id="cb523-7"><a href="#cb523-7" aria-hidden="true"></a><span class="co">#&gt;   Rubio      0.012  0.159  0.017  0.027</span></span></code></pre></div>
<ul>
<li>Tabla de frecuencias relativas de los colores de cabello dentro de cada color de ojos:</li>
</ul>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="#cb524-1" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">prop.table</span>(HEC, <span class="dt">margin=</span><span class="dv">1</span>), <span class="dv">3</span>)  </span>
<span id="cb524-2"><a href="#cb524-2" aria-hidden="true"></a><span class="co">#&gt;          Ojos</span></span>
<span id="cb524-3"><a href="#cb524-3" aria-hidden="true"></a><span class="co">#&gt; Cabello   Marrones Azules Pardos Verdes</span></span>
<span id="cb524-4"><a href="#cb524-4" aria-hidden="true"></a><span class="co">#&gt;   Negro      0.630  0.185  0.139  0.046</span></span>
<span id="cb524-5"><a href="#cb524-5" aria-hidden="true"></a><span class="co">#&gt;   Castaño    0.416  0.294  0.189  0.101</span></span>
<span id="cb524-6"><a href="#cb524-6" aria-hidden="true"></a><span class="co">#&gt;   Rojo       0.366  0.239  0.197  0.197</span></span>
<span id="cb524-7"><a href="#cb524-7" aria-hidden="true"></a><span class="co">#&gt;   Rubio      0.055  0.740  0.079  0.126</span></span></code></pre></div>
<ul>
<li>Tabla de frecuencias relativas de los colores de ojos dentro de cada color de cabellos:</li>
</ul>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="#cb525-1" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">prop.table</span>(HEC, <span class="dt">margin=</span><span class="dv">2</span>), <span class="dv">3</span>)   </span>
<span id="cb525-2"><a href="#cb525-2" aria-hidden="true"></a><span class="co">#&gt;          Ojos</span></span>
<span id="cb525-3"><a href="#cb525-3" aria-hidden="true"></a><span class="co">#&gt; Cabello   Marrones Azules Pardos Verdes</span></span>
<span id="cb525-4"><a href="#cb525-4" aria-hidden="true"></a><span class="co">#&gt;   Negro      0.309  0.093  0.161  0.078</span></span>
<span id="cb525-5"><a href="#cb525-5" aria-hidden="true"></a><span class="co">#&gt;   Castaño    0.541  0.391  0.581  0.453</span></span>
<span id="cb525-6"><a href="#cb525-6" aria-hidden="true"></a><span class="co">#&gt;   Rojo       0.118  0.079  0.151  0.219</span></span>
<span id="cb525-7"><a href="#cb525-7" aria-hidden="true"></a><span class="co">#&gt;   Rubio      0.032  0.437  0.108  0.250</span></span></code></pre></div>
<ul>
<li>Diagrama de barras de frecuencias relativas de los colores de cabello dentro de cada color de ojos:</li>
</ul>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="#cb526-1" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">prop.table</span>(HEC, <span class="dt">margin=</span><span class="dv">1</span>), <span class="dt">beside=</span><span class="ot">TRUE</span>, <span class="dt">legend.text=</span><span class="ot">TRUE</span>,</span>
<span id="cb526-2"><a href="#cb526-2" aria-hidden="true"></a>   <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;brown&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;gold&quot;</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.8</span>))</span></code></pre></div>
<p><img src="10chap10_Descripción_cualitativos_files/figure-html/unnamed-chunk-79-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ul>
<li>Diagrama de barras de frecuencias relativas de los colores de ojos dentro de cada color de cabello:</li>
</ul>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="#cb527-1" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">t</span>(<span class="kw">prop.table</span>(HEC, <span class="dt">margin=</span><span class="dv">2</span>)), <span class="dt">beside=</span><span class="ot">TRUE</span>,</span>
<span id="cb527-2"><a href="#cb527-2" aria-hidden="true"></a>   <span class="dt">legend.text=</span><span class="ot">TRUE</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>),</span>
<span id="cb527-3"><a href="#cb527-3" aria-hidden="true"></a>   <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;burlywood4&quot;</span>,<span class="st">&quot;lightblue&quot;</span>,<span class="st">&quot;orange3&quot;</span>,<span class="st">&quot;lightgreen&quot;</span>))</span></code></pre></div>
<p><img src="10chap10_Descripción_cualitativos_files/figure-html/unnamed-chunk-80-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Vemos, por ejemplo, que entre las personas de ojos azules, los cabellos rubios son los más frecuentes, y que entre las personas castañas el color de ojos más frecuente es el pardo.</p>
<!--
\begin{figure}[ht]
\begin{center}
\includegraphics[width=0.45\textwidth]{HECmargin1}\
\includegraphics[width=0.45\textwidth]{HECmargin2}\
\end{center}
\caption{Diagrama de barras de frecuencias relativas marginales de colores de ojos y de cabellos en `HairEyeColor`.}\label{fig:HECmarg}
\end{figure}
-->
</div>
<div id="guía-rápida-de-funciones-4" class="section level2" number="10.9">
<h2 number="10.9"><span class="header-section-number">10.9</span> Guía rápida de funciones</h2>
<ul>
<li><code>table</code> calcula la tabla de frecuencias absolutas de un vector o un factor.</li>
<li><code>as.table</code> convierte un objeto (por ejemplo, una matriz) en una tabla de contingencia.</li>
<li><code>ftable</code> muestra una tabla multidimensional en formato plano.</li>
<li><code>t</code> sirve para trasponer una tabla bidimensional.</li>
<li><code>aperm</code> sirve para permutar las variables de una tabla multidimensional. La permutación se especifica con el parámetro <code>perm</code>.</li>
<li><code>prop.table</code> calcula la tabla de frecuencias relativas de un vector o un factor a partir de su tabla de frecuencias absolutas. El parámetro <code>margin</code> sirve para especificar las dimensiones en cuyos niveles se calcularán las frecuencias relativas marginales. Si no se especifica, se calculan las frecuencias relativas globales.</li>
<li><code>CrossTable</code> del paquete <code>gmodels</code>, produce, en el caso bidimensional, una tabla conjunta de frecuencias absolutas y de frecuencias relativas globales y marginales.</li>
<li><code>names</code> da los nombres de las columnas de una tabla unidimensional, y sirve también para modificar estos nombres.</li>
<li><code>dimnames</code> da una <code>list</code> con los vectores de los nombres de los niveles de las diferentes variables de una tabla multidimensional, y sirve también para modificar los nombres tanto de las variables como de sus niveles.</li>
<li><code>tabla[...]</code> se usa para especificar un elemento, una fila, una columna o una subtabla de la <code>tabla</code>.</li>
<li><code>barplot</code> dibuja el diagrama de barras de un vector o un factor a partir de una tabla de frecuencias. Algunos parámetros importantes:
<ul>
<li><code>col</code>: sirve para especificar los colores de las barras.</li>
<li><code>horiz=TRUE</code>: sirve para dibujar el diagrama horizontal.</li>
<li><code>beside=TRUE</code>: sirve para especificar que el diagrama sea por bloques.</li>
<li><code>legend.text</code>: sirve para añadir una leyenda que explique qué barras corresponden a cada uno de los niveles de la primera variable.</li>
<li><code>args.legend</code>: sirve para modificar las características de esta leyenda, igualándolo a una <code>list</code> con los valores de los parámetros de la función <code>legend</code> que queramos especificar.</li>
<li><code>names</code>: sirve para cambiar en el diagrama los nombres de los niveles de la segunda variable.</li>
<li><code>main</code>, <code>xlab</code>, <code>ylab</code> y el resto de parámetros de <code>plot</code> que tengan sentido para diagramas de barras.</li>
</ul></li>
<li><code>pie</code> dibuja el diagrama circular de un vector o un factor a partir de una tabla de frecuencias. Algunos parámetros importantes:
<ul>
<li><code>col</code>: sirve para especificar los colores de los sectores.</li>
<li><code>names</code>: sirve para cambiar en el diagrama los nombres de los niveles.</li>
<li><code>main</code>, <code>xlab</code>, <code>ylab</code> y el resto de parámetros de <code>plot</code> que tengan sentido para diagramas circulares.</li>
</ul></li>
<li><code>plot</code> y <code>mosaicplot</code> dibujan el diagrama de mosaico de una tabla de frecuencias. Algunos parámetros relevantes (aparte de los usuales de <code>plot</code>):
<ul>
<li><code>col</code>: asigna colores a los niveles de la última variable.</li>
<li><code>dir</code>: igualado a un vector de direcciones <code>"v"</code> (vertical) y <code>"h"</code> (horizontal), sirve para especificar la dirección de las barras de cada variable.</li>
</ul></li>
<li><code>mosaic</code> del paquete <code>vcd</code>, también dibuja el diagrama de mosaico de una tabla de frecuencias. Algunos parámetros importantes:
<ul>
<li><code>dir</code>: como en <code>mosaicplot</code>.</li>
<li><code>highlighting</code>: sirve para destacar una variable.</li>
<li><code>highlighting_fill</code>: sirve para asignar colores a los niveles de la variable destacada.</li>
</ul></li>
<li><code>cotabplot</code> del paquete <code>vcd</code>, produce una tabla con un diagrama de mosaico para cada nivel de la última variable.</li>
<li><code>mosaic3d</code> del paquete <code>vcdExtra</code>, produce un diagrama de mosaico tridimensional.</li>
<li><code>\n</code> indica un cambio de línea en un título o etiqueta.</li>
<li><code>\"</code> escribe unas comillas en el texto de un título o etiqueta.</li>
</ul>
</div>
<div id="ejercicios-8" class="section level2" number="10.10">
<h2 number="10.10"><span class="header-section-number">10.10</span> Ejercicios</h2>
<div id="test-7" class="section level3 unnumbered">
<h3 class="unnumbered">Test</h3>
<p><em>(1)</em> Dad una instrucción que defina la tabla de frecuencias absolutas de un vector llamado <code>flores</code>.</p>
<p><em>(2)</em> Dad una instrucción que defina la tabla de frecuencias relativas de un vector llamado <code>flores</code> usando la función <code>prop.table</code>.</p>
<p><em>(3)</em> Dad una instrucción que defina la tabla bidimensional conjunta de frecuencias absolutas de dos vectores llamados <code>flores</code> y <code>zona</code> de forma que las filas correspondan a <code>flores</code> y las columnas a <code>zona</code>.</p>
<p><em>(4)</em> Dad una instrucción que defina la tabla bidimensional conjunta de frecuencias relativas, calculadas dentro del total, de dos vectores llamados <code>flores</code> y <code>zona</code>, de forma que las filas correspondan a <code>zona</code> y las columnas a <code>flores</code>.</p>
<p><em>(5)</em> Dad una instrucción que dibuje un diagrama de barras básico de un vector llamado <code>flores</code>.</p>
<p><em>(6)</em> Dad una instrucción que dibuje un diagrama circular básico de un vector llamado <code>flores</code>.</p>
<p><em>(7)</em> Definid un <em>data frame</em> a partir de la tabla de datos contenida en el <em>url</em> <a href="http://aprender.uib.es/Rdir/ESD.txt">http://aprender.uib.es/Rdir/ESD.txt</a> y dad la moda de la variable <code>MB</code>. Tenéis que dar el resultado final, no cómo lo habéis obtenido, y sin las comillas. Si la frecuencia máxima se logra en dos o más valores de esta variable, dad todos estos valores, ordenados de menor a mayor, separados por un espacio en blanco.</p>
<p><em>(8)</em> Definid un <em>data frame</em> a partir de la tabla de datos contenida en el <em>url</em> <a href="http://aprender.uib.es/Rdir/ESD.txt">http://aprender.uib.es/Rdir/ESD.txt</a> y dad la frecuencia relativa (redondeada a 2 cifras decimales) del valor 135 en la variable <code>MB</code>. Tenéis que dar el resultado final, no cómo lo habéis obtenido.</p>
<p><em>(9)</em> Definid un <em>data frame</em> a partir de la tabla de datos contenida en el <em>url</em> <a href="http://aprender.uib.es/Rdir/ESD.txt">http://aprender.uib.es/Rdir/ESD.txt</a> y dad la frecuencia relativa (calculada dentro del total y redondeada a 4 cifras decimales) de los individuos que en la variable <code>MB</code> tienen el valor 126 y en la variable <code>BH</code> tienen el valor 124.</p>
<p><em>(10)</em> La tabla <code>DNase</code> es uno de los <em>data frames</em> que lleva predefinidos R. Dad una instrucción que dibuje un diagrama de barras básico de la variable <em>density</em> de este <em>data frame</em>. Y antes de contestar, comprobad que funciona.</p>
<p><em>(11)</em> Considerad el objeto de datos <code>HairEyeColor</code> que lleva predefinido R y que ya hemos usado en esta lección. ¿Qué porcentaje de hombres en esta tabla son pelirrojos y tienen los ojos verdes? Dad el valor del porcentaje redondeado a dos cifras decimales y sin el signo %.</p>
</div>
<div id="ejercicio-7" class="section level3 unnumbered">
<h3 class="unnumbered">Ejercicio</h3>
<p>Instalad y cargad el paquete <strong>MASS</strong>. Este paquete lleva una tabla de datos llamada <code>birthwt</code> sobre factores que pueden incidir en el peso de los niños al nacer. Antes de empezar, con <code>str</code>, <code>View</code>, <code>head</code> … explorad su estructura y consultad en su Ayuda el significado de cada variable.</p>
<p><em>(a)</em> Calculad una tabla bidimensional de frecuencias relativas marginales de los pares (raza de la madre, peso inferior a 2.5 kg o no) que permita ver, fácilmente, si la raza de la madre influye en el peso del bebé. Dibujad un diagrama de mosaico de esta tabla.</p>
<p>Asimismo, dibujad un diagrama de barras por bloques e estas frecuencias relativas que permita visualizar esta información. Poned nombres adecuados a los bloques, colores a las barras, y añadid una leyenda que explique qué representa cada barra. ¿Se puede obtener alguna conclusión de esta tabla y de este diagrama de barras?</p>
<p><em>(b)</em> Repetid el punto anterior para los pares (madre fumadora o no, peso inferior a 2.5 kg o no) y para los pares (madre hipertensa o no, peso inferior a 2.5 kg o no).</p>
<p><em>(c)</em> Calculad una tabla de frecuencias relativas marginales de las ternas (raza de la madre, madre fumadora o no, peso inferior a 2.5 kg o no) que permita ver, fácilmente, si la combinación de la raza de la madre y su condición de fumadora o no fumadora influye en el peso del bebé. Dibujad un diagrama de mosaico de esta tabla tridimensional.</p>
<p>Asimismo, dibujad un diagrama de barras por bloques que permita visualizar esta información (pensad cómo pasaréis de la tabla tridimensional a un diagrama de barras bidimensional que muestre la información deseada). Poned nombres adecuados a los bloques, colores a las barras, y añadid una leyenda que explique qué representa cada barra. ¿Se puede obtener alguna conclusión de esta tabla y de este diagrama de barras?</p>
</div>
<div id="respuestas-al-test-7" class="section level3 unnumbered">
<h3 class="unnumbered">Respuestas al test</h3>
<p><em>(1)</em> <code>table(flores)</code></p>
<p><em>(2)</em> <code>prop.table(table(flores))</code></p>
<p><em>(3)</em> <code>table(flores,zona)</code></p>
<p><em>(4)</em> <code>prop.table(table(zona,flores))</code></p>
<p><em>(5)</em> <code>barplot(table(flores))</code></p>
<p><em>(6)</em> <code>pie(table(flores))</code></p>
<p><em>(7)</em> 131 138</p>
<p><em>(8)</em> 0.07</p>
<p><em>(9)</em> 0.0067</p>
<p><em>(10)</em> <code>barplot(table(DNase$density))</code></p>
<p><em>(11)</em> 2.51</p>
<!--chapter:end:10chap10_Descripción_cualitativos.Rmd-->
</div>
</div>
</div>
<div id="chap:ord" class="section level1" number="11">
<h1 number="11"><span class="header-section-number">11</span> Descripción de datos ordinales</h1>
<p>Los datos ordinales son parecidos a los cualitativos, en el sentido de que son cualidades de objetos o individuos. Su diferencia con los datos cualitativos está en que las características que expresan los datos ordinales tienen un orden natural que permite <em>acumular</em> observaciones, es decir, contar cuántas hay por debajo de cada nivel. Un caso frecuente son las escalas tipo <em>Likert</em>, que se usan para conocer la opinión de un grupo de personas sobre un tema determinado; para más información, podéis consultar <a href="http://es.wikipedia.org/wiki/Escalas_Likert">la entrada de la Wikipedia sobre escalas Likert</a>.</p>
<div id="frecuencias-para-datos-ordinales" class="section level2" number="11.1">
<h2 number="11.1"><span class="header-section-number">11.1</span> Frecuencias para datos ordinales</h2>
<p>Cuando trabajamos con datos ordinales, el orden de los niveles de los datos permite calcular no sólo las frecuencias absolutas y relativas que veíamos en la lección anterior, y que para variables ordinales se definen del mismo modo, sino también frecuencias <strong>acumuladas</strong>. Es decir, no sólo podemos contar cuántas veces hemos observado un cierto dato, sino también cuántas veces hemos observado un dato menor o igual que él.</p>

<div class="example">
<span id="exm:ex1701bis" class="example"><strong>(#exm:ex1701bis) </strong></span>Tenemos una muestra de 20 estudiantes de quienes sabemos la calificación que han sacado en un examen. Clasificamos estas calificaciones en Suspenso (<em>S</em>), Aprobado (<em>A</em>), Notable (<em>N</em>) y Sobresaliente (<em>E</em>) y consideramos su orden natural <em>S</em> &lt; <em>A</em> &lt; <em>N</em> &lt; <em>E</em>. Las calificaciones que han obtenido son las siguientes:
<p style="text-align:center">
<em>A</em>, <em>A</em>, <em>N</em>, <em>S</em>, <em>S</em>, <em>A</em>, <em>N</em>, <em>E</em>, <em>A</em>, <em>A</em>, <em>S</em>, <em>S</em>, <em>S</em>, <em>A</em>, <em>E</em>, <em>N</em>, <em>N</em>, <em>E</em>, <em>S</em>, <em>A</em>.
</p>
</div>
<p>En esta lista hay 6 <em>S</em>, 7 <em>A</em>, 4 <em>N</em> y 3 <em>E</em>: éstas serían las frecuencias absolutas de las calificaciones en esta muestra de estudiantes. Por lo que se refiere a sus <strong>frecuencias absolutas acumuladas</strong>:</p>
<ul>
<li>Hay 6 estudiantes que han obtenido <em>S</em> o menos: la frecuencia absoluta acumulada de <em>S</em> es 6.</li>
<li>Hay 13 estudiantes que han obtenido <em>A</em> o menos (6 <em>S</em> y 7 <em>A</em>): la frecuencia absoluta acumulada de <em>A</em> es 13.</li>
<li>Hay 17 estudiantes que han obtenido <em>N</em> o menos (6 <em>S</em>, 7 <em>A</em> y 4 <em>N</em>): la frecuencia absoluta acumulada de <em>N</em> es 17.</li>
<li>Hay 20 estudiantes que han obtenido <em>E</em> o menos (todos): la frecuencia absoluta acumulada de <em>E</em> es 20.</li>
</ul>
<p>La <strong>frecuencia relativa acumulada</strong> de cada calificación es la fracción del total de estudiantes que representa su frecuencia absoluta acumulada: por ejemplo, la frecuencia relativa acumulada de notables es la proporción de estudiantes que han sacado un notable o menos, y, por lo tanto, es igual a la frecuencia absoluta acumulada de <em>N</em> dividida por el número total de estudiantes. Así pues, para calcular las frecuencias relativas acumuladas de las calificaciones en esta muestra, tenemos que dividir sus frecuencias absolutas acumuladas entre 20:</p>
<ul>
<li><em>S</em>: 6/20=0.3</li>
<li><em>A</em>: 13/20=0.65</li>
<li><em>N</em>: 17/20=0.85</li>
<li><em>E</em>: 20/20=1</li>
</ul>
<p>En general, supongamos que efectuamos <span class="math inline">\(n\)</span> observaciones
<span class="math display">\[
x_1,x_2,\ldots,x_n
\]</span>
de un cierto tipo de datos ordinales, cuyos posibles <strong>niveles</strong> ordenados son
<span class="math display">\[
l_1&lt;l_2&lt;\cdots &lt;l_k.
\]</span>
Por lo tanto, cada una de estas observaciones <span class="math inline">\(x_j\)</span> es igual a algún <span class="math inline">\(l_i\)</span>. Diremos que estas observaciones forman una <strong>variable ordinal</strong>. En el ejemplo anterior, tendríamos que los niveles ordenados son <em>S</em> &lt; <em>A</em> &lt; <em>N</em> &lt; <em>E</em>, que <span class="math inline">\(n=20\)</span>, y que <span class="math inline">\(x_1,\ldots,x_{20}\)</span> son las calificaciones obtenidas por los estudiantes de la muestra.</p>
<p>Con estas notaciones:</p>
<ul>
<li><p>Las definiciones de <strong>frecuencias absolutas</strong> <span class="math inline">\(n_j\)</span> y <strong>relativas</strong> <span class="math inline">\(f_j\)</span>, para cada nivel <span class="math inline">\(l_j\)</span>,
son las mismas que en una variable cualitativa (véase la Sección @ref(sec:edqual)).</p></li>
<li><p>La <strong>frecuencia absoluta acumulada</strong> del nivel <span class="math inline">\(l_j\)</span> en esta variable ordinal es el número <span class="math inline">\(N_j\)</span> de observaciones <span class="math inline">\(x_i\)</span> tales que <span class="math inline">\(x_i\leqslant l_j\)</span>. Es decir,
es
<span class="math display">\[N_j=\sum\limits_{k=1}^j n_k.\]</span></p></li>
<li><p>La <strong>frecuencia relativa acumulada</strong> del nivel <span class="math inline">\(l_j\)</span> en esta variable ordinal es la fracción (en tanto por uno) <span class="math inline">\(F_j\)</span> de observaciones <span class="math inline">\(x_i\)</span> tales que <span class="math inline">\(x_i\leqslant l_j\)</span>. Es decir,
<span class="math display">\[
F_j=\dfrac{N_j}{n}=\sum\limits_{k=1}^j f_k.
\]</span></p></li>
</ul>
</div>
<div id="descripción-de-datos-ordinales-con-r" class="section level2" number="11.2">
<h2 number="11.2"><span class="header-section-number">11.2</span> Descripción de datos ordinales con R</h2>
<p>Recordemos de la Lección @ref(chap:vect) que la función <code>cumsum</code>, aplicada a un vector, calcula el vector de sus sumas acumuladas. Sobre una tabla de contingencia tiene el mismo efecto, y por lo tanto podemos usarla para calcular la tabla de frecuencias acumuladas (absolutas o relativas) de un vector, aplicándola a su tabla de frecuencias (absolutas o relativas, según corresponda).</p>

<div class="example">
<p><span id="exm:ex1ordinales" class="example"><strong>(#exm:ex1ordinales) </strong></span>Vamos a calcular y representar gráficamente las frecuencias acumuladas de la muestra de calificaciones del Ejemplo @ref(exm:ex1701bis). Para ello entraremos dichas calificaciones como un factor ordenado, porque es la manera natural de guardar una variable ordinal en R.</p>
</div>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="#cb528-1" aria-hidden="true"></a>notas=<span class="kw">ordered</span>(<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;E&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;E&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;E&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;A&quot;</span>), </span>
<span id="cb528-2"><a href="#cb528-2" aria-hidden="true"></a>              <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;S&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;E&quot;</span>))</span>
<span id="cb528-3"><a href="#cb528-3" aria-hidden="true"></a>notas</span>
<span id="cb528-4"><a href="#cb528-4" aria-hidden="true"></a><span class="co">#&gt;  [1] A A N S S A N E A A S S S A E N N E S A</span></span>
<span id="cb528-5"><a href="#cb528-5" aria-hidden="true"></a><span class="co">#&gt; Levels: S &lt; A &lt; N &lt; E</span></span></code></pre></div>
<ul>
<li>Su tabla de frecuencias absolutas:</li>
</ul>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="#cb529-1" aria-hidden="true"></a><span class="kw">table</span>(notas)</span>
<span id="cb529-2"><a href="#cb529-2" aria-hidden="true"></a><span class="co">#&gt; notas</span></span>
<span id="cb529-3"><a href="#cb529-3" aria-hidden="true"></a><span class="co">#&gt; S A N E </span></span>
<span id="cb529-4"><a href="#cb529-4" aria-hidden="true"></a><span class="co">#&gt; 6 7 4 3</span></span></code></pre></div>
<ul>
<li>Su tabla de frecuencias absolutas acumuladas:</li>
</ul>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="#cb530-1" aria-hidden="true"></a><span class="kw">cumsum</span>(<span class="kw">table</span>(notas))</span>
<span id="cb530-2"><a href="#cb530-2" aria-hidden="true"></a><span class="co">#&gt;  S  A  N  E </span></span>
<span id="cb530-3"><a href="#cb530-3" aria-hidden="true"></a><span class="co">#&gt;  6 13 17 20</span></span></code></pre></div>
<ul>
<li>Su tabla de frecuencias relativas acumuladas:</li>
</ul>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="#cb531-1" aria-hidden="true"></a><span class="kw">cumsum</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(notas)))</span>
<span id="cb531-2"><a href="#cb531-2" aria-hidden="true"></a><span class="co">#&gt;    S    A    N    E </span></span>
<span id="cb531-3"><a href="#cb531-3" aria-hidden="true"></a><span class="co">#&gt; 0.30 0.65 0.85 1.00</span></span></code></pre></div>
<ul>
<li>Un diagrama de barras de sus frecuencias absolutas:</li>
</ul>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="#cb532-1" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">table</span>(notas))</span></code></pre></div>
<p><img src="11chap11_Descripcion_ordinales_files/figure-html/unnamed-chunk-5-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ul>
<li>Un diagrama de barras de sus frecuencias absolutas acumuladas:</li>
</ul>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="#cb533-1" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">cumsum</span>(<span class="kw">table</span>(notas)))</span></code></pre></div>
<p><img src="11chap11_Descripcion_ordinales_files/figure-html/unnamed-chunk-6-1.png" width="90%" style="display: block; margin: auto;" /></p>
<!--
```{r F1702,fig.cap="Diagramas de barras de frecuencias absolutas y de frecuencias absolutas acumuladas de las notas del Ejemplo 
\@ref(ex:ex1701bis)."}
knitr::include_graphics(c("images/notasnoacum1.png","images/notasacum1.png"))
```


\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.45\textwidth]{notasnoacum1.pdf}\
\includegraphics[width=0.45\textwidth]{notasacum1.pdf}
\end{center}
\caption{Diagramas de barras de frecuencias absolutas y de frecuencias absolutas acumuladas de las notas del Ejemplo \@ref(ex:17.1).}\label{fig:17.2)
\end{figure}
-->
<p>Para calcular las frecuencias relativas acumuladas hemos usado la instrucción</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="#cb534-1" aria-hidden="true"></a><span class="kw">cumsum</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(notas)))</span></code></pre></div>
<p>que va sumando las frecuencias relativas. También las podríamos haber calculado dividiendo las frecuencias
absolutas acumuladas por el número de datos, usando una de las dos instrucciones siguientes:</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="#cb535-1" aria-hidden="true"></a><span class="kw">cumsum</span>(<span class="kw">table</span>(notas))<span class="op">/</span><span class="kw">length</span>(notas)</span>
<span id="cb535-2"><a href="#cb535-2" aria-hidden="true"></a><span class="co">#&gt;    S    A    N    E </span></span>
<span id="cb535-3"><a href="#cb535-3" aria-hidden="true"></a><span class="co">#&gt; 0.30 0.65 0.85 1.00</span></span>
<span id="cb535-4"><a href="#cb535-4" aria-hidden="true"></a><span class="kw">cumsum</span>(<span class="kw">table</span>(notas)<span class="op">/</span><span class="kw">length</span>(notas))</span>
<span id="cb535-5"><a href="#cb535-5" aria-hidden="true"></a><span class="co">#&gt;    S    A    N    E </span></span>
<span id="cb535-6"><a href="#cb535-6" aria-hidden="true"></a><span class="co">#&gt; 0.30 0.65 0.85 1.00</span></span></code></pre></div>
<p>Pero <em>no</em> podíamos usar</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="#cb536-1" aria-hidden="true"></a><span class="kw">prop.table</span>(<span class="kw">cumsum</span>(<span class="kw">table</span>(notas)))</span>
<span id="cb536-2"><a href="#cb536-2" aria-hidden="true"></a><span class="co">#&gt;         S         A         N         E </span></span>
<span id="cb536-3"><a href="#cb536-3" aria-hidden="true"></a><span class="co">#&gt; 0.1071429 0.2321429 0.3035714 0.3571429</span></span></code></pre></div>
<p>Pensad qué ha entendido R que queríamos hacer con esta última instrucción.</p>

<div class="example">
<p><span id="exm:ex1704" class="example"><strong>(#exm:ex1704) </strong></span>En un estudio sobre el comportamiento ético de una empresa, a un grupo de técnicos en impacto ambiental que trabajaban en dicha empresa se les hizo la pregunta siguiente: “<em>¿Cree que su empresa anima a sus técnicos en impacto ambiental a usar métodos que favorezcan la opinión del cliente que ha encargado el estudio?</em>”</p>
</div>
<p>Las posibles respuestas eran las que aparecen en la Tabla @ref(tab:Likert), y forman una escala ordinal de tipo , con 1 &lt; 2 &lt; 3 &lt; 4 &lt; 5.</p>
<table>
<caption>(#tab:Likert)Un ejemplo de escala <em>Likert</em>.</caption>
<thead>
<tr class="header">
<th align="right">Nivel</th>
<th align="left">Significado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">Muy en desacuerdo</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">En desacuerdo</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">Neutro</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">De acuerdo</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">Muy de acuerdo</td>
</tr>
</tbody>
</table>
<!--
\begin{table}[h]
\begin{center}
\abovecaptionskip=7pt
\begin{tabular}{|r|l|}
\hline
Nivel & Significado\\\hline
1 & Muy en desacuerdo\\
2 & En desacuerdo \\
3 & Neutro\\
4 & De acuerdo\\
5 & Muy de acuerdo\\\hline
\end{tabular}
\caption{Un ejemplo de datos ordinales.}\label{tablaLikert}
\end{center}
\end{table}
-->
<p>Supongamos que se recogieron las siguientes respuestas de 100 técnicos, que tenemos en un vector:</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="#cb537-1" aria-hidden="true"></a>respuestas=<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,</span>
<span id="cb537-2"><a href="#cb537-2" aria-hidden="true"></a>             <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,</span>
<span id="cb537-3"><a href="#cb537-3" aria-hidden="true"></a>             <span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,</span>
<span id="cb537-4"><a href="#cb537-4" aria-hidden="true"></a>             <span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">3</span>)</span></code></pre></div>
<p>En este caso tenemos 5 niveles (<span class="math inline">\(k=5\)</span>) y 100 observaciones (<span class="math inline">\(n=100\)</span>) que forman una variable ordinal que llamamos <em>respuestas</em>. Vamos a calcular sus dos tablas de frecuencias relativas (acumuladas o no) y dos diagramas de barras adecuados de sus frecuencias relativas (de nuevo, acumuladas o no). Para ello, en primer lugar transformaremos este vector en un factor ordenado.</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="#cb538-1" aria-hidden="true"></a>respuestas=<span class="kw">ordered</span>(respuestas,<span class="dt">levels=</span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span></code></pre></div>
<ul>
<li>Su tabla de frecuencias relativas:</li>
</ul>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="#cb539-1" aria-hidden="true"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(respuestas))</span>
<span id="cb539-2"><a href="#cb539-2" aria-hidden="true"></a><span class="co">#&gt; respuestas</span></span>
<span id="cb539-3"><a href="#cb539-3" aria-hidden="true"></a><span class="co">#&gt;    1    2    3    4    5 </span></span>
<span id="cb539-4"><a href="#cb539-4" aria-hidden="true"></a><span class="co">#&gt; 0.24 0.22 0.24 0.20 0.10</span></span></code></pre></div>
<ul>
<li>Su tabla de frecuencias relativas acumuladas:</li>
</ul>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="#cb540-1" aria-hidden="true"></a><span class="kw">cumsum</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(respuestas)))</span>
<span id="cb540-2"><a href="#cb540-2" aria-hidden="true"></a><span class="co">#&gt;    1    2    3    4    5 </span></span>
<span id="cb540-3"><a href="#cb540-3" aria-hidden="true"></a><span class="co">#&gt; 0.24 0.46 0.70 0.90 1.00</span></span></code></pre></div>
<ul>
<li>Un diagrama de barras de sus frecuencias relativas:</li>
</ul>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="#cb541-1" aria-hidden="true"></a>Nombres.compl=<span class="kw">c</span>(<span class="st">&quot;Muy en</span><span class="ch">\n</span><span class="st"> desacuerdo&quot;</span>,<span class="st">&quot;En</span><span class="ch">\n</span><span class="st"> desacuerdo&quot;</span>,<span class="st">&quot;Neutro</span><span class="ch">\n</span><span class="st"> &quot;</span>,</span>
<span id="cb541-2"><a href="#cb541-2" aria-hidden="true"></a>                <span class="st">&quot;De</span><span class="ch">\n</span><span class="st"> acuerdo&quot;</span>,<span class="st">&quot;Muy de</span><span class="ch">\n</span><span class="st"> acuerdo&quot;</span>)</span>
<span id="cb541-3"><a href="#cb541-3" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(respuestas)), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.30</span>), <span class="dt">cex.names=</span><span class="fl">0.75</span>,</span>
<span id="cb541-4"><a href="#cb541-4" aria-hidden="true"></a>  <span class="dt">main=</span><span class="st">&quot;Diagrama de barras de las frecuencias relativas</span><span class="ch">\n</span><span class="st"> de la variable </span><span class="ch">\&quot;</span><span class="st">respuestas</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, </span>
<span id="cb541-5"><a href="#cb541-5" aria-hidden="true"></a>  <span class="dt">names=</span>Nombres.compl, <span class="dt">xlab=</span><span class="st">&quot;Nivel de acuerdo escala Likert&quot;</span>,  <span class="dt">ylab=</span><span class="st">&quot;Frec. relativas&quot;</span>)</span></code></pre></div>
<p><img src="11chap11_Descripcion_ordinales_files/figure-html/unnamed-chunk-14-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ul>
<li>Un diagrama de barras de sus frecuencias relativas acumuladas:</li>
</ul>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="#cb542-1" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">cumsum</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(respuestas))), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">cex.names=</span><span class="fl">0.75</span>,</span>
<span id="cb542-2"><a href="#cb542-2" aria-hidden="true"></a>  <span class="dt">main=</span><span class="st">&quot;Diagrama de barras de las frecuencias relativas acumuladas </span><span class="ch">\n</span><span class="st"> de la variable </span><span class="ch">\&quot;</span><span class="st">respuestas</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, </span>
<span id="cb542-3"><a href="#cb542-3" aria-hidden="true"></a>  <span class="dt">names=</span>Nombres.compl, <span class="dt">xlab=</span><span class="st">&quot;Nivel de acuerdo escala Likert&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Frec. relativas acumuladas&quot;</span>)</span></code></pre></div>
<p><img src="11chap11_Descripcion_ordinales_files/figure-html/unnamed-chunk-15-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>En los dos últimos diagramas de barras, hemos representado los niveles con un texto más descriptivo. Para hacerlo, hemos definido un vector <code>Nombres.compl</code> con sus nuevos nombres en el orden correspondiente (y en dos líneas cada uno para ocupar menos espacio horizontal), y entonces en los <code>barplot</code> hemos especificado <code>names=Nombres.compl</code>. Además, con el parámetro <code>cex.names</code> hemos reducido un 25% el tamaño de los nombres de las barras para que cupieran bien en el dibujo.</p>

<div class="example">
<p><span id="exm:ex1706" class="example"><strong>(#exm:ex1706) </strong></span>Un microbiólogo ha evaluado la semejanza a una cierta comunidad prototipo de los microbiotas intestinales de 40 individuos con síndrome del colon irritable. Los niveles de semejanza que ha usado son los de la Tabla @ref(tab:tablameta), y los considera ordenados de la manera natural:</p>
</div>
<p style="text-align:center">
Tot.difs &lt;Difs &lt; Pars &lt; Muy.pars &lt; Iguales
</p>
<table>
<caption>
(#tab:tablameta)Niveles de semejanza de comunidades microbianas.
</caption>
<thead>
<tr>
<th style="text-align:left;">
Nivel
</th>
<th style="text-align:left;">
Significado
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Tot.difs
</td>
<td style="text-align:left;">
Totalmente diferentes
</td>
</tr>
<tr>
<td style="text-align:left;">
Difs
</td>
<td style="text-align:left;">
Diferentes
</td>
</tr>
<tr>
<td style="text-align:left;">
Pars
</td>
<td style="text-align:left;">
Parecidas
</td>
</tr>
<tr>
<td style="text-align:left;">
Muy.pars
</td>
<td style="text-align:left;">
Muy parecidas
</td>
</tr>
<tr>
<td style="text-align:left;">
Iguales
</td>
<td style="text-align:left;">
Totalmente Iguales
</td>
</tr>
</tbody>
</table>
<!--
\begin{table}[h]
\begin{center}
\abovecaptionskip=6pt
\begin{tabular}{|r|l|}
\hline
Nivel & Significado\\\hline
`Tot.difs` & Totalmente diferentes\\
`Difs` & Diferentes \\
`Pars` & Parecidas \\
`Muy.pars` & Muy parecidas\\
`Iguales` & Totalmente iguales\\\hline
\end{tabular}
\caption{Niveles de semejanza de comunidades microbianas.}\label{tablameta}
\end{center}
\end{table}
-->
<p>Los valores obtenidos en el estudio son los contenidos en el siguiente vector.</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="#cb543-1" aria-hidden="true"></a>datos=<span class="kw">c</span>(<span class="st">&quot;Difs&quot;</span>,<span class="st">&quot;Pars&quot;</span>,<span class="st">&quot;Difs&quot;</span>,<span class="st">&quot;Muy.pars&quot;</span>,<span class="st">&quot;Muy.pars&quot;</span>,<span class="st">&quot;Muy.pars&quot;</span>,<span class="st">&quot;Iguales&quot;</span>,<span class="st">&quot;Pars&quot;</span>,<span class="st">&quot;Difs&quot;</span>,<span class="st">&quot;Tot.difs&quot;</span>,</span>
<span id="cb543-2"><a href="#cb543-2" aria-hidden="true"></a>        <span class="st">&quot;Muy.pars&quot;</span>,<span class="st">&quot;Iguales&quot;</span>,<span class="st">&quot;Muy.pars&quot;</span>,<span class="st">&quot;Pars&quot;</span>,<span class="st">&quot;Pars&quot;</span>,<span class="st">&quot;Muy.pars&quot;</span>,<span class="st">&quot;Iguales&quot;</span>,<span class="st">&quot;Difs&quot;</span>,<span class="st">&quot;Difs&quot;</span>,<span class="st">&quot;Pars&quot;</span>,</span>
<span id="cb543-3"><a href="#cb543-3" aria-hidden="true"></a>        <span class="st">&quot;Muy.pars&quot;</span>,<span class="st">&quot;Muy.pars&quot;</span>,<span class="st">&quot;Muy.pars&quot;</span>,<span class="st">&quot;Difs&quot;</span>,<span class="st">&quot;Pars&quot;</span>,<span class="st">&quot;Pars&quot;</span>,<span class="st">&quot;Iguales&quot;</span>,<span class="st">&quot;Iguales&quot;</span>,<span class="st">&quot;Muy.pars&quot;</span>,</span>
<span id="cb543-4"><a href="#cb543-4" aria-hidden="true"></a>        <span class="st">&quot;Iguales&quot;</span>,<span class="st">&quot;Difs&quot;</span>,<span class="st">&quot;Tot.difs&quot;</span>,<span class="st">&quot;Pars&quot;</span>,<span class="st">&quot;Muy.pars&quot;</span>,<span class="st">&quot;Iguales&quot;</span>,<span class="st">&quot;Difs&quot;</span>,<span class="st">&quot;Muy.pars&quot;</span>,<span class="st">&quot;Muy.pars&quot;</span>,</span>
<span id="cb543-5"><a href="#cb543-5" aria-hidden="true"></a>        <span class="st">&quot;Iguales&quot;</span>,<span class="st">&quot;Tot.difs&quot;</span>)</span></code></pre></div>
<p>Para estudiar las frecuencias acumuladas de los niveles de semejanza en este estudio, transformaremos este vector en un factor ordenado con los niveles ordenados de manera adecuada.</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="#cb544-1" aria-hidden="true"></a>sem.com=<span class="kw">ordered</span>(datos,<span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;Tot.difs&quot;</span>,<span class="st">&quot;Difs&quot;</span>,<span class="st">&quot;Pars&quot;</span>,<span class="st">&quot;Muy.pars&quot;</span>,<span class="st">&quot;Iguales&quot;</span>))</span></code></pre></div>
<ul>
<li>La tabla de frecuencias absolutas:</li>
</ul>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="#cb545-1" aria-hidden="true"></a>AbsFr=<span class="kw">table</span>(sem.com)</span>
<span id="cb545-2"><a href="#cb545-2" aria-hidden="true"></a>AbsFr</span>
<span id="cb545-3"><a href="#cb545-3" aria-hidden="true"></a><span class="co">#&gt; sem.com</span></span>
<span id="cb545-4"><a href="#cb545-4" aria-hidden="true"></a><span class="co">#&gt; Tot.difs     Difs     Pars Muy.pars  Iguales </span></span>
<span id="cb545-5"><a href="#cb545-5" aria-hidden="true"></a><span class="co">#&gt;        3        8        8       13        8</span></span></code></pre></div>
<ul>
<li>La tabla de frecuencias relativas:</li>
</ul>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="#cb546-1" aria-hidden="true"></a><span class="kw">prop.table</span>(AbsFr)</span>
<span id="cb546-2"><a href="#cb546-2" aria-hidden="true"></a><span class="co">#&gt; sem.com</span></span>
<span id="cb546-3"><a href="#cb546-3" aria-hidden="true"></a><span class="co">#&gt; Tot.difs     Difs     Pars Muy.pars  Iguales </span></span>
<span id="cb546-4"><a href="#cb546-4" aria-hidden="true"></a><span class="co">#&gt;    0.075    0.200    0.200    0.325    0.200</span></span></code></pre></div>
<ul>
<li>La tabla de frecuencias absolutas acumuladas:</li>
</ul>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="#cb547-1" aria-hidden="true"></a><span class="kw">cumsum</span>(AbsFr)</span>
<span id="cb547-2"><a href="#cb547-2" aria-hidden="true"></a><span class="co">#&gt; Tot.difs     Difs     Pars Muy.pars  Iguales </span></span>
<span id="cb547-3"><a href="#cb547-3" aria-hidden="true"></a><span class="co">#&gt;        3       11       19       32       40</span></span></code></pre></div>
<ul>
<li>La tabla de frecuencias relativas acumuladas:</li>
</ul>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="#cb548-1" aria-hidden="true"></a><span class="kw">cumsum</span>(<span class="kw">prop.table</span>(AbsFr))</span>
<span id="cb548-2"><a href="#cb548-2" aria-hidden="true"></a><span class="co">#&gt; Tot.difs     Difs     Pars Muy.pars  Iguales </span></span>
<span id="cb548-3"><a href="#cb548-3" aria-hidden="true"></a><span class="co">#&gt;    0.075    0.275    0.475    0.800    1.000</span></span></code></pre></div>
<ul>
<li>Un diagrama de barras de sus frecuencias relativas acumuladas:</li>
</ul>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="#cb549-1" aria-hidden="true"></a>Nombres.Completos=<span class="kw">c</span>(<span class="st">&quot;Totalmente</span><span class="ch">\n</span><span class="st"> diferentes&quot;</span>,<span class="st">&quot;Diferentes</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;Parecidas</span><span class="ch">\n</span><span class="st"> &quot;</span>,</span>
<span id="cb549-2"><a href="#cb549-2" aria-hidden="true"></a>                    <span class="st">&quot;Muy</span><span class="ch">\n</span><span class="st"> parecidas&quot;</span>,<span class="st">&quot;Totalmente</span><span class="ch">\n</span><span class="st"> iguales&quot;</span>)</span>
<span id="cb549-3"><a href="#cb549-3" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">cumsum</span>(<span class="kw">prop.table</span>(AbsFr)), <span class="dt">names=</span>Nombres.Completos, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">cex.names=</span><span class="fl">0.75</span>)</span></code></pre></div>
<p><img src="11chap11_Descripcion_ordinales_files/figure-html/unnamed-chunk-21-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Para calcular frecuencias acumuladas en una tabla multidimensional, hay que aplicar a la tabla la función <code>cumsum</code> mediante la función <code>apply</code>. En este caso concreto, la sintaxis de la instrucción sería</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="#cb550-1" aria-hidden="true"></a><span class="kw">apply</span>(tabla, <span class="dt">MARGIN=</span>..., <span class="dt">FUN=</span>cumsum)</span></code></pre></div>
<p>donde el valor de <code>MARGIN</code> ha de ser el de la dimensión en la que queremos acumular las frecuencias: 1 si queremos calcular las frecuencias acumuladas por filas, 2 si las queremos calcular por columnas, etc. Esta construcción tiene algunas particularidades, que vamos a ilustrar con un ejemplo.</p>
<!--
\begin{ejemplo}\label{ex:encuestacum}
-->

<div class="example">
<p><span id="exm:encuestacum" class="example"><strong>(#exm:encuestacum) </strong></span>Supongamos que las 100 respuestas a la encuesta en el Ejemplo @ref(exm:ex1704) en realidad provienen de técnicos de tres empresas diferentes, A, B y C, de manera que las 30 primeras son de técnicos de A, las 20 siguientes, de técnicos de B, y las 50 últimas, de técnicos de C. Nos interesa estudiar la distribución de las respuestas según la empresa.</p>
</div>
<p>Vamos a organizar estos datos en un <em>data frame</em>. Para que sea más fácil visualizar la información que nos interesa, es conveniente que las filas de las tablas de frecuencias correspondan a las empresas. Por lo tanto, al definir el <em>data frame</em>, entraremos como primera variable la de las empresas; de esta manera, éstas aparecerán en las filas al aplicarle la función <code>table</code>. Recordad además que las respuestas ya las tenemos convenientemente organizadas en un factor ordenado llamado <em>respuestas</em>.</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="#cb551-1" aria-hidden="true"></a>empresas=<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>), <span class="dt">times=</span><span class="kw">c</span>(<span class="dv">30</span>,<span class="dv">20</span>,<span class="dv">50</span>))</span>
<span id="cb551-2"><a href="#cb551-2" aria-hidden="true"></a>df_encuesta=<span class="kw">data.frame</span>(empresas,respuestas)</span>
<span id="cb551-3"><a href="#cb551-3" aria-hidden="true"></a><span class="kw">str</span>(df_encuesta)</span>
<span id="cb551-4"><a href="#cb551-4" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    100 obs. of  2 variables:</span></span>
<span id="cb551-5"><a href="#cb551-5" aria-hidden="true"></a><span class="co">#&gt;  $ empresas  : chr  &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; ...</span></span>
<span id="cb551-6"><a href="#cb551-6" aria-hidden="true"></a><span class="co">#&gt;  $ respuestas: Ord.factor w/ 5 levels &quot;1&quot;&lt;&quot;2&quot;&lt;&quot;3&quot;&lt;&quot;4&quot;&lt;..: 4 4 2 1 3 3 4 1 1 3 ...</span></span>
<span id="cb551-7"><a href="#cb551-7" aria-hidden="true"></a><span class="kw">head</span>(df_encuesta,<span class="dv">5</span>)</span>
<span id="cb551-8"><a href="#cb551-8" aria-hidden="true"></a><span class="co">#&gt;   empresas respuestas</span></span>
<span id="cb551-9"><a href="#cb551-9" aria-hidden="true"></a><span class="co">#&gt; 1        A          4</span></span>
<span id="cb551-10"><a href="#cb551-10" aria-hidden="true"></a><span class="co">#&gt; 2        A          4</span></span>
<span id="cb551-11"><a href="#cb551-11" aria-hidden="true"></a><span class="co">#&gt; 3        A          2</span></span>
<span id="cb551-12"><a href="#cb551-12" aria-hidden="true"></a><span class="co">#&gt; 4        A          1</span></span>
<span id="cb551-13"><a href="#cb551-13" aria-hidden="true"></a><span class="co">#&gt; 5        A          3</span></span>
<span id="cb551-14"><a href="#cb551-14" aria-hidden="true"></a><span class="kw">table</span>(df_encuesta)</span>
<span id="cb551-15"><a href="#cb551-15" aria-hidden="true"></a><span class="co">#&gt;         respuestas</span></span>
<span id="cb551-16"><a href="#cb551-16" aria-hidden="true"></a><span class="co">#&gt; empresas  1  2  3  4  5</span></span>
<span id="cb551-17"><a href="#cb551-17" aria-hidden="true"></a><span class="co">#&gt;        A  9  9  4  5  3</span></span>
<span id="cb551-18"><a href="#cb551-18" aria-hidden="true"></a><span class="co">#&gt;        B  3  5  7  4  1</span></span>
<span id="cb551-19"><a href="#cb551-19" aria-hidden="true"></a><span class="co">#&gt;        C 12  8 13 11  6</span></span></code></pre></div>
<p>Para calcular la tabla de frecuencias absolutas acumuladas de las respuestas por empresa, y como las empresas definen las filas de la tabla anterior, hemos de usar <code>apply</code> con <code>MARGIN=1</code>.</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="#cb552-1" aria-hidden="true"></a><span class="kw">apply</span>(<span class="kw">table</span>(df_encuesta), <span class="dt">MARGIN=</span><span class="dv">1</span>, <span class="dt">FUN=</span>cumsum)</span>
<span id="cb552-2"><a href="#cb552-2" aria-hidden="true"></a><span class="co">#&gt;           empresas</span></span>
<span id="cb552-3"><a href="#cb552-3" aria-hidden="true"></a><span class="co">#&gt; respuestas  A  B  C</span></span>
<span id="cb552-4"><a href="#cb552-4" aria-hidden="true"></a><span class="co">#&gt;          1  9  3 12</span></span>
<span id="cb552-5"><a href="#cb552-5" aria-hidden="true"></a><span class="co">#&gt;          2 18  8 20</span></span>
<span id="cb552-6"><a href="#cb552-6" aria-hidden="true"></a><span class="co">#&gt;          3 22 15 33</span></span>
<span id="cb552-7"><a href="#cb552-7" aria-hidden="true"></a><span class="co">#&gt;          4 27 19 44</span></span>
<span id="cb552-8"><a href="#cb552-8" aria-hidden="true"></a><span class="co">#&gt;          5 30 20 50</span></span></code></pre></div>
<p>¡La tabla se ha traspuesto!
Resulta que cuando se aplica <code>apply</code> a una <code>table</code> bidimensional, R intercambia, si es necesario, filas por columnas en el resultado para que la dimensión de la tabla resultante en la que se haya aplicado la función sea la de las columnas. Por lo tanto, para volver a tener las empresas en las filas, hemos de trasponer el resultado de <code>apply</code>.</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="#cb553-1" aria-hidden="true"></a><span class="kw">t</span>(<span class="kw">apply</span>(<span class="kw">table</span>(df_encuesta), <span class="dt">MARGIN=</span><span class="dv">1</span>, <span class="dt">FUN=</span>cumsum))</span>
<span id="cb553-2"><a href="#cb553-2" aria-hidden="true"></a><span class="co">#&gt;         respuestas</span></span>
<span id="cb553-3"><a href="#cb553-3" aria-hidden="true"></a><span class="co">#&gt; empresas  1  2  3  4  5</span></span>
<span id="cb553-4"><a href="#cb553-4" aria-hidden="true"></a><span class="co">#&gt;        A  9 18 22 27 30</span></span>
<span id="cb553-5"><a href="#cb553-5" aria-hidden="true"></a><span class="co">#&gt;        B  3  8 15 19 20</span></span>
<span id="cb553-6"><a href="#cb553-6" aria-hidden="true"></a><span class="co">#&gt;        C 12 20 33 44 50</span></span></code></pre></div>
<p>Vamos ahora a calcular la tabla de frecuencias relativas acumuladas de las respuestas por empresa. Para ello, y en una sola instrucción, primero calculamos la tabla de frecuencias relativas por filas; a continuación, las acumulamos por filas con <code>apply</code> y <code>cumsum</code>; y, finalmente, como ya estamos avisados, trasponemos el resultado. Además, redondearemos el resultado a 3 cifras decimales.</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="#cb554-1" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">t</span>(<span class="kw">apply</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(df_encuesta), <span class="dt">margin=</span><span class="dv">1</span>), <span class="dt">MARGIN=</span><span class="dv">1</span>, <span class="dt">FUN=</span>cumsum)),<span class="dv">3</span>)</span>
<span id="cb554-2"><a href="#cb554-2" aria-hidden="true"></a><span class="co">#&gt;         respuestas</span></span>
<span id="cb554-3"><a href="#cb554-3" aria-hidden="true"></a><span class="co">#&gt; empresas    1   2     3    4 5</span></span>
<span id="cb554-4"><a href="#cb554-4" aria-hidden="true"></a><span class="co">#&gt;        A 0.30 0.6 0.733 0.90 1</span></span>
<span id="cb554-5"><a href="#cb554-5" aria-hidden="true"></a><span class="co">#&gt;        B 0.15 0.4 0.750 0.95 1</span></span>
<span id="cb554-6"><a href="#cb554-6" aria-hidden="true"></a><span class="co">#&gt;        C 0.24 0.4 0.660 0.88 1</span></span></code></pre></div>
<p>Vamos ahora a dibujar el diagrama de barras por bloques de esta tabla. Como queremos que las barras de este diagrama se agrupen por empresas, hemos de aplicar <code>barplot</code> a la tabla sin trasponer.</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="#cb555-1" aria-hidden="true"></a>Tabla=<span class="kw">apply</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(df_encuesta), <span class="dt">margin=</span><span class="dv">1</span>), <span class="dt">MARGIN=</span><span class="dv">1</span>,<span class="dt">FUN=</span>cumsum)</span>
<span id="cb555-2"><a href="#cb555-2" aria-hidden="true"></a><span class="kw">barplot</span>(Tabla, <span class="dt">beside=</span><span class="ot">TRUE</span>, <span class="dt">legend=</span><span class="ot">TRUE</span>,</span>
<span id="cb555-3"><a href="#cb555-3" aria-hidden="true"></a>        <span class="dt">main=</span><span class="st">&quot;Diagrama de barras de frecuencias relativas acumuladas</span><span class="ch">\n</span><span class="st"> de respuestas por empresa&quot;</span>)</span></code></pre></div>
<p><img src="11chap11_Descripcion_ordinales_files/figure-html/unnamed-chunk-27-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Como vemos, la leyenda se superpone sobre las barras de la última empresa. Para resolver este problema, situaremos la leyenda en la esquina superior izquierda. Además, vamos a sustituir en la leyenda los valores de las respuestas por sus significados, y para que quepa, reduciremos el tamaño del texto.</p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="#cb556-1" aria-hidden="true"></a><span class="kw">barplot</span>(Tabla, <span class="dt">beside=</span><span class="ot">TRUE</span>, </span>
<span id="cb556-2"><a href="#cb556-2" aria-hidden="true"></a>        <span class="dt">legend.text=</span><span class="kw">c</span>(<span class="st">&quot;Muy en desacuerdo&quot;</span>, <span class="st">&quot;En desacuerdo&quot;</span>,<span class="st">&quot;Neutro&quot;</span>,<span class="st">&quot;De acuerdo&quot;</span>,<span class="st">&quot;Muy de acuerdo&quot;</span>), </span>
<span id="cb556-3"><a href="#cb556-3" aria-hidden="true"></a>        <span class="dt">main=</span><span class="st">&quot;Diagrama de barras de frecuencias relativas acumuladas</span><span class="ch">\n</span><span class="st"> de respuestas por empresa&quot;</span>,</span>
<span id="cb556-4"><a href="#cb556-4" aria-hidden="true"></a>        <span class="dt">args.legend=</span><span class="kw">list</span>(<span class="dt">x=</span><span class="st">&quot;topleft&quot;</span>, <span class="dt">cex=</span><span class="fl">0.45</span>))</span></code></pre></div>
<p><img src="11chap11_Descripcion_ordinales_files/figure-html/unnamed-chunk-28-1.png" width="90%" style="display: block; margin: auto;" /></p>
<!--
\end{ejemplo}

\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.45\textwidth]{figenc1}\
\includegraphics[width=0.45\textwidth]{figenc2}
\end{center}
\caption{Diagramas de barras  de frecuencias relativas acumuladas de respuestas por empresa en el Ejemplo \@ref(ex:encuestacum).}\label(fig:acumenc)
\end{figure}
-->

<div class="example">
<p><span id="exm:sprayord" class="example"><strong>(#exm:sprayord) </strong></span>Consideremos el <em>data frame</em> <code>InsectSprays</code>, que viene predefinido en R. Veamos su estructura.</p>
</div>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="#cb557-1" aria-hidden="true"></a><span class="kw">head</span>(InsectSprays)</span>
<span id="cb557-2"><a href="#cb557-2" aria-hidden="true"></a><span class="co">#&gt;   count spray</span></span>
<span id="cb557-3"><a href="#cb557-3" aria-hidden="true"></a><span class="co">#&gt; 1    10     A</span></span>
<span id="cb557-4"><a href="#cb557-4" aria-hidden="true"></a><span class="co">#&gt; 2     7     A</span></span>
<span id="cb557-5"><a href="#cb557-5" aria-hidden="true"></a><span class="co">#&gt; 3    20     A</span></span>
<span id="cb557-6"><a href="#cb557-6" aria-hidden="true"></a><span class="co">#&gt; 4    14     A</span></span>
<span id="cb557-7"><a href="#cb557-7" aria-hidden="true"></a><span class="co">#&gt; 5    14     A</span></span>
<span id="cb557-8"><a href="#cb557-8" aria-hidden="true"></a><span class="co">#&gt; 6    12     A</span></span>
<span id="cb557-9"><a href="#cb557-9" aria-hidden="true"></a><span class="kw">str</span>(InsectSprays)</span>
<span id="cb557-10"><a href="#cb557-10" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    72 obs. of  2 variables:</span></span>
<span id="cb557-11"><a href="#cb557-11" aria-hidden="true"></a><span class="co">#&gt;  $ count: num  10 7 20 14 14 12 10 23 17 20 ...</span></span>
<span id="cb557-12"><a href="#cb557-12" aria-hidden="true"></a><span class="co">#&gt;  $ spray: Factor w/ 6 levels &quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</span></span></code></pre></div>
<p>Consultando la Ayuda de <code>InsectSprays</code> nos enteramos de que la variable numérica <code>count</code> contiene los números de insectos que se encontraron en diferentes superficies agrícolas, todas de la misma área, tratadas con el insecticida indicado por el factor <code>spray</code>.</p>
<p>En primer lugar, vamos a convertir la variable <code>count</code> en una variable ordinal que agrupe las entradas de la variable original en los niveles siguientes: “<em>Entre 0 y 4</em>”, “<em>Entre 5 y 9</em>”, “<em>Entre 10 y 14</em>”, “<em>Entre 15 y 19</em>” y “<em>20 o más</em>”. La manera más sencilla de llevarlo a cabo es usando la función <code>cut</code>, que estudiaremos en detalle en la Lección @ref(chap:cut). Por ahora es suficiente saber que la instrucción</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="#cb558-1" aria-hidden="true"></a><span class="kw">cut</span>(InsectSprays<span class="op">$</span>count, <span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="ot">Inf</span>), <span class="dt">right=</span><span class="ot">FALSE</span>,</span>
<span id="cb558-2"><a href="#cb558-2" aria-hidden="true"></a>    <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;0-4&quot;</span>,<span class="st">&quot;5-9&quot;</span>,<span class="st">&quot;10-14&quot;</span>,<span class="st">&quot;15-19&quot;</span>,<span class="st">&quot;20-...&quot;</span>))</span></code></pre></div>
<p>“cortará” el vector numérico <code>InsectSprays$count</code> en intervalos de extremos los puntos especificados en el argumento <code>breaks</code>, donde <code>Inf</code> indica <span class="math inline">\(\infty\)</span>, y el parámetro <code>right=FALSE</code> indica que los puntos de corte pertenecen al intervalo a su derecha, formando por lo tanto intervalos cerrados a la izquierda. Así pues, los intervalos en los que esta instrucción clasifica los números de insectos son</p>
<p><span class="math display">\[
[0,5), [5,10), [10,15), [15,20), [20,\infty).
\]</span>
El resultado de la instrucción es un factor no ordenado que tiene como niveles estos intervalos, identificados por medio de las etiquetas especificadas con el parámetro <code>labels</code> (es decir, respectivamente, <code>0-4</code>, <code>5-9</code>, <code>10-14</code>, <code>15-19</code> y <code>20-...</code>) y donde cada entrada de <code>InsectSprays$count</code> ha sido substituida por la etiqueta correspondiente al intervalo al que pertenece. A modo de ejemplo, comparemos las primeras 10 entradas de <code>InsectSprays$count</code> con las primeras 10 entradas del resultado de esta función <code>cut</code>:</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="#cb559-1" aria-hidden="true"></a>InsectSprays<span class="op">$</span>count[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</span>
<span id="cb559-2"><a href="#cb559-2" aria-hidden="true"></a><span class="co">#&gt;  [1] 10  7 20 14 14 12 10 23 17 20</span></span>
<span id="cb559-3"><a href="#cb559-3" aria-hidden="true"></a><span class="kw">cut</span>(InsectSprays<span class="op">$</span>count, <span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="ot">Inf</span>), <span class="dt">right=</span><span class="ot">FALSE</span>,</span>
<span id="cb559-4"><a href="#cb559-4" aria-hidden="true"></a>    <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;0-4&quot;</span>,<span class="st">&quot;5-9&quot;</span>,<span class="st">&quot;10-14&quot;</span>,<span class="st">&quot;15-19&quot;</span>,<span class="st">&quot;20-...&quot;</span>))[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</span>
<span id="cb559-5"><a href="#cb559-5" aria-hidden="true"></a><span class="co">#&gt;  [1] 10-14  5-9    20-... 10-14  10-14  10-14  10-14  20-... 15-19  20-...</span></span>
<span id="cb559-6"><a href="#cb559-6" aria-hidden="true"></a><span class="co">#&gt; Levels: 0-4 5-9 10-14 15-19 20-...</span></span></code></pre></div>
<p>Como nosotros vamos a usar estos intervalos como niveles de una variable ordinal, tenemos que convertir el factor resultante en ordenado. Vamos a añadir este factor ordenado como una nueva variable a una copia de <code>InsectSprays</code>.</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="#cb560-1" aria-hidden="true"></a>IS=InsectSprays</span>
<span id="cb560-2"><a href="#cb560-2" aria-hidden="true"></a>IS<span class="op">$</span>count.rank=<span class="kw">ordered</span>(<span class="kw">cut</span>(IS<span class="op">$</span>count,<span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="ot">Inf</span>),</span>
<span id="cb560-3"><a href="#cb560-3" aria-hidden="true"></a>  <span class="dt">right=</span><span class="ot">FALSE</span>, <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;0-4&quot;</span>,<span class="st">&quot;5-9&quot;</span>,<span class="st">&quot;10-14&quot;</span>,<span class="st">&quot;15-19&quot;</span>,<span class="st">&quot;20-...&quot;</span>)))</span>
<span id="cb560-4"><a href="#cb560-4" aria-hidden="true"></a><span class="kw">str</span>(IS)</span>
<span id="cb560-5"><a href="#cb560-5" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    72 obs. of  3 variables:</span></span>
<span id="cb560-6"><a href="#cb560-6" aria-hidden="true"></a><span class="co">#&gt;  $ count     : num  10 7 20 14 14 12 10 23 17 20 ...</span></span>
<span id="cb560-7"><a href="#cb560-7" aria-hidden="true"></a><span class="co">#&gt;  $ spray     : Factor w/ 6 levels &quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb560-8"><a href="#cb560-8" aria-hidden="true"></a><span class="co">#&gt;  $ count.rank: Ord.factor w/ 5 levels &quot;0-4&quot;&lt;&quot;5-9&quot;&lt;&quot;10-14&quot;&lt;..: 3 2 5 3 3 3 3 5 4 5 ...</span></span>
<span id="cb560-9"><a href="#cb560-9" aria-hidden="true"></a><span class="kw">head</span>(IS)</span>
<span id="cb560-10"><a href="#cb560-10" aria-hidden="true"></a><span class="co">#&gt;   count spray count.rank</span></span>
<span id="cb560-11"><a href="#cb560-11" aria-hidden="true"></a><span class="co">#&gt; 1    10     A      10-14</span></span>
<span id="cb560-12"><a href="#cb560-12" aria-hidden="true"></a><span class="co">#&gt; 2     7     A        5-9</span></span>
<span id="cb560-13"><a href="#cb560-13" aria-hidden="true"></a><span class="co">#&gt; 3    20     A     20-...</span></span>
<span id="cb560-14"><a href="#cb560-14" aria-hidden="true"></a><span class="co">#&gt; 4    14     A      10-14</span></span>
<span id="cb560-15"><a href="#cb560-15" aria-hidden="true"></a><span class="co">#&gt; 5    14     A      10-14</span></span>
<span id="cb560-16"><a href="#cb560-16" aria-hidden="true"></a><span class="co">#&gt; 6    12     A      10-14</span></span></code></pre></div>
<p>Nos interesa estudiar la distribución de los números de insectos según el tipo de insecticida. Por lo tanto, vamos a calcular las tablas bidimensionales de frecuencias relativas y relativas acumuladas de los intervalos de números de insectos en cada nivel de <code>Spray</code>, y las representaremos por medio de diagramas de barras.</p>
<p>La tabla de frecuencias absolutas de los pares (insecticida, intervalo de números de insectos) se puede obtener aplicando <code>table</code> al <em>data frame</em> formado por las dos últimas columnas de <code>IS</code>.</p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="#cb561-1" aria-hidden="true"></a>Tab=<span class="kw">table</span>(IS[,<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>])</span>
<span id="cb561-2"><a href="#cb561-2" aria-hidden="true"></a>Tab</span>
<span id="cb561-3"><a href="#cb561-3" aria-hidden="true"></a><span class="co">#&gt;      count.rank</span></span>
<span id="cb561-4"><a href="#cb561-4" aria-hidden="true"></a><span class="co">#&gt; spray 0-4 5-9 10-14 15-19 20-...</span></span>
<span id="cb561-5"><a href="#cb561-5" aria-hidden="true"></a><span class="co">#&gt;     A   0   1     7     1      3</span></span>
<span id="cb561-6"><a href="#cb561-6" aria-hidden="true"></a><span class="co">#&gt;     B   0   1     4     5      2</span></span>
<span id="cb561-7"><a href="#cb561-7" aria-hidden="true"></a><span class="co">#&gt;     C  11   1     0     0      0</span></span>
<span id="cb561-8"><a href="#cb561-8" aria-hidden="true"></a><span class="co">#&gt;     D   5   6     1     0      0</span></span>
<span id="cb561-9"><a href="#cb561-9" aria-hidden="true"></a><span class="co">#&gt;     E   8   4     0     0      0</span></span>
<span id="cb561-10"><a href="#cb561-10" aria-hidden="true"></a><span class="co">#&gt;     F   0   1     4     3      4</span></span></code></pre></div>
<p>La tabla bidimensional de frecuencias relativas de los intervalos de números de insectos en cada nivel de <code>Spray</code> es la siguiente:</p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="#cb562-1" aria-hidden="true"></a>Freq.rel=<span class="kw">round</span>(<span class="kw">prop.table</span>(Tab, <span class="dt">margin=</span><span class="dv">1</span>), <span class="dv">3</span>)</span>
<span id="cb562-2"><a href="#cb562-2" aria-hidden="true"></a>Freq.rel</span>
<span id="cb562-3"><a href="#cb562-3" aria-hidden="true"></a><span class="co">#&gt;      count.rank</span></span>
<span id="cb562-4"><a href="#cb562-4" aria-hidden="true"></a><span class="co">#&gt; spray   0-4   5-9 10-14 15-19 20-...</span></span>
<span id="cb562-5"><a href="#cb562-5" aria-hidden="true"></a><span class="co">#&gt;     A 0.000 0.083 0.583 0.083  0.250</span></span>
<span id="cb562-6"><a href="#cb562-6" aria-hidden="true"></a><span class="co">#&gt;     B 0.000 0.083 0.333 0.417  0.167</span></span>
<span id="cb562-7"><a href="#cb562-7" aria-hidden="true"></a><span class="co">#&gt;     C 0.917 0.083 0.000 0.000  0.000</span></span>
<span id="cb562-8"><a href="#cb562-8" aria-hidden="true"></a><span class="co">#&gt;     D 0.417 0.500 0.083 0.000  0.000</span></span>
<span id="cb562-9"><a href="#cb562-9" aria-hidden="true"></a><span class="co">#&gt;     E 0.667 0.333 0.000 0.000  0.000</span></span>
<span id="cb562-10"><a href="#cb562-10" aria-hidden="true"></a><span class="co">#&gt;     F 0.000 0.083 0.333 0.250  0.333</span></span></code></pre></div>
<p>y la correspondiente tabla de frecuencias relativas acumuladas (ya traspuesta) es:</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="#cb563-1" aria-hidden="true"></a>Freq.rel.acum=<span class="kw">round</span>(<span class="kw">apply</span>(<span class="kw">prop.table</span>(Tab, <span class="dt">margin=</span><span class="dv">1</span>), <span class="dt">MARGIN=</span><span class="dv">1</span>, <span class="dt">FUN=</span>cumsum), <span class="dv">3</span>)</span>
<span id="cb563-2"><a href="#cb563-2" aria-hidden="true"></a><span class="kw">t</span>(Freq.rel.acum)</span>
<span id="cb563-3"><a href="#cb563-3" aria-hidden="true"></a><span class="co">#&gt;      count.rank</span></span>
<span id="cb563-4"><a href="#cb563-4" aria-hidden="true"></a><span class="co">#&gt; spray   0-4   5-9 10-14 15-19 20-...</span></span>
<span id="cb563-5"><a href="#cb563-5" aria-hidden="true"></a><span class="co">#&gt;     A 0.000 0.083 0.667 0.750      1</span></span>
<span id="cb563-6"><a href="#cb563-6" aria-hidden="true"></a><span class="co">#&gt;     B 0.000 0.083 0.417 0.833      1</span></span>
<span id="cb563-7"><a href="#cb563-7" aria-hidden="true"></a><span class="co">#&gt;     C 0.917 1.000 1.000 1.000      1</span></span>
<span id="cb563-8"><a href="#cb563-8" aria-hidden="true"></a><span class="co">#&gt;     D 0.417 0.917 1.000 1.000      1</span></span>
<span id="cb563-9"><a href="#cb563-9" aria-hidden="true"></a><span class="co">#&gt;     E 0.667 1.000 1.000 1.000      1</span></span>
<span id="cb563-10"><a href="#cb563-10" aria-hidden="true"></a><span class="co">#&gt;     F 0.000 0.083 0.417 0.667      1</span></span></code></pre></div>
<p>Los dos diagramas de barras que no interesan son los siguientes:</p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="#cb564-1" aria-hidden="true"></a>cyan.col=<span class="kw">c</span>(<span class="st">&quot;cyan4&quot;</span>,<span class="st">&quot;cyan3&quot;</span>,<span class="st">&quot;cyan2&quot;</span>,<span class="st">&quot;cyan1&quot;</span>,<span class="st">&quot;cyan&quot;</span>) <span class="co">#Colores azulones para las barras</span></span>
<span id="cb564-2"><a href="#cb564-2" aria-hidden="true"></a><span class="kw">barplot</span>(<span class="kw">t</span>(Freq.rel), <span class="dt">beside=</span><span class="ot">TRUE</span>, <span class="dt">legend=</span><span class="ot">TRUE</span>,  <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">col=</span>cyan.col, </span>
<span id="cb564-3"><a href="#cb564-3" aria-hidden="true"></a>  <span class="dt">main=</span><span class="st">&quot;Diagrama de barras de frecuencias relativas</span><span class="ch">\n</span><span class="st"> de números de insectos por insecticida&quot;</span>)</span></code></pre></div>
<p><img src="11chap11_Descripcion_ordinales_files/figure-html/unnamed-chunk-36-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="#cb565-1" aria-hidden="true"></a><span class="kw">barplot</span>(Freq.rel.acum, <span class="dt">beside=</span><span class="ot">TRUE</span>, <span class="dt">legend=</span><span class="ot">TRUE</span>,<span class="dt">col=</span>cyan.col, </span>
<span id="cb565-2"><a href="#cb565-2" aria-hidden="true"></a>  <span class="dt">main=</span><span class="st">&quot;Diagrama de barras de frecuencias relativas acumuladas</span><span class="ch">\n</span><span class="st"> de números de insectos por insecticida&quot;</span>, </span>
<span id="cb565-3"><a href="#cb565-3" aria-hidden="true"></a>  <span class="dt">args.legend=</span><span class="kw">list</span>(<span class="dt">x=</span><span class="st">&quot;topleft&quot;</span>,<span class="dt">cex=</span><span class="fl">0.55</span>))</span></code></pre></div>
<p><img src="11chap11_Descripcion_ordinales_files/figure-html/unnamed-chunk-37-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Observamos que los insecticidas C, D y E son los más efectivos, porque producen mayores números de campos con pocos insectos, mientras que B y F son poco efectivos.</p>
<!--
\begin{figure}[htb]
\begin{center}
\includegraphics[width=0.45\textwidth]{Insect1}\
\includegraphics[width=0.45\textwidth]{Insect2}
\end{center}
\caption{Diagramas de barras de frecuencias relativas y relativas acumuladas de números de insectos por tipo de insecticida en el *data frame* `InsectSprays`.}\label{fig:ISacum}
\end{figure}

\end{ejemplo}
-->
</div>
<div id="guía-rápida-de-funciones-5" class="section level2" number="11.3">
<h2 number="11.3"><span class="header-section-number">11.3</span> Guía rápida de funciones</h2>
<ul>
<li><p><code>ordered</code> sirve para construir factores ordenados. Sus parámetros principales se pueden consultar en la guía de la Lección @ref(chap:vect).</p></li>
<li><p><code>table</code> calcula la tabla de frecuencias absolutas de un vector o un factor.</p></li>
<li><p><code>t</code> sirve para trasponer una tabla bidimensional.</p></li>
<li><p><code>prop.table</code> calcula la tabla de frecuencias relativas de un vector o un factor a partir de su tabla de frecuencias absolutas. Sus parámetros principales se pueden consultar en la guía de la Lección @ref(chap:edqual).</p></li>
<li><p><code>cumsum</code> calcula las sumas acumuladas de un vector.</p></li>
<li><p><code>apply(tabla, MARGIN=..., FUN=función)</code> aplica la <code>función</code> a
los niveles de las variables de la <code>tabla</code> que se especifican en <code>MARGIN</code>. Para calcular frecuencias acumuladas en tablas multidimensionales, se usa <code>FUN=cumsum</code>.</p></li>
<li><p><code>barplot</code> dibuja el diagrama de barras de un vector o un factor a partir de una tabla de frecuencias. Sus parámetros principales se pueden consultar en la guía de la Lección @ref(chap:edqual).</p></li>
</ul>
</div>
<div id="ejercicios-9" class="section level2" number="11.4">
<h2 number="11.4"><span class="header-section-number">11.4</span> Ejercicios</h2>
<div id="test-8" class="section level3 unnumbered">
<h3 class="unnumbered">Test</h3>
<p><em>(1)</em> Dad una instrucción que defina la tabla de frecuencias absolutas acumuladas de un vector llamado <code>flores</code>.</p>
<p><em>(2)</em> Dad una instrucción que defina la tabla de frecuencias relativas acumuladas de un vector llamado <code>flores</code> usando la función <code>prop.table</code>.</p>
<p><em>(3)</em> Considerad el vector que forma el fichero <a href="http://bioinfo.uib.es/~recerca/RMOOC/datostest9.txt">http://bioinfo.uib.es/~recerca/RMOOC/datostest9.txt</a> como una variable ordinal de niveles 1, 2, 3, … , 9, ordenados con su orden creciente natural. ¿Cuál es la frecuencia relativa acumulada de 6 en esta variable, redondeada a 3 cifras decimales? Dad su valor, no cómo lo habeis calculado.</p>
<p><em>(4)</em> Considerad la tabla de datos del <em>url</em> <a href="http://bioinfo.uib.es/~recerca/RMOOC/Felizdata.txt">http://bioinfo.uib.es/~recerca/RMOOC/Felizdata.txt</a>. Considerad su variable <code>nivel.feliz</code> como una variable ordinal con niveles ordenados <code>Infeliz</code> &lt; <code>Poco.feliz</code> &lt; <code>Feliz</code> &lt; <code>Muy.Feliz</code>. ¿Cuál es la frecuencia relativa acumulada del nivel <code>Feliz</code> entre los estudiantes de 2<sup>o</sup> curso, redondeada a 3 cifras decimales? Dad su valor, no cómo lo habeis calculado.</p>
</div>
<div id="ejercicio-8" class="section level3 unnumbered">
<h3 class="unnumbered">Ejercicio</h3>
<p>La tabla de datos que encontraréis en el <em>url</em> <a href="http://aprender.uib.es/Rdir/Notas2011A.txt">http://aprender.uib.es/Rdir/Notas2011A.txt</a> contiene las notas obtenidas por los estudiantes de los grados de Biología y Bioquímica de la UIB en un examen de la asignatura Matemáticas I del curso 2011-12 (no aparecen los no presentados, por lo que no hay valores <code>NA</code>). Las variables que contiene la tabla para cada estudiante son: su nota numérica (sobre 10), su calificación alfabética (S significa Suspenso, A, Aprobado, N Notable, y E, Sobresaliente) y su grupo (BLM para el grupo de las mañanas de Biología, BLT para el grupo de las tardes de Biología y BQ para Bioquímica).</p>
<p><em>(a)</em> Definid un <em>data frame</em> con esta tabla, de manera que su variable <code>NotasLetra</code> sea un factor ordenado, con las calificaciones alfabéticas ordenadas según su orden natural S &lt; A &lt; N &lt; E. Comprobad con <code>str</code> y <code>head</code> que el <em>data frame</em> obtenido tiene la estructura deseada.</p>
<p><em>(b)</em> Comprobad que las notas alfabéticas se corresponden con las notas numéricas: [0,5) corresponde a S; [5,7), a A; [7,9), a N; y [9,10], a E. Si hay algún error, corregid la nota alfabética.</p>
<p><em>(c)</em> Calculad la tabla bidimensional de frecuencias relativas de las calificaciones alfabéticas por grupo, con las frecuencias relativas calculadas dentro de los grupos. Redondead las frecuencias a 2 cifras decimales. Los grupos tienen que definir las filas, y las notas, las columnas.</p>
<p><em>(d)</em> Calculad la tabla bidimensional de frecuencias relativas acumuladas de las calificaciones alfabéticas por grupo, con las frecuencias relativas calculadas dentro de los grupos. Redondead a 2 cifras decimales. Los grupos tienen que definir las filas, y las notas, las columnas.</p>
<p><em>(e)</em> Dibujad un diagrama de barras por bloques de las frecuencias relativas
de las calificaciones alfabéticas dentro de cada grupo: los bloques han de corresponder a los grupos. Poned un título al gráfico y añadid una leyenda que explique cada barra qué calificación representa. Podéis poner colores, cambiar los nombres, etc. para mejorar su aspecto.</p>
<p><em>(f)</em> Dibujad un diagrama de barras por bloques de las frecuencias relativas acumuladas de las calificaciones alfabéticas dentro de cada grupo: los bloques han de corresponder a los grupos. Como antes, poned un título al gráfico y añadid una leyenda que explique cada barra qué calificación representa. Podéis poner colores, cambiar los nombres, etc. para mejorar su aspecto.</p>
<p><em>(g)</em> ¿Podéis extraer alguna conclusión de las tablas y los gráficos anteriores?</p>
</div>
<div id="respuestas-al-test-8" class="section level3 unnumbered">
<h3 class="unnumbered">Respuestas al test</h3>
<p><em>(1)</em> <code>cumsum(table(flors))</code></p>
<p><em>(2)</em> <code>cumsum(prop.table(table(flors)))</code></p>
<p><em>(3)</em> 0.397</p>
<p><em>(4)</em> 0.763</p>
<!--chapter:end:11chap11_Descripcion_ordinales.Rmd-->
</div>
</div>
</div>
<div id="chap:quan" class="section level1" number="12">
<h1 number="12"><span class="header-section-number">12</span> Descripción de datos cuantitativos</h1>
<p>Los <strong>datos cuantitativos</strong> son los que expresan cantidades que se representan mediante números, tales como los resultados de contar objetos o individuos o de medir pesos, distancias, tiempos o concentraciones, y se suelen clasificar en continuos y discretos.
Los <strong>datos continuos</strong> son los que, si pudiéramos medirlos con precisión infinita, en principio podrían tomar todos los valores de un intervalo de la recta real: por ejemplo, el peso o la altura de un individuo o el tiempo que tarda un determinado proceso.
En cambio, los <strong>datos discretos</strong> son los que pueden tomar solo un conjunto contable de valores: el resultado obtenido al lanzar un dado, el número de individuos en una población, el número de aminoácidos en una proteína… En todo caso, hay que tener en cuenta que esta distinción es solo teórica: en la práctica, todos los datos son discretos, ya que la precisión infinita no existe. Pero a veces es conveniente suponer que unos datos son continuos para poder usar técnicas específicas en su análisis.</p>
<p>Para estudiar una <strong>variable cuantitativa</strong> (un vector de datos cuantitativos), podemos usar las frecuencias y las frecuencias acumuladas de sus diferentes valores,
como en las variables ordinales, puesto que podemos ordenar los datos cuantitativos con el orden natural de los números reales. Pero además de las frecuencias, disponemos de otras muchas técnicas descriptivas, ya que, como los datos cuantitativos son números reales y tienen el significado de números reales, podemos operar con ellos.</p>
<p>Los datos cuantitativos admiten dos tipos de tratamiento, según trabajemos con los datos originales o <strong>brutos</strong> (<em>raw data</em>) o los agrupemos en clases o intervalos (recordad el Ejemplo @ref(exm:sprayord)). En esta lección vamos a tratar solo la primera situación, y en la Lección @ref(chap:cut) estudiaremos la descripción de datos agrupados.</p>
<div id="sec:quan" class="section level2" number="12.1">
<h2 number="12.1"><span class="header-section-number">12.1</span> Frecuencias</h2>
<p>El tratamiento de las frecuencias de datos cuantitativos es similar al de los datos ordinales, excepto por un detalle: no se tienen en cuenta todos los niveles posibles, sino solo los observados.</p>

<div class="example">
<p><span id="exm:ex181" class="example"><strong>(#exm:ex181) </strong></span>Hemos pedido las edades a un grupo de 15 voluntarios de una ONG. Las respuestas, en años, han sido las siguientes:</p>
</div>
<p style="text-align:center">
18, 22, 16, 19, 23, 18, 35, 16, 45, 20, 20, 22, 40, 18, 45.
</p>
<p>Las diferentes edades que hemos observado son 16, 18, 19, 20, 22, 23, 35, 40 y 45, y por lo tanto solo nos interesan las frecuencias de estas edades. Las podemos calcular con R y así, de paso, recordaremos cómo se hace.</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="#cb566-1" aria-hidden="true"></a>edades=<span class="kw">c</span>(<span class="dv">18</span>,<span class="dv">22</span>,<span class="dv">16</span>,<span class="dv">19</span>,<span class="dv">23</span>,<span class="dv">18</span>,<span class="dv">35</span>,<span class="dv">16</span>,<span class="dv">45</span>,<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">22</span>,<span class="dv">40</span>,<span class="dv">18</span>,<span class="dv">45</span>)</span></code></pre></div>
<ul>
<li>Tabla de frecuencias absolutas:</li>
</ul>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="#cb567-1" aria-hidden="true"></a><span class="kw">table</span>(edades)    </span>
<span id="cb567-2"><a href="#cb567-2" aria-hidden="true"></a><span class="co">#&gt; edades</span></span>
<span id="cb567-3"><a href="#cb567-3" aria-hidden="true"></a><span class="co">#&gt; 16 18 19 20 22 23 35 40 45 </span></span>
<span id="cb567-4"><a href="#cb567-4" aria-hidden="true"></a><span class="co">#&gt;  2  3  1  2  2  1  1  1  2</span></span></code></pre></div>
<ul>
<li>Tabla de frecuencias relativas:</li>
</ul>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="#cb568-1" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(edades)), <span class="dv">2</span>) </span>
<span id="cb568-2"><a href="#cb568-2" aria-hidden="true"></a><span class="co">#&gt; edades</span></span>
<span id="cb568-3"><a href="#cb568-3" aria-hidden="true"></a><span class="co">#&gt;   16   18   19   20   22   23   35   40   45 </span></span>
<span id="cb568-4"><a href="#cb568-4" aria-hidden="true"></a><span class="co">#&gt; 0.13 0.20 0.07 0.13 0.13 0.07 0.07 0.07 0.13</span></span></code></pre></div>
<ul>
<li>Tabla de frecuencias absolutas acumuladas:</li>
</ul>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="#cb569-1" aria-hidden="true"></a><span class="kw">cumsum</span>(<span class="kw">table</span>(edades))</span>
<span id="cb569-2"><a href="#cb569-2" aria-hidden="true"></a><span class="co">#&gt; 16 18 19 20 22 23 35 40 45 </span></span>
<span id="cb569-3"><a href="#cb569-3" aria-hidden="true"></a><span class="co">#&gt;  2  5  6  8 10 11 12 13 15</span></span></code></pre></div>
<ul>
<li>Tabla de frecuencias relativas acumuladas:</li>
</ul>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="#cb570-1" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">cumsum</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(edades))), <span class="dv">2</span>)</span>
<span id="cb570-2"><a href="#cb570-2" aria-hidden="true"></a><span class="co">#&gt;   16   18   19   20   22   23   35   40   45 </span></span>
<span id="cb570-3"><a href="#cb570-3" aria-hidden="true"></a><span class="co">#&gt; 0.13 0.33 0.40 0.53 0.67 0.73 0.80 0.87 1.00</span></span></code></pre></div>
<p>Supongamos que realizamos <span class="math inline">\(n\)</span> observaciones de una propiedad que se mide con un número real, y obtenemos la lista de datos cuantitativos (la <strong>variable cuantitativa</strong>)
<span class="math display">\[
x_1, \ldots, x_n.
\]</span>
Sean <span class="math inline">\(X_1, \ldots, X_k\)</span> los valores distintos que aparecen en esta lista de datos; los consideraremos ordenados
<span class="math display">\[
X_1 &lt; X_2 &lt; \cdots &lt; X_k.
\]</span>
Entonces, en esta variable cuantitativa:</p>
<ul>
<li><p>La <strong>frecuencia absoluta</strong> de <span class="math inline">\(X_j\)</span> es el número <span class="math inline">\(n_j\)</span> de elementos que son iguales a <span class="math inline">\(X_j\)</span>.</p></li>
<li><p>La <strong>frecuencia absoluta acumulada</strong> de <span class="math inline">\(X_j\)</span> es <span class="math inline">\(\displaystyle N_j=\sum\limits_{i=1}^j n_i.\)</span></p></li>
<li><p>La <strong>frecuencia relativa</strong> de <span class="math inline">\(X_j\)</span> es <span class="math inline">\(\displaystyle f_j=\frac{n_j}{n}.\)</span></p></li>
<li><p>La <strong>frecuencia relativa acumulada</strong> de <span class="math inline">\(X_j\)</span> es
<span class="math inline">\(\displaystyle F_j=\frac{N_j}{n}=\sum\limits_{i=1}^j f_i.\)</span></p></li>
</ul>

<div class="example">
<p><span id="exm:dados" class="example"><strong>(#exm:dados) </strong></span>Lanzamos 10 veces un dado de seis caras al aire y anotamos los resultados:</p>
</div>
<p style="text-align:center">
2, 1, 4, 5, 6, 3, 5, 6, 3.
</p>
<p>En este caso, <span class="math inline">\(n=10\)</span>, y los distintos valores observados son
<span class="math display">\[
X_1=1,\ X_2=2,\ X_3=3,\ X_4=4,\ X_5=5,\ X_6=6.
\]</span>
Vamos a calcular las frecuencias de este experimento, y las organizaremos en forma de <em>data frame</em> para visualizarlas como una tabla:</p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="#cb571-1" aria-hidden="true"></a>dados=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>)</span>
<span id="cb571-2"><a href="#cb571-2" aria-hidden="true"></a><span class="kw">table</span>(dados)</span>
<span id="cb571-3"><a href="#cb571-3" aria-hidden="true"></a><span class="co">#&gt; dados</span></span>
<span id="cb571-4"><a href="#cb571-4" aria-hidden="true"></a><span class="co">#&gt; 1 2 3 4 5 6 </span></span>
<span id="cb571-5"><a href="#cb571-5" aria-hidden="true"></a><span class="co">#&gt; 2 1 2 1 2 2</span></span>
<span id="cb571-6"><a href="#cb571-6" aria-hidden="true"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(dados))</span>
<span id="cb571-7"><a href="#cb571-7" aria-hidden="true"></a><span class="co">#&gt; dados</span></span>
<span id="cb571-8"><a href="#cb571-8" aria-hidden="true"></a><span class="co">#&gt;   1   2   3   4   5   6 </span></span>
<span id="cb571-9"><a href="#cb571-9" aria-hidden="true"></a><span class="co">#&gt; 0.2 0.1 0.2 0.1 0.2 0.2</span></span>
<span id="cb571-10"><a href="#cb571-10" aria-hidden="true"></a><span class="kw">cumsum</span>(<span class="kw">table</span>(dados))</span>
<span id="cb571-11"><a href="#cb571-11" aria-hidden="true"></a><span class="co">#&gt;  1  2  3  4  5  6 </span></span>
<span id="cb571-12"><a href="#cb571-12" aria-hidden="true"></a><span class="co">#&gt;  2  3  5  6  8 10</span></span>
<span id="cb571-13"><a href="#cb571-13" aria-hidden="true"></a><span class="kw">cumsum</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(dados)))</span>
<span id="cb571-14"><a href="#cb571-14" aria-hidden="true"></a><span class="co">#&gt;   1   2   3   4   5   6 </span></span>
<span id="cb571-15"><a href="#cb571-15" aria-hidden="true"></a><span class="co">#&gt; 0.2 0.3 0.5 0.6 0.8 1.0</span></span>
<span id="cb571-16"><a href="#cb571-16" aria-hidden="true"></a>tabla_df=<span class="kw">data.frame</span>(<span class="dt">Resultado=</span><span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, </span>
<span id="cb571-17"><a href="#cb571-17" aria-hidden="true"></a>  <span class="dt">Frec_Abs=</span><span class="kw">as.vector</span>(<span class="kw">table</span>(dados)), </span>
<span id="cb571-18"><a href="#cb571-18" aria-hidden="true"></a>  <span class="dt">Frec_Rel=</span><span class="kw">as.vector</span>(<span class="kw">round</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(dados)), <span class="dv">2</span>)), </span>
<span id="cb571-19"><a href="#cb571-19" aria-hidden="true"></a>  <span class="dt">Frec_Abs_Acum=</span><span class="kw">as.vector</span>(<span class="kw">cumsum</span>(<span class="kw">table</span>(dados))), </span>
<span id="cb571-20"><a href="#cb571-20" aria-hidden="true"></a>  <span class="dt">Frec_Rel_Acum=</span><span class="kw">as.vector</span>(<span class="kw">round</span>(<span class="kw">cumsum</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(dados))), <span class="dv">2</span>)))</span>
<span id="cb571-21"><a href="#cb571-21" aria-hidden="true"></a>tabla_df</span>
<span id="cb571-22"><a href="#cb571-22" aria-hidden="true"></a><span class="co">#&gt;   Resultado Frec_Abs Frec_Rel Frec_Abs_Acum Frec_Rel_Acum</span></span>
<span id="cb571-23"><a href="#cb571-23" aria-hidden="true"></a><span class="co">#&gt; 1         1        2      0.2             2           0.2</span></span>
<span id="cb571-24"><a href="#cb571-24" aria-hidden="true"></a><span class="co">#&gt; 2         2        1      0.1             3           0.3</span></span>
<span id="cb571-25"><a href="#cb571-25" aria-hidden="true"></a><span class="co">#&gt; 3         3        2      0.2             5           0.5</span></span>
<span id="cb571-26"><a href="#cb571-26" aria-hidden="true"></a><span class="co">#&gt; 4         4        1      0.1             6           0.6</span></span>
<span id="cb571-27"><a href="#cb571-27" aria-hidden="true"></a><span class="co">#&gt; 5         5        2      0.2             8           0.8</span></span>
<span id="cb571-28"><a href="#cb571-28" aria-hidden="true"></a><span class="co">#&gt; 6         6        2      0.2            10           1.0</span></span></code></pre></div>
<p>Para entrar una tabla unidimensional como una variable en un <em>data frame</em>, es conveniente transformarla en vector con <code>as.vector</code>. De lo contrario, cada <code>table</code> y cada <code>prop.table</code> añadirían una columna extra con los nombres de los niveles. Comprobadlo.</p>
</div>
<div id="medidas-de-tendencia-central" class="section level2" number="12.2">
<h2 number="12.2"><span class="header-section-number">12.2</span> Medidas de tendencia central</h2>
<p>Las <strong>medidas de tendencia central</strong> son las que dan un valor representativo de todas las observaciones; las más importantes son:</p>
<ul>
<li><p>La <strong>moda</strong>, que es el valor, o los valores, de máxima frecuencia (absoluta o relativa, tanto da).</p></li>
<li><p>La <strong>media aritmética</strong>, o <strong>valor medio</strong>,
<span class="math display">\[
 \overline{x}=\frac{\sum_{i=1}^n x_i}{n}=\frac{\sum_{j=1}^k n_j\cdot X_j}{n}=
\sum_{j=1}^k f_j\cdot X_j.
\]</span></p></li>
<li><p>La <strong>mediana</strong>, que representa el valor central en la lista ordenada de observaciones y se define formalmente de la manera siguiente. Si denotamos por
<span class="math display">\[
x_{(1)}\leqslant x_{(2)}\leqslant\cdots \leqslant x_{(n)}
\]</span>
los datos de la variable cuantitativa ordenados de menor a mayor, la mediana es:</p>
<ul>
<li>Si <span class="math inline">\(n\)</span> es par, la media de los dos datos centrales:
<span class="math display">\[
\frac{x_{(n/2)}+x_{(n/2+1)}}{2}.
\]</span></li>
<li>Si <span class="math inline">\(n\)</span> es impar, el dato central: <span class="math inline">\(x_{(n+1)/2}\)</span>.</li>
</ul></li>
</ul>
<p>En este curso, cuando hablemos de la <em>media</em> de unos datos nos referiremos siempre a su media aritmética. Hay otros tipos de media, como por ejemplo la media geométrica o la armónica, que no estudiaremos.</p>

<div class="example">
<p><span id="exm:unnamed-chunk-7" class="example"><strong>(#exm:unnamed-chunk-7) </strong></span>En la situación del Ejemplo @ref(exm:ex181), la moda es 18 y la media es
<span class="math display">\[
\frac{18+22+16+19+23+18+35+16+45+20+20+22+40+18+45}{15}=25.1333.
\]</span>
Si ordenamos los 15 resultados, quedan de la siguiente manera:</p>
<p style="text-align:center">
16, 16, 18, 18, 18, 19, 20, 20, 22, 22, 23, 35, 40, 45, 45.
</p>
<p>Su mediana es la entrada central en esta lista, es decir, la octava: 20.</p>
</div>
<p>En la situación del Ejemplo @ref(exm:dados), la moda es, de hecho, cuatro valores: 1, 3, 5 y 6. La media es
<span class="math display">\[
\frac{1+2+1+4+5+6+3+5+6+3}{10}=3.6.
\]</span>
Como esta variable contiene 10 datos, su mediana es la media aritmética de sus dos resultados centrales (el quinto y el sexto) en la lista ordenada de resultados</p>
<p style="text-align:center">
1, 1, 2, 3, 3, 4, 5, 5, 6, 6.
</p>
<p>Por lo tanto, su mediana es <span class="math inline">\((3+4)/2=3.5\)</span>.</p>
<p>Ya explicamos cómo se calcula la moda con R en la Lección @ref(chap:edqual). La única diferencia aquí es que, como trabajamos con datos cuantitativos, es conveniente que el resultado lo demos como un número, aplicándole <code>as.numeric</code>. En cuanto a la media y la mediana, se calculan aplicando las funciones <code>mean</code> y <code>median</code>, respectivamente, al vector de datos. Así:</p>
<ul>
<li>La moda de nuestro vector de edades es:</li>
</ul>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="#cb572-1" aria-hidden="true"></a><span class="kw">as.numeric</span>(<span class="kw">names</span>(<span class="kw">which</span>(<span class="kw">table</span>(edades)<span class="op">==</span><span class="kw">max</span>(<span class="kw">table</span>(edades)))))</span>
<span id="cb572-2"><a href="#cb572-2" aria-hidden="true"></a><span class="co">#&gt; [1] 18</span></span></code></pre></div>
<ul>
<li>La media de nuestro vector de edades es:</li>
</ul>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="#cb573-1" aria-hidden="true"></a><span class="kw">mean</span>(edades)</span>
<span id="cb573-2"><a href="#cb573-2" aria-hidden="true"></a><span class="co">#&gt; [1] 25.13333</span></span></code></pre></div>
<ul>
<li>La mediana de nuestro vector de edades es:</li>
</ul>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="#cb574-1" aria-hidden="true"></a><span class="kw">median</span>(edades)</span>
<span id="cb574-2"><a href="#cb574-2" aria-hidden="true"></a><span class="co">#&gt; [1] 20</span></span></code></pre></div>
<ul>
<li>Las modas de nuestro vector de lanzamientos de dados son:</li>
</ul>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="#cb575-1" aria-hidden="true"></a><span class="kw">as.numeric</span>(<span class="kw">names</span>(<span class="kw">which</span>(<span class="kw">table</span>(dados)<span class="op">==</span><span class="kw">max</span>(<span class="kw">table</span>(dados))))) </span>
<span id="cb575-2"><a href="#cb575-2" aria-hidden="true"></a><span class="co">#&gt; [1] 1 3 5 6</span></span></code></pre></div>
<ul>
<li>La media de nuestro vector de lanzamientos de dados es:</li>
</ul>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="#cb576-1" aria-hidden="true"></a><span class="kw">mean</span>(dados)</span>
<span id="cb576-2"><a href="#cb576-2" aria-hidden="true"></a><span class="co">#&gt; [1] 3.6</span></span></code></pre></div>
<ul>
<li>La mediana de nuestro vector de lanzamientos de dados es:</li>
</ul>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="#cb577-1" aria-hidden="true"></a><span class="kw">median</span>(dados)</span>
<span id="cb577-2"><a href="#cb577-2" aria-hidden="true"></a><span class="co">#&gt; [1] 3.5</span></span></code></pre></div>
</div>
<div id="medidas-de-posición" class="section level2" number="12.3">
<h2 number="12.3"><span class="header-section-number">12.3</span> Medidas de posición</h2>
<p>Las <strong>medidas de posición</strong> estiman qué valores dividen la población en unas determinadas proporciones; los valores que determinan estas posiciones reciben el nombre de <strong>cuantiles</strong>. En este sentido, la mediana es también una medida de posición, puesto que divide la variable en dos mitades.</p>
<p>Dada una proporción <span class="math inline">\(0&lt;p&lt;1\)</span>, el <strong>cuantil de orden <span class="math inline">\(p\)</span></strong> de una variable cuantitativa, que denotaremos por <span class="math inline">\(Q_p\)</span>, es el valor más pequeño tal que su frecuencia relativa acumulada es mayor o igual que <span class="math inline">\(p\)</span>. En otras palabras, si tenemos un conjunto de datos <span class="math inline">\(x_1, \ldots, x_n\)</span> y los ordenamos de menor a mayor, <span class="math inline">\(Q_p\)</span> es el número más pequeño que deja a su izquierda (incluyéndolo a él) como mínimo la fracción <span class="math inline">\(p\)</span> de los datos, es decir, <span class="math inline">\(p\cdot n\)</span> datos.
De esta manera, la mediana viene a ser el cuantil <span class="math inline">\(Q_{0.5}\)</span>.</p>

<div class="example">
<p><span id="exm:ex184" class="example"><strong>(#exm:ex184) </strong></span>Consideremos otro experimento de lanzamientos de un dado. Esta vez lo lanzamos 30 veces y obtenemos los resultados siguientes:</p>
</div>
<p style="text-align:center">
2, 4, 5, 6, 3, 2, 4, 5, 1, 2, 1, 3, 4, 2, 3, 4, 1, 2, 5, 6, 5, 5, 3, 2, 1, 3, 4, 2, 2, 1.
</p>
<p>Ordenamos estos resultados de menor a mayor.</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="#cb578-1" aria-hidden="true"></a>dados2=<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb578-2"><a href="#cb578-2" aria-hidden="true"></a>dados2=<span class="kw">sort</span>(dados2)</span>
<span id="cb578-3"><a href="#cb578-3" aria-hidden="true"></a>dados2</span>
<span id="cb578-4"><a href="#cb578-4" aria-hidden="true"></a><span class="co">#&gt;  [1] 1 1 1 1 1 2 2 2 2 2 2 2 2 3 3 3 3 3 4 4 4 4 4 5 5 5 5 5 6 6</span></span></code></pre></div>
<p>Si nos pidieran el cuantil <span class="math inline">\(Q_{0.2}\)</span>, sería el primer elemento en esta lista ordenada que fuera mayor o igual que, como mínimo, el 20% de los datos. Como el 20% de 30 es 6, sería el sexto elemento.</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="#cb579-1" aria-hidden="true"></a>dados2[<span class="dv">6</span>]</span>
<span id="cb579-2"><a href="#cb579-2" aria-hidden="true"></a><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<p>Si nos pidieran en cambio el cuantil <span class="math inline">\(Q_{0.65}\)</span>, sería el primer elemento en esta lista ordenada mayor o igual que, como mínimo, el 65% de los datos. Como el 65% de 30 es 19.5, sería el vigésimo elemento.</p>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="#cb580-1" aria-hidden="true"></a>dados2[<span class="dv">20</span>]</span>
<span id="cb580-2"><a href="#cb580-2" aria-hidden="true"></a><span class="co">#&gt; [1] 4</span></span></code></pre></div>
<p>También podemos calcular los cuantiles <span class="math inline">\(Q_p\)</span> comparando la proporción <span class="math inline">\(p\)</span> con las frecuencias relativas acumuladas.</p>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="#cb581-1" aria-hidden="true"></a><span class="kw">cumsum</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(dados2)))</span>
<span id="cb581-2"><a href="#cb581-2" aria-hidden="true"></a><span class="co">#&gt;         1         2         3         4         5         6 </span></span>
<span id="cb581-3"><a href="#cb581-3" aria-hidden="true"></a><span class="co">#&gt; 0.1666667 0.4333333 0.6000000 0.7666667 0.9333333 1.0000000</span></span></code></pre></div>
<p>El primer elemento con frecuencia relativa acumulada mayor o igual que 0.2 es 2, lo que implica que <span class="math inline">\(Q_{0.2}=2\)</span>, y el primer elemento con frecuencia relativa acumulada mayor o igual que 0.65 es 4, por lo que <span class="math inline">\(Q_{0.65}=4\)</span>.</p>
<p>Algunos cuantiles tienen nombre propio:</p>
<ul>
<li><p>La <strong>mediana</strong> es el cuantil <span class="math inline">\(Q_{0.5}\)</span>.</p></li>
<li><p>Los <strong>cuartiles</strong> son los cuantiles <span class="math inline">\(Q_{0.25}\)</span>, <span class="math inline">\(Q_{0.5}\)</span> y <span class="math inline">\(Q_{0.75}\)</span>, y reciben, respectivamente, los nombres de <strong>primer cuartil</strong>, <strong>segundo cuartil</strong> (o mediana) y <strong>tercer cuartil</strong>. <span class="math inline">\(Q_{0.25}\)</span> será, pues, el menor valor que es mayor o igual que una cuarta parte de los datos, y <span class="math inline">\(Q_{0.75}\)</span>, el menor valor que es mayor o igual que tres cuartas partes de los datos.</p></li>
<li><p>Los <strong>deciles</strong> son los cuantiles <span class="math inline">\(Q_{p}\)</span> con <span class="math inline">\(p\)</span> un múltiplo entero de 0.1: el <strong>primer decil</strong> es <span class="math inline">\(Q_{0.1}\)</span>, el <strong>segundo decil</strong> es <span class="math inline">\(Q_{0.2}\)</span>, y así sucesivamente.</p></li>
<li><p>Los <strong>percentiles</strong> son los cuantiles <span class="math inline">\(Q_{p}\)</span> con <span class="math inline">\(p\)</span> un múltiplo entero de 0.01.</p></li>
</ul>
<p>Ha llegado el momento de avisar que la definición de cuantil que hemos dado es más bien orientativa; en realidad, y salvo para el caso de la mediana, no hay un consenso sobre cómo se tienen que calcular los cuantiles, de manera que se han propuesto métodos diferentes que pueden dar resultados diferentes. La razón es que el objetivo final del cálculo de cuantiles puede no ser solo encontrar el primer valor cuya frecuencia relativa acumulada en la variable sea mayor o igual que <span class="math inline">\(p\)</span>, sino también estimar qué vale este valor para el total de la población.</p>
<p>Con R, los cuantiles de orden <span class="math inline">\(p\)</span> de un vector <span class="math inline">\(x\)</span> se calculan con la instrucción</p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="#cb582-1" aria-hidden="true"></a><span class="kw">quantile</span>(x, p)</span></code></pre></div>
<p>Veamos algunos ejemplos:</p>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="#cb583-1" aria-hidden="true"></a>x=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">6</span>)</span>
<span id="cb583-2"><a href="#cb583-2" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">cumsum</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(x))), <span class="dv">3</span>)</span>
<span id="cb583-3"><a href="#cb583-3" aria-hidden="true"></a><span class="co">#&gt;     1     2     3     4     5     6     7 </span></span>
<span id="cb583-4"><a href="#cb583-4" aria-hidden="true"></a><span class="co">#&gt; 0.083 0.417 0.667 0.792 0.875 0.958 1.000</span></span>
<span id="cb583-5"><a href="#cb583-5" aria-hidden="true"></a><span class="kw">quantile</span>(x, <span class="fl">0.1</span>)</span>
<span id="cb583-6"><a href="#cb583-6" aria-hidden="true"></a><span class="co">#&gt; 10% </span></span>
<span id="cb583-7"><a href="#cb583-7" aria-hidden="true"></a><span class="co">#&gt;   2</span></span>
<span id="cb583-8"><a href="#cb583-8" aria-hidden="true"></a><span class="kw">quantile</span>(x, <span class="fl">0.25</span>)</span>
<span id="cb583-9"><a href="#cb583-9" aria-hidden="true"></a><span class="co">#&gt; 25% </span></span>
<span id="cb583-10"><a href="#cb583-10" aria-hidden="true"></a><span class="co">#&gt;   2</span></span>
<span id="cb583-11"><a href="#cb583-11" aria-hidden="true"></a><span class="kw">quantile</span>(x, <span class="fl">0.75</span>)</span>
<span id="cb583-12"><a href="#cb583-12" aria-hidden="true"></a><span class="co">#&gt; 75% </span></span>
<span id="cb583-13"><a href="#cb583-13" aria-hidden="true"></a><span class="co">#&gt;   4</span></span></code></pre></div>
<p>R dispone de 9 métodos diferentes para calcular cuantiles, que se pueden especificar dentro de <code>quantile</code> con el parámetro <code>type</code>. En la mayoría de las ocasiones se obtiene el mismo resultado con todos los métodos, pero no siempre. Para saber en detalle las fórmulas que usa <code>quantile</code> para cada valor de <code>type</code>, se puede consultar la <a href="http://en.wikipedia.org/wiki/quantile">entrada correspondiente de la Wikipedia</a>. El método que hemos usado en el Ejemplo @ref(exm:ex184) es el que corresponde a <code>type=1</code>, y siempre da un dato de los observados. El problema es que, entonces, <code>quantile(x,0.5,type=1)</code> y <code>median(x)</code> pueden dar resultados diferentes. El método que usa R por defecto si no especificamos otro es <code>type=7</code>.</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="#cb584-1" aria-hidden="true"></a>x=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">6</span>)</span>
<span id="cb584-2"><a href="#cb584-2" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">cumsum</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(x))), <span class="dv">3</span>)</span>
<span id="cb584-3"><a href="#cb584-3" aria-hidden="true"></a><span class="co">#&gt;     1     2     3     4     5     6     7 </span></span>
<span id="cb584-4"><a href="#cb584-4" aria-hidden="true"></a><span class="co">#&gt; 0.083 0.417 0.667 0.792 0.875 0.958 1.000</span></span>
<span id="cb584-5"><a href="#cb584-5" aria-hidden="true"></a><span class="kw">quantile</span>(x, <span class="fl">0.67</span>)</span>
<span id="cb584-6"><a href="#cb584-6" aria-hidden="true"></a><span class="co">#&gt;  67% </span></span>
<span id="cb584-7"><a href="#cb584-7" aria-hidden="true"></a><span class="co">#&gt; 3.41</span></span>
<span id="cb584-8"><a href="#cb584-8" aria-hidden="true"></a><span class="kw">quantile</span>(x, <span class="fl">0.67</span>, <span class="dt">type=</span><span class="dv">1</span>)</span>
<span id="cb584-9"><a href="#cb584-9" aria-hidden="true"></a><span class="co">#&gt; 67% </span></span>
<span id="cb584-10"><a href="#cb584-10" aria-hidden="true"></a><span class="co">#&gt;   4</span></span>
<span id="cb584-11"><a href="#cb584-11" aria-hidden="true"></a>dados=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>)</span>
<span id="cb584-12"><a href="#cb584-12" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">cumsum</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(dados))), <span class="dv">3</span>)</span>
<span id="cb584-13"><a href="#cb584-13" aria-hidden="true"></a><span class="co">#&gt;   1   2   3   4   5   6 </span></span>
<span id="cb584-14"><a href="#cb584-14" aria-hidden="true"></a><span class="co">#&gt; 0.2 0.3 0.5 0.6 0.8 1.0</span></span>
<span id="cb584-15"><a href="#cb584-15" aria-hidden="true"></a><span class="kw">median</span>(dados)</span>
<span id="cb584-16"><a href="#cb584-16" aria-hidden="true"></a><span class="co">#&gt; [1] 3.5</span></span>
<span id="cb584-17"><a href="#cb584-17" aria-hidden="true"></a><span class="kw">quantile</span>(dados, <span class="fl">0.5</span>, <span class="dt">type=</span><span class="dv">1</span>)</span>
<span id="cb584-18"><a href="#cb584-18" aria-hidden="true"></a><span class="co">#&gt; 50% </span></span>
<span id="cb584-19"><a href="#cb584-19" aria-hidden="true"></a><span class="co">#&gt;   3</span></span>
<span id="cb584-20"><a href="#cb584-20" aria-hidden="true"></a><span class="kw">quantile</span>(dados, <span class="fl">0.5</span>)</span>
<span id="cb584-21"><a href="#cb584-21" aria-hidden="true"></a><span class="co">#&gt; 50% </span></span>
<span id="cb584-22"><a href="#cb584-22" aria-hidden="true"></a><span class="co">#&gt; 3.5</span></span></code></pre></div>
<p>Seguramente os preguntáis: si los cuantiles se pueden calcular de diferentes maneras, ¿cómo lo tenéis que hacer vosotros? Como en el nivel de este curso no es necesario afinar tanto, aquí usaremos la función <code>quantile</code> sin especificar <code>type</code>, es decir, con su método por defecto; no hace falta que sepáis qué hace este método, lo importante es que entendáis el concepto de cuantil y qué representa, <em>grosso modo</em>, el resultado de <code>quantile</code>.</p>
</div>
<div id="medidas-de-dispersión" class="section level2" number="12.4">
<h2 number="12.4"><span class="header-section-number">12.4</span> Medidas de dispersión</h2>
<p>Las <strong>medidas de dispersión</strong> evalúan lo desperdigados que están los datos. Las más importantes son:</p>
<ul>
<li><p>El <strong>rango</strong>, o <strong>recorrido</strong>, que es la diferencia entre el máximo y el mínimo de las observaciones.</p></li>
<li><p>El <strong>rango intercuartílico</strong>, que es la diferencia <span class="math inline">\(Q_{0.75}-Q_{0.25}\)</span>. También se llama a veces rango intercuartílico al <strong>intervalo intercuartílico</strong>: el intervalo <span class="math inline">\([Q_{0.25},Q_{0.75}]\)</span>.</p></li>
<li><p>La <strong>varianza</strong>, que es la media aritmética de las diferencias al cuadrado entre los datos <span class="math inline">\(x_i\)</span> y la media <span class="math inline">\(\overline{x}\)</span> de la variable; la denotamos por <span class="math inline">\(s^2\)</span>. Es decir,
<span class="math display">\[
s^2=\frac{\sum_{i=1}^n (x_i-\overline{x})^2}{n}=\frac{\sum_{i=1}^k n_i\cdot
(X_i-\overline{x})^2}{n}=\sum_{i=1}^k f_i\cdot (X_i-\overline{x})^2.
\]</span></p></li>
<li><p>La <strong>desviación típica</strong>, que es la raíz cuadrada positiva <span class="math inline">\(s\)</span> de la varianza:
<span class="math inline">\(s=\sqrt{s^2}\)</span>.</p></li>
<li><p>La <strong>varianza muestral</strong>, que es la corrección siguiente de la varianza:
<span class="math display">\[
\tilde{s}^2 =\frac{n}{n-1} \cdot s^2=\frac{\sum_{i=1}^n (x_i-\overline{x})^2}{n-1}.
\]</span>
Esto es, la varianza muestral se calcula con la misma fórmula que la varianza salvo que el denominador es <span class="math inline">\(n-1\)</span> en lugar de <span class="math inline">\(n\)</span>.</p></li>
<li><p>La <strong>desviación típica muestral</strong>, que es la raíz cuadrada positiva <span class="math inline">\(\tilde{s}\)</span> de la varianza muestral: <span class="math inline">\(\tilde{s}=\sqrt{\tilde{s}^2}\)</span>.</p></li>
</ul>
<p>La distinción entre la versión muestral y la “verdadera” de la varianza está motivada por la interrelación entre la estadística descriptiva y la inferencial de la que hablábamos en la introducción de la Lección @ref(chap:df). Por un lado, es natural medir la variabilidad de un conjunto de datos cuantitativos mediante su varianza “verdadera”, definida como la media de las distancias (al cuadrado) de los datos a su valor promedio; pero, por otro lado, nuestro conjunto de datos será, normalmente, una muestra de una población mucho mayor, de la que querremos estimar información, y en concreto su variabilidad. Por poner un ejemplo, las flores iris recogidas en la tabla de datos <code>iris</code> forman una muestra de la población de <em>todas</em> las flores iris. Con las técnicas de la estadística descriptiva, resumimos y representamos las características de esta muestra concreta; pero este estudio suele ser solo un paso previo al análisis inferencial de estos datos, cuyo objetivo no es analizar esta muestra en si misma, sino inferir información sobre todas las flores iris a partir de esta muestra. Así, lo más probable es que, en realidad, la variabilidad de las longitudes de los sépalos de las flores de iris setosa en esta muestra nos interese sobre todo como estimación de la variabilidad de las longitudes de los sépalos de <em>todas</em> las flores de esta especie.</p>
<p>Pues bien, resulta que la varianza “verdadera” de una muestra tiende a dar valores más pequeños que la varianza real de la población, mientras que la varianza muestral tiende a dar valores alrededor de la varianza real de la población. Para muestras grandes, la diferencia no es sustancial: si <span class="math inline">\(n\)</span> es grande, dividir por <span class="math inline">\(n\)</span> o por <span class="math inline">\(n-1\)</span> no significa una gran diferencia, y sobre todo si tenemos en cuenta que se trata de estimar la varianza de la población, no de calcularla exactamente. Pero si el tamaño de la muestra es pequeño (pongamos, de menos de 25 individuos), la varianza muestral de una muestra aproxima significativamente mejor la varianza real de la población que su varianza “verdadera”. La justificación de este hecho se basa en la teoría de la estimación de parámetros y se sale de los objetivos de este curso.</p>
<p>¿Y por qué definimos la varianza y desviación típica, si ambas medidas dan una información equivalente? El motivo es que si los elementos de una variable cuantitativa tienen unidades (metros, años, individuos por metro cuadrado…), su varianza (sea “verdadera” o muestral) tiene estas unidades al cuadrado; por ejemplo, si los <span class="math inline">\(x_i\)</span> son años, los valores de <span class="math inline">\(s^2\)</span> y <span class="math inline">\(\tilde{s}^2\)</span> representan años al cuadrado. En cambio, las desviaciones típicas tienen las mismas unidades que los datos, por lo que se pueden comparar con ellos, y de ahí su utilidad.</p>
<p>La varianza tiene las propiedades matemáticas siguientes:</p>
<ul>
<li><p><span class="math inline">\(s^2\geqslant 0\)</span>, porque es una suma de cuadrados de numeros reales.</p></li>
<li><p>Si <span class="math inline">\(s^2=0\)</span>, todos los sumandos <span class="math inline">\((x_i-\overline{x})^2\)</span> son 0 y, por lo tanto, todos los datos son iguales a su media. En particular, <span class="math inline">\(s^2=0\)</span> significa que todos los datos son iguales.</p></li>
<li><p>A partir de la fórmula dada para <span class="math inline">\(s^2\)</span>, se tiene que
<span class="math display">\[
\begin{array}{rl}
n\cdot s^2 &amp; \displaystyle = \sum_{i=1}^n (x_i-\overline{x})^2=
\sum_{i=1}^n (x_i^2-2\overline{x}x_i+\overline{x}^2)=
\sum_{i=1}^n x_i^2-2\sum_{i=1}^n\overline{x}x_i+\sum_{i=1}^n\overline{x}^2\\[2ex]
&amp;  \displaystyle =
\sum_{i=1}^n x_i^2-2\overline{x}\Big(\sum_{i=1}^n x_i\Big)+n\overline{x}^2=
\sum_{i=1}^n x_i^2-2\overline{x}\cdot n\overline{x}+n\overline{x}^2=
\sum_{i=1}^n x_i^2-n\overline{x}^2
\end{array}
\]</span>
de donde deducimos que
<span class="math display">\[
s^2=\frac{\sum_{i=1}^n x_i^2-n\overline{x}^2}{n}=
 \frac{\sum_{i=1}^n x_i^2}{n}-\overline{x}^2.
\]</span>
Es decir, <em>la varianza es la media de los cuadrados de los datos, menos el cuadrado de la media de los datos.</em></p></li>
</ul>
<p>Hay que ir con cuidado con la desviación típica y la desviación típica muestral. En los trabajos científicos es frecuente que se utilice una u otra sin especificar cuál es, y se la llame “desviación típica” (<em>standard deviation</em>) y se la denote por <span class="math inline">\(s\)</span> independientemente de cuál sea en realidad. Asimismo, la mayoría de paquetes estadísticos llevan funciones para calcular la varianza y la desviación típica (sin más aclaraciones) que, en realidad, calculan sus versiones muestrales; como veremos en un momento, éste va ser justamente el caso de R. El motivo es que, como ya hemos comentado, suele interesar más su aspecto inferencial que el descriptivo.</p>
<p>Con R, podemos calcular la medidas de dispersión para un vector <span class="math inline">\(x\)</span> definidas al principio de esta sección mediante las funciones siguientes:</p>
<ul>
<li><p>La instrucción <code>range(x)</code> nos da sus valores mínimo y máximo. Por lo tanto, su rango se puede calcular con <code>diff(range(x))</code>.</p></li>
<li><p>Su rango intercuartílico se calcula con <code>IQR(x)</code>. Naturalmente, si se desea, se puede especificar el parámetro <code>type</code> de los cuantiles.</p></li>
<li><p>Su varianza muestral se obtiene con la función <code>var</code>.</p></li>
<li><p>Su desviación típica muestral se calcula con la función <code>sd</code>.</p></li>
<li><p>Para calcular su varianza, tenemos que multiplicar el resultado de <code>var</code> por <span class="math inline">\((n-1)/n\)</span>, donde <span class="math inline">\(n\)</span> es el número de datos que contiene <span class="math inline">\(x\)</span> (que podemos calcular con <code>length</code>); por consiguiente, la varianza de <span class="math inline">\(x\)</span> se puede calcular con la instrucción</p></li>
</ul>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="#cb585-1" aria-hidden="true"></a><span class="kw">var</span>(x)<span class="op">*</span>(<span class="kw">length</span>(x)<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="kw">length</span>(x)</span></code></pre></div>
<ul>
<li>Para calcular su desviación típica, tenemos que efectuar la raíz cuadrada de la varianza, calculada con el procedimiento anterior:</li>
</ul>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="#cb586-1" aria-hidden="true"></a><span class="kw">sqrt</span>(<span class="kw">var</span>(x)<span class="op">*</span>(<span class="kw">length</span>(x)<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="kw">length</span>(x))</span></code></pre></div>
<div class="line-block">       O bien, aprovechando que, por definición, <code>sd(...)=sqrt(var(...))</code>, podemos usar:</div>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="#cb587-1" aria-hidden="true"></a><span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">sqrt</span>((<span class="kw">length</span>(x)<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="kw">length</span>(x))</span></code></pre></div>
<p>¡Id con cuidado! Recordad que las funciones <code>var</code> y <code>sd</code> <em>no calculan la varianza y la desviación típica</em>, sino sus versiones muestrales.</p>
<p>Veamos algunos ejemplos. Consideremos el vector</p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="#cb588-1" aria-hidden="true"></a>x=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">6</span>)</span></code></pre></div>
<ul>
<li>Su rango es</li>
</ul>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="#cb589-1" aria-hidden="true"></a><span class="kw">diff</span>(<span class="kw">range</span>(x)) </span>
<span id="cb589-2"><a href="#cb589-2" aria-hidden="true"></a><span class="co">#&gt; [1] 6</span></span></code></pre></div>
<ul>
<li>Su rango intercuartílico es</li>
</ul>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="#cb590-1" aria-hidden="true"></a><span class="kw">IQR</span>(x)   </span>
<span id="cb590-2"><a href="#cb590-2" aria-hidden="true"></a><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<ul>
<li>Su varianza muestral es</li>
</ul>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="#cb591-1" aria-hidden="true"></a><span class="kw">var</span>(x) </span>
<span id="cb591-2"><a href="#cb591-2" aria-hidden="true"></a><span class="co">#&gt; [1] 2.606884</span></span></code></pre></div>
<ul>
<li>Su desviación típica muestral es</li>
</ul>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="#cb592-1" aria-hidden="true"></a><span class="kw">sd</span>(x) </span>
<span id="cb592-2"><a href="#cb592-2" aria-hidden="true"></a><span class="co">#&gt; [1] 1.614585</span></span></code></pre></div>
<ul>
<li>Su varianza es</li>
</ul>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="#cb593-1" aria-hidden="true"></a><span class="kw">var</span>(x)<span class="op">*</span>(<span class="kw">length</span>(x)<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="kw">length</span>(x)</span>
<span id="cb593-2"><a href="#cb593-2" aria-hidden="true"></a><span class="co">#&gt; [1] 2.498264</span></span></code></pre></div>
<ul>
<li>Su desviación típica es</li>
</ul>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="#cb594-1" aria-hidden="true"></a><span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">sqrt</span>((<span class="kw">length</span>(x)<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="kw">length</span>(x))</span>
<span id="cb594-2"><a href="#cb594-2" aria-hidden="true"></a><span class="co">#&gt; [1] 1.58059</span></span></code></pre></div>
<div class="line-block">       o también</div>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="#cb595-1" aria-hidden="true"></a><span class="kw">sqrt</span>(<span class="kw">var</span>(x)<span class="op">*</span>(<span class="kw">length</span>(x)<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="kw">length</span>(x))</span>
<span id="cb595-2"><a href="#cb595-2" aria-hidden="true"></a><span class="co">#&gt; [1] 1.58059</span></span></code></pre></div>
<p>Si se aplica la función <code>summary</code> a un vector numérico, se obtiene un resumen estadístico que contiene sus valores mínimo y máximo, sus tres cuartiles y su media.</p>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="#cb596-1" aria-hidden="true"></a><span class="kw">summary</span>(x)</span>
<span id="cb596-2"><a href="#cb596-2" aria-hidden="true"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb596-3"><a href="#cb596-3" aria-hidden="true"></a><span class="co">#&gt;   1.000   2.000   3.000   3.208   4.000   7.000</span></span></code></pre></div>
<p>La función <code>summary</code> produce otros tipos de resúmenes para otras clases de objetos; por ejemplo, ya vimos en la Lección @ref(chap:lm) el resultado de aplicar <code>summary</code> al resultado de una función <code>lm</code>.</p>
<p>Cuando aplicamos la función <code>summary</code> a un <em>data frame</em>, se aplica simultáneamente a todas sus variables, y así de manera rápida podemos observar si hay diferencias apreciables entre sus variables numéricas. A modo de ejemplo, si la aplicamos al <em>data frame</em> formado por las variables numéricas de la tabla <code>iris</code>, obtenemos lo siguiente:</p>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="#cb597-1" aria-hidden="true"></a><span class="kw">summary</span>(iris[,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])</span>
<span id="cb597-2"><a href="#cb597-2" aria-hidden="true"></a><span class="co">#&gt;   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   </span></span>
<span id="cb597-3"><a href="#cb597-3" aria-hidden="true"></a><span class="co">#&gt;  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  </span></span>
<span id="cb597-4"><a href="#cb597-4" aria-hidden="true"></a><span class="co">#&gt;  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  </span></span>
<span id="cb597-5"><a href="#cb597-5" aria-hidden="true"></a><span class="co">#&gt;  Median :5.800   Median :3.000   Median :4.350   Median :1.300  </span></span>
<span id="cb597-6"><a href="#cb597-6" aria-hidden="true"></a><span class="co">#&gt;  Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  </span></span>
<span id="cb597-7"><a href="#cb597-7" aria-hidden="true"></a><span class="co">#&gt;  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  </span></span>
<span id="cb597-8"><a href="#cb597-8" aria-hidden="true"></a><span class="co">#&gt;  Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500</span></span></code></pre></div>
<p>De manera similar, si quisiéramos comparar numéricamente las longitudes de pétalos y sépalos de las flores de especie setosa con las de las flores de especie virgínica, podríamos entrar lo siguiente:</p>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="#cb598-1" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">subset</span>(iris, Species<span class="op">==</span><span class="st">&quot;setosa&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Sepal.Length&quot;</span>,<span class="st">&quot;Petal.Length&quot;</span>)))</span>
<span id="cb598-2"><a href="#cb598-2" aria-hidden="true"></a><span class="co">#&gt;   Sepal.Length    Petal.Length  </span></span>
<span id="cb598-3"><a href="#cb598-3" aria-hidden="true"></a><span class="co">#&gt;  Min.   :4.300   Min.   :1.000  </span></span>
<span id="cb598-4"><a href="#cb598-4" aria-hidden="true"></a><span class="co">#&gt;  1st Qu.:4.800   1st Qu.:1.400  </span></span>
<span id="cb598-5"><a href="#cb598-5" aria-hidden="true"></a><span class="co">#&gt;  Median :5.000   Median :1.500  </span></span>
<span id="cb598-6"><a href="#cb598-6" aria-hidden="true"></a><span class="co">#&gt;  Mean   :5.006   Mean   :1.462  </span></span>
<span id="cb598-7"><a href="#cb598-7" aria-hidden="true"></a><span class="co">#&gt;  3rd Qu.:5.200   3rd Qu.:1.575  </span></span>
<span id="cb598-8"><a href="#cb598-8" aria-hidden="true"></a><span class="co">#&gt;  Max.   :5.800   Max.   :1.900</span></span>
<span id="cb598-9"><a href="#cb598-9" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">subset</span>(iris, Species<span class="op">==</span><span class="st">&quot;virginica&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Sepal.Length&quot;</span>,<span class="st">&quot;Petal.Length&quot;</span>)))</span>
<span id="cb598-10"><a href="#cb598-10" aria-hidden="true"></a><span class="co">#&gt;   Sepal.Length    Petal.Length  </span></span>
<span id="cb598-11"><a href="#cb598-11" aria-hidden="true"></a><span class="co">#&gt;  Min.   :4.900   Min.   :4.500  </span></span>
<span id="cb598-12"><a href="#cb598-12" aria-hidden="true"></a><span class="co">#&gt;  1st Qu.:6.225   1st Qu.:5.100  </span></span>
<span id="cb598-13"><a href="#cb598-13" aria-hidden="true"></a><span class="co">#&gt;  Median :6.500   Median :5.550  </span></span>
<span id="cb598-14"><a href="#cb598-14" aria-hidden="true"></a><span class="co">#&gt;  Mean   :6.588   Mean   :5.552  </span></span>
<span id="cb598-15"><a href="#cb598-15" aria-hidden="true"></a><span class="co">#&gt;  3rd Qu.:6.900   3rd Qu.:5.875  </span></span>
<span id="cb598-16"><a href="#cb598-16" aria-hidden="true"></a><span class="co">#&gt;  Max.   :7.900   Max.   :6.900</span></span></code></pre></div>
<p>y deducimos así a simple vista que los pétalos y sépalos de las iris virgínica son más grandes que los de las iris setosa.</p>
<p>La función <code>by</code> sirve para aplicar una función a algunas columnas de un <em>data frame</em> segmentándolas según los niveles de un factor. Su sintaxis es</p>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb599-1"><a href="#cb599-1" aria-hidden="true"></a><span class="kw">by</span>(columnas, factor, <span class="dt">FUN=</span>función)</span></code></pre></div>
<p>Por lo tanto, usando <code>by</code> con <code>FUN=summary</code>, podemos calcular este resumen estadístico en las subpoblaciones definidas por los niveles de un factor. Por ejemplo:</p>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="#cb600-1" aria-hidden="true"></a><span class="kw">by</span>(iris[, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], iris<span class="op">$</span>Species, <span class="dt">FUN=</span>summary)</span>
<span id="cb600-2"><a href="#cb600-2" aria-hidden="true"></a><span class="co">#&gt; iris$Species: setosa</span></span>
<span id="cb600-3"><a href="#cb600-3" aria-hidden="true"></a><span class="co">#&gt;   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   </span></span>
<span id="cb600-4"><a href="#cb600-4" aria-hidden="true"></a><span class="co">#&gt;  Min.   :4.300   Min.   :2.300   Min.   :1.000   Min.   :0.100  </span></span>
<span id="cb600-5"><a href="#cb600-5" aria-hidden="true"></a><span class="co">#&gt;  1st Qu.:4.800   1st Qu.:3.200   1st Qu.:1.400   1st Qu.:0.200  </span></span>
<span id="cb600-6"><a href="#cb600-6" aria-hidden="true"></a><span class="co">#&gt;  Median :5.000   Median :3.400   Median :1.500   Median :0.200  </span></span>
<span id="cb600-7"><a href="#cb600-7" aria-hidden="true"></a><span class="co">#&gt;  Mean   :5.006   Mean   :3.428   Mean   :1.462   Mean   :0.246  </span></span>
<span id="cb600-8"><a href="#cb600-8" aria-hidden="true"></a><span class="co">#&gt;  3rd Qu.:5.200   3rd Qu.:3.675   3rd Qu.:1.575   3rd Qu.:0.300  </span></span>
<span id="cb600-9"><a href="#cb600-9" aria-hidden="true"></a><span class="co">#&gt;  Max.   :5.800   Max.   :4.400   Max.   :1.900   Max.   :0.600  </span></span>
<span id="cb600-10"><a href="#cb600-10" aria-hidden="true"></a><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span id="cb600-11"><a href="#cb600-11" aria-hidden="true"></a><span class="co">#&gt; iris$Species: versicolor</span></span>
<span id="cb600-12"><a href="#cb600-12" aria-hidden="true"></a><span class="co">#&gt;   Sepal.Length    Sepal.Width     Petal.Length   Petal.Width   </span></span>
<span id="cb600-13"><a href="#cb600-13" aria-hidden="true"></a><span class="co">#&gt;  Min.   :4.900   Min.   :2.000   Min.   :3.00   Min.   :1.000  </span></span>
<span id="cb600-14"><a href="#cb600-14" aria-hidden="true"></a><span class="co">#&gt;  1st Qu.:5.600   1st Qu.:2.525   1st Qu.:4.00   1st Qu.:1.200  </span></span>
<span id="cb600-15"><a href="#cb600-15" aria-hidden="true"></a><span class="co">#&gt;  Median :5.900   Median :2.800   Median :4.35   Median :1.300  </span></span>
<span id="cb600-16"><a href="#cb600-16" aria-hidden="true"></a><span class="co">#&gt;  Mean   :5.936   Mean   :2.770   Mean   :4.26   Mean   :1.326  </span></span>
<span id="cb600-17"><a href="#cb600-17" aria-hidden="true"></a><span class="co">#&gt;  3rd Qu.:6.300   3rd Qu.:3.000   3rd Qu.:4.60   3rd Qu.:1.500  </span></span>
<span id="cb600-18"><a href="#cb600-18" aria-hidden="true"></a><span class="co">#&gt;  Max.   :7.000   Max.   :3.400   Max.   :5.10   Max.   :1.800  </span></span>
<span id="cb600-19"><a href="#cb600-19" aria-hidden="true"></a><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span id="cb600-20"><a href="#cb600-20" aria-hidden="true"></a><span class="co">#&gt; iris$Species: virginica</span></span>
<span id="cb600-21"><a href="#cb600-21" aria-hidden="true"></a><span class="co">#&gt;   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   </span></span>
<span id="cb600-22"><a href="#cb600-22" aria-hidden="true"></a><span class="co">#&gt;  Min.   :4.900   Min.   :2.200   Min.   :4.500   Min.   :1.400  </span></span>
<span id="cb600-23"><a href="#cb600-23" aria-hidden="true"></a><span class="co">#&gt;  1st Qu.:6.225   1st Qu.:2.800   1st Qu.:5.100   1st Qu.:1.800  </span></span>
<span id="cb600-24"><a href="#cb600-24" aria-hidden="true"></a><span class="co">#&gt;  Median :6.500   Median :3.000   Median :5.550   Median :2.000  </span></span>
<span id="cb600-25"><a href="#cb600-25" aria-hidden="true"></a><span class="co">#&gt;  Mean   :6.588   Mean   :2.974   Mean   :5.552   Mean   :2.026  </span></span>
<span id="cb600-26"><a href="#cb600-26" aria-hidden="true"></a><span class="co">#&gt;  3rd Qu.:6.900   3rd Qu.:3.175   3rd Qu.:5.875   3rd Qu.:2.300  </span></span>
<span id="cb600-27"><a href="#cb600-27" aria-hidden="true"></a><span class="co">#&gt;  Max.   :7.900   Max.   :3.800   Max.   :6.900   Max.   :2.500</span></span></code></pre></div>
<p>Usar <code>by</code> es equivalente a usar <code>aggregate</code>, pero el resultado se muestra de manera diferente. En este caso, era más conveniente usar <code>by</code>. Entrad la instrucción siguiente y lo comprobaréis.</p>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="#cb601-1" aria-hidden="true"></a><span class="kw">aggregate</span>(<span class="kw">cbind</span>(Sepal.Length,Sepal.Width,Petal.Length, Petal.Width)<span class="op">~</span>Species, <span class="dt">data=</span>iris, <span class="dt">FUN=</span>summary)</span></code></pre></div>
<p>La mayoría de las instrucciones para calcular medidas estadísticas no admiten valores <code>NA</code>.</p>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="#cb602-1" aria-hidden="true"></a>z=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="ot">NA</span>,<span class="dv">4</span>)</span>
<span id="cb602-2"><a href="#cb602-2" aria-hidden="true"></a><span class="kw">sum</span>(z)</span>
<span id="cb602-3"><a href="#cb602-3" aria-hidden="true"></a><span class="co">#&gt; [1] NA</span></span>
<span id="cb602-4"><a href="#cb602-4" aria-hidden="true"></a><span class="kw">mean</span>(z)</span>
<span id="cb602-5"><a href="#cb602-5" aria-hidden="true"></a><span class="co">#&gt; [1] NA</span></span>
<span id="cb602-6"><a href="#cb602-6" aria-hidden="true"></a><span class="kw">var</span>(z)</span>
<span id="cb602-7"><a href="#cb602-7" aria-hidden="true"></a><span class="co">#&gt; [1] NA</span></span></code></pre></div>
<p>Para no tenerlos en cuenta a la hora de calcularlas, lo más conveniente es incluir el parámetro <code>na.rm=TRUE</code> en el argumento de la función.</p>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="#cb603-1" aria-hidden="true"></a><span class="kw">sum</span>(z, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</span>
<span id="cb603-2"><a href="#cb603-2" aria-hidden="true"></a><span class="co">#&gt; [1] 7</span></span>
<span id="cb603-3"><a href="#cb603-3" aria-hidden="true"></a><span class="kw">mean</span>(z, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</span>
<span id="cb603-4"><a href="#cb603-4" aria-hidden="true"></a><span class="co">#&gt; [1] 2.333333</span></span>
<span id="cb603-5"><a href="#cb603-5" aria-hidden="true"></a><span class="kw">var</span>(z, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</span>
<span id="cb603-6"><a href="#cb603-6" aria-hidden="true"></a><span class="co">#&gt; [1] 2.333333</span></span></code></pre></div>
<p>Recordad de la Lección @ref(chap:vect) que también podéis eliminar los <code>NA</code> de un vector con la función <code>na.omit</code>.</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="#cb604-1" aria-hidden="true"></a><span class="kw">mean</span>(<span class="kw">na.omit</span>(z))</span>
<span id="cb604-2"><a href="#cb604-2" aria-hidden="true"></a><span class="co">#&gt; [1] 2.333333</span></span></code></pre></div>
</div>
<div id="diagramas-de-caja" class="section level2" number="12.5">
<h2 number="12.5"><span class="header-section-number">12.5</span> Diagramas de caja</h2>
<p>Un <strong>diagrama de caja</strong>, o <em>box plot</em>, es un gráfico que resume algunos datos estadísticos de una variable cuantitativa (véase la Figura @ref(fig:boxplot)). Este gráfico marca básicamente cinco valores:</p>
<ul>
<li><p>Los lados inferior y superior de la caja representan el primer y el tercer cuartil, por lo que la altura de la caja es igual al rango intercuartílico.</p></li>
<li><p>La línea gruesa que divide la caja marca la mediana.</p></li>
<li><p>Los valores <span class="math inline">\(b_{inf}\)</span> y <span class="math inline">\(b_{sup}\)</span> son los <strong>bigotes</strong> (<em>whiskers</em>) del gráfico. Estos valores se calculan de la manera siguiente:</p>
<ul>
<li><p>Sea <span class="math inline">\(m\)</span> el mínimo del conjunto de datos. Si <span class="math inline">\(m\geqslant Q_{0.25}-1.5\cdot(Q_{0.75}-Q_{0.25})\)</span> (es decir, si el mínimo está a menos de 1.5 veces el rango intercuartílico de <span class="math inline">\(Q_{0.25}\)</span>), entonces <span class="math inline">\(b_{inf}=m\)</span>. Si, en cambio, <span class="math inline">\(m&lt; Q_{0.25}-1.5\cdot(Q_{0.75}-Q_{0.25})\)</span>, entonces <span class="math inline">\(b_{inf}\)</span> es el menor elemento del conjunto de datos que es mayor o igual que <span class="math inline">\(Q_{0.25}-1.5\cdot(Q_{0.75}-Q_{0.25})\)</span>.</p></li>
<li><p>Sea <span class="math inline">\(M\)</span> el máximo del conjunto de datos. Si <span class="math inline">\(M\leqslant Q_{0.75}+1.5\cdot(Q_{0.75}-Q_{0.25})\)</span> (es decir, si el máximo está a menos de 1.5 veces el rango intercuartílico de <span class="math inline">\(Q_{0.75}\)</span>), entonces <span class="math inline">\(b_{sup}=M\)</span>. Si, en cambio, <span class="math inline">\(M&gt; Q_{0.75}+1.5\cdot(Q_{0.75}-Q_{0.25})\)</span>, entonces <span class="math inline">\(b_{sup}\)</span> es el mayor elemento del conjunto de datos que es menor o igual que <span class="math inline">\(Q_{0.75}+1.5\cdot(Q_{0.75}-Q_{0.25})\)</span>.</p></li>
</ul>
<p>Es decir, los bigotes marcan el mínimo y el máximo de la variable, excepto cuando están muy alejados de la caja intercuartílica; en este caso, el bigote inferior marca el menor valor por debajo de la caja intercuartílica a distancia menor o igual que 1.5 veces la altura de dicha caja, y el superior marca el mayor valor por encima de la caja intercuartílica a distancia menor o igual que 1.5 veces la altura de dicha caja.</p></li>
<li><p>Si hay datos más allá de los bigotes (menores que <span class="math inline">\(b_{inf}\)</span> o mayores que <span class="math inline">\(b_{sup}\)</span>), se marcan como puntos aislados: son los <strong>valores atípicos</strong> (<em>outliers</em>) de la variable.</p></li>
</ul>
<div class="figure" style="text-align: center">
<img src="AprendeR-Parte-I_files/figure-html/boxplotgen.png" alt="Esquema de un diagrama de caja." width="90%" />
<p class="caption">
(#fig:boxplot)Esquema de un diagrama de caja.
</p>
</div>
<p>La función básica para dibujar un diagrama de caja con R es <code>boxplot</code>. Por ejemplo,</p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="#cb605-1" aria-hidden="true"></a>x=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">6</span>)</span>
<span id="cb605-2"><a href="#cb605-2" aria-hidden="true"></a><span class="kw">boxplot</span>(x)</span></code></pre></div>
<p>produce la Figura @ref(fig:182).</p>
<div class="figure" style="text-align: center">
<img src="12chap12_Descripcion_cuantitativos_files/figure-html/182-1.png" alt="Un diagrama de caja." width="90%" />
<p class="caption">
(#fig:182)Un diagrama de caja.
</p>
</div>
<p>La instrucción <code>boxplot</code> admite los parámetros usuales de <code>plot</code> para mejorar o hacer más informativo el resultado: <code>main</code>, <code>xlab</code> , <code>ylim</code>, <code>yaxp</code>, <code>col</code>, etc.; podéis consultarlos en su Ayuda. Por ejemplo, si queremos producir un diagrama de caja de las longitudes de pétalos de las flores de especie setosa recogidas en el <em>data frame</em> <code>iris</code>, con más marcas en el eje vertical para facilitar la lectura de los valores y un título oportuno, podemos entrar lo siguiente:</p>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="#cb606-1" aria-hidden="true"></a><span class="kw">boxplot</span>(iris[iris<span class="op">$</span>Species<span class="op">==</span><span class="st">&quot;setosa&quot;</span>, ]<span class="op">$</span>Petal.Length, </span>
<span id="cb606-2"><a href="#cb606-2" aria-hidden="true"></a>        <span class="dt">main=</span><span class="st">&quot;Longitudes de pétalos de las Iris setosa&quot;</span>, <span class="dt">yaxp=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">1.9</span>,<span class="dv">9</span>)) </span></code></pre></div>
<p><img src="12chap12_Descripcion_cuantitativos_files/figure-html/unnamed-chunk-42-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Para dibujar varios diagramas de caja en un mismo gráfico, por ejemplo para poder compararlos, basta aplicar la instrucción <code>boxplot</code> a todos los vectores simultáneamente. Por ejemplo:</p>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="#cb607-1" aria-hidden="true"></a>x=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">6</span>)</span>
<span id="cb607-2"><a href="#cb607-2" aria-hidden="true"></a>y=<span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">1</span>)</span>
<span id="cb607-3"><a href="#cb607-3" aria-hidden="true"></a>z=<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>)</span>
<span id="cb607-4"><a href="#cb607-4" aria-hidden="true"></a><span class="kw">boxplot</span>(x, y, z, <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>))</span></code></pre></div>
<p><img src="12chap12_Descripcion_cuantitativos_files/figure-html/unnamed-chunk-43-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Observad que en la función <code>boxplot</code> del bloque anterior hemos usado el parámetro <code>names</code> para especificar las etiquetas de los diagramas de caja: de lo contrario, el gráfico hubiera sido más difícil de interpretar, probadlo.</p>
<p>Si preferís las cajas horizontales, podéis usar el parámetro <code>horizontal=TRUE</code>:</p>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="#cb608-1" aria-hidden="true"></a><span class="kw">boxplot</span>(x, y, z, <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>), <span class="dt">horizontal=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="12chap12_Descripcion_cuantitativos_files/figure-html/unnamed-chunk-44-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Podemos dibujar los diagramas de caja de todas las variables de un <em>data frame</em> en un solo paso, aplicando la función <code>boxplot</code> al <em>data frame</em>; por ejemplo:</p>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="#cb609-1" aria-hidden="true"></a><span class="kw">boxplot</span>(iris)</span></code></pre></div>
<p><img src="12chap12_Descripcion_cuantitativos_files/figure-html/unnamed-chunk-45-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Observaréis que este gráfico no es muy satisfactorio. Dibujar el diagrama de caja de la variable <code>Species</code>, que es un factor, no tiene ningún sentido, y los nombres, además, no han quedado muy vistosos; podemos mejorar este gráfico, incluyendo solo las cuatro primeras variables y cambiando un poco los nombres, con la instrucción siguiente:</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="#cb610-1" aria-hidden="true"></a><span class="kw">boxplot</span>(iris[, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;Sepal</span><span class="ch">\n</span><span class="st"> length&quot;</span>,<span class="st">&quot;Sepal</span><span class="ch">\n</span><span class="st"> width&quot;</span>,<span class="st">&quot;Petal</span><span class="ch">\n</span><span class="st"> length&quot;</span>,<span class="st">&quot;Petal</span><span class="ch">\n</span><span class="st"> width&quot;</span>))</span></code></pre></div>
<p><img src="12chap12_Descripcion_cuantitativos_files/figure-html/unnamed-chunk-46-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>El objetivo de agrupar varios diagramas de caja en un único gráfico suele ser el poder compararlos visualmente, y esto normalmente solo tiene sentido cuando las variables tienen significados muy similares, o mejor, cuando son la misma variable sobre poblaciones diferentes. En concreto, a menudo querremos producir diagramas de caja de una variable cuantitativa segmentada por un factor, porque esto nos permitirá comparar el comportamiento de esta variable sobre cada uno de los niveles del factor. La manera más conveniente de hacerlo es partir de un <em>data frame</em> donde el factor sea una variable, digamos, <code>F</code>, y el vector de datos numéricos otra variable, digamos, <code>X</code>. Entonces, para cada nivel <code>L</code> de <code>F</code>, obtendremos un diagrama de caja de los valores que toma la variable <code>X</code> en los individuos de nivel <code>L</code>.</p>
<p>La sintaxis básica de la instrucción para dibujar en un único gráfico los diagramas de caja de una variable numérica de un <em>data frame</em> segmentada por un factor del <em>data frame</em> es</p>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="#cb611-1" aria-hidden="true"></a><span class="kw">boxplot</span>(variable numérica<span class="op">~</span>factor, <span class="dt">data=</span>data frame)</span></code></pre></div>
<p>A modo de ejemplo, para dibujar en un único gráfico un diagrama de caja de la variable <code>Sepal.Length</code> del <em>data frame</em> <code>iris</code> para cada uno de los niveles del factor <code>Species</code>, podemos entrar</p>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="#cb612-1" aria-hidden="true"></a><span class="kw">boxplot</span>(Sepal.Length<span class="op">~</span>Species, <span class="dt">data=</span>iris, <span class="dt">ylab=</span><span class="st">&quot;Longitudes de sépalos (cm)&quot;</span>)</span></code></pre></div>
<p>y obtenemos la Figura @ref(fig:187), donde podemos observar diferencias sustanciales entre las longitudes de los sépalos de las tres especies, y además un valor inusualmente pequeño en el conjunto de valores de las flores virgínica.</p>
<div class="figure" style="text-align: center">
<img src="12chap12_Descripcion_cuantitativos_files/figure-html/187-1.png" alt="Diagramas de caja de las longitudes de sépalos de las flores iris agrupadas por especies." width="90%" />
<p class="caption">
(#fig:187)Diagramas de caja de las longitudes de sépalos de las flores iris agrupadas por especies.
</p>
</div>
<p>Aparte de los parámetros de la función <code>plot</code> que tengan sentido,
la función <code>boxplot</code> dispone de algunos parámetros específicos. Destacamos el parámetro <code>notch</code> que, igualado a <code>TRUE</code>, añade una muesca en la mediana de cada caja. Estas muescas se calculan de tal manera que si las de dos diagramas de caja no se solapan, se puede tomar como evidencia significativa de que las medianas de las poblaciones correspondientes son diferentes; por ejemplo,</p>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="#cb613-1" aria-hidden="true"></a><span class="kw">boxplot</span>(Sepal.Length<span class="op">~</span>Species, <span class="dt">data=</span>iris, <span class="dt">notch=</span><span class="ot">TRUE</span>, </span>
<span id="cb613-2"><a href="#cb613-2" aria-hidden="true"></a>        <span class="dt">ylab=</span><span class="st">&quot;Longitudes de sépalos (cm)&quot;</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>))</span></code></pre></div>
<p>produce el gráfico de la Figura @ref(fig:notch) donde, colores aparte, vemos que las muescas no se solapan, lo que nos permite afirmar con un alto grado de confianza que las medianas de las longitudes de los sépalos de las tres especies de flores iris son diferentes (en general, y no solo para la muestra concreta recogida en el <em>data frame</em>). Este tipo de conclusiones son las que persigue la estadística inferencial.</p>
<div class="figure" style="text-align: center">
<img src="12chap12_Descripcion_cuantitativos_files/figure-html/notch-1.png" alt="Diagramas de caja con muescas de las longitudes de sépalos de las flores iris agrupadas por especies." width="90%" />
<p class="caption">
(#fig:notch)Diagramas de caja con muescas de las longitudes de sépalos de las flores iris agrupadas por especies.
</p>
</div>
<p>A veces es útil superponer a un diagrama de caja una marca en el valor correspondiente a la media aritmética. Para ello se puede usar la función <code>points</code>. Considerad el bloque de código siguiente. Su primera instrucción produce el diagrama de caja de las longitudes de los sépalos de las flores iris agrupadas según la especie, de color gris claro; la segunda, calcula las medias de dichas longitudes para cada especie; finalmente, la tercera, añade al diagrama de caja de cada especie un diamante rojo en la ordenada correspondiente al valor de su media.</p>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="#cb614-1" aria-hidden="true"></a><span class="kw">boxplot</span>(Sepal.Length<span class="op">~</span>Species, <span class="dt">data=</span>iris, <span class="dt">col=</span><span class="st">&quot;lightgray&quot;</span>)</span>
<span id="cb614-2"><a href="#cb614-2" aria-hidden="true"></a>medias=<span class="kw">aggregate</span>(Sepal.Length<span class="op">~</span>Species, <span class="dt">data=</span>iris, <span class="dt">FUN=</span>mean)</span>
<span id="cb614-3"><a href="#cb614-3" aria-hidden="true"></a><span class="kw">points</span>(medias, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">pch=</span><span class="dv">18</span>)</span></code></pre></div>
<p><img src="12chap12_Descripcion_cuantitativos_files/figure-html/unnamed-chunk-50-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>El resultado de una instrucción <code>boxplot</code> tiene una estructura interna que podemos aprovechar. Observemos, por ejemplo, el resultado de la instrucción siguiente (el parámetro <code>plot=FALSE</code> indica que no dibuje el boxplot):</p>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="#cb615-1" aria-hidden="true"></a><span class="kw">str</span>(<span class="kw">boxplot</span>(Sepal.Length<span class="op">~</span>Species, <span class="dt">data=</span>iris, <span class="dt">plot=</span><span class="ot">FALSE</span>))</span>
<span id="cb615-2"><a href="#cb615-2" aria-hidden="true"></a><span class="co">#&gt; List of 6</span></span>
<span id="cb615-3"><a href="#cb615-3" aria-hidden="true"></a><span class="co">#&gt;  $ stats: num [1:5, 1:3] 4.3 4.8 5 5.2 5.8 4.9 5.6 5.9 6.3 7 ...</span></span>
<span id="cb615-4"><a href="#cb615-4" aria-hidden="true"></a><span class="co">#&gt;  $ n    : num [1:3] 50 50 50</span></span>
<span id="cb615-5"><a href="#cb615-5" aria-hidden="true"></a><span class="co">#&gt;  $ conf : num [1:2, 1:3] 4.91 5.09 5.74 6.06 6.34 ...</span></span>
<span id="cb615-6"><a href="#cb615-6" aria-hidden="true"></a><span class="co">#&gt;  $ out  : num 4.9</span></span>
<span id="cb615-7"><a href="#cb615-7" aria-hidden="true"></a><span class="co">#&gt;  $ group: num 3</span></span>
<span id="cb615-8"><a href="#cb615-8" aria-hidden="true"></a><span class="co">#&gt;  $ names: chr [1:3] &quot;setosa&quot; &quot;versicolor&quot; &quot;virginica&quot;</span></span></code></pre></div>
<p>Esto muestra que un <code>boxplot</code>, como objeto de R, es en realidad una <code>list</code>. Los significados de sus componentes se pueden consultar en la Ayuda de la función. Aquí queremos destacar las siguientes:</p>
<ul>
<li><code>stats</code> nos da, para cada diagrama de caja en el gráfico, los valores corresondientes a sus cinco líneas horizontales: <span class="math inline">\(b_{inf}, Q_{0.25}, Q_{0.5}, Q_{0.75}, b_{sup}\)</span>.</li>
</ul>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="#cb616-1" aria-hidden="true"></a><span class="kw">boxplot</span>(Sepal.Length<span class="op">~</span>Species, <span class="dt">data=</span>iris, <span class="dt">plot=</span><span class="ot">FALSE</span>)<span class="op">$</span>stats</span>
<span id="cb616-2"><a href="#cb616-2" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb616-3"><a href="#cb616-3" aria-hidden="true"></a><span class="co">#&gt; [1,]  4.3  4.9  5.6</span></span>
<span id="cb616-4"><a href="#cb616-4" aria-hidden="true"></a><span class="co">#&gt; [2,]  4.8  5.6  6.2</span></span>
<span id="cb616-5"><a href="#cb616-5" aria-hidden="true"></a><span class="co">#&gt; [3,]  5.0  5.9  6.5</span></span>
<span id="cb616-6"><a href="#cb616-6" aria-hidden="true"></a><span class="co">#&gt; [4,]  5.2  6.3  6.9</span></span>
<span id="cb616-7"><a href="#cb616-7" aria-hidden="true"></a><span class="co">#&gt; [5,]  5.8  7.0  7.9</span></span></code></pre></div>
<ul>
<li><code>out</code> nos da los valores atípicos. Si hay más de un diagrama de caja, la componente <code>group</code> nos indica los diagramas a los que pertenecen estos valores atípicos.</li>
</ul>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="#cb617-1" aria-hidden="true"></a><span class="kw">boxplot</span>(Sepal.Length<span class="op">~</span>Species, <span class="dt">data=</span>iris, <span class="dt">plot=</span><span class="ot">FALSE</span>)<span class="op">$</span>out</span>
<span id="cb617-2"><a href="#cb617-2" aria-hidden="true"></a><span class="co">#&gt; [1] 4.9</span></span>
<span id="cb617-3"><a href="#cb617-3" aria-hidden="true"></a><span class="kw">boxplot</span>(Sepal.Length<span class="op">~</span>Species, <span class="dt">data=</span>iris, <span class="dt">plot=</span><span class="ot">FALSE</span>)<span class="op">$</span>group</span>
<span id="cb617-4"><a href="#cb617-4" aria-hidden="true"></a><span class="co">#&gt; [1] 3</span></span></code></pre></div>

<div class="example">
<p><span id="exm:unnamed-chunk-54" class="example"><strong>(#exm:unnamed-chunk-54) </strong></span>Recordemos del Ejemplo @ref(exm:sprayord) el <em>data frame</em> <code>InsectSprays</code> que viene predefinido en R. Este <em>data frame</em> tiene una variable factor <code>spray</code> con 6 niveles que corresponden a tipos de insecticidas, y una variable numérica <code>count</code> que contiene números de insectos recolectados en campos tratados con los insecticidas. En aquel ejemplo convertimos la variable <code>count</code> en una variable ordinal, pero está claro que se trata de una variable cuantitativa; por lo tanto, podemos usar las técnicas explicadas en esta lección para comparar de manera más significativa la efectividad de los insecticidas a partir de los datos brutos de esta variable.</p>
</div>
<p>En primer lugar, obtenemos un resumen estadístico de los números de insectos recogidos en los campos tratados con cada tipo de insecticida.</p>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb618-1"><a href="#cb618-1" aria-hidden="true"></a><span class="kw">by</span>(InsectSprays<span class="op">$</span>count, InsectSprays<span class="op">$</span>spray, <span class="dt">FUN=</span>summary)</span>
<span id="cb618-2"><a href="#cb618-2" aria-hidden="true"></a><span class="co">#&gt; InsectSprays$spray: A</span></span>
<span id="cb618-3"><a href="#cb618-3" aria-hidden="true"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb618-4"><a href="#cb618-4" aria-hidden="true"></a><span class="co">#&gt;    7.00   11.50   14.00   14.50   17.75   23.00 </span></span>
<span id="cb618-5"><a href="#cb618-5" aria-hidden="true"></a><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span id="cb618-6"><a href="#cb618-6" aria-hidden="true"></a><span class="co">#&gt; InsectSprays$spray: B</span></span>
<span id="cb618-7"><a href="#cb618-7" aria-hidden="true"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb618-8"><a href="#cb618-8" aria-hidden="true"></a><span class="co">#&gt;    7.00   12.50   16.50   15.33   17.50   21.00 </span></span>
<span id="cb618-9"><a href="#cb618-9" aria-hidden="true"></a><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span id="cb618-10"><a href="#cb618-10" aria-hidden="true"></a><span class="co">#&gt; InsectSprays$spray: C</span></span>
<span id="cb618-11"><a href="#cb618-11" aria-hidden="true"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb618-12"><a href="#cb618-12" aria-hidden="true"></a><span class="co">#&gt;   0.000   1.000   1.500   2.083   3.000   7.000 </span></span>
<span id="cb618-13"><a href="#cb618-13" aria-hidden="true"></a><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span id="cb618-14"><a href="#cb618-14" aria-hidden="true"></a><span class="co">#&gt; InsectSprays$spray: D</span></span>
<span id="cb618-15"><a href="#cb618-15" aria-hidden="true"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb618-16"><a href="#cb618-16" aria-hidden="true"></a><span class="co">#&gt;   2.000   3.750   5.000   4.917   5.000  12.000 </span></span>
<span id="cb618-17"><a href="#cb618-17" aria-hidden="true"></a><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span id="cb618-18"><a href="#cb618-18" aria-hidden="true"></a><span class="co">#&gt; InsectSprays$spray: E</span></span>
<span id="cb618-19"><a href="#cb618-19" aria-hidden="true"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb618-20"><a href="#cb618-20" aria-hidden="true"></a><span class="co">#&gt;    1.00    2.75    3.00    3.50    5.00    6.00 </span></span>
<span id="cb618-21"><a href="#cb618-21" aria-hidden="true"></a><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span id="cb618-22"><a href="#cb618-22" aria-hidden="true"></a><span class="co">#&gt; InsectSprays$spray: F</span></span>
<span id="cb618-23"><a href="#cb618-23" aria-hidden="true"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb618-24"><a href="#cb618-24" aria-hidden="true"></a><span class="co">#&gt;    9.00   12.50   15.00   16.67   22.50   26.00</span></span></code></pre></div>
<p>Echando un vistazo a las columnas de las medianas y medias vemos que los insecticidas C, D y E son, en término medio, más efectivos que A, B y F. Como una imagen vale más que mil palabras, a continuación dibujamos en un gráfico los diagramas de caja de los valores de <code>count</code> separados por los niveles de <code>spray</code>.</p>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="#cb619-1" aria-hidden="true"></a><span class="kw">boxplot</span>(count<span class="op">~</span>spray, <span class="dt">data=</span>InsectSprays, <span class="dt">ylab=</span><span class="st">&quot;Número de insectos&quot;</span>, </span>
<span id="cb619-2"><a href="#cb619-2" aria-hidden="true"></a>        <span class="dt">xlab=</span><span class="st">&quot;Tipo de insecticida&quot;</span>, <span class="dt">col=</span><span class="st">&quot;pink&quot;</span>)</span></code></pre></div>
<p>Obtenemos la Figura @ref(fig:188), que muestra a simple vista la diferencia en la efectividad de los insecticidas. También se ve en este gráfico que los números de insectos obtenidos en los campos tratados con los insecticidas C, D y E presentan una menor variabilidad que el resto, puesto que sus cajas intercuartílicas son mucho más cortas; lo podemos confirmar calculando las correspondientes desviaciones típicas muestrales.</p>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="#cb620-1" aria-hidden="true"></a><span class="kw">aggregate</span>(count<span class="op">~</span>spray, <span class="dt">data=</span>InsectSprays, <span class="dt">FUN=</span>sd)</span>
<span id="cb620-2"><a href="#cb620-2" aria-hidden="true"></a><span class="co">#&gt;   spray    count</span></span>
<span id="cb620-3"><a href="#cb620-3" aria-hidden="true"></a><span class="co">#&gt; 1     A 4.719399</span></span>
<span id="cb620-4"><a href="#cb620-4" aria-hidden="true"></a><span class="co">#&gt; 2     B 4.271115</span></span>
<span id="cb620-5"><a href="#cb620-5" aria-hidden="true"></a><span class="co">#&gt; 3     C 1.975225</span></span>
<span id="cb620-6"><a href="#cb620-6" aria-hidden="true"></a><span class="co">#&gt; 4     D 2.503028</span></span>
<span id="cb620-7"><a href="#cb620-7" aria-hidden="true"></a><span class="co">#&gt; 5     E 1.732051</span></span>
<span id="cb620-8"><a href="#cb620-8" aria-hidden="true"></a><span class="co">#&gt; 6     F 6.213378</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="12chap12_Descripcion_cuantitativos_files/figure-html/188-1.png" alt="Diagramas de caja de los números de insectos en campos tratados con diferentes insecticidas." width="90%" />
<p class="caption">
(#fig:188)Diagramas de caja de los números de insectos en campos tratados con diferentes insecticidas.
</p>
</div>
</div>
<div id="guía-rápida-de-funciones-6" class="section level2" number="12.6">
<h2 number="12.6"><span class="header-section-number">12.6</span> Guía rápida de funciones</h2>
<ul>
<li><p><code>table</code> calcula la tabla de frecuencias absolutas de un vector.</p></li>
<li><p><code>prop.table</code> calcula la tabla de frecuencias relativas de un vector a partir de su tabla de frecuencias absolutas.</p></li>
<li><p><code>cumsum</code> calcula las sumas acumuladas de un vector.</p></li>
<li><p><code>as.vector</code> transforma un objeto en un vector.</p></li>
<li><p><code>mean</code> calcula la media de un vector numérico.</p></li>
<li><p><code>median</code> calcula la mediana de un vector numérico.</p></li>
<li><p><code>as.numeric(names(which(table(x)==max(table(x)))))</code> calcula la moda del vector <span class="math inline">\(x\)</span>.</p></li>
<li><p><code>quantile(x, p)</code> calcula el cuantil de orden <span class="math inline">\(p\)</span> del vector numérico <span class="math inline">\(x\)</span>. El parámetro <code>type</code> permite especificar el método.</p></li>
<li><p><code>range</code> produce un vector con el mínimo y el máximo de un vector numérico.</p></li>
<li><p><code>IQR</code> calcula el rango intercuartílico de un vector numérico. El parámetro <code>type</code> permite especificar el método de cálculo de los cuartiles.</p></li>
<li><p><code>var</code> calcula la varianza muestral de un vector numérico.</p></li>
<li><p><code>sd</code> calcula la desviación típica muestral de un vector numérico.</p></li>
<li><p><code>summary</code>, aplicado a un vector numérico, calcula sus extremos, sus cuartiles y su media; aplicado a un <em>data frame</em>, calcula resúmenes similares para todas sus variables.</p></li>
<li><p><code>by(data frame,factor, FUN=función)</code> aplica la <code>función</code> a las variables del <em>data frame</em> segmentadas según el <em>factor</em>.</p></li>
<li><p><code>boxplot</code> dibuja los diagramas de caja de los vectores numéricos a los que se aplica.
Algunos parámetros importantes:</p>
<ul>
<li><p>Los de <code>plot</code> que tengan sentido.</p></li>
<li><p><code>horizontal</code>: igualado a <code>TRUE</code>, dibuja las cajas horizontales.</p></li>
<li><p><code>names</code>: sirve para especificar los nombres bajo los diagramas de caja en un gráfico que contenga varios.</p></li>
<li><p><code>notch</code>: dibuja cinturas alrededor de las medianas que permiten contrastar si las medianas poblacionales son diferentes.</p></li>
<li><p><code>plot</code>: igualado a <code>FALSE</code> calcula el diagrama de caja, pero no lo dibuja.</p></li>
</ul>
<p>Como objeto de datos, el resultado de esta función es una <code>list</code> entre cuyas componentes destacamos:</p>
<ul>
<li><p><code>stats</code>: contiene, para cada diagrama de caja en el gráfico, sus valores
<span class="math inline">\(b_{inf}, Q_{0.25}, Q_{0.5}, Q_{0.75}, b_{sup}\)</span>.</p></li>
<li><p><code>out</code>: contiene los valores atípicos.</p></li>
<li><p><code>group</code>: indica los diagramas a los que pertenecen los valores atípicos.</p></li>
</ul></li>
</ul>
</div>
<div id="ejercicios-10" class="section level2" number="12.7">
<h2 number="12.7"><span class="header-section-number">12.7</span> Ejercicios</h2>
<div id="test-9" class="section level3 unnumbered">
<h3 class="unnumbered">Test</h3>
<p><em>(1)</em> ¿Qué vale la mediana de la variable <code>BH</code> de la tabla <a href="http://aprender.uib.es/Rdir/ESD.txt">http://aprender.uib.es/Rdir/ESD.txt</a>?</p>
<p><em>(2)</em> ¿Qué vale la varianza de la variable <code>BH</code> de la tabla <a href="http://aprender.uib.es/Rdir/ESD.txt">http://aprender.uib.es/Rdir/ESD.txt</a>? Dad su valor redondeado a 2 cifras decimales.</p>
<p><em>(3)</em> La tabla <code>DNase</code> es uno de los <em>data frames</em> que lleva predefinidos R. Con una sola instrucción, dibujad un diagrama de cajas básico de la variable <code>density</code> de este <em>data frames</em> agrupada por su factor <code>Run</code>. Y antes de contestar, por favor, comprobad que funciona.</p>
<p><em>(4)</em> Considerad la tabla de datos <code>happy</code> del paquete <strong>faraway</strong>. ¿Cuál de los cuatro valores de la variable <code>work</code> da un valor medio mayor de la variable <code>money</code>?</p>
<p><em>(5)</em> Considerad de nuevo la tabla de datos <code>happy</code> del paquete <strong>faraway</strong>. ¿Qué vale la varianza, redondeada a 3 cifras decimales, de los valores que toma la variable <code>happy</code> entre los individuos de esta tabla que tienen una actividad sexual satisfactoria?</p>
<p><em>(6)</em> Considerad de nuevo el <em>data frame</em> <code>DNase</code> que lleva predefinido R. Da el valor, redondeado a 3 cifras decimales, del bigote superior en el diagrama de caja de su variable <code>density</code> y responded, con SI o NO, si esta variable contiene valores atípicos por encima del bigote superior. Dad las dos respuestas en este orden y separadas por un espacio en blanco.</p>
</div>
<div id="ejercicio-9" class="section level3 unnumbered">
<h3 class="unnumbered">Ejercicio</h3>
<p>Considerad de nuevo la tabla del ejercicio de la lección anterior, que se encuentra en <a href="http://aprender.uib.es/Rdir/Notas2011A.txt">http://aprender.uib.es/Rdir/Notas2011A.txt</a>.
Definid un <em>data frame</em> con esta tabla, y comprobad con <code>str</code> y <code>head</code> que el <em>data frame</em> obtenido tiene la estructura deseada.</p>
<p><em>(a)</em> Calculad la media, la mediana y la desviación típica (redondeadas a 2 cifras decimales) de las notas numéricas del examen, tanto globalmente como por grupos. ¿En qué grupo hay más variación de notas? ¿Qué grupo tiene la nota media más alta? ¿Hay mucha diferencia en estos dos valores entre los grupos?</p>
<p><em>(b)</em> Dibujad en un único gráfico los diagramas de caja de las notas numéricas del examen de cada grupo; añadid marcas en las notas medias; poned nombres, título, etc., para que resulte más informativo. ¿Tiene algún grupo algún valor atípico? ¿Podéis decir a partir de este gráfico en qué grupo hay más variación de notas?</p>
<p><em>(c)</em> Agrupad los estudiantes de los dos grupos de Biología, BLM y BLT, en uno solo, BL, y repetid los dos puntos anteriores para los grados BL y BQ.</p>
<p><em>(d)</em> ¿Podéis extraer alguna conclusión sobre si el examen ha ido mejor en algún grupo que en los demás, o mejor en un grado que en el otro?</p>
</div>
<div id="respuestas-al-test-9" class="section level3 unnumbered">
<h3 class="unnumbered">Respuestas al test</h3>
<p><em>(1)</em> 133</p>
<p><em>(2)</em> 24.23</p>
<p><em>(3)</em> <code>boxplot(DNase$density~DNase$Run)</code> o <code>boxplot(density~Run,data=DNase)</code></p>
<p><em>(4)</em> 4</p>
<p><em>(5)</em> 3.097</p>
<p><em>(6)</em> 2.003 NO</p>
<!--chapter:end:12chap12_Descripcion_cuantitativos.Rmd-->
</div>
</div>
</div>
<div id="chap:hist" class="section level1" number="13">
<h1 number="13"><span class="header-section-number">13</span> Datos cuantitativos agrupados</h1>
<p>En nuestro lenguaje cotidiano, solemos agrupar datos cuantitativos sin que seamos conscientes de ello. Cuando decimos, por ejemplo, que la edad de alguien es de 18 años, no queremos decir que nació justo hoy hace 18 años, sino que ya ha cumplido los 18 años, pero aún no ha cumplido los 19; es decir, que agrupamos todas las edades que caen dentro del intervalo [18,19) en una misma clase, que llamamos “18 años”. Del mismo modo, que alguien mida 1.72 no significa que esta sea su altura exacta, con la precisión del grueso de un cabello, sino que su altura pertenece a un intervalo de valores en torno a 1.72 metros que identificamos con “1.72”. Bajo la calificación de “aprobado” agrupamos todas las notas mayores o iguales que 5 y menores que 7. Y estamos seguros de que se os ocurren otros ejemplos.</p>
<p>Cuando trabajamos en estadística con datos cuantitativos, puede haber varios motivos por los que nos interese agruparlos. Una posibilidad es que queramos estudiar la distribución de una cierta variable (pongamos, la altura) en una muestra de individuos, y que los valores que pueda tomar esta variable sean muy heterogéneos; en esta situación, lo normal sería que obtuviéramos muy pocas repeticiones, por lo que las frecuencias de los valores individuales serían muy bajas y por lo tanto muy similares. Esto daría lugar a un diagrama de barras difícil de interpretar.</p>
<p>Veamos un ejemplo: consideremos la siguiente muestra de 30 alturas de estudiantes:</p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="#cb621-1" aria-hidden="true"></a>alturas=<span class="kw">c</span>(<span class="fl">1.71</span>,<span class="fl">1.62</span>,<span class="fl">1.72</span>,<span class="fl">1.76</span>,<span class="fl">1.78</span>,<span class="fl">1.73</span>,<span class="fl">1.67</span>,<span class="fl">1.64</span>,<span class="fl">1.63</span>,<span class="fl">1.68</span>,<span class="fl">1.68</span>,<span class="fl">1.70</span>,<span class="fl">1.67</span>,</span>
<span id="cb621-2"><a href="#cb621-2" aria-hidden="true"></a>  <span class="fl">1.56</span>,<span class="fl">1.66</span>,<span class="fl">1.57</span>,<span class="fl">1.69</span>,<span class="fl">1.68</span>,<span class="fl">1.67</span>,<span class="fl">1.75</span>,<span class="fl">1.61</span>,<span class="fl">1.60</span>,<span class="fl">1.74</span>,<span class="fl">1.70</span>,<span class="fl">1.65</span>,<span class="fl">1.55</span>,<span class="fl">1.82</span>,<span class="fl">1.70</span>,<span class="fl">1.69</span>,<span class="fl">1.81</span>)</span></code></pre></div>
<p>El gráfico siguiente muestra el diagrama de barras de sus frecuencias, tomando como posibles niveles todas las alturas entre su mínimo y su máximo, redondeadas a cm. Todas la barras tienen alturas entre 0 y 3, y salvo una mayor presencia de los valores centrales (entre 1.67 y 1.70), no hay mucho más que salte a la vista en este gráfico.</p>
<p><img src="13chap13_Agrupados_files/figure-html/unnamed-chunk-2-1.png" width="60%" style="display: block; margin: auto;" /></p>
<p>En situaciones como esta, es recomendable dividir los posibles valores de la variable en intervalos y contar cuántos datos caen dentro de cada intervalo: habitualmente, las frecuencias que se obtienen de esta manera son más fáciles de interpretar que las de los datos individuales. Así, siguiendo con nuestro ejemplo de las alturas, el diagrama de barras siguiente representa sus frecuencias cuando las agrupamos en intervalos de 5 cm. La distribución de estas alturas es mucho más fácil de entender mediante este gráfico que con el primero.</p>
<p><img src="13chap13_Agrupados_files/figure-html/unnamed-chunk-3-1.png" width="60%" style="display: block; margin: auto;" /></p>
<p>Otro motivo por el que puede ser conveniente agrupar datos es la imposibilidad física de medir de manera exacta algunas magnitudes continuas como alturas, pesos o tiempos; esto hace que los datos obtenidos sean sólo aproximaciones o redondeos de los valores reales y que cada medida diferente represente todo un intervalo de posibles valores.</p>
<p>En general, hay tres situaciones concretas en las cuales conviene agrupar datos cuantitativos en intervalos de valores, también llamados <strong>clases</strong>:</p>
<ul>
<li><p>Cuando los datos son continuos y no se pueden medir de manera exacta: su redondeo ya define un agrupamiento</p></li>
<li><p>Cuando los datos son discretos, pero con un número muy grande de posibles valores: números de aminoácidos en proteínas, números de bases en cadenas de ADN…</p></li>
<li><p>Cuando tenemos muchos datos y nos interesa estudiar las frecuencias de sus valores; hay autores que consideran que <em>muchos</em>, en este contexto, significa “a partir de 30”</p></li>
</ul>
<div id="cómo-agrupar-datos" class="section level2" number="13.1">
<h2 number="13.1"><span class="header-section-number">13.1</span> Cómo agrupar datos</h2>
<p>El paso previo al estudio de unos datos agrupados es, naturalmente, agruparlos. El proceso es el siguiente:</p>
<ol style="list-style-type: decimal">
<li>Se decide el número de intervalos que se van a usar.</li>
<li>Se decide su amplitud.</li>
<li>Se calculan los extremos de los intervalos.</li>
<li>Finalmente, en algunas aplicaciones, se calcula un valor representativo de cada intervalo, llamado su <strong>marca de clase</strong>.</li>
</ol>
<p>No hay una manera de agrupar datos mejor que otra; por ejemplo, para estudiar las calificaciones de un curso podemos agruparlas en Suspenso, [0,5), Aprobado, [5,7) Notable, [7,9), y Sobresaliente, [9,10], o podemos redondear por defecto las notas a su parte entera y usar los intervalos [0,1), [1,2), …, [9,10]. Podría ser que cada uno de estos agrupamientos saque a la luz características diferentes del conjunto de datos.</p>
<p>La función básica de R para estudiar datos agrupados, <code>hist</code>, implementa todo el proceso: si le entramos el vector de datos y el número de intervalos, o el método para determinarlo (véase más adelante), agrupará los datos en, más o menos, el número de clases que le hemos especificado, sin ningún control por nuestra parte sobre los intervalos que produce. Para un análisis somero de los datos, esto suele ser más que suficiente, pero para una descripción más cuidadosa es conveniente que seamos nosotros quienes controlemos el proceso de agrupamiento, y en particular que calculemos los extremos de los intervalos, en lugar de dejárselos calcular a R.
En esta sección explicamos <strong>nuestra receta</strong> para agrupar datos y calcular marcas de clase; no es ni mejor ni peor que otras, pero es la que os recomendamos que uséis, sobre todo en el test si queréis obtener las respuestas correctas.</p>
<p>Lo primero que tenemos que hacer es establecer el número <span class="math inline">\(k\)</span> de clases en las que vamos a dividir el conjunto de datos, al que denotaremos en lo que sigue por <span class="math inline">\(x\)</span>. Podemos decidir este número de clases en función de nuestros intereses concretos, o podemos usar alguna de las reglas que se han propuesto con este fin; las más populares son las siguientes, donde <span class="math inline">\(n\)</span> denota el número de datos en la muestra (recordad en lo que sigue que <span class="math inline">\(\lceil x \rceil\)</span> denota el menor entero que es mayor o igual que <span class="math inline">\(x\)</span>, y que con R se calcula mediante la función <code>ceiling</code>):</p>
<ul>
<li><p><strong>Regla de la raíz cuadrada</strong>: <span class="math inline">\(k=\big\lceil \sqrt{n}\big\rceil\)</span>.</p></li>
<li><p><strong>Regla de Sturges</strong>: <span class="math inline">\(k= \big\lceil 1+\log_{2}(n)\big\rceil.\)</span></p></li>
<li><p><strong>Regla de Scott</strong>: Se determina primero la <strong>amplitud teórica</strong> <span class="math inline">\(A_S\)</span> de las clases mediante la fórmula
<span class="math display">\[
A_S= 3.5\cdot \widetilde{s}\cdot n^{-\frac{1}{3}}
\]</span>
(donde <span class="math inline">\(\widetilde{s}\)</span> es la desviación típica muestral del conjunto de datos), y entonces se toma
<span class="math display">\[
k=\left\lceil
\frac{\max(x) -\min(x)}{A_S}\right\rceil.
\]</span></p></li>
<li><p><strong>Regla de Freedman-Diaconis</strong>: Se determina primero la <strong>amplitud teórica</strong> <span class="math inline">\(A_{FD}\)</span> de las clases por medio de la fórmula
<span class="math display">\[
A_{FD}= 2 \cdot (Q_{0.75}-Q_{0.25}) \cdot n^{-\frac{1}{3}}
\]</span>
(recordad que <span class="math inline">\(Q_{0.75}-Q_{0.25}\)</span> es el rango intercuartílico), y entonces se toma de nuevo
<span class="math display">\[
k= \left\lceil \frac{\max(x) -\min(x)}{A_{FD}}\right\rceil.
\]</span></p></li>
</ul>
<p>Como podéis ver, las dos primeras sólo dependen de <span class="math inline">\(n\)</span>, mientras que las dos últimas tienen en cuenta, de maneras diferentes, su dispersión. No hay una regla mejor que las otras y, además, números de clases diferentes pueden revelar características diferentes de los datos. Las tres últimas reglas están implementadas en las funciones <code>nclass.Sturges</code>, <code>nclass.scott</code> y <code>nclass.FD</code> de R, respectivamente.</p>

<div class="example">
<p><span id="exm:alerg" class="example"><strong>(#exm:alerg) </strong></span>Mucha gente manifiesta reacciones alérgicas sistémicas a las picaduras de insecto.
Estas reacciones varían entre pacientes, no sólo en lo que se refiere a la gravedad de la reacción,
sino también en el tiempo que tarda en manifestarse.</p>
<p>En un estudio se midió, en 40 pacientes que experimentaron una reacción alérgica a una picadura de abeja,
el tiempo de inicio de esta reacción desde la picadura, y se obtuvieron los datos siguientes, que expresamos en minutos:</p>
</div>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb622-1"><a href="#cb622-1" aria-hidden="true"></a>alergia=<span class="kw">c</span>(<span class="fl">10.5</span>,<span class="fl">11.2</span>,<span class="fl">9.9</span>,<span class="fl">15.0</span>,<span class="fl">11.4</span>,<span class="fl">12.7</span>,<span class="fl">16.5</span>,<span class="fl">10.1</span>,<span class="fl">12.7</span>,<span class="fl">11.4</span>,<span class="fl">11.6</span>,<span class="fl">6.2</span>,<span class="fl">7.9</span>,</span>
<span id="cb622-2"><a href="#cb622-2" aria-hidden="true"></a>  <span class="fl">8.3</span>,<span class="fl">10.9</span>,<span class="fl">8.1</span>,<span class="fl">3.8</span>,<span class="fl">10.5</span>,<span class="fl">11.7</span>,<span class="fl">8.4</span>,<span class="fl">12.5</span>,<span class="fl">11.2</span>,<span class="fl">9.1</span>,<span class="fl">10.4</span>,<span class="fl">9.1</span>,<span class="fl">13.4</span>,<span class="fl">12.3</span>,<span class="fl">5.9</span>,<span class="fl">11.4</span>,</span>
<span id="cb622-3"><a href="#cb622-3" aria-hidden="true"></a>  <span class="fl">8.8</span>,<span class="fl">7.4</span>,<span class="fl">8.6</span>,<span class="fl">13.6</span>,<span class="fl">14.7</span>,<span class="fl">11.5</span>,<span class="fl">11.5</span>,<span class="fl">10.9</span>,<span class="fl">9.8</span>,<span class="fl">12.9</span>,<span class="fl">9.9</span>)</span></code></pre></div>
<p>Vamos a dar los números de intervalos en los que tendríamos que dividir estos datos según las diferentes reglas que hemos explicado. Antes, vamos a calcular los estadísticos de este conjunto de datos que vamos a usar:</p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="#cb623-1" aria-hidden="true"></a><span class="kw">length</span>(alergia)  <span class="co">#Número de datos</span></span>
<span id="cb623-2"><a href="#cb623-2" aria-hidden="true"></a><span class="co">#&gt; [1] 40</span></span>
<span id="cb623-3"><a href="#cb623-3" aria-hidden="true"></a><span class="kw">sd</span>(alergia) <span class="co">#Desviación típica muestral</span></span>
<span id="cb623-4"><a href="#cb623-4" aria-hidden="true"></a><span class="co">#&gt; [1] 2.533609</span></span>
<span id="cb623-5"><a href="#cb623-5" aria-hidden="true"></a><span class="kw">diff</span>(<span class="kw">range</span>(alergia))  <span class="co">#Rango de valores</span></span>
<span id="cb623-6"><a href="#cb623-6" aria-hidden="true"></a><span class="co">#&gt; [1] 12.7</span></span>
<span id="cb623-7"><a href="#cb623-7" aria-hidden="true"></a><span class="kw">IQR</span>(alergia) <span class="co"># Rango intercuartílico</span></span>
<span id="cb623-8"><a href="#cb623-8" aria-hidden="true"></a><span class="co">#&gt; [1] 2.825</span></span></code></pre></div>
<ul>
<li><p><strong>Regla de la raíz cuadrada</strong>: <span class="math inline">\(k= \lceil \sqrt{40} \rceil =\lceil 6.3245\rceil=7\)</span></p></li>
<li><p><strong>Regla de Sturges</strong>: <span class="math inline">\(k= \lceil 1+\log_{2}(40)\rceil= \lceil 6.321928\rceil=7\)</span>. Con R:</p></li>
</ul>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="#cb624-1" aria-hidden="true"></a><span class="kw">nclass.Sturges</span>(alergia)</span>
<span id="cb624-2"><a href="#cb624-2" aria-hidden="true"></a><span class="co">#&gt; [1] 7</span></span></code></pre></div>
<ul>
<li><strong>Regla de Scott</strong>: <span class="math inline">\(A_{S}= 3.5\cdot \widetilde{s}\cdot n^{-\frac{1}{3}}=3.5\cdot 2.533609 \cdot 40^{-\frac{1}{3}}= 2.592911\)</span> y entonces, como el rango del conjunto de datos es 12.7, tenemos que <span class="math inline">\(k=\lceil {12.7}/{2.592911}\rceil=\lceil 4.89797\rceil=5\)</span>. Con R:</li>
</ul>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="#cb625-1" aria-hidden="true"></a><span class="kw">nclass.scott</span>(alergia)</span>
<span id="cb625-2"><a href="#cb625-2" aria-hidden="true"></a><span class="co">#&gt; [1] 5</span></span></code></pre></div>
<ul>
<li><strong>Regla de Freedman-Diaconis</strong>: <span class="math inline">\(A_{FD}= 2 \cdot (Q_{0.75}-Q_{0.25}) \cdot n^{-\frac{1}{3}}=2\cdot 2.825 \cdot 40^{-\frac{1}{3}}=1.65207\)</span> y por lo tanto <span class="math inline">\(k= \lceil {12.7}/{1.65207}\rceil=\lceil 7.687\rceil=8\)</span>. Con R:</li>
</ul>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="#cb626-1" aria-hidden="true"></a><span class="kw">nclass.FD</span>(alergia)</span>
<span id="cb626-2"><a href="#cb626-2" aria-hidden="true"></a><span class="co">#&gt; [1] 8</span></span></code></pre></div>
<p>Como podéis ver, reglas diferentes pueden dar valores diferentes, y puede que no.</p>
<p>Una vez determinado el número <span class="math inline">\(k\)</span> de clases, tenemos que decidir su amplitud. La forma más sencilla, y que adoptaremos por defecto, es tomar todos los intervalos de la misma amplitud (aunque no es la única forma posible de hacerlo, naturalmente: recordad, por ejemplo, el agrupamiento de las calificaciones en Suspenso, Aprobado, Notable y Sobresaliente, que representan intervalos de notas de amplitudes diferentes). Para calcular esta amplitud, <span class="math inline">\(A\)</span>, dividiremos el rango de los datos entre el número <span class="math inline">\(k\)</span> de clases y redondearemos por exceso a un valor de la precisión de la medida: si medimos edades con una precisión de años, redondearemos este cociente por exceso a años, si medimos alturas con una precisión de centímetros, redondearemos por exceso a centímetros, etc. En el caso improbable de que el cociente del rango entre el número de clases dé un valor exacto en la precisión de la medida, tomaremos como <span class="math inline">\(A\)</span> este cociente más una unidad de precisión; así, por ejemplo, si hemos medido unas alturas en metros con una precisión de centímetros y obtenemos que el cociente del rango entre <span class="math inline">\(k\)</span> da un número exacto de centímetros, tomaremos como amplitud <span class="math inline">\(A\)</span> este cociente más 1 cm.</p>

<div class="example">
<p><span id="exm:unnamed-chunk-9" class="example"><strong>(#exm:unnamed-chunk-9) </strong></span>Seguimos con el Ejemplo @ref(exm:alerg); vamos a continuar el proceso de agrupamiento de los datos en <span class="math inline">\(k=7\)</span> clases.
Recordemos que el rango del conjunto de datos en cuestión es 12.7 y que los datos están expresados en minutos
con una precisión de una cifra decimal; por lo tanto, la amplitud será el cociente <span class="math inline">\(12.7/7=1.8143\)</span> redondeado
por exceso a una cifra decimal: <span class="math inline">\(A=1.9\)</span>.</p>
</div>
<p>Ahora hemos de calcular los extremos de los intervalos. En este curso, tomaremos estos intervalos siempre cerrados a la izquierda y abiertos a la derecha, y los denotaremos por
<span class="math display">\[
[L_1,L_2),[L_2,L_3),\ldots, [L_k,L_{k+1}).
\]</span>
Sin entrar en detalles, el motivo por el que tomamos los intervalos de esta forma y no al revés (abiertos por la izquierda y cerrados por la derecha, que es como los construye R por defecto) es porque así es como se usan en Teoría de Probabilidades al definir la distribución de una variable aleatoria discreta, y también en muchas situaciones cotidianas (calificaciones, edades…). En todo caso, queremos haceros notar que, con la regla que explicamos a continuación, los extremos de los intervalos nunca van a coincidir con valores del conjunto de datos. Por lo tanto, si la usáis, tanto dará si consideráis los intervalos abiertos o cerrados en sus extremos.</p>
<p>Los extremos <span class="math inline">\(L_1,\ldots,L_{k+1}\)</span> de estos intervalos se calculan de la manera siguiente: tomamos como extremo izquierdo <span class="math inline">\(L_1\)</span> del primer intervalo el valor
<span class="math display">\[
L_1=\min(x)-\frac{1}{2}\cdot \text{precisión} 
\]</span>
Es decir, si la precisión son las unidades en las que hemos medido los datos, <span class="math inline">\(L_1=\min(x)-0.5\)</span>; si la precisión son décimas de unidad, <span class="math inline">\(L_1=\min(x)-0.05\)</span>; etc. A partir de este extremo inferior, cada uno de los extremos siguientes se obtiene sumando la amplitud al extremo anterior: <span class="math inline">\(L_2=L_1+A\)</span>, <span class="math inline">\(L_3=L_{2}+A\)</span> y así sucesivamente, hasta llegar a <span class="math inline">\(L_{k+1}=L_{k}+A\)</span>. Por consiguiente, estos extremos forman una progresión aritmética de paso <span class="math inline">\(A\)</span>:
<span class="math display">\[
L_i=L_1+(i-1)A,\quad i=2,\ldots,k+1.
\]</span>
Como decíamos, de esta manera se garantiza que los extremos de los intervalos nunca coincidan con valores del conjunto de datos: por ejemplo, si los datos están expresados con una sola cifra decimal, estos extremos tienen todos un 5 en su segunda cifra decimal.</p>

<div class="example">
<p><span id="exm:unnamed-chunk-10" class="example"><strong>(#exm:unnamed-chunk-10) </strong></span>Continuemos con el Ejemplo @ref(exm:alerg) y <span class="math inline">\(k=7\)</span>; hemos visto que tenemos que tomar <span class="math inline">\(A=1.9\)</span>. El valor mínimo del conjunto de datos es:</p>
</div>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="#cb627-1" aria-hidden="true"></a><span class="kw">min</span>(alergia)</span>
<span id="cb627-2"><a href="#cb627-2" aria-hidden="true"></a><span class="co">#&gt; [1] 3.8</span></span></code></pre></div>
<p>Además, los datos están expresados con una precisión de décimas de unidad. El extremo inferior del primer intervalo será, entonces, <span class="math inline">\(L_1=3.8-0.05=3.75\)</span>, y a partir de aquí obtendremos el resto de extremos mediante una progresión aritmética de paso 1.9:
<span class="math display">\[
\begin{array}{l}
L_1=3.75\\
L_2=3.75+1.9=5.65\\ 
L_3=3.75+2\cdot 1.9 = 7.55\\ 
L_4= 3.75+3\cdot 1.9 = 9.45\\ 
L_5= 3.75+4\cdot 1.9 = 11.35\\ 
L_6= 3.75+5\cdot 1.9 = 13.25\\
L_7= 3.75+6\cdot 1.9 = 15.15\\
 L_8= 3.75+7\cdot 1.9 = 17.05
\end{array}
\]</span>
Los intervalos son, por lo tanto,
<span class="math display">\[
\begin{array}{l}
[3.75,5.65),\ [5.65,7.55),\ [7.55,9.45),\ [9.45, 11.35),\ [11.35 ,13.25),\\{}
[13.25,15.15),\ [15.15,17.05).
\end{array}
\]</span></p>
<p>Finalmente, hemos de determinar la <strong>marca de clase</strong> <span class="math inline">\(X_i\)</span> de cada intervalo <span class="math inline">\([L_i,L_{i+1})\)</span>; se trata de un valor del intervalo que usaremos para identificar la clase y para calcular algunos estadísticos. Como regla general, en este curso marcaremos el punto medio del intervalo,
<span class="math display">\[
X_i=\frac{L_{i}+L_{i+1}}{2};
\]</span>
de esta manera, el error máximo que se comete al describir cualquier elemento del intervalo por medio de su marca de clase es mínimo e igual a la mitad de la amplitud del intervalo.</p>
<p>Como todos los intervalos tienen la misma amplitud <span class="math inline">\(A\)</span>, la diferencia entre dos puntos medios consecutivos será también <span class="math inline">\(A\)</span>, y por consiguiente las marcas de clase formarán de nuevo una progresión aritmética de paso <span class="math inline">\(A\)</span>:
<span class="math display">\[
X_1=\frac{L_1+L_2}{2}\quad \text{ y }\quad X_i=X_1+(i-1)A, \quad i=2,\ldots,k.
\]</span></p>

<div class="example">
<span id="exm:unnamed-chunk-12" class="example"><strong>(#exm:unnamed-chunk-12) </strong></span>Continuemos con el Ejemplo @ref(exm:alerg) para <span class="math inline">\(k=7\)</span>. Las marcas de clase serán los puntos medios de los intervalos que hemos determinado en el ejemplo anterior; como hemos visto, formarán una progresión aritmética de origen el punto medio del primer intervalo y paso la amplitud de las clases:
<span class="math display">\[
\begin{array}{l}
X_1=(3.75+5.65)/2=4.7\\
X_2= 4.7 +1.9= 6.6\\
X_3= 4.7 + 2\cdot 1.9 = 8.5\\
X_4= 4.7 + 3\cdot 1.9= 10.4\\
X_5= 4.7 + 4\cdot 1.9= 12.3\\
X_6=4.7 + 5\cdot 1.9= 14.2\\
X_7= 4.7 + 6\cdot 1.9= 16.1
\end{array}
\]</span>
</div>

<div class="example">
<p><span id="exm:alerg7cl" class="example"><strong>(#exm:alerg7cl) </strong></span>Volvamos a la situación inicial del Ejemplo @ref(exm:alerg), y esta vez vamos a agrupar los datos siguiendo la regla de Scott.
Ya calculamos en su momento que, con esta regla, tenemos que usar <span class="math inline">\(k=5\)</span> intervalos. Como el rango de los datos es 12.7 y <span class="math inline">\(12.7/5=2.54\)</span>, redondeando por exceso este cociente a una décima obtenemos que la amplitud de los intervalos ha de ser <span class="math inline">\(A=2.6\)</span>.</p>
</div>
<p>Calculemos los extremos de los intervalos: el extremo inferior del primero es, de nuevo, <span class="math inline">\(L_1=3.8-0.05=3.75\)</span>, y a partir de este valor, los otros extremos se obtienen sumando consecutivamente la amplitud hasta llegar a <span class="math inline">\(L_6\)</span>:</p>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="#cb628-1" aria-hidden="true"></a>L=<span class="fl">3.75+2.6</span><span class="op">*</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb628-2"><a href="#cb628-2" aria-hidden="true"></a>L</span>
<span id="cb628-3"><a href="#cb628-3" aria-hidden="true"></a><span class="co">#&gt; [1]  3.75  6.35  8.95 11.55 14.15 16.75</span></span></code></pre></div>
<p>Los intervalos son, por lo tanto,
<span class="math display">\[
[3.75, 6.35),\ [6.35,8.95),\ [8.95,11.55),\ [11.55, 14.15),\ [14.15 ,16.75).
\]</span></p>
<p>La marca de clase del primer intervalo es su punto medio:
<span class="math display">\[
X_1=\frac{3.75+ 6.35}{2}= 5.05.
\]</span>
A partir de este valor, las otras marcas se obtienen sumando consecutivamente la amplitud hasta llegar a <span class="math inline">\(X_5\)</span>:</p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="#cb629-1" aria-hidden="true"></a>X=<span class="fl">5.05+2.6</span><span class="op">*</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">4</span>)</span>
<span id="cb629-2"><a href="#cb629-2" aria-hidden="true"></a>X</span>
<span id="cb629-3"><a href="#cb629-3" aria-hidden="true"></a><span class="co">#&gt; [1]  5.05  7.65 10.25 12.85 15.45</span></span></code></pre></div>
<p>También podríamos haber calculado estas marcas de clase definiéndolas directamente como los puntos medios de los intervalos:</p>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="#cb630-1" aria-hidden="true"></a>X=(L[<span class="op">-</span><span class="kw">length</span>(L)]<span class="op">+</span>L[<span class="op">-</span><span class="dv">1</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb630-2"><a href="#cb630-2" aria-hidden="true"></a>X</span>
<span id="cb630-3"><a href="#cb630-3" aria-hidden="true"></a><span class="co">#&gt; [1]  5.05  7.65 10.25 12.85 15.45</span></span></code></pre></div>
<p>Observad que, en esta última construcción, <code>L[-length(L)]</code> es el vector <span class="math inline">\(L_1,L_2,\ldots,L_k\)</span> (obtenido a partir de <span class="math inline">\(L_1,L_2,\ldots,L_k,L_{k+1}\)</span> eliminando su último elemento) y
<code>L[-1]</code> es el vector <span class="math inline">\(L_2,L_3,\ldots,L_{k+1}\)</span> (obtenido a partir de <span class="math inline">\(L_1,L_2,\ldots,L_k,L_{k+1}\)</span> eliminando su primer elemento), por lo que</p>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="#cb631-1" aria-hidden="true"></a>(L[<span class="op">-</span><span class="kw">length</span>(L)]<span class="op">+</span>L[<span class="op">-</span><span class="dv">1</span>]])<span class="op">/</span><span class="dv">2</span></span></code></pre></div>
<p>define el vector
<span class="math display">\[
\frac{L_1+L_2}{2},\frac{L_2+L_3}{2},\ldots,\frac{L_k+L_{k+1}}{2}
\]</span>
formado por las marcas de clase.</p>
<p>Una vez agrupados los datos, ya podemos empezar a estudiarlos. Una primera posibilidad es considerar las clases como los niveles de una variable ordinal y calcular sus frecuencias; así,</p>
<ul>
<li><p>la <strong>frecuencia absoluta</strong> de una clase será el número de datos originales que pertenecen a esta clase</p></li>
<li><p>la <strong>frecuencia absoluta acumulada</strong> de una clase será el número de datos originales que pertenecen a esta clase o a alguna de las anteriores</p></li>
<li><p>etc.</p></li>
</ul>
<p>La manera usual de representar las frecuencias de un conjunto de datos agrupados es la que mostramos en la tabla siguiente, donde <span class="math inline">\(X_j\)</span> indica la marca de clase, <span class="math inline">\(n_j\)</span> la frecuencia absoluta de la clase, <span class="math inline">\(N_j\)</span> su frecuencia absoluta acumulada, <span class="math inline">\(f_j\)</span> su frecuencia relativa y <span class="math inline">\(F_j\)</span> su frecuencia relativa acumulada. De esta manera, <span class="math inline">\(N_k\)</span> será igual al número total de datos recogidos y <span class="math inline">\(F_k\)</span> siempre valdrá 1.</p>
<p><span class="math display">\[
\begin{array}{lccccc}
\hline \text{clases} &amp; X_j &amp;
n_j &amp; N_j &amp; f_j &amp; F_j
\\\hline \left[L_1,L_2\right) &amp; X_1 &amp; n_1 &amp; N_1 &amp; f_1 &amp; F_1 \\
\left[L_2,L_3\right) &amp; X_2 &amp; n_2 &amp; N_2 &amp; f_2 &amp; F_2 \\
\quad\ \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
\left[L_k,L_{k+1}\right) &amp; X_k &amp; n_k &amp; N_k &amp; f_k &amp; F_k\\ \hline
\end{array}
\]</span></p>

<div class="example">
<p><span id="exm:table1" class="example"><strong>(#exm:table1) </strong></span>Continuemos con el Ejemplo @ref(exm:alerg). Recordemos los datos, que damos ordenados para facilitar el cálculo de la tabla de frecuencias:</p>
</div>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="#cb632-1" aria-hidden="true"></a><span class="kw">sort</span>(alergia)</span>
<span id="cb632-2"><a href="#cb632-2" aria-hidden="true"></a><span class="co">#&gt;  [1]  3.8  5.9  6.2  7.4  7.9  8.1  8.3  8.4  8.6  8.8  9.1  9.1  9.8  9.9  9.9</span></span>
<span id="cb632-3"><a href="#cb632-3" aria-hidden="true"></a><span class="co">#&gt; [16] 10.1 10.4 10.5 10.5 10.9 10.9 11.2 11.2 11.4 11.4 11.4 11.5 11.5 11.6 11.7</span></span>
<span id="cb632-4"><a href="#cb632-4" aria-hidden="true"></a><span class="co">#&gt; [31] 12.3 12.5 12.7 12.7 12.9 13.4 13.6 14.7 15.0 16.5</span></span></code></pre></div>
<p>Las frecuencias de este conjunto de datos para su agrupamiento en 7 clases obtenido en el Ejemplo @ref(exm:alerg7cl) se muestran en la tabla siguiente. Para construir esta tabla, primero hemos calculado las frecuencias absolutas de cada clase: sólo hay 1 valor dentro de [3.75, 5.65), por lo que <span class="math inline">\(n_1=1\)</span>; hay 3 valores dentro de [5.65, 7.55), por lo que <span class="math inline">\(n_2=3\)</span>; etc. A partir de estas frecuencias absolutas, hemos calculado el resto de la manera usual.</p>
<p><span class="math display">\[
\begin{array}{lrrrrr}
  \hline
\text{clases} &amp; X_j &amp; n_j &amp; N_j &amp; f_j &amp; F_j \\ 
  \hline
\left[3.75, 5.65\right) &amp; 4.7 &amp;   1 &amp;   1 &amp; 0.025 &amp; 0.025 \\ 
\left[5.65, 7.55\right) &amp; 6.6 &amp;   3 &amp;   4 &amp; 0.075 &amp; 0.100 \\ 
\left[7.55, 9.45\right) &amp; 8.5 &amp;   8 &amp;  12 &amp; 0.200 &amp; 0.300 \\ 
\left[9.45, 11.35\right) &amp; 10.4 &amp;  11 &amp;  23 &amp; 0.275 &amp; 0.575 \\ 
\left[11.35, 13.25\right) &amp; 12.3 &amp;  12 &amp;  35 &amp; 0.300 &amp; 0.875 \\ 
\left[13.25, 15.15\right) &amp; 14.2 &amp;   4 &amp;  39 &amp; 0.100 &amp; 0.975 \\ 
\left[15.15, 17.05\right) &amp; 16.1 &amp;   1 &amp;  40 &amp; 0.025 &amp; 1.000 \\ 
   \hline
\end{array}
\]</span></p>

<div class="example">
<p><span id="exm:fruitals" class="example"><strong>(#exm:fruitals) </strong></span>Los siguientes valores son números de árboles frutales afectados por la mosca de la fruta en 50 terrenos rústicos de las mismas dimensiones:</p>
</div>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="#cb633-1" aria-hidden="true"></a>fruta=<span class="kw">c</span>(<span class="dv">8</span>,<span class="dv">11</span>,<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">16</span>,<span class="dv">6</span>,<span class="dv">12</span>,<span class="dv">19</span>,<span class="dv">13</span>,<span class="dv">6</span>,<span class="dv">9</span>,<span class="dv">13</span>,<span class="dv">15</span>,<span class="dv">9</span>,<span class="dv">12</span>,<span class="dv">16</span>,<span class="dv">8</span>,<span class="dv">7</span>,<span class="dv">14</span>,<span class="dv">11</span>,<span class="dv">15</span>,<span class="dv">6</span>,<span class="dv">14</span>,</span>
<span id="cb633-2"><a href="#cb633-2" aria-hidden="true"></a>  <span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">11</span>,<span class="dv">6</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">19</span>,<span class="dv">12</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">6</span>,<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">16</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">12</span>,<span class="dv">12</span>,<span class="dv">8</span>,<span class="dv">17</span>,<span class="dv">13</span>,<span class="dv">7</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">12</span>)</span></code></pre></div>
<p>Para estudiar estos valores, vamos a agruparlos; par variar, usaremos la regla de Freedman-Diaconis.</p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="#cb634-1" aria-hidden="true"></a><span class="kw">nclass.FD</span>(fruta)</span>
<span id="cb634-2"><a href="#cb634-2" aria-hidden="true"></a><span class="co">#&gt; [1] 5</span></span>
<span id="cb634-3"><a href="#cb634-3" aria-hidden="true"></a><span class="kw">diff</span>(<span class="kw">range</span>(fruta))<span class="op">/</span><span class="dv">5</span></span>
<span id="cb634-4"><a href="#cb634-4" aria-hidden="true"></a><span class="co">#&gt; [1] 2.6</span></span>
<span id="cb634-5"><a href="#cb634-5" aria-hidden="true"></a><span class="kw">min</span>(fruta)</span>
<span id="cb634-6"><a href="#cb634-6" aria-hidden="true"></a><span class="co">#&gt; [1] 6</span></span></code></pre></div>
<p>Por consiguiente, usaremos 5 clases. Como hemos dado las medidas con una precisión de unidades,
para calcular su amplitud <span class="math inline">\(A\)</span> hemos de redondear por exceso a unidades el cociente entre el rango de la variable y el número de clases; este cociente vale 2.6, y por lo tanto <span class="math inline">\(A=3\)</span>. Recordad que, si la precisión hubiera sido de décimas de unidad, como este cociente ha dado exactamente 2.6, hubiéramos tomado como amplitud el cociente más una unidad de precisión: 2.7.</p>
<p>El extremo inferior de la primera clase será 6-0.5=5.5, y a partir de aquí calculamos los 5 extremos siguientes sumando sucesivamente la amplitud:</p>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="#cb635-1" aria-hidden="true"></a><span class="fl">5.5</span><span class="op">+</span><span class="dv">3</span><span class="op">*</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb635-2"><a href="#cb635-2" aria-hidden="true"></a><span class="co">#&gt; [1]  5.5  8.5 11.5 14.5 17.5 20.5</span></span></code></pre></div>
<p>Por consiguiente, los intervalos son
<span class="math display">\[
\left[5.5, 8.5\right),\ \left[8.5,11.5\right),\ \left[11.5, 14.5\right),\ \left[14.5, 17.5\right),\ \left[17.5, 20.5\right).
\]</span></p>
<p>Las marcas de clase serán los puntos medios de estos intervalos, que calcularemos sumando múltiplos consecutivos de la amplitud al primer punto medio:</p>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="#cb636-1" aria-hidden="true"></a>(<span class="fl">5.5+8.5</span>)<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">3</span><span class="op">*</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">4</span>)</span>
<span id="cb636-2"><a href="#cb636-2" aria-hidden="true"></a><span class="co">#&gt; [1]  7 10 13 16 19</span></span></code></pre></div>
<p>Es decir,
<span class="math display">\[
X_1=7,\  X_2=10, \ X_3= 13,\  X_4= 16,\  X_5= 19.
\]</span></p>
<p>Finalmente, ordenamos los datos</p>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="#cb637-1" aria-hidden="true"></a><span class="kw">sort</span>(fruta)</span>
<span id="cb637-2"><a href="#cb637-2" aria-hidden="true"></a><span class="co">#&gt;  [1]  6  6  6  6  6  7  7  8  8  8  8  9  9  9  9 10 10 11 11 11 11 11 12 12 12</span></span>
<span id="cb637-3"><a href="#cb637-3" aria-hidden="true"></a><span class="co">#&gt; [26] 12 12 12 12 12 12 13 13 13 13 14 14 14 14 15 15 15 16 16 16 16 17 17 19 19</span></span></code></pre></div>
<p>y contamos cuántos pertenecen a cada clase (serán las frecuencias absolutas) y a partir de aquí calculamos el resto de frecuencias. Al final, obtenemos la tabla siguiente.</p>
<p><span class="math display">\[
\begin{array}{lccccc}
\hline
\text{clases}  &amp; X_j &amp; n_j &amp; N_j &amp;  f_j &amp;  F_j \\ \hline 
\left[5.5,8.5\right)  &amp; \ 7  &amp; 11 &amp; 11 &amp; 0.22 &amp;  0.22 \\ 
\left[8.5,11.5\right) &amp; 10  &amp; 11  &amp; 22  &amp; 0.22  &amp; 0.44 \\
\left[11.5,14.5\right) &amp; 13 &amp; 17  &amp; 39  &amp; 0.34  &amp; 0.78 \\ 
\left[14.5,17.5\right) &amp; 16 &amp; \ 9  &amp; 48 &amp; 0.18  &amp; 0.96\\
\left[17.5,20.5\right) &amp; 19   &amp; \ 2  &amp; 50 &amp; 0.04  &amp; 1.00 \\ \hline
\end{array}
\]</span></p>
<p>Lo que nos interesa ahora es que R calcule esta tabla por nosotros.</p>
</div>
<div id="sec:agrupR" class="section level2" number="13.2">
<h2 number="13.2"><span class="header-section-number">13.2</span> Agrupamiento de datos con R</h2>
<p>Al agrupar un conjunto de datos con R, lo que hacemos es codificarlos,
convirtiendo la variable cuantitativa en un factor cuyos niveles son las clases en las que hemos agrupado los valores y asignando cada dato a su clase. Las etiquetas de estos niveles pueden ser de diferentes tipos, en función de los intereses o el gusto del usuario. A modo de ejemplo, supongamos que agrupamos los valores de una variable cuantitativa en los intervalos
[0.5,3.5), [3.5,6.5) y [6.5,9.5). Los tres tipos de codificación más usuales son:</p>
<ul>
<li><strong>Codificación 1</strong>: Codificamos cada intervalo por medio de él mismo: <em>[0.5,3.5), [3.5,6.5), [6.5,9.5)</em></li>
<li><strong>Codificación 2</strong>: Codificamos cada intervalo por medio de su marca de clase, es decir, su punto medio: <em>2, 5, 8</em></li>
<li><strong>Codificación 3</strong>: Codificamos cada intervalo por medio de su número de orden: <em>1, 2, 3</em></li>
</ul>
<p>Naturalmente, en la práctica podemos usar cualquier otra codificación que se nos ocurra.</p>
<p>La función básica de R para agrupar un vector de datos numéricos y codificar
sus valores con las clases a las que pertenecen es</p>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="#cb638-1" aria-hidden="true"></a><span class="kw">cut</span>(x, <span class="dt">breaks=</span>..., <span class="dt">labels=</span>..., <span class="dt">right=</span><span class="ot">FALSE</span>, <span class="dt">include.lowest=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p>donde:</p>
<ul>
<li><p><code>x</code> es el vector numérico que contiene los datos</p></li>
<li><p>El parámetro <code>breaks</code> puede ser un vector numérico formado por los extremos de los intervalos en los que queremos agrupar los datos y que habremos calculado previamente. También podemos igualar este parámetro a un número <span class="math inline">\(k\)</span>, en cuyo caso R agrupa los datos en <span class="math inline">\(k\)</span> clases; para ello, divide el intervalo comprendido entre los valores mínimo y máximo de <span class="math inline">\(x\)</span> en <span class="math inline">\(k\)</span> intervalos y, a continuación, desplaza ligeramente a la izquierda el extremo inferior del primero y a la derecha el extremo superior del último. Por consiguiente, estos intervalos no tienen todos la misma amplitud, y además puede pasar que algún extremo intermedio coincida con algún dato del conjunto.</p></li>
<li><p>El parámetro <code>labels</code> es un vector con las etiquetas de los intervalos. Su valor por defecto, el que utiliza si no lo especificamos, es la codificación 1: usa como etiquetas los mismos intervalos (aunque puede que escriba sus extremos redondeados, para que muestren todos un número máximo de cifras significativas: por defecto, 3). Si especificamos <code>labels=FALSE</code>, obtenemos la codificación 3: los intervalos se identifican por medio de números naturales correlativos empezando por 1. Para usar como etiquetas las marcas de clase o cualquier otro vector, hay que entrarlo como valor de este parámetro.</p></li>
<li><p>El parámetro <code>right</code> es un parámetro lógico que permite indicar qué tipo de intervalos queremos. Si usamos intervalos cerrados por la izquierda y abiertos por la derecha, que va a ser la norma en este curso, tenemos que especificar <code>right=FALSE</code>, que <strong>no es el valor por defecto</strong>.</p></li>
<li><p>Combinado con <code>right=FALSE</code>, <code>include.lowest=TRUE</code> impone que el último intervalo sea cerrado: <span class="math inline">\([L_k,L_{k+1}]\)</span>. De esta manera, si por casualidad (o porque no hemos definido con cuidado las clases) el extremo superior del último intervalo, <span class="math inline">\(L_{k+1}\)</span>, coincide con un valor del conjunto de datos, lo contamos en el último intervalo;
sin <code>include.lowest=TRUE</code> no tendríamos en cuenta los <span class="math inline">\(L_{k+1}\)</span> del conjunto de datos. Naturalmente, si sabemos que <span class="math inline">\(L_{k+1}\)</span> no pertenece a nuestro conjunto de datos, entonces no hace falta entrar este parámetro.</p></li>
</ul>
<p>Podéis consultar la Ayuda de la función para conocer otros parámetros que os puedan ser de utilidad y para saber cómo se pueden especificar otros tipos de intervalos.</p>

<div class="example">
<p><span id="exm:cut" class="example"><strong>(#exm:cut) </strong></span>En un experimento hemos recogido los datos siguientes:</p>
</div>
<pre><code>&gt; 10,9,8,7,3,5,6,8,9,5,2,1,3,1,1.</code></pre>
<p>Vamos a agruparlos en los intervalos</p>
<p><span class="math display">\[
\left[0.5,4.5\right), \left[4.5,8.5\right), \left[8.5,12.5\right).
\]</span></p>
<p>Son <span class="math inline">\(k=3\)</span> intervalos de amplitud <span class="math inline">\(A=4\)</span>.</p>
<ul>
<li>Creamos un vector <code>x</code> con los datos</li>
</ul>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="#cb640-1" aria-hidden="true"></a>x=<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">9</span>,<span class="dv">8</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span></code></pre></div>
<ul>
<li>Definimos un vector <code>L</code> con los extremos de los intervalos</li>
</ul>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="#cb641-1" aria-hidden="true"></a>L=<span class="fl">0.5</span><span class="op">+</span><span class="dv">4</span><span class="op">*</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">3</span>)</span></code></pre></div>
<ul>
<li>Definimos <code>x_int</code> como el resultado de la codificación en intervalos empleando como etiquetas los intervalos</li>
</ul>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="#cb642-1" aria-hidden="true"></a>x_int=<span class="kw">cut</span>(x, <span class="dt">breaks=</span>L, <span class="dt">right=</span><span class="ot">FALSE</span>)</span>
<span id="cb642-2"><a href="#cb642-2" aria-hidden="true"></a>x_int</span>
<span id="cb642-3"><a href="#cb642-3" aria-hidden="true"></a><span class="co">#&gt;  [1] [8.5,12.5) [8.5,12.5) [4.5,8.5)  [4.5,8.5)  [0.5,4.5)  [4.5,8.5) </span></span>
<span id="cb642-4"><a href="#cb642-4" aria-hidden="true"></a><span class="co">#&gt;  [7] [4.5,8.5)  [4.5,8.5)  [8.5,12.5) [4.5,8.5)  [0.5,4.5)  [0.5,4.5) </span></span>
<span id="cb642-5"><a href="#cb642-5" aria-hidden="true"></a><span class="co">#&gt; [13] [0.5,4.5)  [0.5,4.5)  [0.5,4.5) </span></span>
<span id="cb642-6"><a href="#cb642-6" aria-hidden="true"></a><span class="co">#&gt; Levels: [0.5,4.5) [4.5,8.5) [8.5,12.5)</span></span></code></pre></div>
<ul>
<li>Definimos <code>x_MC</code> como el resultado de la codificación en intervalos empleando como etiquetas las marcas de clase</li>
</ul>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="#cb643-1" aria-hidden="true"></a>MC=(L[<span class="dv">1</span>]<span class="op">+</span>L[<span class="dv">2</span>])<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">4</span><span class="op">*</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">2</span>)  <span class="co">#Las marcas de clase</span></span>
<span id="cb643-2"><a href="#cb643-2" aria-hidden="true"></a>x_MC=<span class="kw">cut</span>(x, <span class="dt">breaks=</span>L, <span class="dt">labels=</span>MC, <span class="dt">right=</span><span class="ot">FALSE</span>)</span>
<span id="cb643-3"><a href="#cb643-3" aria-hidden="true"></a>x_MC</span>
<span id="cb643-4"><a href="#cb643-4" aria-hidden="true"></a><span class="co">#&gt;  [1] 10.5 10.5 6.5  6.5  2.5  6.5  6.5  6.5  10.5 6.5  2.5  2.5  2.5  2.5  2.5 </span></span>
<span id="cb643-5"><a href="#cb643-5" aria-hidden="true"></a><span class="co">#&gt; Levels: 2.5 6.5 10.5</span></span></code></pre></div>
<ul>
<li>Definimos <code>x_Num</code> como el resultado de la codificación en intervalos empleando como etiquetas 1, 2, 3</li>
</ul>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="#cb644-1" aria-hidden="true"></a>x_Num=<span class="kw">cut</span>(x, <span class="dt">breaks=</span>L, <span class="dt">labels=</span><span class="ot">FALSE</span>, <span class="dt">right=</span><span class="ot">FALSE</span>)</span>
<span id="cb644-2"><a href="#cb644-2" aria-hidden="true"></a>x_Num</span>
<span id="cb644-3"><a href="#cb644-3" aria-hidden="true"></a><span class="co">#&gt;  [1] 3 3 2 2 1 2 2 2 3 2 1 1 1 1 1</span></span></code></pre></div>
<p>El resultado de <code>cut</code> ha sido, en cada caso, una lista con los elementos del vector original codificados con las etiquetas de las clases a las que pertenecen. Podemos observar que las dos primeras aplicaciones de <code>cut</code> han producido factores (cuyos niveles son los intervalos y las marcas de clase, respectivamente, en ambos casos ordenados de manera natural), mientras que aplicándola con <code>labels=FALSE</code> hemos obtenido un vector.</p>
<p>Antes de continuar, ¿que habría pasado si hubiéramos pedido a R que cortase los datos en 3 grupos?</p>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="#cb645-1" aria-hidden="true"></a>x</span>
<span id="cb645-2"><a href="#cb645-2" aria-hidden="true"></a><span class="co">#&gt;  [1] 10  9  8  7  3  5  6  8  9  5  2  1  3  1  1</span></span>
<span id="cb645-3"><a href="#cb645-3" aria-hidden="true"></a><span class="kw">cut</span>(x, <span class="dt">breaks=</span><span class="dv">3</span>, <span class="dt">right=</span><span class="ot">FALSE</span>)</span>
<span id="cb645-4"><a href="#cb645-4" aria-hidden="true"></a><span class="co">#&gt;  [1] [7,10)    [7,10)    [7,10)    [7,10)    [0.991,4) [4,7)     [4,7)    </span></span>
<span id="cb645-5"><a href="#cb645-5" aria-hidden="true"></a><span class="co">#&gt;  [8] [7,10)    [7,10)    [4,7)     [0.991,4) [0.991,4) [0.991,4) [0.991,4)</span></span>
<span id="cb645-6"><a href="#cb645-6" aria-hidden="true"></a><span class="co">#&gt; [15] [0.991,4)</span></span>
<span id="cb645-7"><a href="#cb645-7" aria-hidden="true"></a><span class="co">#&gt; Levels: [0.991,4) [4,7) [7,10)</span></span></code></pre></div>
<p>R ha repartido los datos en tres intervalos de longitud 3, y ha desplazado ligeramente a la izquierda el extremo izquierdo del primer intervalo y a la derecha el extremo derecho del último intervalo; esto último no se ve a simple vista, pero lo podéis deducir del hecho que, según el resultado que muestra R, 10 pertenece a [7,10). Aunque así escrito resulte contradictorio, la realidad es que R ha tomado como extremo derecho del último intervalo el valor 10.009, tal y como se explica en la Ayuda de <code>cut</code>, pero lo ha escrito redondeado a 10.</p>
<p>Una vez agrupados los datos y codificados con las etiquetas de las clases, ya podemos calcular las tablas de frecuencias absolutas, relativas y acumuladas de los datos agrupados. Una posibilidad es usar las funciones <code>table</code>, <code>prop.table</code> y <code>cumsum</code> tal como lo hacíamos en las Lecciones @ref(chap:edqual) y @ref(chap:ord). Otra posibilidad es usar la función <code>hist</code>, a la que dedicaremos la Sección @ref(sec:hist). Esta función sirve para dibujar el <strong>histograma</strong> de la variable cuantitativa agrupada (una especie de diagrama de barras para las clases del agrupamiento), pero internamente da lugar a una <code>list</code> cuya componente <code>count</code> es el vector de frecuencias absolutas de las clases. Por consiguiente, para calcular estas frecuencias absolutas, podemos usar la instrucción</p>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="#cb646-1" aria-hidden="true"></a><span class="kw">hist</span>(x, <span class="dt">breaks=</span>..., <span class="dt">right=</span><span class="ot">FALSE</span>, <span class="dt">include.lowest=</span><span class="ot">TRUE</span>, <span class="dt">plot=</span><span class="ot">FALSE</span>)<span class="op">$</span>count</span></code></pre></div>
<p>En esta instrucción, es conveniente igualar el parámetro <code>breaks</code> al vector de los extremos de los intervalos (porque <code>cut</code> y <code>hist</code> usan métodos diferentes para agrupar los datos cuando se especifica sólo el número de clases); el significado de <code>right=FALSE</code> (y, si es necesario, <code>include.lowest=TRUE</code>) es el mismo que en <code>cut</code>; y <code>plot=FALSE</code> impide que se dibuje el histograma. Por ahora es interesante también saber que el resultado de <code>hist</code> incluye la componente <code>mids</code> que contiene el vector de puntos medios de los intervalos, nuestras marcas de clase.</p>

<div class="example">
<p><span id="exm:notes" class="example"><strong>(#exm:notes) </strong></span>Supongamos que tenemos las 50 calificaciones siguientes, obtenidas por los estudiantes de una asignatura:</p>
</div>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="#cb647-1" aria-hidden="true"></a>Notas=<span class="kw">c</span>(<span class="fl">5.1</span>,<span class="fl">1.1</span>,<span class="fl">6.4</span>,<span class="fl">5.3</span>,<span class="dv">10</span>,<span class="fl">5.4</span>,<span class="fl">1.9</span>,<span class="fl">3.1</span>,<span class="fl">5.1</span>,<span class="fl">0.8</span>,<span class="fl">9.6</span>,<span class="fl">6.6</span>,<span class="fl">7.0</span>,<span class="fl">9.6</span>,</span>
<span id="cb647-2"><a href="#cb647-2" aria-hidden="true"></a>  <span class="dv">10</span>,<span class="fl">1.2</span>,<span class="fl">4.2</span>,<span class="fl">8.8</span>,<span class="fl">2.4</span>,<span class="fl">1.8</span>,<span class="fl">5.6</span>,<span class="fl">6.8</span>,<span class="fl">6.7</span>,<span class="fl">2.2</span>,<span class="fl">8.6</span>,<span class="fl">3.9</span>,<span class="fl">5.6</span>,<span class="fl">5.9</span>,<span class="fl">8.4</span>,<span class="fl">4.9</span>,</span>
<span id="cb647-3"><a href="#cb647-3" aria-hidden="true"></a>  <span class="fl">0.7</span>,<span class="fl">8.2</span>,<span class="fl">3.7</span>,<span class="fl">4.8</span>,<span class="fl">5.8</span>,<span class="fl">3.3</span>,<span class="fl">9.7</span>,<span class="fl">7.8</span>,<span class="fl">9.3</span>,<span class="fl">4.5</span>,<span class="fl">6.2</span>,<span class="fl">3.9</span>,<span class="fl">4.7</span>,<span class="fl">6.2</span>,<span class="fl">6.3</span>,<span class="fl">9.4</span>,</span>
<span id="cb647-4"><a href="#cb647-4" aria-hidden="true"></a>  <span class="fl">9.3</span>,<span class="fl">2.3</span>,<span class="fl">8.5</span>,<span class="fl">1.4</span>)</span></code></pre></div>
<p>Vamos a agruparlas en Suspenso, Aprobado, Notable, y Sobresaliente, y calcularemos las frecuencias de estas clases. Observad que las clases no tienen la misma amplitud, y que además la última ha de ser cerrada a la derecha (ha de contener los dieces), por lo que tendremos que usar <code>include.lowest=TRUE</code>.</p>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="#cb648-1" aria-hidden="true"></a>Notas_cut=<span class="kw">cut</span>(Notas, <span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">10</span>),</span>
<span id="cb648-2"><a href="#cb648-2" aria-hidden="true"></a>  <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Suspenso&quot;</span>,<span class="st">&quot;Aprobado&quot;</span>,<span class="st">&quot;Notable&quot;</span>,<span class="st">&quot;Sobresaliente&quot;</span>),</span>
<span id="cb648-3"><a href="#cb648-3" aria-hidden="true"></a>  <span class="dt">right=</span><span class="ot">FALSE</span>, <span class="dt">include.lowest=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<ul>
<li>La tabla de frecuencias absolutas:</li>
</ul>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="#cb649-1" aria-hidden="true"></a><span class="kw">table</span>(Notas_cut)  </span>
<span id="cb649-2"><a href="#cb649-2" aria-hidden="true"></a><span class="co">#&gt; Notas_cut</span></span>
<span id="cb649-3"><a href="#cb649-3" aria-hidden="true"></a><span class="co">#&gt;      Suspenso      Aprobado       Notable Sobresaliente </span></span>
<span id="cb649-4"><a href="#cb649-4" aria-hidden="true"></a><span class="co">#&gt;            20            15             7             8</span></span></code></pre></div>
<ul>
<li>La tabla de frecuencias absolutas acumuladas:</li>
</ul>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="#cb650-1" aria-hidden="true"></a><span class="kw">cumsum</span>(<span class="kw">table</span>(Notas_cut))  </span>
<span id="cb650-2"><a href="#cb650-2" aria-hidden="true"></a><span class="co">#&gt;      Suspenso      Aprobado       Notable Sobresaliente </span></span>
<span id="cb650-3"><a href="#cb650-3" aria-hidden="true"></a><span class="co">#&gt;            20            35            42            50</span></span></code></pre></div>
<ul>
<li>La tabla de frecuencias relativas:</li>
</ul>
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb651-1"><a href="#cb651-1" aria-hidden="true"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(Notas_cut))   </span>
<span id="cb651-2"><a href="#cb651-2" aria-hidden="true"></a><span class="co">#&gt; Notas_cut</span></span>
<span id="cb651-3"><a href="#cb651-3" aria-hidden="true"></a><span class="co">#&gt;      Suspenso      Aprobado       Notable Sobresaliente </span></span>
<span id="cb651-4"><a href="#cb651-4" aria-hidden="true"></a><span class="co">#&gt;          0.40          0.30          0.14          0.16</span></span></code></pre></div>
<ul>
<li>La tabla de frecuencias relativas acumuladas:</li>
</ul>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="#cb652-1" aria-hidden="true"></a><span class="kw">cumsum</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(Notas_cut)))  </span>
<span id="cb652-2"><a href="#cb652-2" aria-hidden="true"></a><span class="co">#&gt;      Suspenso      Aprobado       Notable Sobresaliente </span></span>
<span id="cb652-3"><a href="#cb652-3" aria-hidden="true"></a><span class="co">#&gt;          0.40          0.70          0.84          1.00</span></span></code></pre></div>
<p>También podríamos haber obtenido estas frecuencias usando la función <code>hist</code> para calcular el vector de frecuencias absolutas y luego operando con este vector para obtener el resto:</p>
<ul>
<li>La tabla de frecuencias absolutas:</li>
</ul>
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb653-1"><a href="#cb653-1" aria-hidden="true"></a>frec_abs=<span class="kw">hist</span>(Notas, <span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">10</span>), <span class="dt">right=</span><span class="ot">FALSE</span>,</span>
<span id="cb653-2"><a href="#cb653-2" aria-hidden="true"></a>   <span class="dt">include.lowest=</span><span class="ot">TRUE</span>, <span class="dt">plot=</span><span class="ot">FALSE</span>)<span class="op">$</span>count </span>
<span id="cb653-3"><a href="#cb653-3" aria-hidden="true"></a>frec_abs</span>
<span id="cb653-4"><a href="#cb653-4" aria-hidden="true"></a><span class="co">#&gt; [1] 20 15  7  8</span></span></code></pre></div>
<ul>
<li>La tabla de frecuencias absolutas acumuladas:</li>
</ul>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="#cb654-1" aria-hidden="true"></a><span class="kw">cumsum</span>(frec_abs) </span>
<span id="cb654-2"><a href="#cb654-2" aria-hidden="true"></a><span class="co">#&gt; [1] 20 35 42 50</span></span></code></pre></div>
<ul>
<li>La tabla de frecuencias relativas (ahora no podemos usar <code>prop.table</code>, puesto que <code>frec_abs</code> no es una <code>table</code>):</li>
</ul>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb655-1"><a href="#cb655-1" aria-hidden="true"></a>frec_abs<span class="op">/</span><span class="kw">length</span>(Notas)  </span>
<span id="cb655-2"><a href="#cb655-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.40 0.30 0.14 0.16</span></span></code></pre></div>
<ul>
<li>La tabla de frecuencias relativas acumuladas:</li>
</ul>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="#cb656-1" aria-hidden="true"></a><span class="kw">cumsum</span>(frec_abs<span class="op">/</span><span class="kw">length</span>(Notas))  </span>
<span id="cb656-2"><a href="#cb656-2" aria-hidden="true"></a><span class="co">#&gt; [1] 0.40 0.70 0.84 1.00</span></span></code></pre></div>
<p>Ahora podemos construir un <em>data frame</em> que contenga las frecuencias de estas calificaciones con la estructura de las tablas que hemos dado al final de la sección anterior. Como ya explicamos en el Ejemplo @ref(exm:dados), si calculamos las frecuencias absolutas con <code>table</code>, no es conveniente usar el resultado como columna del <em>data frame</em>: es mejor utilizar el vector que se obtiene al aplicar <code>as.vector</code> al resultado de <code>table</code>, y así no se generan columnas espurias con los nombres de los niveles.</p>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb657-1"><a href="#cb657-1" aria-hidden="true"></a>intervalos=<span class="kw">c</span>(<span class="st">&quot;[0,5)&quot;</span>,<span class="st">&quot;[5,7)&quot;</span>,<span class="st">&quot;[7,9)&quot;</span>,<span class="st">&quot;[9,10]&quot;</span>)</span>
<span id="cb657-2"><a href="#cb657-2" aria-hidden="true"></a>calificaciones=<span class="kw">c</span>(<span class="st">&quot;Suspenso&quot;</span>,<span class="st">&quot;Aprobado&quot;</span>,<span class="st">&quot;Notable&quot;</span>,<span class="st">&quot;Sobresaliente&quot;</span>)</span>
<span id="cb657-3"><a href="#cb657-3" aria-hidden="true"></a>marcas=<span class="kw">c</span>(<span class="fl">2.5</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="fl">9.5</span>) <span class="co">#Marcas de clase</span></span>
<span id="cb657-4"><a href="#cb657-4" aria-hidden="true"></a>f.abs=<span class="kw">as.vector</span>(<span class="kw">table</span>(Notas_cut)) <span class="co">#Frecuencias absolutas</span></span>
<span id="cb657-5"><a href="#cb657-5" aria-hidden="true"></a>f.abs.cum=<span class="kw">cumsum</span>(f.abs)  <span class="co">#Frecuencias absolutas acumuladas</span></span>
<span id="cb657-6"><a href="#cb657-6" aria-hidden="true"></a>f.rel=f.abs<span class="op">/</span><span class="kw">length</span>(Notas) <span class="co">#Frecuencias relativas</span></span>
<span id="cb657-7"><a href="#cb657-7" aria-hidden="true"></a>f.rel.cum=<span class="kw">cumsum</span>(f.rel) <span class="co">#Frecuencias relativas acumuladas</span></span>
<span id="cb657-8"><a href="#cb657-8" aria-hidden="true"></a>tabla.frec=<span class="kw">data.frame</span>(intervalos, calificaciones, marcas, f.abs, </span>
<span id="cb657-9"><a href="#cb657-9" aria-hidden="true"></a>   f.abs.cum, f.rel, f.rel.cum)  <span class="co">#Construimos el data frame</span></span>
<span id="cb657-10"><a href="#cb657-10" aria-hidden="true"></a>tabla.frec</span>
<span id="cb657-11"><a href="#cb657-11" aria-hidden="true"></a><span class="co">#&gt;   intervalos calificaciones marcas f.abs f.abs.cum f.rel f.rel.cum</span></span>
<span id="cb657-12"><a href="#cb657-12" aria-hidden="true"></a><span class="co">#&gt; 1      [0,5)       Suspenso    2.5    20        20  0.40      0.40</span></span>
<span id="cb657-13"><a href="#cb657-13" aria-hidden="true"></a><span class="co">#&gt; 2      [5,7)       Aprobado    6.0    15        35  0.30      0.70</span></span>
<span id="cb657-14"><a href="#cb657-14" aria-hidden="true"></a><span class="co">#&gt; 3      [7,9)        Notable    8.0     7        42  0.14      0.84</span></span>
<span id="cb657-15"><a href="#cb657-15" aria-hidden="true"></a><span class="co">#&gt; 4     [9,10]  Sobresaliente    9.5     8        50  0.16      1.00</span></span></code></pre></div>
<p>También hubiéramos podido usar</p>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="#cb658-1" aria-hidden="true"></a>Hist_notas=<span class="kw">hist</span>(Notas, <span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">10</span>), <span class="dt">right=</span><span class="ot">FALSE</span>, </span>
<span id="cb658-2"><a href="#cb658-2" aria-hidden="true"></a>  <span class="dt">include.lowest=</span><span class="ot">TRUE</span>, <span class="dt">plot=</span><span class="ot">FALSE</span>)</span>
<span id="cb658-3"><a href="#cb658-3" aria-hidden="true"></a>f.abs=Hist_notas<span class="op">$</span>count  </span>
<span id="cb658-4"><a href="#cb658-4" aria-hidden="true"></a>marcas=Hist_notas<span class="op">$</span>mids  </span></code></pre></div>
<p>y usar el vector <code>f.abs</code> como arranque para calcular las columnas de frecuencias del <em>data frame</em> y el vector <code>marcas</code> como columna de marcas de clase.</p>

<div class="example">
<p><span id="exm:unnamed-chunk-43" class="example"><strong>(#exm:unnamed-chunk-43) </strong></span>Continuemos con el Ejemplo @ref(exm:cut); vamos a calcular las diferentes frecuencias para la codificación <code>x_int</code>:</p>
</div>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb659-1"><a href="#cb659-1" aria-hidden="true"></a>x_int</span>
<span id="cb659-2"><a href="#cb659-2" aria-hidden="true"></a><span class="co">#&gt;  [1] [8.5,12.5) [8.5,12.5) [4.5,8.5)  [4.5,8.5)  [0.5,4.5)  [4.5,8.5) </span></span>
<span id="cb659-3"><a href="#cb659-3" aria-hidden="true"></a><span class="co">#&gt;  [7] [4.5,8.5)  [4.5,8.5)  [8.5,12.5) [4.5,8.5)  [0.5,4.5)  [0.5,4.5) </span></span>
<span id="cb659-4"><a href="#cb659-4" aria-hidden="true"></a><span class="co">#&gt; [13] [0.5,4.5)  [0.5,4.5)  [0.5,4.5) </span></span>
<span id="cb659-5"><a href="#cb659-5" aria-hidden="true"></a><span class="co">#&gt; Levels: [0.5,4.5) [4.5,8.5) [8.5,12.5)</span></span>
<span id="cb659-6"><a href="#cb659-6" aria-hidden="true"></a><span class="kw">table</span>(x_int)</span>
<span id="cb659-7"><a href="#cb659-7" aria-hidden="true"></a><span class="co">#&gt; x_int</span></span>
<span id="cb659-8"><a href="#cb659-8" aria-hidden="true"></a><span class="co">#&gt;  [0.5,4.5)  [4.5,8.5) [8.5,12.5) </span></span>
<span id="cb659-9"><a href="#cb659-9" aria-hidden="true"></a><span class="co">#&gt;          6          6          3</span></span>
<span id="cb659-10"><a href="#cb659-10" aria-hidden="true"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(x_int))</span>
<span id="cb659-11"><a href="#cb659-11" aria-hidden="true"></a><span class="co">#&gt; x_int</span></span>
<span id="cb659-12"><a href="#cb659-12" aria-hidden="true"></a><span class="co">#&gt;  [0.5,4.5)  [4.5,8.5) [8.5,12.5) </span></span>
<span id="cb659-13"><a href="#cb659-13" aria-hidden="true"></a><span class="co">#&gt;        0.4        0.4        0.2</span></span>
<span id="cb659-14"><a href="#cb659-14" aria-hidden="true"></a><span class="kw">cumsum</span>(<span class="kw">table</span>(x_int))</span>
<span id="cb659-15"><a href="#cb659-15" aria-hidden="true"></a><span class="co">#&gt;  [0.5,4.5)  [4.5,8.5) [8.5,12.5) </span></span>
<span id="cb659-16"><a href="#cb659-16" aria-hidden="true"></a><span class="co">#&gt;          6         12         15</span></span>
<span id="cb659-17"><a href="#cb659-17" aria-hidden="true"></a><span class="kw">cumsum</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(x_int)))</span>
<span id="cb659-18"><a href="#cb659-18" aria-hidden="true"></a><span class="co">#&gt;  [0.5,4.5)  [4.5,8.5) [8.5,12.5) </span></span>
<span id="cb659-19"><a href="#cb659-19" aria-hidden="true"></a><span class="co">#&gt;        0.4        0.8        1.0</span></span></code></pre></div>
<p>Ahora, vamos a construir un <em>data frame</em> que contenga la tabla de frecuencias de esta variable agrupada:</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="#cb660-1" aria-hidden="true"></a>intervalos=<span class="kw">levels</span>(x_int)</span>
<span id="cb660-2"><a href="#cb660-2" aria-hidden="true"></a>marcas=MC  <span class="co">#Las hemos calculado en un ejemplo anterior</span></span>
<span id="cb660-3"><a href="#cb660-3" aria-hidden="true"></a>f.abs=<span class="kw">as.vector</span>(<span class="kw">table</span>(x_int))</span>
<span id="cb660-4"><a href="#cb660-4" aria-hidden="true"></a>f.abs.cum=<span class="kw">cumsum</span>(f.abs)</span>
<span id="cb660-5"><a href="#cb660-5" aria-hidden="true"></a>f.rel=f.abs<span class="op">/</span><span class="kw">length</span>(x)</span>
<span id="cb660-6"><a href="#cb660-6" aria-hidden="true"></a>f.rel.cum=<span class="kw">cumsum</span>(f.rel)</span>
<span id="cb660-7"><a href="#cb660-7" aria-hidden="true"></a>tabla.frec=<span class="kw">data.frame</span>(intervalos, marcas, f.abs, f.abs.cum, f.rel, f.rel.cum)</span>
<span id="cb660-8"><a href="#cb660-8" aria-hidden="true"></a>tabla.frec</span>
<span id="cb660-9"><a href="#cb660-9" aria-hidden="true"></a><span class="co">#&gt;   intervalos marcas f.abs f.abs.cum f.rel f.rel.cum</span></span>
<span id="cb660-10"><a href="#cb660-10" aria-hidden="true"></a><span class="co">#&gt; 1  [0.5,4.5)    2.5     6         6   0.4       0.4</span></span>
<span id="cb660-11"><a href="#cb660-11" aria-hidden="true"></a><span class="co">#&gt; 2  [4.5,8.5)    6.5     6        12   0.4       0.8</span></span>
<span id="cb660-12"><a href="#cb660-12" aria-hidden="true"></a><span class="co">#&gt; 3 [8.5,12.5)   10.5     3        15   0.2       1.0</span></span></code></pre></div>
<p>Podemos automatizar el cálculo de esta tabla de frecuencias, usando las dos funciones siguientes.
La primera sirve en el caso en que vayamos a tomar todas las clases de la misma amplitud.
Sus parámetros son: <span class="math inline">\(x\)</span>, el vector con los datos; <span class="math inline">\(k\)</span>, el número de clases; <span class="math inline">\(A\)</span>, su amplitud; y <span class="math inline">\(p\)</span>, la precisión de los datos (<span class="math inline">\(p=1\)</span> si la precisión son unidades, <span class="math inline">\(p=0.1\)</span> si la precisión son décimas de unidad, etc.).</p>
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb661-1"><a href="#cb661-1" aria-hidden="true"></a>Tabla_frec_agrup=<span class="cf">function</span>(x,k,A,p){</span>
<span id="cb661-2"><a href="#cb661-2" aria-hidden="true"></a>    L=<span class="kw">min</span>(x)<span class="op">-</span>p<span class="op">/</span><span class="dv">2</span><span class="op">+</span>A<span class="op">*</span>(<span class="dv">0</span><span class="op">:</span>k)</span>
<span id="cb661-3"><a href="#cb661-3" aria-hidden="true"></a>    x_int=<span class="kw">cut</span>(x, <span class="dt">breaks=</span>L, <span class="dt">right=</span><span class="ot">FALSE</span>)</span>
<span id="cb661-4"><a href="#cb661-4" aria-hidden="true"></a>    intervalos=<span class="kw">levels</span>(x_int)</span>
<span id="cb661-5"><a href="#cb661-5" aria-hidden="true"></a>    marcas=(L[<span class="dv">1</span>]<span class="op">+</span>L[<span class="dv">2</span>])<span class="op">/</span><span class="dv">2</span><span class="op">+</span>A<span class="op">*</span>(<span class="dv">0</span><span class="op">:</span>(k<span class="dv">-1</span>))</span>
<span id="cb661-6"><a href="#cb661-6" aria-hidden="true"></a>    f.abs=<span class="kw">as.vector</span>(<span class="kw">table</span>(x_int))</span>
<span id="cb661-7"><a href="#cb661-7" aria-hidden="true"></a>    f.rel=f.abs<span class="op">/</span><span class="kw">length</span>(x)</span>
<span id="cb661-8"><a href="#cb661-8" aria-hidden="true"></a>    f.abs.cum=<span class="kw">cumsum</span>(f.abs)</span>
<span id="cb661-9"><a href="#cb661-9" aria-hidden="true"></a>    f.rel.cum=<span class="kw">cumsum</span>(f.rel)</span>
<span id="cb661-10"><a href="#cb661-10" aria-hidden="true"></a>    tabla_x=<span class="kw">data.frame</span>(intervalos, marcas, f.abs, f.abs.cum, f.rel, f.rel.cum)</span>
<span id="cb661-11"><a href="#cb661-11" aria-hidden="true"></a>    tabla_x</span>
<span id="cb661-12"><a href="#cb661-12" aria-hidden="true"></a>  }</span></code></pre></div>
<p>Si de las clases conocemos de entrada sus extremos, podemos usar la función siguiente.
Sus parámetros son: <span class="math inline">\(x\)</span>, el vector con los datos, y <span class="math inline">\(L\)</span>, el vector de extremos de clases.</p>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="#cb662-1" aria-hidden="true"></a>Tabla_frec_agrup_L=<span class="cf">function</span>(x,L){</span>
<span id="cb662-2"><a href="#cb662-2" aria-hidden="true"></a>    x_int=<span class="kw">cut</span>(x, <span class="dt">breaks=</span>L, <span class="dt">right=</span><span class="ot">FALSE</span>, <span class="dt">include.lowest=</span><span class="ot">TRUE</span>)</span>
<span id="cb662-3"><a href="#cb662-3" aria-hidden="true"></a>    intervalos=<span class="kw">levels</span>(x_int)</span>
<span id="cb662-4"><a href="#cb662-4" aria-hidden="true"></a>    marcas=(L[<span class="op">-</span><span class="kw">length</span>(L)]<span class="op">+</span>L[<span class="op">-</span><span class="dv">1</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb662-5"><a href="#cb662-5" aria-hidden="true"></a>    f.abs=<span class="kw">as.vector</span>(<span class="kw">table</span>(x_int))</span>
<span id="cb662-6"><a href="#cb662-6" aria-hidden="true"></a>    f.rel=f.abs<span class="op">/</span><span class="kw">length</span>(x)</span>
<span id="cb662-7"><a href="#cb662-7" aria-hidden="true"></a>    f.abs.cum=<span class="kw">cumsum</span>(f.abs)</span>
<span id="cb662-8"><a href="#cb662-8" aria-hidden="true"></a>    f.rel.cum=<span class="kw">cumsum</span>(f.rel)</span>
<span id="cb662-9"><a href="#cb662-9" aria-hidden="true"></a>    tabla_x=<span class="kw">data.frame</span>(intervalos, marcas, f.abs, f.abs.cum, f.rel, f.rel.cum)</span>
<span id="cb662-10"><a href="#cb662-10" aria-hidden="true"></a>    tabla_x</span>
<span id="cb662-11"><a href="#cb662-11" aria-hidden="true"></a>  }</span></code></pre></div>

<div class="example">
<span id="exm:unnamed-chunk-48" class="example"><strong>(#exm:unnamed-chunk-48) </strong></span>Volviendo al Ejemplo @ref(exm:alerg), vamos a calcular, para el agrupamiento en 7 clases, su tabla de frecuencias en forma de <em>data frame</em> usando la función <code>Tabla_frec_agrup</code>. Ya sabemos que <span class="math inline">\(k=7\)</span> y <span class="math inline">\(A=1.9\)</span> y que los datos están expresados con una precisión de décimas de unidad.
</div>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="#cb663-1" aria-hidden="true"></a><span class="kw">Tabla_frec_agrup</span>(alergia, <span class="dv">7</span>, <span class="fl">1.9</span>, <span class="fl">0.1</span>)</span>
<span id="cb663-2"><a href="#cb663-2" aria-hidden="true"></a><span class="co">#&gt;    intervalos marcas f.abs f.abs.cum f.rel f.rel.cum</span></span>
<span id="cb663-3"><a href="#cb663-3" aria-hidden="true"></a><span class="co">#&gt; 1 [3.75,5.65)    4.7     1         1 0.025     0.025</span></span>
<span id="cb663-4"><a href="#cb663-4" aria-hidden="true"></a><span class="co">#&gt; 2 [5.65,7.55)    6.6     3         4 0.075     0.100</span></span>
<span id="cb663-5"><a href="#cb663-5" aria-hidden="true"></a><span class="co">#&gt; 3 [7.55,9.45)    8.5     8        12 0.200     0.300</span></span>
<span id="cb663-6"><a href="#cb663-6" aria-hidden="true"></a><span class="co">#&gt; 4 [9.45,11.3)   10.4    11        23 0.275     0.575</span></span>
<span id="cb663-7"><a href="#cb663-7" aria-hidden="true"></a><span class="co">#&gt; 5 [11.3,13.2)   12.3    12        35 0.300     0.875</span></span>
<span id="cb663-8"><a href="#cb663-8" aria-hidden="true"></a><span class="co">#&gt; 6 [13.2,15.1)   14.2     4        39 0.100     0.975</span></span>
<span id="cb663-9"><a href="#cb663-9" aria-hidden="true"></a><span class="co">#&gt; 7   [15.1,17)   16.1     1        40 0.025     1.000</span></span></code></pre></div>
<p>La ventaja de definir esta tabla de frecuencias mediante un <em>data frame</em> es que podemos usar la función <code>kable</code> del paquete <strong>knitr</strong> o el paquete <em>printr</em> para producirla en formato adecuado en un documento html.</p>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="#cb664-1" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">Tabla_frec_agrup</span>(alergia, <span class="dv">7</span>, <span class="fl">1.9</span>, <span class="fl">0.1</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">intervalos</th>
<th align="right">marcas</th>
<th align="right">f.abs</th>
<th align="right">f.abs.cum</th>
<th align="right">f.rel</th>
<th align="right">f.rel.cum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">[3.75,5.65)</td>
<td align="right">4.7</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.025</td>
<td align="right">0.025</td>
</tr>
<tr class="even">
<td align="left">[5.65,7.55)</td>
<td align="right">6.6</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">0.075</td>
<td align="right">0.100</td>
</tr>
<tr class="odd">
<td align="left">[7.55,9.45)</td>
<td align="right">8.5</td>
<td align="right">8</td>
<td align="right">12</td>
<td align="right">0.200</td>
<td align="right">0.300</td>
</tr>
<tr class="even">
<td align="left">[9.45,11.3)</td>
<td align="right">10.4</td>
<td align="right">11</td>
<td align="right">23</td>
<td align="right">0.275</td>
<td align="right">0.575</td>
</tr>
<tr class="odd">
<td align="left">[11.3,13.2)</td>
<td align="right">12.3</td>
<td align="right">12</td>
<td align="right">35</td>
<td align="right">0.300</td>
<td align="right">0.875</td>
</tr>
<tr class="even">
<td align="left">[13.2,15.1)</td>
<td align="right">14.2</td>
<td align="right">4</td>
<td align="right">39</td>
<td align="right">0.100</td>
<td align="right">0.975</td>
</tr>
<tr class="odd">
<td align="left">[15.1,17)</td>
<td align="right">16.1</td>
<td align="right">1</td>
<td align="right">40</td>
<td align="right">0.025</td>
<td align="right">1.000</td>
</tr>
</tbody>
</table>
<p>Observad que, como advertíamos en su momento, ha escrito los extremos de los intervalos redondeados para que tengan como máximo 3 cifras. Esto se puede resolver usando en la función <code>cut</code> el parámetro <code>dig.lab</code>, que permite especificar el número máximo de cifras significativas en los extremos de las etiquetas.</p>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="#cb665-1" aria-hidden="true"></a>L=<span class="fl">3.75+1.9</span><span class="op">*</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">7</span>)</span>
<span id="cb665-2"><a href="#cb665-2" aria-hidden="true"></a>L</span>
<span id="cb665-3"><a href="#cb665-3" aria-hidden="true"></a><span class="co">#&gt; [1]  3.75  5.65  7.55  9.45 11.35 13.25 15.15 17.05</span></span>
<span id="cb665-4"><a href="#cb665-4" aria-hidden="true"></a><span class="kw">cut</span>(alergia, <span class="dt">breaks=</span>L, <span class="dt">right=</span><span class="ot">FALSE</span>)</span>
<span id="cb665-5"><a href="#cb665-5" aria-hidden="true"></a><span class="co">#&gt;  [1] [9.45,11.3) [9.45,11.3) [9.45,11.3) [13.2,15.1) [11.3,13.2) [11.3,13.2)</span></span>
<span id="cb665-6"><a href="#cb665-6" aria-hidden="true"></a><span class="co">#&gt;  [7] [15.1,17)   [9.45,11.3) [11.3,13.2) [11.3,13.2) [11.3,13.2) [5.65,7.55)</span></span>
<span id="cb665-7"><a href="#cb665-7" aria-hidden="true"></a><span class="co">#&gt; [13] [7.55,9.45) [7.55,9.45) [9.45,11.3) [7.55,9.45) [3.75,5.65) [9.45,11.3)</span></span>
<span id="cb665-8"><a href="#cb665-8" aria-hidden="true"></a><span class="co">#&gt; [19] [11.3,13.2) [7.55,9.45) [11.3,13.2) [9.45,11.3) [7.55,9.45) [9.45,11.3)</span></span>
<span id="cb665-9"><a href="#cb665-9" aria-hidden="true"></a><span class="co">#&gt; [25] [7.55,9.45) [13.2,15.1) [11.3,13.2) [5.65,7.55) [11.3,13.2) [7.55,9.45)</span></span>
<span id="cb665-10"><a href="#cb665-10" aria-hidden="true"></a><span class="co">#&gt; [31] [5.65,7.55) [7.55,9.45) [13.2,15.1) [13.2,15.1) [11.3,13.2) [11.3,13.2)</span></span>
<span id="cb665-11"><a href="#cb665-11" aria-hidden="true"></a><span class="co">#&gt; [37] [9.45,11.3) [9.45,11.3) [11.3,13.2) [9.45,11.3)</span></span>
<span id="cb665-12"><a href="#cb665-12" aria-hidden="true"></a><span class="co">#&gt; 7 Levels: [3.75,5.65) [5.65,7.55) [7.55,9.45) [9.45,11.3) ... [15.1,17)</span></span>
<span id="cb665-13"><a href="#cb665-13" aria-hidden="true"></a><span class="kw">cut</span>(alergia, <span class="dt">breaks=</span>L, <span class="dt">right=</span><span class="ot">FALSE</span>, <span class="dt">dig.lab=</span><span class="dv">4</span>)</span>
<span id="cb665-14"><a href="#cb665-14" aria-hidden="true"></a><span class="co">#&gt;  [1] [9.45,11.35)  [9.45,11.35)  [9.45,11.35)  [13.25,15.15) [11.35,13.25)</span></span>
<span id="cb665-15"><a href="#cb665-15" aria-hidden="true"></a><span class="co">#&gt;  [6] [11.35,13.25) [15.15,17.05) [9.45,11.35)  [11.35,13.25) [11.35,13.25)</span></span>
<span id="cb665-16"><a href="#cb665-16" aria-hidden="true"></a><span class="co">#&gt; [11] [11.35,13.25) [5.65,7.55)   [7.55,9.45)   [7.55,9.45)   [9.45,11.35) </span></span>
<span id="cb665-17"><a href="#cb665-17" aria-hidden="true"></a><span class="co">#&gt; [16] [7.55,9.45)   [3.75,5.65)   [9.45,11.35)  [11.35,13.25) [7.55,9.45)  </span></span>
<span id="cb665-18"><a href="#cb665-18" aria-hidden="true"></a><span class="co">#&gt; [21] [11.35,13.25) [9.45,11.35)  [7.55,9.45)   [9.45,11.35)  [7.55,9.45)  </span></span>
<span id="cb665-19"><a href="#cb665-19" aria-hidden="true"></a><span class="co">#&gt; [26] [13.25,15.15) [11.35,13.25) [5.65,7.55)   [11.35,13.25) [7.55,9.45)  </span></span>
<span id="cb665-20"><a href="#cb665-20" aria-hidden="true"></a><span class="co">#&gt; [31] [5.65,7.55)   [7.55,9.45)   [13.25,15.15) [13.25,15.15) [11.35,13.25)</span></span>
<span id="cb665-21"><a href="#cb665-21" aria-hidden="true"></a><span class="co">#&gt; [36] [11.35,13.25) [9.45,11.35)  [9.45,11.35)  [11.35,13.25) [9.45,11.35) </span></span>
<span id="cb665-22"><a href="#cb665-22" aria-hidden="true"></a><span class="co">#&gt; 7 Levels: [3.75,5.65) [5.65,7.55) [7.55,9.45) [9.45,11.35) ... [15.15,17.05)</span></span></code></pre></div>
<p>Por lo tanto, si quisiéramos permitir que los extremos de las etiquetas tuvieran más de 3 cifras significativas, bastaría redefinir la función <code>Tabla_frec_agrup</code> añadiéndole un parámetro <code>dig.lab</code>, que tuviera valor por defecto 3, y que se entrara a la función <code>cut</code>.</p>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="#cb666-1" aria-hidden="true"></a>Tabla_frec_agrup=<span class="cf">function</span>(x,k,A,p,<span class="dt">dig.lab=</span><span class="dv">3</span>){</span>
<span id="cb666-2"><a href="#cb666-2" aria-hidden="true"></a>    L=<span class="kw">min</span>(x)<span class="op">-</span>p<span class="op">/</span><span class="dv">2</span><span class="op">+</span>A<span class="op">*</span>(<span class="dv">0</span><span class="op">:</span>k)</span>
<span id="cb666-3"><a href="#cb666-3" aria-hidden="true"></a>    x_int=<span class="kw">cut</span>(x, <span class="dt">breaks=</span>L, <span class="dt">right=</span><span class="ot">FALSE</span>,<span class="dt">dig.lab=</span>dig.lab)</span>
<span id="cb666-4"><a href="#cb666-4" aria-hidden="true"></a>    intervalos=<span class="kw">levels</span>(x_int)</span>
<span id="cb666-5"><a href="#cb666-5" aria-hidden="true"></a>    marcas=(L[<span class="dv">1</span>]<span class="op">+</span>L[<span class="dv">2</span>])<span class="op">/</span><span class="dv">2</span><span class="op">+</span>A<span class="op">*</span>(<span class="dv">0</span><span class="op">:</span>(k<span class="dv">-1</span>))</span>
<span id="cb666-6"><a href="#cb666-6" aria-hidden="true"></a>    f.abs=<span class="kw">as.vector</span>(<span class="kw">table</span>(x_int))</span>
<span id="cb666-7"><a href="#cb666-7" aria-hidden="true"></a>    f.rel=f.abs<span class="op">/</span><span class="kw">length</span>(x)</span>
<span id="cb666-8"><a href="#cb666-8" aria-hidden="true"></a>    f.abs.cum=<span class="kw">cumsum</span>(f.abs)</span>
<span id="cb666-9"><a href="#cb666-9" aria-hidden="true"></a>    f.rel.cum=<span class="kw">cumsum</span>(f.rel)</span>
<span id="cb666-10"><a href="#cb666-10" aria-hidden="true"></a>    tabla_x=<span class="kw">data.frame</span>(intervalos, marcas, f.abs, f.abs.cum, f.rel, f.rel.cum)</span>
<span id="cb666-11"><a href="#cb666-11" aria-hidden="true"></a>    tabla_x</span>
<span id="cb666-12"><a href="#cb666-12" aria-hidden="true"></a>  }</span></code></pre></div>

<div class="example">
<p><span id="exm:unnamed-chunk-53" class="example"><strong>(#exm:unnamed-chunk-53) </strong></span>Vamos a calcular la tabla de frecuencias de los datos del Ejemplo @ref(exm:fruitals) usando la función <code>Tabla_frec_agrup</code>. Ya habíamos decidido que <span class="math inline">\(k=5\)</span> y que en este caso la amplitud era 3. Los datos estaban expresados en unidades.</p>
</div>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb667-1"><a href="#cb667-1" aria-hidden="true"></a><span class="kw">Tabla_frec_agrup</span>(fruta, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb667-2"><a href="#cb667-2" aria-hidden="true"></a><span class="co">#&gt;    intervalos marcas f.abs f.abs.cum f.rel f.rel.cum</span></span>
<span id="cb667-3"><a href="#cb667-3" aria-hidden="true"></a><span class="co">#&gt; 1   [5.5,8.5)      7    11        11  0.22      0.22</span></span>
<span id="cb667-4"><a href="#cb667-4" aria-hidden="true"></a><span class="co">#&gt; 2  [8.5,11.5)     10    11        22  0.22      0.44</span></span>
<span id="cb667-5"><a href="#cb667-5" aria-hidden="true"></a><span class="co">#&gt; 3 [11.5,14.5)     13    17        39  0.34      0.78</span></span>
<span id="cb667-6"><a href="#cb667-6" aria-hidden="true"></a><span class="co">#&gt; 4 [14.5,17.5)     16     9        48  0.18      0.96</span></span>
<span id="cb667-7"><a href="#cb667-7" aria-hidden="true"></a><span class="co">#&gt; 5 [17.5,20.5)     19     2        50  0.04      1.00</span></span></code></pre></div>

<div class="example">
<p><span id="exm:unnamed-chunk-55" class="example"><strong>(#exm:unnamed-chunk-55) </strong></span>Vamos a volver a calcular la tabla de frecuencias de las notas del Ejemplo @ref(exm:notes), usando esta vez una de nuestras funciones. Como las clases tienen amplitudes diferentes, usaremos la función <code>Tabla_frec_agrup_L</code>.</p>
</div>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="#cb668-1" aria-hidden="true"></a><span class="kw">Tabla_frec_agrup_L</span>(Notas,<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">10</span>))</span>
<span id="cb668-2"><a href="#cb668-2" aria-hidden="true"></a><span class="co">#&gt;   intervalos marcas f.abs f.abs.cum f.rel f.rel.cum</span></span>
<span id="cb668-3"><a href="#cb668-3" aria-hidden="true"></a><span class="co">#&gt; 1      [0,5)    2.5    20        20  0.40      0.40</span></span>
<span id="cb668-4"><a href="#cb668-4" aria-hidden="true"></a><span class="co">#&gt; 2      [5,7)    6.0    15        35  0.30      0.70</span></span>
<span id="cb668-5"><a href="#cb668-5" aria-hidden="true"></a><span class="co">#&gt; 3      [7,9)    8.0     7        42  0.14      0.84</span></span>
<span id="cb668-6"><a href="#cb668-6" aria-hidden="true"></a><span class="co">#&gt; 4     [9,10]    9.5     8        50  0.16      1.00</span></span></code></pre></div>
</div>
<div id="estadísticos-para-datos-agrupados" class="section level2" number="13.3">
<h2 number="13.3"><span class="header-section-number">13.3</span> Estadísticos para datos agrupados</h2>
<p>Si tenemos una muestra de datos numéricos, para calcular sus estadísticos es conveniente usar los datos <strong>brutos</strong>, sin agrupar, ya que al agruparlos perdemos información; pero hay ocasiones en que los datos se obtienen ya agrupados: por ejemplo, mediante encuestas en las que se pida marcar un grupo de edad o una franja salarial en una lista de intervalos prefijados. En este tipo de situaciones, sigue siendo posible calcular los estadísticos de la muestra obtenida y usarlos como aproximaciones de los estadísticos de los datos “reales”, que en realidad no conocemos.</p>
<p>La media <span class="math inline">\(\overline{x}\)</span>, la varianza <span class="math inline">\(s^2\)</span>, la varianza muestral <span class="math inline">\(\tilde{s}^2\)</span>, la desviación típica <span class="math inline">\(s\)</span> y la desviación típica muestral <span class="math inline">\(\tilde{s}\)</span> de un conjunto de datos agrupados se calculan con las mismas fórmulas que para los datos sin agrupar, excepto que sustituimos cada clase por su marca y la contamos con su frecuencia. Supongamos, en concreto, que tenemos <span class="math inline">\(k\)</span> clases, sus respectivas marcas son <span class="math inline">\(X_1,\ldots,X_k\)</span> y sus respectivas frecuencias absolutas son <span class="math inline">\(n_1,\ldots,n_k\)</span>, de manera que la longitud total de la muestra es
<span class="math inline">\(n=\sum_{i=1}^k n_i\)</span>; entonces
<span class="math display">\[
\overline{x}=\frac{\sum_{i=1}^k n_iX_i}{n},\
s^2=\frac{\sum_{i=1}^k n_iX^2_i}{n}-\overline{x}^2,\
\tilde{s}^2=\frac{n}{n-1}\cdot s^2,\
s=\sqrt{s^2},\
\tilde{s}=\sqrt{\widetilde{s}^2}.
\]</span>
Por lo que se refiere a la moda, se sustituye por el <strong>intervalo modal</strong>, que es la clase con mayor frecuencia (absoluta o relativa). Si se desea un valor numérico, se toma su marca de clase.</p>

<div class="example">
<p><span id="exm:demografia" class="example"><strong>(#exm:demografia) </strong></span>Hemos descargado de la <a href="http://www.ine.es/jaxi/tabla.do?path=/t20/e243/e01/a1981/l0/&amp;file=01006.px&amp;type=pcaxis&amp;L=0">web del Instituto Nacional de Estadística</a> una tabla con la población censal española de 1981 por grupos quinquenales de edad y la hemos guardado en un fichero en formato CSV en el <em>url</em> <a href="https://raw.githubusercontent.com/AprendeR-UIB/AprendeR1/master/datos/cens81.csv" class="uri">https://raw.githubusercontent.com/AprendeR-UIB/AprendeR1/master/datos/cens81.csv</a>.</p>
</div>
<p>Este fichero contiene dos columnas: una con los grupos de edad y otra con las poblaciones.
Vamos a usar estos datos agrupados para calcular algunos estadísticos de la distribución de la población española por edades en ese año.</p>
<p>Lo primero que hacemos es importarlo en un <em>data frame</em>; para ello podemos usar la función <code>read.csv</code> o la función <code>read.table</code> con <code>header=TRUE</code> y <code>sep=","</code>. Como la variable de grupos de edad tiene todos sus valores diferentes y no la usaremos para clasificar otros valores, la importaremos como un vector de palabras con
<code>stringsAsFactors=FALSE</code>. Como las etiquetas de los grupos de edad contienen la palabra “años”, para garantizar que las eñes se importan de manera correcta es conveniente incluir <code>encoding="utf8"</code>.</p>
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb669-1"><a href="#cb669-1" aria-hidden="true"></a>tabla=<span class="kw">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/AprendeR-UIB/AprendeR1/master/datos/cens81.csv&quot;</span>, </span>
<span id="cb669-2"><a href="#cb669-2" aria-hidden="true"></a>               <span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>, <span class="dt">encoding=</span><span class="st">&quot;UTF-8&quot;</span>)</span>
<span id="cb669-3"><a href="#cb669-3" aria-hidden="true"></a><span class="kw">str</span>(tabla)</span>
<span id="cb669-4"><a href="#cb669-4" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    18 obs. of  2 variables:</span></span>
<span id="cb669-5"><a href="#cb669-5" aria-hidden="true"></a><span class="co">#&gt;  $ Edades   : chr  &quot;De 0 a 4 años&quot; &quot;De 5 a 9 años&quot; &quot;De 10 a 14 años&quot; &quot;De 15 a 19 años&quot; ...</span></span>
<span id="cb669-6"><a href="#cb669-6" aria-hidden="true"></a><span class="co">#&gt;  $ Población: int  3075352 3308049 3302328 3263312 2942178 2537428 2455314 2245806 2056009 2361225 ...</span></span>
<span id="cb669-7"><a href="#cb669-7" aria-hidden="true"></a>tabla</span>
<span id="cb669-8"><a href="#cb669-8" aria-hidden="true"></a><span class="co">#&gt;              Edades Población</span></span>
<span id="cb669-9"><a href="#cb669-9" aria-hidden="true"></a><span class="co">#&gt; 1     De 0 a 4 años   3075352</span></span>
<span id="cb669-10"><a href="#cb669-10" aria-hidden="true"></a><span class="co">#&gt; 2     De 5 a 9 años   3308049</span></span>
<span id="cb669-11"><a href="#cb669-11" aria-hidden="true"></a><span class="co">#&gt; 3   De 10 a 14 años   3302328</span></span>
<span id="cb669-12"><a href="#cb669-12" aria-hidden="true"></a><span class="co">#&gt; 4   De 15 a 19 años   3263312</span></span>
<span id="cb669-13"><a href="#cb669-13" aria-hidden="true"></a><span class="co">#&gt; 5   De 20 a 24 años   2942178</span></span>
<span id="cb669-14"><a href="#cb669-14" aria-hidden="true"></a><span class="co">#&gt; 6   De 25 a 29 años   2537428</span></span>
<span id="cb669-15"><a href="#cb669-15" aria-hidden="true"></a><span class="co">#&gt; 7   De 30 a 34 años   2455314</span></span>
<span id="cb669-16"><a href="#cb669-16" aria-hidden="true"></a><span class="co">#&gt; 8   De 35 a 39 años   2245806</span></span>
<span id="cb669-17"><a href="#cb669-17" aria-hidden="true"></a><span class="co">#&gt; 9   De 40 a 44 años   2056009</span></span>
<span id="cb669-18"><a href="#cb669-18" aria-hidden="true"></a><span class="co">#&gt; 10  De 45 a 49 años   2361225</span></span>
<span id="cb669-19"><a href="#cb669-19" aria-hidden="true"></a><span class="co">#&gt; 11  De 50 a 54 años   2265091</span></span>
<span id="cb669-20"><a href="#cb669-20" aria-hidden="true"></a><span class="co">#&gt; 12  De 55 a 59 años   2038002</span></span>
<span id="cb669-21"><a href="#cb669-21" aria-hidden="true"></a><span class="co">#&gt; 13  De 60 a 64 años   1596543</span></span>
<span id="cb669-22"><a href="#cb669-22" aria-hidden="true"></a><span class="co">#&gt; 14  De 65 a 69 años   1445606</span></span>
<span id="cb669-23"><a href="#cb669-23" aria-hidden="true"></a><span class="co">#&gt; 15  De 70 a 74 años   1213807</span></span>
<span id="cb669-24"><a href="#cb669-24" aria-hidden="true"></a><span class="co">#&gt; 16  De 75 a 79 años    852180</span></span>
<span id="cb669-25"><a href="#cb669-25" aria-hidden="true"></a><span class="co">#&gt; 17  De 80 a 84 años    461960</span></span>
<span id="cb669-26"><a href="#cb669-26" aria-hidden="true"></a><span class="co">#&gt; 18 De 85 y más años    263171</span></span></code></pre></div>
<p>Hay que tener en cuenta que, en esta tabla, la clase “De 0 a 4 años” representa el intervalo de edades [0,5), la clase “De 5 a 9 años” representa el intervalo de edades [5,10), y así sucesivamente.</p>
<p>Para calcular las diferentes medidas estadísticas, hemos de asignar a cada grupo de edades un valor numérico como marca de clase: para los 17 primeros grupos, de amplitud 5, tomaremos su punto medio, y para el último, de amplitud indeterminada, tomaremos 90 como marca. Añadiremos estas marcas al <em>data frame</em> anterior como una nueva variable.</p>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb670-1"><a href="#cb670-1" aria-hidden="true"></a>tabla<span class="op">$</span>Marcas=<span class="kw">c</span>(<span class="fl">2.5</span><span class="op">+</span><span class="dv">5</span><span class="op">*</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">16</span>),<span class="dv">90</span>)</span>
<span id="cb670-2"><a href="#cb670-2" aria-hidden="true"></a><span class="kw">head</span>(tabla)</span>
<span id="cb670-3"><a href="#cb670-3" aria-hidden="true"></a><span class="co">#&gt;            Edades Población Marcas</span></span>
<span id="cb670-4"><a href="#cb670-4" aria-hidden="true"></a><span class="co">#&gt; 1   De 0 a 4 años   3075352    2.5</span></span>
<span id="cb670-5"><a href="#cb670-5" aria-hidden="true"></a><span class="co">#&gt; 2   De 5 a 9 años   3308049    7.5</span></span>
<span id="cb670-6"><a href="#cb670-6" aria-hidden="true"></a><span class="co">#&gt; 3 De 10 a 14 años   3302328   12.5</span></span>
<span id="cb670-7"><a href="#cb670-7" aria-hidden="true"></a><span class="co">#&gt; 4 De 15 a 19 años   3263312   17.5</span></span>
<span id="cb670-8"><a href="#cb670-8" aria-hidden="true"></a><span class="co">#&gt; 5 De 20 a 24 años   2942178   22.5</span></span>
<span id="cb670-9"><a href="#cb670-9" aria-hidden="true"></a><span class="co">#&gt; 6 De 25 a 29 años   2537428   27.5</span></span></code></pre></div>
<p>Ahora ya podemos calcular los estadísticos:</p>
<ul>
<li>Población total:</li>
</ul>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="#cb671-1" aria-hidden="true"></a>Total=<span class="kw">sum</span>(tabla<span class="op">$</span>Población)</span>
<span id="cb671-2"><a href="#cb671-2" aria-hidden="true"></a>Total</span>
<span id="cb671-3"><a href="#cb671-3" aria-hidden="true"></a><span class="co">#&gt; [1] 37683361</span></span></code></pre></div>
<ul>
<li>Media:</li>
</ul>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb672-1"><a href="#cb672-1" aria-hidden="true"></a>Edad.media=<span class="kw">sum</span>(tabla<span class="op">$</span>Población<span class="op">*</span>tabla<span class="op">$</span>Marcas)<span class="op">/</span>Total  </span>
<span id="cb672-2"><a href="#cb672-2" aria-hidden="true"></a>Edad.media </span>
<span id="cb672-3"><a href="#cb672-3" aria-hidden="true"></a><span class="co">#&gt; [1] 33.95994</span></span></code></pre></div>
<ul>
<li>Varianza:</li>
</ul>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="#cb673-1" aria-hidden="true"></a>Edad.varianza=<span class="kw">sum</span>(tabla<span class="op">$</span>Población<span class="op">*</span>tabla<span class="op">$</span>Marcas<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>Total<span class="op">-</span>Edad.media<span class="op">^</span><span class="dv">2</span> </span>
<span id="cb673-2"><a href="#cb673-2" aria-hidden="true"></a>Edad.varianza</span>
<span id="cb673-3"><a href="#cb673-3" aria-hidden="true"></a><span class="co">#&gt; [1] 505.2943</span></span></code></pre></div>
<ul>
<li>Desviación típica:</li>
</ul>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb674-1"><a href="#cb674-1" aria-hidden="true"></a>Edad.desv.tip=<span class="kw">sqrt</span>(Edad.varianza)  </span>
<span id="cb674-2"><a href="#cb674-2" aria-hidden="true"></a>Edad.desv.tip</span>
<span id="cb674-3"><a href="#cb674-3" aria-hidden="true"></a><span class="co">#&gt; [1] 22.47875</span></span></code></pre></div>
<ul>
<li>Intervalo modal:</li>
</ul>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="#cb675-1" aria-hidden="true"></a>Int.modal=tabla<span class="op">$</span>Edades[<span class="kw">which</span>(tabla<span class="op">$</span>Población<span class="op">==</span><span class="kw">max</span>(tabla<span class="op">$</span>Población))]  </span>
<span id="cb675-2"><a href="#cb675-2" aria-hidden="true"></a>Int.modal</span>
<span id="cb675-3"><a href="#cb675-3" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;De 5 a 9 años&quot;</span></span></code></pre></div>
<p>Por lo tanto, con los datos de los que disponemos, podemos afirmar que la edad media de los españoles censados en 1981 era de unos 34 años, con una desviación típica de unos 22.5 años, y que el grupo de edad más numeroso era el de los niños y niñas de 5 a 9 años.</p>
<p>Se han propuesto muchos métodos para aproximar la mediana y los otros cuantiles de una variable cuantitativa agrupada a partir de las tablas de frecuencias de sus clases. Aquí explicaremos una de las más sencillas, y la ilustraremos con el ejemplo anterior; para empezar, vamos a completar el <em>data frame</em> con las frecuencias absolutas acumuladas, relativas y relativas acumuladas:</p>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb676-1"><a href="#cb676-1" aria-hidden="true"></a>tabla<span class="op">$</span>FA.acum=<span class="kw">cumsum</span>(tabla<span class="op">$</span>Población)</span>
<span id="cb676-2"><a href="#cb676-2" aria-hidden="true"></a>tabla<span class="op">$</span>FR=<span class="kw">round</span>(tabla<span class="op">$</span>Población<span class="op">/</span>Total, <span class="dv">3</span>)</span>
<span id="cb676-3"><a href="#cb676-3" aria-hidden="true"></a>tabla<span class="op">$</span>FR.acum=<span class="kw">round</span>(tabla<span class="op">$</span>FA.acum<span class="op">/</span>Total, <span class="dv">3</span>)</span>
<span id="cb676-4"><a href="#cb676-4" aria-hidden="true"></a>tabla</span>
<span id="cb676-5"><a href="#cb676-5" aria-hidden="true"></a><span class="co">#&gt;              Edades Población Marcas  FA.acum    FR FR.acum</span></span>
<span id="cb676-6"><a href="#cb676-6" aria-hidden="true"></a><span class="co">#&gt; 1     De 0 a 4 años   3075352    2.5  3075352 0.082   0.082</span></span>
<span id="cb676-7"><a href="#cb676-7" aria-hidden="true"></a><span class="co">#&gt; 2     De 5 a 9 años   3308049    7.5  6383401 0.088   0.169</span></span>
<span id="cb676-8"><a href="#cb676-8" aria-hidden="true"></a><span class="co">#&gt; 3   De 10 a 14 años   3302328   12.5  9685729 0.088   0.257</span></span>
<span id="cb676-9"><a href="#cb676-9" aria-hidden="true"></a><span class="co">#&gt; 4   De 15 a 19 años   3263312   17.5 12949041 0.087   0.344</span></span>
<span id="cb676-10"><a href="#cb676-10" aria-hidden="true"></a><span class="co">#&gt; 5   De 20 a 24 años   2942178   22.5 15891219 0.078   0.422</span></span>
<span id="cb676-11"><a href="#cb676-11" aria-hidden="true"></a><span class="co">#&gt; 6   De 25 a 29 años   2537428   27.5 18428647 0.067   0.489</span></span>
<span id="cb676-12"><a href="#cb676-12" aria-hidden="true"></a><span class="co">#&gt; 7   De 30 a 34 años   2455314   32.5 20883961 0.065   0.554</span></span>
<span id="cb676-13"><a href="#cb676-13" aria-hidden="true"></a><span class="co">#&gt; 8   De 35 a 39 años   2245806   37.5 23129767 0.060   0.614</span></span>
<span id="cb676-14"><a href="#cb676-14" aria-hidden="true"></a><span class="co">#&gt; 9   De 40 a 44 años   2056009   42.5 25185776 0.055   0.668</span></span>
<span id="cb676-15"><a href="#cb676-15" aria-hidden="true"></a><span class="co">#&gt; 10  De 45 a 49 años   2361225   47.5 27547001 0.063   0.731</span></span>
<span id="cb676-16"><a href="#cb676-16" aria-hidden="true"></a><span class="co">#&gt; 11  De 50 a 54 años   2265091   52.5 29812092 0.060   0.791</span></span>
<span id="cb676-17"><a href="#cb676-17" aria-hidden="true"></a><span class="co">#&gt; 12  De 55 a 59 años   2038002   57.5 31850094 0.054   0.845</span></span>
<span id="cb676-18"><a href="#cb676-18" aria-hidden="true"></a><span class="co">#&gt; 13  De 60 a 64 años   1596543   62.5 33446637 0.042   0.888</span></span>
<span id="cb676-19"><a href="#cb676-19" aria-hidden="true"></a><span class="co">#&gt; 14  De 65 a 69 años   1445606   67.5 34892243 0.038   0.926</span></span>
<span id="cb676-20"><a href="#cb676-20" aria-hidden="true"></a><span class="co">#&gt; 15  De 70 a 74 años   1213807   72.5 36106050 0.032   0.958</span></span>
<span id="cb676-21"><a href="#cb676-21" aria-hidden="true"></a><span class="co">#&gt; 16  De 75 a 79 años    852180   77.5 36958230 0.023   0.981</span></span>
<span id="cb676-22"><a href="#cb676-22" aria-hidden="true"></a><span class="co">#&gt; 17  De 80 a 84 años    461960   82.5 37420190 0.012   0.993</span></span>
<span id="cb676-23"><a href="#cb676-23" aria-hidden="true"></a><span class="co">#&gt; 18 De 85 y más años    263171   90.0 37683361 0.007   1.000</span></span></code></pre></div>
<p>Llamaremos <strong>intervalo crítico para la mediana</strong> al primer intervalo donde la frecuencia relativa acumulada sea mayor o igual que 0.5.
En este caso, el intervalo crítico es la clase “De 30 a 34 años”, es decir, <span class="math inline">\([30,35)\)</span>.</p>
<p>Sean <span class="math inline">\([L_c, L_{c+1})\)</span> este intervalo crítico; <span class="math inline">\(N_{c-1}\)</span>, la frecuencia absoluta acumulada del intervalo anterior al crítico (si el intervalo crítico es el primero, tomamos <span class="math inline">\(N_{c-1}=0\)</span>); <span class="math inline">\(n_c\)</span>, la frecuencia absoluta del intervalo crítico; <span class="math inline">\(A_c=L_{c+1}-L_c\)</span>, su amplitud; y <span class="math inline">\(n\)</span>, el número total de datos. Entonces, la fórmula siguiente nos da una <strong>aproximación</strong> <span class="math inline">\(M\)</span> para la mediana de los datos “reales” a partir de los datos agrupados:
<span class="math display">\[
M=L_{c}+A_c\cdot \frac{\frac{n}{2}- N_{c-1}}{n_c}.
\]</span>
La justificación de esta fórmula es la siguiente: lo que hacemos es unir con una recta las frecuencias absolutas acumuladas en <span class="math inline">\(L_c\)</span> y en <span class="math inline">\(L_{c+1}\)</span>, y aproximar la mediana por medio de la abscisa del punto sobre esta recta cuya ordenada es <span class="math inline">\(n/2\)</span> (véase la Figura @ref(fig:median)).</p>
<div class="figure" style="text-align: center">
<img src="AprendeR-Parte-I_files/figure-html/median.png" alt="Aproximación lineal de la mediana a partir de las frecuencias de los datos agrupados." width="60%" />
<p class="caption">
(#fig:median)Aproximación lineal de la mediana a partir de las frecuencias de los datos agrupados.
</p>
</div>
<p>En nuestro ejemplo, <span class="math inline">\(n=37683361\)</span>, <span class="math inline">\(L_c=30\)</span>, <span class="math inline">\(A_c=5\)</span>, <span class="math inline">\(N_{c-1}=18428647\)</span> y <span class="math inline">\(n_c=2455314\)</span>, por lo que
<span class="math display">\[
M=30+5\cdot\frac{0.5\cdot 37683361-18428647}{2455314}= 30.8411.
\]</span>
Esto nos permite estimar que, en 1981, aproximadamente la mitad de la población española tenía menos de 30 años y 10 meses.</p>
<p>En general, este método permite aproximar el cuantil <span class="math inline">\(Q_p\)</span> de los datos “reales” a partir de los datos agrupados con la fórmula siguiente:
<span class="math display">\[
Q_{p} =L_c + A_c \cdot \frac{p\cdot n-N_{c-1}}{n_c},
\]</span>
donde ahora el intervalo crítico <span class="math inline">\([L_c,L_{c+1})\)</span> es el primer intervalo con frecuencia relativa acumulada mayor o igual que <span class="math inline">\(p\)</span>
y el resto de valores se definen relativos a este intervalo crítico.
De este modo, en nuestro ejemplo, el intervalo crítico para <span class="math inline">\(Q_{0.25}\)</span> es “De 10 a 14 años”, y en este caso <span class="math inline">\(L_c=10\)</span>, <span class="math inline">\(A_c=5\)</span>, <span class="math inline">\(N_{c-1}=6383401\)</span> y <span class="math inline">\(n_c=3302328\)</span>, por lo que
<span class="math display">\[
Q_{0.25}=10+5\cdot\frac{0.25\cdot 37683361-6383401}{3302328}= 14.6.
\]</span>
En cuanto al tercer cuantil, <span class="math inline">\(Q_{0.75}\)</span>, el intervalo crítico es “De 50 a 54 años”, por lo que <span class="math inline">\(L_c=50\)</span>, <span class="math inline">\(A_c=5\)</span>, <span class="math inline">\(N_{c-1}=27547001\)</span> y <span class="math inline">\(n_c=2265091\)</span>, y, por consiguiente,
<span class="math display">\[
Q_{0.75}=50+5\cdot\frac{0.75\cdot 37683361-27547001}{2265091}=51.58.
\]</span></p>
</div>
<div id="sec:hist" class="section level2" number="13.4">
<h2 number="13.4"><span class="header-section-number">13.4</span> Histogramas</h2>
<p>Los datos agrupados se describen gráficamente por medio de unos diagramas de barras específicos llamados <strong>histogramas</strong>, donde se dibuja sobre cada clase una barra cuya <strong>área</strong> representa la frecuencia de dicha clase. Queremos recalcar que en los histogramas es el área de las barras, y no su altura, la que en general representa las frecuencias de las clases.</p>
<p>Veamos un ejemplo.</p>

<div class="example">
<p><span id="exm:1115" class="example"><strong>(#exm:1115) </strong></span>Supongamos que tenemos los datos</p>
</div>
<blockquote>
<p>10,9,8,1,9,8,2,5,7,3,5,6,1,3,7,8,9,8,5,6,2,4,1,3,5,4,6,7,10,8,5,4,2,7,8</p>
</blockquote>
<p>y que los agrupamos en los intervalos [0.5,4), [4,7.5) y [7.5,11).
Calculemos las frecuencias absolutas de estas clases:</p>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="#cb677-1" aria-hidden="true"></a>x=<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">9</span>,<span class="dv">8</span>,<span class="dv">1</span>,<span class="dv">9</span>,<span class="dv">8</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">8</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>,</span>
<span id="cb677-2"><a href="#cb677-2" aria-hidden="true"></a>  <span class="dv">10</span>,<span class="dv">8</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">7</span>,<span class="dv">8</span>)</span>
<span id="cb677-3"><a href="#cb677-3" aria-hidden="true"></a>L1=<span class="kw">c</span>(<span class="fl">0.5</span>,<span class="dv">4</span>,<span class="fl">7.5</span>,<span class="dv">11</span>)</span>
<span id="cb677-4"><a href="#cb677-4" aria-hidden="true"></a>x_int=<span class="kw">cut</span>(x,<span class="dt">breaks=</span>L1,<span class="dt">right=</span><span class="ot">FALSE</span>)</span>
<span id="cb677-5"><a href="#cb677-5" aria-hidden="true"></a><span class="kw">table</span>(x_int)</span>
<span id="cb677-6"><a href="#cb677-6" aria-hidden="true"></a><span class="co">#&gt; x_int</span></span>
<span id="cb677-7"><a href="#cb677-7" aria-hidden="true"></a><span class="co">#&gt;  [0.5,4)  [4,7.5) [7.5,11) </span></span>
<span id="cb677-8"><a href="#cb677-8" aria-hidden="true"></a><span class="co">#&gt;        9       15       11</span></span>
<span id="cb677-9"><a href="#cb677-9" aria-hidden="true"></a>x_int</span>
<span id="cb677-10"><a href="#cb677-10" aria-hidden="true"></a><span class="co">#&gt;  [1] [7.5,11) [7.5,11) [7.5,11) [0.5,4)  [7.5,11) [7.5,11) [0.5,4)  [4,7.5) </span></span>
<span id="cb677-11"><a href="#cb677-11" aria-hidden="true"></a><span class="co">#&gt;  [9] [4,7.5)  [0.5,4)  [4,7.5)  [4,7.5)  [0.5,4)  [0.5,4)  [4,7.5)  [7.5,11)</span></span>
<span id="cb677-12"><a href="#cb677-12" aria-hidden="true"></a><span class="co">#&gt; [17] [7.5,11) [7.5,11) [4,7.5)  [4,7.5)  [0.5,4)  [4,7.5)  [0.5,4)  [0.5,4) </span></span>
<span id="cb677-13"><a href="#cb677-13" aria-hidden="true"></a><span class="co">#&gt; [25] [4,7.5)  [4,7.5)  [4,7.5)  [4,7.5)  [7.5,11) [7.5,11) [4,7.5)  [4,7.5) </span></span>
<span id="cb677-14"><a href="#cb677-14" aria-hidden="true"></a><span class="co">#&gt; [33] [0.5,4)  [4,7.5)  [7.5,11)</span></span>
<span id="cb677-15"><a href="#cb677-15" aria-hidden="true"></a><span class="co">#&gt; Levels: [0.5,4) [4,7.5) [7.5,11)</span></span></code></pre></div>
<p>La Figura @ref(fig:201a) muestra un histograma de las frecuencias absolutas de estos datos con este agrupamiento.
Como todas las clases tienen la misma amplitud, las alturas de estas barras son proporcionales a las frecuencias de sus clases (son estas frecuencias divididas por la amplitud) y las representan correctamente, por lo que hemos marcado sin ningún problema las frecuencias sobre el eje vertical.</p>
<div class="figure" style="text-align: center">
<img src="13chap13_Agrupados_files/figure-html/201a-1.png" alt="Histograma del Ejemplo ref(exm:1115)." width="50%" />
<p class="caption">
(#fig:201a)Histograma del Ejemplo ref(exm:1115).
</p>
</div>
<p>Pero si las amplitudes de las clases no son iguales, las alturas de las barras en un histograma no representan correctamente las frecuencias de las clases. A modo de ejemplo, supongamos que los datos anteriores son notas y que las agrupamos en suspensos, aprobados, notables y sobresalientes: [0,5), [5,7), [7,9) y [9,10]. Recordad que, en este caso, el último intervalo ha de ser cerrado.</p>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb678-1"><a href="#cb678-1" aria-hidden="true"></a>L2=<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">10</span>)</span>
<span id="cb678-2"><a href="#cb678-2" aria-hidden="true"></a>x_int2=<span class="kw">cut</span>(x,<span class="dt">breaks=</span>L2,<span class="dt">right=</span><span class="ot">FALSE</span>,<span class="dt">include.lowest=</span><span class="ot">TRUE</span>) </span>
<span id="cb678-3"><a href="#cb678-3" aria-hidden="true"></a><span class="kw">table</span>(x_int2)</span>
<span id="cb678-4"><a href="#cb678-4" aria-hidden="true"></a><span class="co">#&gt; x_int2</span></span>
<span id="cb678-5"><a href="#cb678-5" aria-hidden="true"></a><span class="co">#&gt;  [0,5)  [5,7)  [7,9) [9,10] </span></span>
<span id="cb678-6"><a href="#cb678-6" aria-hidden="true"></a><span class="co">#&gt;     12      8     10      5</span></span>
<span id="cb678-7"><a href="#cb678-7" aria-hidden="true"></a>x_int2</span>
<span id="cb678-8"><a href="#cb678-8" aria-hidden="true"></a><span class="co">#&gt;  [1] [9,10] [9,10] [7,9)  [0,5)  [9,10] [7,9)  [0,5)  [5,7)  [7,9)  [0,5) </span></span>
<span id="cb678-9"><a href="#cb678-9" aria-hidden="true"></a><span class="co">#&gt; [11] [5,7)  [5,7)  [0,5)  [0,5)  [7,9)  [7,9)  [9,10] [7,9)  [5,7)  [5,7) </span></span>
<span id="cb678-10"><a href="#cb678-10" aria-hidden="true"></a><span class="co">#&gt; [21] [0,5)  [0,5)  [0,5)  [0,5)  [5,7)  [0,5)  [5,7)  [7,9)  [9,10] [7,9) </span></span>
<span id="cb678-11"><a href="#cb678-11" aria-hidden="true"></a><span class="co">#&gt; [31] [5,7)  [0,5)  [0,5)  [7,9)  [7,9) </span></span>
<span id="cb678-12"><a href="#cb678-12" aria-hidden="true"></a><span class="co">#&gt; Levels: [0,5) [5,7) [7,9) [9,10]</span></span></code></pre></div>
<p>En la Figura @ref(fig:203) podéis ver un histograma de frecuencias absolutas de estos datos con este agrupamiento. Comprobaréis que las alturas de las barras son las necesarias para que el área de cada barra sea igual a la frecuencia de la clase correspondiente; como las bases son de amplitudes diferentes, estas alturas no son proporcionales a las frecuencias de las clases, por lo que las marcas en el eje de ordenadas no son las frecuencias de las clases, sino los cocientes entre la frecuencia y la amplitud de las clases.</p>
<div class="figure" style="text-align: center">
<img src="13chap13_Agrupados_files/figure-html/203-1.png" alt="Histograma del Ejemplo ref(exm:1115) con clases de diferentes amplitudes." width="50%" />
<p class="caption">
(#fig:203)Histograma del Ejemplo ref(exm:1115) con clases de diferentes amplitudes.
</p>
</div>
<p>También se usan histogramas para representar frecuencias acumuladas de datos agrupados; en este caso, y a diferencia del anterior, las alturas representan las frecuencias independientemente de la base. El motivo es que estas alturas tienen que ir creciendo. Así, los histogramas de frecuencias absolutas acumuladas de nuestros datos para los dos agrupamientos anteriores serían los mostrados en la Figura @ref(fig:204).</p>
<div class="figure" style="text-align: center">
<img src="13chap13_Agrupados_files/figure-html/204-1.png" alt="Histogramas de frecuencias acumuladas de los datos del Ejemplo \@ref(exm:1115) para dos agrupamientos diferentes." width="90%" />
<p class="caption">
(#fig:204)Histogramas de frecuencias acumuladas de los datos del Ejemplo @ref(exm:1115) para dos agrupamientos diferentes.
</p>
</div>
<p>La Figura @ref(fig:205) muestra la estructura básica de dos histogramas, el izquierdo para las frecuencias absolutas y el derecho para las frecuencias absolutas acumuladas. En un histograma, el eje de las abscisas representa los datos, donde marcamos los extremos de las clases, y se dibuja una barra sobre cada clase; esta barra tiene un significado diferente según el tipo de histograma, pero en general representa la frecuencia de su clase:</p>
<ul>
<li><p>En los histogramas de frecuencias absolutas, la altura de cada barra es la necesaria para que el área de la barra sea igual a la frecuencia absoluta de la clase. Si todas las clases tienen la misma amplitud, esto implica que las alturas de las barras sean proporcionales a las frecuencias de las clases y que, por tanto, las representen bien; si las clases no son todas de la misma amplitud, estas alturas ya no representan las frecuencias. Tanto en un caso como en otro, para facilitar la comprensión del histograma es conveniente indicar de alguna manera las frecuencias que representan las barras;
este consejo se extiende a los histogramas de frecuencias relativas.</p></li>
<li><p>En los histogramas de frecuencias relativas, la altura de cada barra es la necesaria para que el área de la barra sea igual a la frecuencia relativa de la clase; en particular, la suma de las áreas de las barras ha de ser igual a 1. En este contexto, llamamos a las alturas de las barras <strong>densidades</strong>.</p></li>
<li><p>En los histogramas de frecuencias acumuladas (absolutas o relativas), las alturas de las barras son iguales a las frecuencias acumuladas de la clases, independientemente de su amplitud.</p></li>
</ul>
<div class="figure" style="text-align: center">
<img src="13chap13_Agrupados_files/figure-html/205-1.png" alt="Estructura básica de un histograma de frecuencias absolutas (izquierda) y absolutas acumuladas (derecha)" width="90%" />
<p class="caption">
(#fig:205)Estructura básica de un histograma de frecuencias absolutas (izquierda) y absolutas acumuladas (derecha)
</p>
</div>
<p>De este modo, en el histograma de la izquierda de la Figura @ref(fig:205), el área de la barra sobre cada clase <span class="math inline">\([L_j,L_{j+1})\)</span> es igual a la frecuencia absoluta <span class="math inline">\(n_j\)</span> de esta clase; es decir, el producto de la altura <span class="math inline">\(h_j\)</span> de la barra por la amplitud <span class="math inline">\(L_{j+1}-L_j\)</span> es lo que representa la frecuencia, no la altura de la barra. En cambio, en el histograma de la derecha, la barra sobre cada clase <span class="math inline">\([L_j,L_{j+1})\)</span> tiene una altura igual a la frecuencia absoluta acumulada <span class="math inline">\(N_j\)</span> de esta clase.</p>
<p>Una observación: en la práctica, no es conveniente que en un histograma aparezcan clases con frecuencia nula, excepto cuando represente dos poblaciones muy diferentes y separadas, sin individuos “intermedios”. Si aparecen clases vacías, conviene usar un número menor de clases o unir las clases vacías con alguna de sus adyacentes, aunque de esta última manera rompamos la regla básica de usar clases de la misma amplitud.</p>
<p>La función para dibujar histogramas con R es <code>hist</code>. Su estructura básica es</p>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="#cb679-1" aria-hidden="true"></a><span class="kw">hist</span>(x, <span class="dt">breaks=</span>..., <span class="dt">freq=</span>..., <span class="dt">right=</span><span class="ot">FALSE</span>, <span class="dt">include.lowest=</span><span class="ot">TRUE</span>, ...)</span></code></pre></div>
<p>donde:</p>
<ul>
<li><p><code>x</code> es el vector formado por los datos que queremos representar.</p></li>
<li><p>El parámetro <code>breaks</code> es similar al de la función <code>cut</code>: con él podemos establecer los valores de los extremos de los intervalos o el número de intervalos; incluso se puede indicar, entre comillas, el método para calcular el número de clases: <code>"Scott"</code>, <code>"Sturges"</code>, etc.</p>
<p>Ahora bien, tanto si entráis el número de clases como el método para calcularlo, R lo considerará sólo como una sugerencia, por lo que no siempre obtendréis el número deseado de intervalos; además, el método que usa para calcular los intervalos es diferente del usado en <code>cut</code>; por todo ello, os recomendamos que, si queréis tener algún control sobre la producción del histograma, especifiquéis los extremos.</p></li>
<li><p>El parámetro <code>freq</code> es un parámetro lógico: igualado a <code>TRUE</code> (que es el valor por defecto, por lo que en este caso no hace falta incluirlo), produce el histograma de frecuencias absolutas si los intervalos son todos de la misma longitud, y el de frecuencias relativas en caso contrario; igualado a <code>FALSE</code>, produce en los dos casos el de frecuencias relativas.</p></li>
<li><p>El parámetro <code>right</code> funciona como en <code>cut</code>: si queremos nuestros intervalos cerrados a la izquierda y abiertos a la derecha, tenemos que especificar <code>right=FALSE</code>.</p></li>
<li><p>Como ya pasaba en <code>cut</code>, se tiene que añadir <code>include.lowest=TRUE</code> si se ha entrado <code>right=FALSE</code> y el máximo del conjunto de datos coincide con el extremo superior del último intervalo.</p></li>
<li><p>Aparte, podéis usar los parámetros usuales de la función <code>plot</code> para poner un título, cambiar las etiquetas de los ejes, colorear las barras, etc. Recordad también el parámetro <code>plot</code>, que ha salido hace unas páginas: igualado a <code>FALSE</code>, calcula el histograma, pero no lo dibuja.</p></li>
</ul>
<p>Podéis consultar el resto de parámetros en la Ayuda de <code>hist</code>.</p>

<div class="example">
<p><span id="exm:frut-hist" class="example"><strong>(#exm:frut-hist) </strong></span>Seguimos con el Ejemplo @ref(exm:fruitals), sobre árboles frutales afectados por la mosca de la fruta;
vamos a producir el histograma por defecto de los datos para dos agrupamientos diferentes: el que dábamos en dicho ejemplo, en tres clases de amplitud 3, y el que los agrupa en las clases
[5,8), [8,12),[12,14) y [14,20),
de amplitudes diferentes.</p>
</div>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb680-1"><a href="#cb680-1" aria-hidden="true"></a>L1=<span class="fl">5.5</span><span class="op">+</span><span class="dv">3</span><span class="op">*</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb680-2"><a href="#cb680-2" aria-hidden="true"></a><span class="kw">hist</span>(fruta, <span class="dt">breaks=</span> L1, <span class="dt">right=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="13chap13_Agrupados_files/figure-html/unnamed-chunk-68-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="#cb681-1" aria-hidden="true"></a>L2=<span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">20</span>)</span>
<span id="cb681-2"><a href="#cb681-2" aria-hidden="true"></a><span class="kw">hist</span>(fruta, <span class="dt">breaks=</span> L2, <span class="dt">right=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="13chap13_Agrupados_files/figure-html/unnamed-chunk-69-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Como podéis ver, <code>hist</code> ha dibujado los ejes y las barras, pero en el eje horizontal no ha marcado los extremos de las clases; por lo que refiere al eje vertical, en el histograma con las clases de las mismas amplitudes, ha marcado las frecuencias absolutas, pero en el otro ha marcado las densidades, lo que puede dificultar su comprensión.
Además, fijaos en los títulos: <code>hist</code> titula por defecto los histogramas “Histogram of” seguido del nombre del vector de datos, lo que no es muy adecuado si no estáis escribiendo en inglés.</p>
<p>Por suerte, el resultado de <code>hist</code> contiene mucha información escondida que podemos usar para mejorar estos histogramas. Vamos a consultar el contenido del primer histograma del vector <code>fruta</code>; añadimos <code>plot=FALSE</code> para que no lo dibuje.</p>
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb682-1"><a href="#cb682-1" aria-hidden="true"></a>h=<span class="kw">hist</span>(fruta, <span class="dt">breaks=</span>L1, <span class="dt">right=</span><span class="ot">FALSE</span>, <span class="dt">plot=</span><span class="ot">FALSE</span>)</span>
<span id="cb682-2"><a href="#cb682-2" aria-hidden="true"></a>h</span>
<span id="cb682-3"><a href="#cb682-3" aria-hidden="true"></a><span class="co">#&gt; $breaks</span></span>
<span id="cb682-4"><a href="#cb682-4" aria-hidden="true"></a><span class="co">#&gt; [1]  5.5  8.5 11.5 14.5 17.5 20.5</span></span>
<span id="cb682-5"><a href="#cb682-5" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb682-6"><a href="#cb682-6" aria-hidden="true"></a><span class="co">#&gt; $counts</span></span>
<span id="cb682-7"><a href="#cb682-7" aria-hidden="true"></a><span class="co">#&gt; [1] 11 11 17  9  2</span></span>
<span id="cb682-8"><a href="#cb682-8" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb682-9"><a href="#cb682-9" aria-hidden="true"></a><span class="co">#&gt; $density</span></span>
<span id="cb682-10"><a href="#cb682-10" aria-hidden="true"></a><span class="co">#&gt; [1] 0.07333333 0.07333333 0.11333333 0.06000000 0.01333333</span></span>
<span id="cb682-11"><a href="#cb682-11" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb682-12"><a href="#cb682-12" aria-hidden="true"></a><span class="co">#&gt; $mids</span></span>
<span id="cb682-13"><a href="#cb682-13" aria-hidden="true"></a><span class="co">#&gt; [1]  7 10 13 16 19</span></span>
<span id="cb682-14"><a href="#cb682-14" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb682-15"><a href="#cb682-15" aria-hidden="true"></a><span class="co">#&gt; $xname</span></span>
<span id="cb682-16"><a href="#cb682-16" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;fruta&quot;</span></span>
<span id="cb682-17"><a href="#cb682-17" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb682-18"><a href="#cb682-18" aria-hidden="true"></a><span class="co">#&gt; $equidist</span></span>
<span id="cb682-19"><a href="#cb682-19" aria-hidden="true"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb682-20"><a href="#cb682-20" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb682-21"><a href="#cb682-21" aria-hidden="true"></a><span class="co">#&gt; attr(,&quot;class&quot;)</span></span>
<span id="cb682-22"><a href="#cb682-22" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;histogram&quot;</span></span></code></pre></div>
<p>En concreto:</p>
<ul>
<li><p>La componente <code>breaks</code> contiene el vector de extremos de los intervalos: <span class="math inline">\(L_0,L_1,\ldots,L_k\)</span>, <span class="math inline">\(L_{k+1}\)</span>.</p></li>
<li><p>La componente <code>mids</code> contiene el vector de puntos medios de los intervalos (que usamos como marcas de clase): <span class="math inline">\(X_1,X_2, \ldots,X_k\)</span>.</p></li>
<li><p>La componente <code>counts</code> contiene el vector de frecuencias absolutas de los intervalos: <span class="math inline">\(n_1,n_2,\ldots,n_k\)</span>.</p></li>
<li><p>La componente <code>density</code> contiene el vector de las densidades de los intervalos. Estas densidades son las alturas de las barras del histograma de frecuencias relativas; por lo tanto, la densidad de cada intervalo es su frecuencia relativa dividida por su amplitud.</p></li>
</ul>
<p>Podemos servirnos de toda esta información para mejorar el histograma producido por defecto.</p>
<p>Por ejemplo, para histogramas de frecuencias absolutas, podéis usar la función siguiente; sus parámetros son: <span class="math inline">\(x\)</span>, el vector de datos, y <span class="math inline">\(L\)</span>, el vector de extremos de los intervalos.</p>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="#cb683-1" aria-hidden="true"></a>hist_abs=<span class="cf">function</span>(x,L){</span>
<span id="cb683-2"><a href="#cb683-2" aria-hidden="true"></a><span class="cf">if</span> (<span class="kw">sum</span>(<span class="kw">diff</span>(<span class="kw">diff</span>(L)))<span class="op">==</span><span class="dv">0</span>){ </span>
<span id="cb683-3"><a href="#cb683-3" aria-hidden="true"></a>h=<span class="kw">hist</span>(x, <span class="dt">breaks=</span>L, <span class="dt">right=</span><span class="ot">FALSE</span>, <span class="dt">include.lowest=</span><span class="ot">TRUE</span>,</span>
<span id="cb683-4"><a href="#cb683-4" aria-hidden="true"></a>    <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">col=</span><span class="st">&quot;lightgray&quot;</span>,</span>
<span id="cb683-5"><a href="#cb683-5" aria-hidden="true"></a>    <span class="dt">main=</span><span class="st">&quot;Histograma de frecuencias absolutas&quot;</span>,</span>
<span id="cb683-6"><a href="#cb683-6" aria-hidden="true"></a>    <span class="dt">xlab=</span><span class="st">&quot;Intervalos&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Frecuencias absolutas&quot;</span>)</span>
<span id="cb683-7"><a href="#cb683-7" aria-hidden="true"></a>}</span>
<span id="cb683-8"><a href="#cb683-8" aria-hidden="true"></a>  <span class="cf">else</span> {</span>
<span id="cb683-9"><a href="#cb683-9" aria-hidden="true"></a> h=<span class="kw">hist</span>(x, <span class="dt">breaks=</span>L, <span class="dt">right=</span><span class="ot">FALSE</span>, <span class="dt">include.lowest=</span><span class="ot">TRUE</span>,</span>
<span id="cb683-10"><a href="#cb683-10" aria-hidden="true"></a>    <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">col=</span><span class="st">&quot;lightgray&quot;</span>,</span>
<span id="cb683-11"><a href="#cb683-11" aria-hidden="true"></a>    <span class="dt">main=</span><span class="st">&quot;Histograma de frecuencias absolutas&quot;</span>,</span>
<span id="cb683-12"><a href="#cb683-12" aria-hidden="true"></a>    <span class="dt">xlab=</span><span class="st">&quot;Intervalos&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb683-13"><a href="#cb683-13" aria-hidden="true"></a> <span class="kw">text</span>(h<span class="op">$</span>mids, h<span class="op">$</span>density<span class="op">/</span><span class="dv">2</span>, <span class="dt">labels=</span>h<span class="op">$</span>counts, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">cex=</span><span class="fl">0.75</span>)</span>
<span id="cb683-14"><a href="#cb683-14" aria-hidden="true"></a>}</span>
<span id="cb683-15"><a href="#cb683-15" aria-hidden="true"></a><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span>L)}</span></code></pre></div>
<p>Si la aplicamos a los valores de <code>fruta</code> y <code>L1</code> o <code>L2</code> anteriores, obtenemos los dos histogramas siguientes</p>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="#cb684-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb684-2"><a href="#cb684-2" aria-hidden="true"></a><span class="kw">hist_abs</span>(fruta, L1)</span>
<span id="cb684-3"><a href="#cb684-3" aria-hidden="true"></a><span class="kw">hist_abs</span>(fruta, L2)</span></code></pre></div>
<p><img src="13chap13_Agrupados_files/figure-html/unnamed-chunk-72-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb685-1"><a href="#cb685-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>Algunos comentarios sobre la manera como hemos definido esta función, para que la podáis modificar:</p>
<ul>
<li><p>La condición <code>sum(diff(diff(L)))==0</code> es equivalente a que los intervalos definidos por los elementos de <code>L</code> tengan todos la misma amplitud, y por lo tanto tenga sentido marcar las frecuencias en el eje de ordenadas.</p></li>
<li><p>El parámetro <code>axes=FALSE</code> especifica que no se dibujen los ejes, y los parámetros <code>xaxt="n"</code> e <code>yaxt="n"</code> especifican, respectivamente, que no se dibuje el eje de abscisas y que no se dibuje el eje de ordenadas.</p></li>
<li><p>La instrucción <code>axis(i, at=..., labels=...)</code> dibuja el eje correspondiente al valor de <span class="math inline">\(i\)</span> (<span class="math inline">\(i=1\)</span>, el de abscisas; <span class="math inline">\(i=2\)</span>, el de ordenadas) con marcas en los lugares indicados por el vector definido mediante <code>at</code> y etiquetas en las marcas indicadas por el valor de <code>labels</code>; si este último parámetro no se usa, las etiquetas son los valores de las marcas. Por lo tanto, la instrucción <code>axis(1, at=L)</code> añade un eje de abscisas (que no habíamos dibujado) con marcas en los extremos de las clases.</p></li>
</ul>
<p>Naturalmente, podéis adaptar a vuestro gusto esta función <code>hist_abs</code> o las otras que daremos: podéis cambiar el título, cambiar los colores, la etiqueta del eje de abscisas, etc.</p>
<p>Otra posibilidad para indicar las frecuencias absolutas de las barras es usar la función <code>rug</code>, que permite añadir al histograma una “alfombra” con marcas en todos los valores del vector; el grosor de cada marca es proporcional a la frecuencia del valor que representa.
Veamos un ejemplo:</p>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb686-1"><a href="#cb686-1" aria-hidden="true"></a><span class="kw">hist_abs</span>(fruta, L1)</span>
<span id="cb686-2"><a href="#cb686-2" aria-hidden="true"></a><span class="kw">rug</span>(fruta)</span></code></pre></div>
<p><img src="13chap13_Agrupados_files/figure-html/unnamed-chunk-73-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Notaréis que, en este histograma, es difícil deducir de la “alfombra” que la tercera clase tiene una frecuencia mayor que las dos primeras debido a un mayor número de empates. Si encontráis difícil ver los empates, la Ayuda de <code>rug</code> os recomienda combinar <code>rug</code> con la función <code>jitter</code>, que añade un poco de “ruido” a los datos de un vector, deshaciendo empates. Veamos su uso en el histograma anterior:</p>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="#cb687-1" aria-hidden="true"></a><span class="kw">hist_abs</span>(fruta, L1)</span>
<span id="cb687-2"><a href="#cb687-2" aria-hidden="true"></a><span class="kw">rug</span>(<span class="kw">jitter</span>(fruta))</span></code></pre></div>
<p><img src="13chap13_Agrupados_files/figure-html/unnamed-chunk-74-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Para dibujar histogramas de frecuencias absolutas acumuladas, podéis usar la función:</p>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="#cb688-1" aria-hidden="true"></a>hist_abs.cum=<span class="cf">function</span>(x,L){</span>
<span id="cb688-2"><a href="#cb688-2" aria-hidden="true"></a>h=<span class="kw">hist</span>(x, <span class="dt">breaks=</span>L, <span class="dt">right=</span><span class="ot">FALSE</span>, <span class="dt">include.lowest=</span><span class="ot">TRUE</span>, <span class="dt">plot=</span><span class="ot">FALSE</span>)</span>
<span id="cb688-3"><a href="#cb688-3" aria-hidden="true"></a>h<span class="op">$</span>density=<span class="kw">cumsum</span>(h<span class="op">$</span>density)</span>
<span id="cb688-4"><a href="#cb688-4" aria-hidden="true"></a><span class="kw">plot</span>(h, <span class="dt">freq=</span><span class="ot">FALSE</span>, <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">col=</span><span class="st">&quot;lightgray&quot;</span>,</span>
<span id="cb688-5"><a href="#cb688-5" aria-hidden="true"></a>  <span class="dt">main=</span><span class="st">&quot;Histograma de frecuencias absolutas acumuladas&quot;</span>, </span>
<span id="cb688-6"><a href="#cb688-6" aria-hidden="true"></a>  <span class="dt">xlab=</span><span class="st">&quot;Intervalos&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb688-7"><a href="#cb688-7" aria-hidden="true"></a><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span>L)</span>
<span id="cb688-8"><a href="#cb688-8" aria-hidden="true"></a><span class="kw">text</span>(h<span class="op">$</span>mids, h<span class="op">$</span>density<span class="op">/</span><span class="dv">2</span>, <span class="dt">labels=</span><span class="kw">cumsum</span>(h<span class="op">$</span>counts), <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">cex=</span><span class="fl">0.75</span>)</span>
<span id="cb688-9"><a href="#cb688-9" aria-hidden="true"></a>}</span></code></pre></div>
<p>Aplicándola a los valores de <code>fruta</code> y <code>L1</code> anteriores:</p>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="#cb689-1" aria-hidden="true"></a><span class="kw">hist_abs.cum</span>(fruta,L1)</span></code></pre></div>
<p><img src="13chap13_Agrupados_files/figure-html/unnamed-chunk-76-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Con esta función producimos el histograma “básico” de los datos, sin dibujarlo, y a continuación
modificamos su componente <code>density</code> para que contenga las sumas acumuladas de la componente <code>density</code> del histograma original. Luego dibujamos el nuevo histograma resultante, aplicándole la función <code>plot</code>; los parámetros del gráfico se tienen que añadir a este <code>plot</code>, no al histograma original. Finalmente, completamos el gráfico añadiendo el eje de abscisas y las frecuencias acumuladas en el interior de las barras. También podéis añadir un eje de ordenadas con marcas de frecuencias, por ejemplo añadiendo una instrucción del estilo de</p>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="#cb690-1" aria-hidden="true"></a><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="kw">max</span>(h<span class="op">$</span>density),<span class="dt">length.out=</span>...),<span class="dt">labels=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="kw">length</span>(x),<span class="dt">length.out=</span>...))</span></code></pre></div>
<p>con el número de marcas (indicado por los <code>length.out</code>) a vuestro gusto: pueden ser un parámetro de la nueva función que defináis. Por ejemplo</p>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="#cb691-1" aria-hidden="true"></a>hist_abs.cum<span class="fl">.2</span>=<span class="cf">function</span>(x,L,m){</span>
<span id="cb691-2"><a href="#cb691-2" aria-hidden="true"></a>h=<span class="kw">hist</span>(x, <span class="dt">breaks=</span>L, <span class="dt">right=</span><span class="ot">FALSE</span>, <span class="dt">include.lowest=</span><span class="ot">TRUE</span>, <span class="dt">plot=</span><span class="ot">FALSE</span>)</span>
<span id="cb691-3"><a href="#cb691-3" aria-hidden="true"></a>h<span class="op">$</span>density=<span class="kw">cumsum</span>(h<span class="op">$</span>density)</span>
<span id="cb691-4"><a href="#cb691-4" aria-hidden="true"></a><span class="kw">plot</span>(h, <span class="dt">freq=</span><span class="ot">FALSE</span>, <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">col=</span><span class="st">&quot;lightgray&quot;</span>,</span>
<span id="cb691-5"><a href="#cb691-5" aria-hidden="true"></a>  <span class="dt">main=</span><span class="st">&quot;Histograma de frecuencias absolutas acumuladas&quot;</span>, </span>
<span id="cb691-6"><a href="#cb691-6" aria-hidden="true"></a>  <span class="dt">xlab=</span><span class="st">&quot;Intervalos&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb691-7"><a href="#cb691-7" aria-hidden="true"></a><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span>L)</span>
<span id="cb691-8"><a href="#cb691-8" aria-hidden="true"></a><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="kw">max</span>(h<span class="op">$</span>density),<span class="dt">length.out=</span>m),<span class="dt">labels=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="kw">length</span>(x),<span class="dt">length.out=</span>m))</span>
<span id="cb691-9"><a href="#cb691-9" aria-hidden="true"></a>}</span>
<span id="cb691-10"><a href="#cb691-10" aria-hidden="true"></a><span class="kw">hist_abs.cum.2</span>(fruta,L1,<span class="dv">11</span>)</span></code></pre></div>
<p><img src="13chap13_Agrupados_files/figure-html/unnamed-chunk-78-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Pasemos a los histogramas de frecuencias relativas. En ellos, es costumbre superponer una curva que estime la <strong>densidad</strong> de la
distribución de la variable definida por la característica que medimos.</p>
<p>La densidad de una variable es una curva tal que el área comprendida entre el eje de abscisas y la curva sobre un intervalo es igual a la fracción de individuos de la población que caen dentro de ese intervalo. Visualmente,
imaginemos que vamos aumentando el tamaño de la muestra y que agrupamos los datos
en una familia cada vez mayor de intervalos; si el rango de los datos se mantiene más o menos constante, la amplitud de los
intervalos del histograma irá decreciendo; cuando el tamaño del conjunto de datos tiende a infinito,
los intervalos tienden a ser puntos y, las barras, a ser líneas verticales. Los extremos superiores de estas líneas dibujarán una curva: ésta es la densidad de la variable.</p>
<p>La densidad más famosa es la llamada <strong>campana de Gauss</strong>, y corresponde a una variable que tenga una <strong>distribución normal</strong> (véase la Figura @ref(fig:norm)). La forma concreta de la campana depende de dos parámetros: el valor medio <span class="math inline">\(\mu\)</span> de la variable y su desviación típica <span class="math inline">\(\sigma\)</span>.</p>
<div class="figure" style="text-align: center">
<img src="AprendeR-Parte-I_files/figure-html/gauss.png" alt="Campana de Gauss." width="100%" />
<p class="caption">
(#fig:norm)Campana de Gauss.
</p>
</div>
<p>Hay muchos métodos para estimar la densidad de la distribución a partir de una muestra; la manera más sencilla de hacerlo con R es usar la función <code>density</code>. Cuando aplicamos esta función, con sus parámetros por defecto, a un vector númerico, produce una <code>list</code> que incluye los vectores <code>x</code> e <code>y</code> de primeras y segundas coordenadas de una secuencia de puntos <span class="math inline">\((x,y)\)</span> sobre la curva densidad estimada. Aplicando <code>plot</code>, con <code>type="l"</code>, o <code>lines</code> (si hay que añadirla a un gráfico anterior) al resultado de <code>density</code>, obtenemos el gráfico de esta curva. (Explicar el método que usa esta función <code>density</code> para estimar la densidad cae fuera del nivel de este curso. Los curiosos pueden consultar <a href="http://en.wikipedia.org/wiki/Kernel_density_estimation">este artículo de la Wikipedia</a> y luego la Ayuda de la función.)</p>
<p>La instrucción siguiente produce el gráfico de la densidad estimada de la variable que ha producido el vector <code>fruta</code>:</p>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb692-1"><a href="#cb692-1" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">density</span>(fruta), <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Número de árboles&quot;</span>,</span>
<span id="cb692-2"><a href="#cb692-2" aria-hidden="true"></a>  <span class="dt">ylab=</span><span class="st">&quot;Densidad&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Densidad de la variable </span><span class="ch">\&quot;</span><span class="st">fruta</span><span class="ch">\&quot;</span><span class="st">&quot;</span>)</span></code></pre></div>
<p><img src="13chap13_Agrupados_files/figure-html/unnamed-chunk-79-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>La estructura del resultado de <code>density(fruta)</code> es la siguiente:</p>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="#cb693-1" aria-hidden="true"></a><span class="kw">str</span>(<span class="kw">density</span>(fruta))</span>
<span id="cb693-2"><a href="#cb693-2" aria-hidden="true"></a><span class="co">#&gt; List of 7</span></span>
<span id="cb693-3"><a href="#cb693-3" aria-hidden="true"></a><span class="co">#&gt;  $ x        : num [1:512] 1.69 1.73 1.78 1.82 1.86 ...</span></span>
<span id="cb693-4"><a href="#cb693-4" aria-hidden="true"></a><span class="co">#&gt;  $ y        : num [1:512] 0.000326 0.000356 0.000388 0.000424 0.000462 ...</span></span>
<span id="cb693-5"><a href="#cb693-5" aria-hidden="true"></a><span class="co">#&gt;  $ bw       : num 1.44</span></span>
<span id="cb693-6"><a href="#cb693-6" aria-hidden="true"></a><span class="co">#&gt;  $ n        : int 50</span></span>
<span id="cb693-7"><a href="#cb693-7" aria-hidden="true"></a><span class="co">#&gt;  $ call     : language density.default(x = fruta)</span></span>
<span id="cb693-8"><a href="#cb693-8" aria-hidden="true"></a><span class="co">#&gt;  $ data.name: chr &quot;fruta&quot;</span></span>
<span id="cb693-9"><a href="#cb693-9" aria-hidden="true"></a><span class="co">#&gt;  $ has.na   : logi FALSE</span></span>
<span id="cb693-10"><a href="#cb693-10" aria-hidden="true"></a><span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr &quot;density&quot;</span></span></code></pre></div>
<p>Destacamos en particular sus componentes <code>density(fruta)$x</code> y <code>density(fruta)$y</code>, que nos dan las abscisas y las ordenadas de los puntos usados para dibujar su gráfico, y que usaremos más adelante.</p>
<p>Para dibujar un histograma de frecuencias relativas más informativo que el que produce R por defecto y que incluya la estimación de la densidad, podéis usar la función siguiente:</p>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="#cb694-1" aria-hidden="true"></a>hist_rel=<span class="cf">function</span>(x,L){</span>
<span id="cb694-2"><a href="#cb694-2" aria-hidden="true"></a>h=<span class="kw">hist</span>(x, <span class="dt">breaks=</span>L, <span class="dt">right=</span><span class="ot">FALSE</span>, <span class="dt">plot=</span><span class="ot">FALSE</span>)</span>
<span id="cb694-3"><a href="#cb694-3" aria-hidden="true"></a>t=<span class="kw">round</span>(<span class="fl">1.1</span><span class="op">*</span><span class="kw">max</span>(<span class="kw">max</span>(<span class="kw">density</span>(x)[[<span class="dv">2</span>]]),h<span class="op">$</span>density),<span class="dv">2</span>)</span>
<span id="cb694-4"><a href="#cb694-4" aria-hidden="true"></a><span class="kw">plot</span>(h, <span class="dt">freq=</span><span class="ot">FALSE</span>, <span class="dt">col=</span><span class="st">&quot;lightgray&quot;</span>,</span>
<span id="cb694-5"><a href="#cb694-5" aria-hidden="true"></a> <span class="dt">main=</span><span class="st">&quot;Histograma de frec. relativas y curva de densidad estimada&quot;</span>,</span>
<span id="cb694-6"><a href="#cb694-6" aria-hidden="true"></a> <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,t), <span class="dt">xlab=</span><span class="st">&quot;Intervalos&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Densidades&quot;</span>)</span>
<span id="cb694-7"><a href="#cb694-7" aria-hidden="true"></a><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span>L)</span>
<span id="cb694-8"><a href="#cb694-8" aria-hidden="true"></a><span class="kw">text</span>(h<span class="op">$</span>mids, h<span class="op">$</span>density<span class="op">/</span><span class="dv">2</span>, <span class="dt">labels=</span><span class="kw">round</span>(h<span class="op">$</span>counts<span class="op">/</span><span class="kw">length</span>(x),<span class="dv">2</span>), <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">cex=</span><span class="fl">0.75</span>)</span>
<span id="cb694-9"><a href="#cb694-9" aria-hidden="true"></a><span class="kw">lines</span>(<span class="kw">density</span>(x), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb694-10"><a href="#cb694-10" aria-hidden="true"></a>}</span></code></pre></div>
<p>Si la aplicamos a los valores de <code>fruta</code> y <code>L1</code> anteriores:</p>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb695-1"><a href="#cb695-1" aria-hidden="true"></a><span class="kw">hist_rel</span>(fruta, L1)</span></code></pre></div>
<p><img src="13chap13_Agrupados_files/figure-html/unnamed-chunk-82-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>En los histogramas de frecuencias relativas acumuladas, se puede superponer una curva que estime la <strong>función de distribución</strong> de la variable definida por la característica que medimos. Esta función de distribución de una variable nos da, en cada punto, la fracción de individuos de la población que caen a la izquierda de este punto, es decir, la frecuencia relativa acumulada de la variable sobre la población en ese punto. En general, la función de distribución en un valor determinado es igual al área de la región, a la izquierda de la vertical definida por dicho valor, delimitada por la función de densidad y el eje de abscisas.</p>
<p>Para dibujar un histograma de frecuencias relativas acumuladas que incluya la función de distribución estimada, podéis usar la función siguiente:</p>
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb696-1"><a href="#cb696-1" aria-hidden="true"></a>hist_rel.cum=<span class="cf">function</span>(x,L){</span>
<span id="cb696-2"><a href="#cb696-2" aria-hidden="true"></a>h=<span class="kw">hist</span>(x, <span class="dt">breaks=</span>L, <span class="dt">right=</span><span class="ot">FALSE</span>, <span class="dt">plot=</span><span class="ot">FALSE</span>)</span>
<span id="cb696-3"><a href="#cb696-3" aria-hidden="true"></a>h<span class="op">$</span>density=<span class="kw">cumsum</span>(h<span class="op">$</span>counts)<span class="op">/</span><span class="kw">length</span>(x) <span class="co">#calculamos las f. relativas</span></span>
<span id="cb696-4"><a href="#cb696-4" aria-hidden="true"></a><span class="kw">plot</span>(h, <span class="dt">freq=</span><span class="ot">FALSE</span>, <span class="dt">main=</span><span class="st">&quot;Histograma de frec. rel. acumuladas</span><span class="ch">\n</span><span class="st"> y </span></span>
<span id="cb696-5"><a href="#cb696-5" aria-hidden="true"></a><span class="st">  curva de distribución estimada&quot;</span>, <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">col=</span><span class="st">&quot;lightgray&quot;</span>,</span>
<span id="cb696-6"><a href="#cb696-6" aria-hidden="true"></a>  <span class="dt">xlab=</span><span class="st">&quot;Intervalos&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Frec. relativas acumuladas&quot;</span>)</span>
<span id="cb696-7"><a href="#cb696-7" aria-hidden="true"></a><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span>L)</span>
<span id="cb696-8"><a href="#cb696-8" aria-hidden="true"></a><span class="kw">text</span>(h<span class="op">$</span>mids, h<span class="op">$</span>density<span class="op">/</span><span class="dv">2</span>,<span class="dt">labels=</span><span class="kw">round</span>(h<span class="op">$</span>density,<span class="dv">2</span>), <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">cex=</span><span class="fl">0.75</span>)</span>
<span id="cb696-9"><a href="#cb696-9" aria-hidden="true"></a>dens.x=<span class="kw">density</span>(x)</span>
<span id="cb696-10"><a href="#cb696-10" aria-hidden="true"></a>dens.x<span class="op">$</span>y=<span class="kw">cumsum</span>(dens.x<span class="op">$</span>y)<span class="op">*</span>(dens.x<span class="op">$</span>x[<span class="dv">2</span>]<span class="op">-</span>dens.x<span class="op">$</span>x[<span class="dv">1</span>]) </span>
<span id="cb696-11"><a href="#cb696-11" aria-hidden="true"></a><span class="kw">lines</span>(dens.x,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb696-12"><a href="#cb696-12" aria-hidden="true"></a>}</span></code></pre></div>
<p>Aplicándola a los valores de <code>fruta</code> y <code>L1</code> anteriores:</p>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb697-1"><a href="#cb697-1" aria-hidden="true"></a><span class="kw">hist_rel.cum</span>(fruta,L1)</span></code></pre></div>
<p><img src="13chap13_Agrupados_files/figure-html/unnamed-chunk-84-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Veamos otro ejemplo.</p>

<div class="example">
<p><span id="exm:unnamed-chunk-85" class="example"><strong>(#exm:unnamed-chunk-85) </strong></span>Consideremos los datos de tiempos de inicio de reacción alérgica a una picadura del Ejemplo @ref(exm:alerg). Queremos dibujar los histogramas de frecuencias relativas y relativas acumuladas para el agrupamiento según la regla de Sturges. Por completitud, empezaremos de cero.</p>
</div>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb698-1"><a href="#cb698-1" aria-hidden="true"></a>alergia=<span class="kw">c</span>(<span class="fl">10.5</span>,<span class="fl">11.2</span>,<span class="fl">9.9</span>,<span class="fl">15.0</span>,<span class="fl">11.4</span>,<span class="fl">12.7</span>,<span class="fl">16.5</span>,<span class="fl">10.1</span>,<span class="fl">12.7</span>,<span class="fl">11.4</span>,<span class="fl">11.6</span>,</span>
<span id="cb698-2"><a href="#cb698-2" aria-hidden="true"></a>  <span class="fl">6.2</span>,<span class="fl">7.9</span>,<span class="fl">8.3</span>,<span class="fl">10.9</span>,<span class="fl">8.1</span>,<span class="fl">3.8</span>,<span class="fl">10.5</span>,<span class="fl">11.7</span>,<span class="fl">8.4</span>,<span class="fl">12.5</span>,<span class="fl">11.2</span>,<span class="fl">9.1</span>,<span class="fl">10.4</span>,<span class="fl">9.1</span>,</span>
<span id="cb698-3"><a href="#cb698-3" aria-hidden="true"></a>  <span class="fl">13.4</span>,<span class="fl">12.3</span>,<span class="fl">5.9</span>,<span class="fl">11.4</span>,<span class="fl">8.8</span>,<span class="fl">7.4</span>,<span class="fl">8.6</span>,<span class="fl">13.6</span>,<span class="fl">14.7</span>,<span class="fl">11.5</span>,<span class="fl">11.5</span>,<span class="fl">10.9</span>,<span class="fl">9.8</span>,</span>
<span id="cb698-4"><a href="#cb698-4" aria-hidden="true"></a>  <span class="fl">12.9</span>,<span class="fl">9.9</span>)</span>
<span id="cb698-5"><a href="#cb698-5" aria-hidden="true"></a><span class="kw">nclass.Sturges</span>(alergia)</span>
<span id="cb698-6"><a href="#cb698-6" aria-hidden="true"></a><span class="co">#&gt; [1] 7</span></span>
<span id="cb698-7"><a href="#cb698-7" aria-hidden="true"></a><span class="kw">diff</span>(<span class="kw">range</span>(alergia))</span>
<span id="cb698-8"><a href="#cb698-8" aria-hidden="true"></a><span class="co">#&gt; [1] 12.7</span></span>
<span id="cb698-9"><a href="#cb698-9" aria-hidden="true"></a><span class="fl">12.7</span><span class="op">/</span><span class="dv">7</span></span>
<span id="cb698-10"><a href="#cb698-10" aria-hidden="true"></a><span class="co">#&gt; [1] 1.814286</span></span></code></pre></div>
<p>Por lo tanto, tomamos A=1.9.</p>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb699-1"><a href="#cb699-1" aria-hidden="true"></a>L.al=<span class="kw">min</span>(alergia)<span class="op">-</span><span class="fl">0.05+1.9</span><span class="op">*</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">7</span>) </span>
<span id="cb699-2"><a href="#cb699-2" aria-hidden="true"></a>L.al</span>
<span id="cb699-3"><a href="#cb699-3" aria-hidden="true"></a><span class="co">#&gt; [1]  3.75  5.65  7.55  9.45 11.35 13.25 15.15 17.05</span></span></code></pre></div>
<p>Y ahora usamos las funciones que hemos definido:</p>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb700-1"><a href="#cb700-1" aria-hidden="true"></a><span class="kw">hist_rel</span>(alergia, L.al)</span></code></pre></div>
<p><img src="13chap13_Agrupados_files/figure-html/unnamed-chunk-88-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="#cb701-1" aria-hidden="true"></a><span class="kw">hist_rel.cum</span>(alergia, L.al)</span></code></pre></div>
<p><img src="13chap13_Agrupados_files/figure-html/unnamed-chunk-88-2.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Veamos un último ejemplo.</p>

<div class="example">
<p><span id="exm:crab" class="example"><strong>(#exm:crab) </strong></span>El fichero <code>datacrab.txt</code>, del cual hemos guardado una copia en el url <a href="https://raw.githubusercontent.com/AprendeR-UIB/AprendeR1/master/datos/datacrab.txt" class="uri">https://raw.githubusercontent.com/AprendeR-UIB/AprendeR1/master/datos/datacrab.txt</a>, recoge los datos sobre hembras de límula del Atlántico analizadas en el artículo “Satellite male groups in horseshoe crabs, <em>Limulus polyphemus</em>” de H. J. Brockmann (<em>Ethology</em> 102 (1996), pp. 1-21). Una de las variables que incluye esta tabla de datos es la amplitud, <code>width</code>, de los especímenes analizados.</p>
</div>
<p>Vamos a dibujar un histograma de las frecuencias relativas de estas amplitudes que incluya su curva de densidad estimada; esta vez agruparemos estas amplitudes usando la regla de Scott. Aprovecharemos para calcular la tabla de frecuencias de este agrupamiento.</p>
<p>Empezamos importando esta tabla en un <em>data frame</em> y definiendo un vector con la variable correspondiente a la amplitud.</p>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb702-1"><a href="#cb702-1" aria-hidden="true"></a>crab=<span class="kw">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/AprendeR-UIB/AprendeR1/master/datos/datacrab.txt&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>)</span>
<span id="cb702-2"><a href="#cb702-2" aria-hidden="true"></a><span class="kw">str</span>(crab)</span>
<span id="cb702-3"><a href="#cb702-3" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    173 obs. of  5 variables:</span></span>
<span id="cb702-4"><a href="#cb702-4" aria-hidden="true"></a><span class="co">#&gt;  $ input      : int  3 4 2 4 4 3 2 4 3 4 ...</span></span>
<span id="cb702-5"><a href="#cb702-5" aria-hidden="true"></a><span class="co">#&gt;  $ color.spine: int  3 3 1 3 3 3 1 2 1 3 ...</span></span>
<span id="cb702-6"><a href="#cb702-6" aria-hidden="true"></a><span class="co">#&gt;  $ width      : num  28.3 22.5 26 24.8 26 23.8 26.5 24.7 23.7 25.6 ...</span></span>
<span id="cb702-7"><a href="#cb702-7" aria-hidden="true"></a><span class="co">#&gt;  $ satell     : int  8 0 9 0 4 0 0 0 0 0 ...</span></span>
<span id="cb702-8"><a href="#cb702-8" aria-hidden="true"></a><span class="co">#&gt;  $ weight     : int  3050 1550 2300 2100 2600 2100 2350 1900 1950 2150 ...</span></span>
<span id="cb702-9"><a href="#cb702-9" aria-hidden="true"></a>crw=crab<span class="op">$</span>width</span></code></pre></div>
<p>Observamos que las amplitudes están expresadas con una precisión de décimas de unidad.
A continuación, determinamos el número de clases, amplitud, etc. del agrupamiento de este vector <code>crw</code> siguiendo la regla de Scott.</p>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="#cb703-1" aria-hidden="true"></a><span class="kw">nclass.scott</span>(crw)</span>
<span id="cb703-2"><a href="#cb703-2" aria-hidden="true"></a><span class="co">#&gt; [1] 10</span></span>
<span id="cb703-3"><a href="#cb703-3" aria-hidden="true"></a><span class="kw">diff</span>(<span class="kw">range</span>(crw))<span class="op">/</span><span class="dv">10</span></span>
<span id="cb703-4"><a href="#cb703-4" aria-hidden="true"></a><span class="co">#&gt; [1] 1.25</span></span></code></pre></div>
<p>Por lo tanto, tomamos A=1.3.</p>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb704-1"><a href="#cb704-1" aria-hidden="true"></a>L.cr=<span class="kw">min</span>(crw)<span class="op">-</span><span class="fl">0.05+1.3</span><span class="op">*</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>)</span>
<span id="cb704-2"><a href="#cb704-2" aria-hidden="true"></a>L.cr</span>
<span id="cb704-3"><a href="#cb704-3" aria-hidden="true"></a><span class="co">#&gt;  [1] 20.95 22.25 23.55 24.85 26.15 27.45 28.75 30.05 31.35 32.65 33.95</span></span>
<span id="cb704-4"><a href="#cb704-4" aria-hidden="true"></a>crw_int=<span class="kw">cut</span>(crw, <span class="dt">breaks=</span>L.cr, <span class="dt">right=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p>Ahora calcularemos la tabla de frecuencias para este agrupamiento <code>crw_int</code>. Usaremos la función
<code>Tabla_frec_agrup</code> que hemos definido al final de la Sección @ref(sec:agrupR).</p>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="#cb705-1" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">Tabla_frec_agrup</span>(crw,<span class="dv">10</span>,<span class="fl">1.3</span>,<span class="fl">0.1</span>,<span class="dt">dig.lab=</span><span class="dv">4</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">intervalos</th>
<th align="right">marcas</th>
<th align="right">f.abs</th>
<th align="right">f.abs.cum</th>
<th align="right">f.rel</th>
<th align="right">f.rel.cum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">[20.95,22.25)</td>
<td align="right">21.6</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">0.0115607</td>
<td align="right">0.0115607</td>
</tr>
<tr class="even">
<td align="left">[22.25,23.55)</td>
<td align="right">22.9</td>
<td align="right">14</td>
<td align="right">16</td>
<td align="right">0.0809249</td>
<td align="right">0.0924855</td>
</tr>
<tr class="odd">
<td align="left">[23.55,24.85)</td>
<td align="right">24.2</td>
<td align="right">27</td>
<td align="right">43</td>
<td align="right">0.1560694</td>
<td align="right">0.2485549</td>
</tr>
<tr class="even">
<td align="left">[24.85,26.15)</td>
<td align="right">25.5</td>
<td align="right">44</td>
<td align="right">87</td>
<td align="right">0.2543353</td>
<td align="right">0.5028902</td>
</tr>
<tr class="odd">
<td align="left">[26.15,27.45)</td>
<td align="right">26.8</td>
<td align="right">34</td>
<td align="right">121</td>
<td align="right">0.1965318</td>
<td align="right">0.6994220</td>
</tr>
<tr class="even">
<td align="left">[27.45,28.75)</td>
<td align="right">28.1</td>
<td align="right">31</td>
<td align="right">152</td>
<td align="right">0.1791908</td>
<td align="right">0.8786127</td>
</tr>
<tr class="odd">
<td align="left">[28.75,30.05)</td>
<td align="right">29.4</td>
<td align="right">15</td>
<td align="right">167</td>
<td align="right">0.0867052</td>
<td align="right">0.9653179</td>
</tr>
<tr class="even">
<td align="left">[30.05,31.35)</td>
<td align="right">30.7</td>
<td align="right">3</td>
<td align="right">170</td>
<td align="right">0.0173410</td>
<td align="right">0.9826590</td>
</tr>
<tr class="odd">
<td align="left">[31.35,32.65)</td>
<td align="right">32.0</td>
<td align="right">2</td>
<td align="right">172</td>
<td align="right">0.0115607</td>
<td align="right">0.9942197</td>
</tr>
<tr class="even">
<td align="left">[32.65,33.95)</td>
<td align="right">33.3</td>
<td align="right">1</td>
<td align="right">173</td>
<td align="right">0.0057803</td>
<td align="right">1.0000000</td>
</tr>
</tbody>
</table>
<p>Por lo que se refiere al histograma, es</p>
<div class="sourceCode" id="cb706"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb706-1"><a href="#cb706-1" aria-hidden="true"></a><span class="kw">hist_rel</span>(crw, L.cr)</span></code></pre></div>
<p><img src="13chap13_Agrupados_files/figure-html/unnamed-chunk-93-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>La curva de densidad que obtenemos en este gráfico tiene una forma de campana que nos recuerda la campana de Gauss. Para explorar este parecido, vamos a añadir al histograma la gráfica de la función densidad de una distribución normal de media y desviación típica la media y la desviación típica muestral del conjunto de datos original, respectivamente. Esta función se define mediante</p>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="#cb707-1" aria-hidden="true"></a><span class="kw">dnorm</span>(x, <span class="dt">mu=</span>..., <span class="dt">sd=</span>...)</span></code></pre></div>
<p>entrando como valores de <code>mu</code> y <code>sd</code> la media y la desviación típica deseadas, respectivamente.</p>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb708-1"><a href="#cb708-1" aria-hidden="true"></a><span class="kw">hist_rel</span>(crw, L.cr)</span>
<span id="cb708-2"><a href="#cb708-2" aria-hidden="true"></a><span class="kw">curve</span>(<span class="kw">dnorm</span>(x, <span class="kw">mean</span>(crw), <span class="kw">sd</span>(crw)), <span class="dt">col=</span><span class="st">&quot;purple&quot;</span>, <span class="dt">lty=</span><span class="dv">3</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</span>
<span id="cb708-3"><a href="#cb708-3" aria-hidden="true"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">lwd=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;purple&quot;</span>),</span>
<span id="cb708-4"><a href="#cb708-4" aria-hidden="true"></a>  <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;densidad estimada&quot;</span>,<span class="st">&quot;densidad normal&quot;</span>), <span class="dt">cex=</span><span class="fl">0.7</span>)</span></code></pre></div>
<p><img src="13chap13_Agrupados_files/figure-html/unnamed-chunk-95-1.png" width="90%" style="display: block; margin: auto;" />
Se observa un ligero desplazamiento a la izquierda de la densidad estimada respecto de la campana de Gauss.</p>
</div>
<div id="guía-rápida-de-funciones-7" class="section level2" number="13.5">
<h2 number="13.5"><span class="header-section-number">13.5</span> Guía rápida de funciones</h2>
<ul>
<li><p><code>nclass.Sturges</code> calcula el número de clases de un agrupamiento según la regla de Sturges.</p></li>
<li><p><code>nclass.scott</code> calcula el número de clases de un agrupamiento según la regla de Scott.</p></li>
<li><p><code>nclass.FD</code> calcula el número de clases de un agrupamiento según la regla de Freedman-Diaconis.</p></li>
<li><p><code>cut</code> sirve para agrupar un vector numérico y codificar sus valores con las clases a las que pertenecen. Algunos parámetros importantes:</p>
<ul>
<li><code>breaks</code>: sirve para especificar los puntos de corte, o el número de clases.</li>
<li><code>labels</code>: sirve para especificar las etiquetas de las clases.</li>
<li><code>right=FALSE</code>: especifica que las clases son intervalos cerrados a la izquierda y abiertos a la derecha.</li>
<li><code>include.lowest=TRUE</code>: combinado con el anterior, impone que la última clase se tome cerrada a ambos lados.</li>
<li><code>dig.lab</code>: permite especificar el número de cifras significativas en los extremos de las clases cuando se toma el valor por defecto de <code>labels</code>.</li>
</ul></li>
<li><p><code>hist</code> dibuja un histograma de un vector numérico. Algunos parámetros importantes:</p>
<ul>
<li><p><code>breaks</code>: sirve para especificar los puntos de corte, el número de clases, o el método para calcularlo; en estos dos últimos casos, no siempre se obtiene el número de clases especificado.</p></li>
<li><p><code>freq</code>: igualado a <code>TRUE</code>, produce el histograma de frecuencias absolutas si los intervalos son todos de la misma amplitud, y el de frecuencias relativas en caso contrario; igualado a <code>FALSE</code>, produce siempre el de frecuencias relativas.</p></li>
<li><p><code>plot</code>: igualado a <code>FALSE</code>, impide que se dibuje el histograma.</p></li>
<li><p><code>right</code> y <code>include.lowest</code> tienen el mismo significado que en <code>cut</code>.</p></li>
</ul>
<p>Internamente, el resultado de <code>hist</code> es una <code>list</code> que incluye los siguientes vectores:</p>
<ul>
<li><p><code>breaks</code>: los extremos de los intervalos.</p></li>
<li><p><code>mids</code>: los puntos medios de los intervalos.</p></li>
<li><p><code>counts</code>: las frecuencias absolutas de los intervalos.</p></li>
<li><p><code>density</code>: las densidades de los intervalos.</p></li>
</ul></li>
<li><p><code>axis</code> añade a un gráfico un eje, con marcas en los lugares indicados por el vector entrado en el parámetro <code>at</code>.</p></li>
<li><p><code>rug</code> permite añadir una “alfombra” a un histograma.</p></li>
<li><p><code>jitter</code> añade “ruido” estocástico a los datos de un vector numérico.</p></li>
<li><p><code>density</code> calcula una secuencia de puntos sobre la curva de densidad estimada a partir de un vector numérico.</p></li>
<li><p><code>dnorm</code> define la curva de densidad de una distribución normal. Tiene los dos parámetros siguientes:</p>
<ul>
<li><code>mu</code>: la media.</li>
<li><code>sd</code>: la desviación típica.</li>
</ul></li>
</ul>
</div>
<div id="ejercicios-11" class="section level2" number="13.6">
<h2 number="13.6"><span class="header-section-number">13.6</span> Ejercicios</h2>
<div id="test-10" class="section level3 unnumbered">
<h3 class="unnumbered">Test</h3>
<p><em>(1)</em> Supongamos que tenemos un conjunto de 80 datos expresados con una precisión de una décima de unidad. Su valor mínimo es 15 y el máximo, 83. Su desviación típica muestral es 2.5623 y su rango intercuartílico 3.1721. Según la regla de Scott, ¿en cuántas clases los tendríamos que agrupar y qué amplitud tendrían estas clases? Dad estos dos valores en este orden, separados por un único espacio en blanco.</p>
<p><em>(2)</em> Considerad el mismo conjunto de datos que en la pregunta anterior. Si los agrupamos según la regla de Freedman-Diaconis, ¿qué valdría el extremo izquierdo del tercer intervalo que obtendríamos?</p>
<p><em>(3)</em> Agrupad según la regla de Freedman-Diaconis los datos de la variable <code>uptake</code> del <em>data frame</em> <code>CO2</code> que lleva predefinido R (están expresados con una precisión de una cifra decimal). ¿Qué vale el extremo izquierdo del cuarto intervalo que habéis obtenido?</p>
<p><em>(4)</em> Agrupad según la regla de Freedman-Diaconis los datos de la variable <code>uptake</code> del <em>data frame</em> <code>CO2</code> que lleva predefinido R (están expresados con una precisión de una cifra decimal). ¿Cuál es la frecuencia relativa de su tercer intervalo, redondeada a 3 cifras decimales?</p>
<p><em>(5)</em> Supongamos que tenemos un vector de datos llamado <em>alturas</em>. Dad una instrucción que agrupe estos datos en intervalos con extremos dados por un vector llamado <em>Extremos</em> y codificando cada intervalo por él mismo, y llame <em>alturas_cut</em> al factor resultante. Los intervalos resultantes tienen que ser todos cerrados a la izquierda y abiertos a la derecha. Entrad los parámetros en orden alfabético y no dejéis espacios en blanco innecesarios.</p>
<p><em>(6)</em> Definid un <em>data frame</em> con la tabla <a href="https://raw.githubusercontent.com/AprendeR-UIB/AprendeR1/master/datos/ESD.txt" class="uri">https://raw.githubusercontent.com/AprendeR-UIB/AprendeR1/master/datos/ESD.txt</a>. A continuación, agrupad los valores de su variable <code>MB</code> según la regla de Sturges (mirad antes con qué precisión están dadas sus entradas). ¿Cuál es la frecuencia absoluta del intervalo modal de este agrupamiento?</p>
<p><em>(7)</em> Definid un <em>data frame</em> con la tabla <a href="https://raw.githubusercontent.com/AprendeR-UIB/AprendeR1/master/datos/ESD.txt" class="uri">https://raw.githubusercontent.com/AprendeR-UIB/AprendeR1/master/datos/ESD.txt</a>. A continuación, agrupad los valores de su variable <code>MB</code> según la regla de Sturges (mirad antes con qué precisión están dadas sus entradas). ¿Cuánto vale la densidad del tercer intervalo, redondeada a 3 cifras decimales?</p>
</div>
<div id="ejercicio-10" class="section level3 unnumbered">
<h3 class="unnumbered">Ejercicio</h3>
<p>La tabla <code>lobsters.txt</code>, que hemos guardado en el url <a href="https://raw.githubusercontent.com/AprendeR-UIB/AprendeR1/master/datos/lobsters.txt" class="uri">https://raw.githubusercontent.com/AprendeR-UIB/AprendeR1/master/datos/lobsters.txt</a>, está formada por los pesos de langostas capturadas en dos zonas; estos pesos están expresados en kg, con una precisión de 0.01 kg. Las separaciones entre columnas son espacios en blanco y tiene una primera fila con los nombres de las columnas.</p>
<p>Definid un <em>data frame</em> con esta tabla. Echadle un vistazo (y comprobad que se ha importado correctamente). Definid dos vectores con los pesos de las langostas de la zona 1 y de la zona 2, respectivamente.</p>
<p><em>(a)</em> Agrupad los pesos de la zona 1 y de la zona 2 siguiendo la regla de Scott.</p>
<p><em>(b)</em> Para cada zona, y con este agrupamiento, construid un <em>data frame</em> que contenga la tabla de frecuencias agrupadas.</p>
<p><em>(c)</em> Para cada zona, y con este mismo agrupamiento, dibujad el correspondiente histograma de frecuencias relativas incluyendo la curva de densidad estimada. Comparad los dos histogramas: ¿se observa alguna diferencia?</p>
</div>
<div id="respuestas-al-test-10" class="section level3 unnumbered">
<h3 class="unnumbered">Respuestas al test</h3>
<p><em>(1)</em> 33 2.1</p>
<p><em>(2)</em> 17.95</p>
<p><em>(3)</em> 30.45</p>
<p><em>(4)</em> 0.143</p>
<p><em>(5)</em> <code>alturas_cut=cut(alturas,breaks=Extremos,right=FALSE)</code></p>
<p><em>(6)</em> 48</p>
<p><em>(7)</em> 0.033</p>
<!--chapter:end:13chap13_Agrupados.Rmd-->
</div>
</div>
</div>
<div id="gráficos-avanzados" class="section level1" number="14">
<h1 number="14"><span class="header-section-number">14</span> Gráficos avanzados</h1>
<p>La capacidad que tiene R para representar gráficamente datos es
asombrosa y explicar todos los gráficos que puede producir nos llevaría
un curso entero. Por este motivo, en esta lección nos limitaremos a daros una idea de sus capacidades gráficas, explicando unos cuantos gráficos avanzados que se pueden producir con R de manera sencilla, sin entrar en el detalle de los algoritmos que los generan.</p>
<div id="nubes-de-palabras-o-de-etiquetas-word-clouds" class="section level2" number="14.1">
<h2 number="14.1"><span class="header-section-number">14.1</span> Nubes de palabras o de etiquetas (<em>word clouds</em>)</h2>
<p>Una <em>nube de palabras</em>, o <em>de etiquetas</em>, (<em>word cloud</em>) es un gráfico formado por las palabras de un texto, organizadas en forma de nube. Las palabras se representan en la nube de manera que a mayor frecuencia en el texto y, por tanto, a mayor importancia en este
sentido, mayor sea su tamaño. Las frecuencias de las palabras también se pueden indicar por medio de una gradación de color.</p>
<p>Para crear una nube de palabras con R, necesitamos cargar los paquetes <strong>tm</strong> (de <em>text mining</em>), para tratar y manipular textos, y <strong>wordcloud</strong>, para dibujar la nube de palabras.
En primer lugar veremos cómo usar las funciones del paquete <strong>tm</strong> con el fin de extraer la información de un documento que nos permitirá producir su nube de
palabras.</p>
<p>La estructura principal para el manejo de documentos en el paquete <strong>tm</strong> es el <em>Corpus</em>, que representa una colección de textos. La implementación básica que lleva dicho paquete de un <em>Corpus</em>, y que es la que usaremos aquí, es el <em>Corpus volátil</em>, <em>VCorpus</em>, que viene a ser una representación volátil de los documentos en la memoria de R. Decimos volátil porque una vez que el objeto de R en cuestión es borrado, el corpus de los documentos también se borra de la memoria. Para cargar un conjunto de documentos en un <em>VCorpus</em>, usamos la instrucción</p>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="#cb709-1" aria-hidden="true"></a>nombre=<span class="st"> </span><span class="kw">VCorpus</span>(<span class="st">&quot;lugar&quot;</span>, <span class="dt">readerControl=</span>...)</span></code></pre></div>
<p>donde:</p>
<ul>
<li><p>El primer parámetro es el <em>lugar</em> de donde R tiene que cargar los documentos a analizar. Si forman el contenido de un directorio, se especifica con <code>DirSource("directorio")</code>, mientras que, para cargar el código fuente de una página web, se tiene que usar <code>URISource("url")</code>.
Para conocer el resto de funciones que se pueden usar para entrar este <em>lugar</em>, podéis consultar la Ayuda de la función <code>Source</code>. En todas ellas se puede especificar con <code>encoding</code> la codificación de alfabeto; es conveniente hacerlo si los documentos contienen palabras acentuadas o caracteres especiales.</p></li>
<li><p>El parámetro <code>readerControl</code> es una <code>list</code> de dos componentes: <code>reader</code> y <code>language</code>. La componente <code>reader</code> indica la función que ha de usar R para leer y procesar los documentos contenidos en el <em>lugar</em> especificado, que dependerá de su formato; aquí solo consideraremos el análisis de documentos en formato texto, que corresponde al valor por defecto de <code>reader</code>, y por lo tanto podemos omitir esta componente en la <code>list</code> (si tenéis curiosidad, corresponde a <code>reader=readPlain</code>). Si queréis procesar otro tipo de documentos, os recomendamos que, al menos al principio, primero los convirtáis en ficheros de texto ordinario.</p></li>
</ul>
<p>Por su lado, el parámetro <code>language</code> indica el idioma en que está el texto, o los textos, a procesar. Se ha de entrar igualado al código ISO 639-2 del idioma entrecomillado: <code>"en"</code> para inglés, <code>"spa"</code> para español, <code>"tlh"</code> para klingon, etc. Podéis encontrar estos códigos en <a href="https://en.wikipedia.org/wiki/List_of_ISO_639-2_codes">esta entrada de la Wikipedia</a>.</p>
<p>Vamos a desarrollar un ejemplo completo. Hemos guardado en un subdirectorio llamado <em>Wordcloud</em> del directorio de trabajo dos documentos: un fichero <code>lomce.txt</code> con el texto de la Ley orgánica 8/2013, de 9 de diciembre, para la mejora de la calidad educativa, más conocida como LOMCE (que hemos copiado del <a href="http://www.boe.es/diario_boe/txt.php?id=BOE-A-2013-12886">BOE</a>), que será el que analizaremos, y un fichero <code>introR.txt</code> con el primer párrafo de esta lección, que no analizaremos y simplemente nos servirá para ver el efecto de algunas transformaciones.</p>
<p>Vamos a cargar estos dos documentos en un <em>VCorpus</em> llamado <code>Prueba</code>:</p>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="#cb710-1" aria-hidden="true"></a><span class="kw">library</span>(tm)</span>
<span id="cb710-2"><a href="#cb710-2" aria-hidden="true"></a>Prueba=<span class="kw">VCorpus</span>(<span class="kw">DirSource</span>(<span class="st">&quot;Wordcloud&quot;</span>, <span class="dt">encoding=</span><span class="st">&quot;UTF-8&quot;</span>), </span>
<span id="cb710-3"><a href="#cb710-3" aria-hidden="true"></a><span class="dt">readerControl=</span><span class="kw">list</span>(<span class="dt">language=</span><span class="st">&quot;spa&quot;</span>))</span></code></pre></div>
<p>Hemos añadido <code>encoding="UTF-8"</code> porque así es como hemos guardado los ficheros de texto en nuestro ordenador y como contienen letras acentuadas, mejor curarnos en salud. Como están en español, hemos especificado <code>language="spa"</code> en <code>readerControl</code>, y en cambio no hemos especificado la componente <code>reader</code> de esta <code>list</code> porque se trata de ficheros de texto.</p>
<p>A continuación, vamos a inspeccionar el <em>Corpus</em> cargado. Aplicándole la función <code>inspect</code>, obtenemos cuántos documentos contiene y, para cada uno, su número de caracteres y su formato.</p>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb711-1"><a href="#cb711-1" aria-hidden="true"></a><span class="kw">inspect</span>(Prueba)</span>
<span id="cb711-2"><a href="#cb711-2" aria-hidden="true"></a><span class="co">#&gt; &lt;&lt;VCorpus&gt;&gt;</span></span>
<span id="cb711-3"><a href="#cb711-3" aria-hidden="true"></a><span class="co">#&gt; Metadata:  corpus specific: 0, document level (indexed): 0</span></span>
<span id="cb711-4"><a href="#cb711-4" aria-hidden="true"></a><span class="co">#&gt; Content:  documents: 2</span></span>
<span id="cb711-5"><a href="#cb711-5" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb711-6"><a href="#cb711-6" aria-hidden="true"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb711-7"><a href="#cb711-7" aria-hidden="true"></a><span class="co">#&gt; &lt;&lt;PlainTextDocument&gt;&gt;</span></span>
<span id="cb711-8"><a href="#cb711-8" aria-hidden="true"></a><span class="co">#&gt; Metadata:  7</span></span>
<span id="cb711-9"><a href="#cb711-9" aria-hidden="true"></a><span class="co">#&gt; Content:  chars: 404</span></span>
<span id="cb711-10"><a href="#cb711-10" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb711-11"><a href="#cb711-11" aria-hidden="true"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb711-12"><a href="#cb711-12" aria-hidden="true"></a><span class="co">#&gt; &lt;&lt;PlainTextDocument&gt;&gt;</span></span>
<span id="cb711-13"><a href="#cb711-13" aria-hidden="true"></a><span class="co">#&gt; Metadata:  7</span></span>
<span id="cb711-14"><a href="#cb711-14" aria-hidden="true"></a><span class="co">#&gt; Content:  chars: 214377</span></span></code></pre></div>
<p>De esta manera vemos que R ha incorporado al <code>VCorpus</code> los documentos por orden alfabético de su título: el primero es el corto, <code>introR.txt</code>, y el segundo, el largo, <code>lomce.txt</code>.</p>
<p>Con la instrucción <code>writeLines(as.character(VCorpus[[k]]))</code> obtenemos en la consola el contenido completo del <span class="math inline">\(k\)</span>-ésimo texto de nuestro <em>VCorpus</em>. Veamos, por ejemplo, el contenido del texto corto:</p>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="#cb712-1" aria-hidden="true"></a><span class="kw">writeLines</span>(<span class="kw">as.character</span>(Prueba[[<span class="dv">1</span>]]))</span>
<span id="cb712-2"><a href="#cb712-2" aria-hidden="true"></a><span class="co">#&gt; La capacidad que tiene R para representar gráficamente datos es </span></span>
<span id="cb712-3"><a href="#cb712-3" aria-hidden="true"></a><span class="co">#&gt; asombrosa y explicar todos los gráficos que puede producir  nos llevaría </span></span>
<span id="cb712-4"><a href="#cb712-4" aria-hidden="true"></a><span class="co">#&gt; un curso entero. Por este motivo,  en esta lección nos limitaremos a daros </span></span>
<span id="cb712-5"><a href="#cb712-5" aria-hidden="true"></a><span class="co">#&gt; una idea de sus capacidades gráficas, explicando unos cuantos gráficos </span></span>
<span id="cb712-6"><a href="#cb712-6" aria-hidden="true"></a><span class="co">#&gt; avanzados que se pueden  producir con R de manera sencilla, sin  entrar </span></span>
<span id="cb712-7"><a href="#cb712-7" aria-hidden="true"></a><span class="co">#&gt; en el detalle de los algoritmos que los  generan.</span></span></code></pre></div>
<p>Una vez que hemos guardado una serie de documentos en un <code>VCorpus</code>, tenemos que <em>limpiarlos</em>, en el sentido de eliminar, por ejemplo, signos de puntuación y palabras comunes sin ningún interés para que no aparezcan en la nube de palabras. Esto se lleva a cabo aplicando la función <code>tm_map</code> al <code>VCorpus</code> y a una <em>transformación</em>. Veamos algunos ejemplos:</p>
<ul>
<li>Convertimos todas las letras en minúsculas, para que R no considere diferentes dos palabras simplemente por la grafía de sus letras:</li>
</ul>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb713-1"><a href="#cb713-1" aria-hidden="true"></a>Prueba=<span class="kw">tm_map</span>(Prueba, tolower)</span></code></pre></div>
<ul>
<li>Eliminamos los signos de puntuación:</li>
</ul>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb714-1"><a href="#cb714-1" aria-hidden="true"></a>Prueba=<span class="kw">tm_map</span>(Prueba, removePunctuation)</span></code></pre></div>
<ul>
<li>Eliminamos las palabras <em>comodín</em>: preposiciones, artículos, algunos tiempos verbales de ser, estar y haber, etc. (si entráis en la consola la instrucción <code>stopwords("spanish")</code> veréis la lista de las palabras que se eliminan):</li>
</ul>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb715-1"><a href="#cb715-1" aria-hidden="true"></a>Prueba=<span class="kw">tm_map</span>(Prueba, removeWords, <span class="kw">stopwords</span>(<span class="st">&quot;spanish&quot;</span>))</span></code></pre></div>
<ul>
<li>Más en general, con <code>Prueba=tm_map(Prueba, removeWords, vector)</code> podemos borrar un <em>vector</em> de palabras. Por ejemplo, vamos a eliminar también la palabra <em>artículo</em>, para evitar que aparezca en la nube de palabras de la LOMCE, y <em>r</em> (ya en minúsculas) para ver cómo desaparece del texto corto.</li>
</ul>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb716-1"><a href="#cb716-1" aria-hidden="true"></a>Prueba=<span class="kw">tm_map</span>(Prueba, removeWords, <span class="kw">c</span>(<span class="st">&quot;artículo&quot;</span>,<span class="st">&quot;r&quot;</span>))</span></code></pre></div>
<p>Veamos como ha quedado el texto corto tras estas transformaciones:</p>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb717-1"><a href="#cb717-1" aria-hidden="true"></a><span class="kw">writeLines</span>(<span class="kw">as.character</span>(Prueba[[<span class="dv">1</span>]]))</span>
<span id="cb717-2"><a href="#cb717-2" aria-hidden="true"></a><span class="co">#&gt;  capacidad     representar gráficamente datos  </span></span>
<span id="cb717-3"><a href="#cb717-3" aria-hidden="true"></a><span class="co">#&gt; asombrosa  explicar   gráficos  puede producir   llevaría </span></span>
<span id="cb717-4"><a href="#cb717-4" aria-hidden="true"></a><span class="co">#&gt;  curso entero   motivo    lección  limitaremos  daros </span></span>
<span id="cb717-5"><a href="#cb717-5" aria-hidden="true"></a><span class="co">#&gt;  idea   capacidades gráficas explicando  cuantos gráficos </span></span>
<span id="cb717-6"><a href="#cb717-6" aria-hidden="true"></a><span class="co">#&gt; avanzados   pueden  producir    manera sencilla   entrar </span></span>
<span id="cb717-7"><a href="#cb717-7" aria-hidden="true"></a><span class="co">#&gt;   detalle   algoritmos    generan</span></span></code></pre></div>
<p>Otras transformaciones posibles que nosotros no hemos aplicado, son: <code>stripWhitespace</code>, para eliminar los espacios en blanco extra; <code>removeNumbers</code>, para eliminar los números, y, cargando el paquete <strong>SnowballC</strong>, la transformación <code>stemDocument</code> (con, en nuestro ejemplo, <code>language="spanish"</code>), que se queda sólo con las raíces de algunas palabras (y la nube de palabras que se produciría sería la de estas raíces: así, por ejemplo, en la de la LOMCE saldría <em>alumn</em> en lugar de <em>alumnos</em> y <em>alumnas</em>).</p>
<p>Ahora estamos en condiciones de construir la nube de palabras de la LOMCE. Para ello, usaremos la función <code>wordcloud</code> del paquete homónimo. Veamos su aplicación a nuestro caso concreto, y luego comentamos algunos parámetros:</p>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb718-1"><a href="#cb718-1" aria-hidden="true"></a><span class="kw">library</span>(wordcloud)</span>
<span id="cb718-2"><a href="#cb718-2" aria-hidden="true"></a><span class="kw">wordcloud</span>(Prueba[[<span class="dv">2</span>]],</span>
<span id="cb718-3"><a href="#cb718-3" aria-hidden="true"></a>                 <span class="dt">scale=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="fl">0.5</span>), <span class="dt">max.words=</span><span class="dv">100</span>,</span>
<span id="cb718-4"><a href="#cb718-4" aria-hidden="true"></a>                 <span class="dt">rot.per=</span><span class="fl">0.25</span>,</span>
<span id="cb718-5"><a href="#cb718-5" aria-hidden="true"></a>                 <span class="dt">colors=</span><span class="kw">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&quot;Dark2&quot;</span>))</span></code></pre></div>
<p><img src="14cap13_EDextra_files/figure-html/unnamed-chunk-10-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Obtenemos el gráfico anterior, donde observamos que las palabras de mayor tamaño, y por lo tanto las más repetidas, son <strong>educación</strong>, <strong>alumnos</strong>, <strong>alumnas</strong>, <strong>centros</strong>, etc.</p>
<p>Como vemos, la función <code>wordcloud</code> se aplica al documento, en este caso <code>Prueba[[2]]</code>, y
sus parámetros principales son los siguientes:</p>
<ul>
<li><p><code>scale</code>: un vector de longitud 2 que sirve para indicar la escala, o los tamaños relativos, de las palabras. Su primera entrada indica el tamaño de la palabra más repetida y la segunda, el de la palabra menos repetida.</p></li>
<li><p><code>max.words</code>: el número máximo de palabras a mostrar.</p></li>
<li><p><code>min.freq</code>: la frecuencia mínima necesaria para que una palabra aparezca en el gráfico.</p></li>
<li><p><code>rot.per</code>: la proporción de palabras que se pueden mostrar giradas 90 grados.</p></li>
<li><p><code>colors</code>: la paleta de colores usados para representar las frecuencias, en orden creciente. Nosotros hemos usado una paleta del paquete <strong>RColorBrewer</strong> que se explicará con más detalle en la Sección 8.7 de la Segunda parte de AprendeR (y que se carga automáticamente junto con el paquete <strong>wordcloud</strong>).</p></li>
</ul>
<p>Algunos comentarios importantes:</p>
<ul>
<li><p>La posición de las palabras en la nube es aleatoria, de manera que puede variar en cada ejecución de la instrucción.</p></li>
<li><p>R procura evitar solapamientos de palabras, y eso hace que, según cómo las vaya colocando, algunas no le quepan: en este caso os avisará con un <code>warning</code> para cada palabra omitida. Algunas posibles soluciones son volver a repetir el gráfico hasta que el azar produzca una combinación en la que quepan todas, reducir el número de palabras en la nube o reducir el rango de tamaños de las palabras. Otra posibilidad es usar el parámetro
<code>random.order=FALSE</code>, que añade las palabras en orden decreciente de frecuencia, con lo que si hay palabras que no incluya, serán las menos importantes.</p></li>
<li><p>Si, al guardar la imagen, modificáis sus dimensiones, las palabras se recolocarán y puede que se superpongan (si reducís el gráfico) o se separen (si lo ampliáis). Procurad, al guardar la imagen, usar la opción <code>View plot after saving</code> para controlar el resultado final.</p></li>
</ul>
</div>
<div id="mapa-de-calor-o-heatmap" class="section level2" number="14.2">
<h2 number="14.2"><span class="header-section-number">14.2</span> Mapa de calor o <em>heatmap</em></h2>
<p>Uno de los gráficos más usados en estadística multidimensional para representar la relación existente entre un conjunto de individuos o de variables es un <em>mapa de calor</em>, o <em>heatmap</em>. Por ejemplo, a partir de una tabla de datos, podemos producir un mapa de calor que represente las correlaciones de sus variables, para poder visualizar los pares de variables con mayor y menor relación lineal, o un mapa de calor que represente las diferencias (en algún sentido) entre sus individuos, para poder visualizar qué individuos se parecen más o menos.</p>
<p>La función básica para producir mapas de calor es <code>heatmap</code>, y se aplica a una matriz.
Para ilustrar su funcionamiento, vamos a ver dos ejemplos sobre una misma tabla de datos, y aprovecharemos para explicar algunos de sus parámetros.</p>

<div class="example">
<p><span id="exm:mtcars" class="example"><strong>(#exm:mtcars) </strong></span>Consideremos la tabla de datos que lleva R llamada <code>mtcars</code>. Dicha tabla de datos contiene los valores de las 11 características siguientes (las variables) de 32 vehículos (las filas):</p>
<ul>
<li><code>mpg</code>: El consumo del vehículo en millas por galón de combustible.</li>
<li><code>cyl</code>: Su número de cilindros.</li>
<li><code>disp</code>: Su cilindrada.</li>
<li><code>hp</code>: Su número de caballos de potencia.</li>
<li><code>drat</code>: Su relación del eje trasero.</li>
<li><code>wt</code>: Su peso (en libras/1000).</li>
<li><code>qsec</code>: El tiempo que tarda en recorrer un cuarto de milla.</li>
<li><code>vs</code>: El tipo de motor: Motor en V (valor 0) o en línea (valor 1).</li>
<li><code>am</code>: El tipo de transmisión: 0 automática, 1 manual.</li>
<li><code>gear</code>: El número de marchas hacia adelante.</li>
<li><code>carb</code>: El número de carburadores.</li>
</ul>
Para estudiar los pares de variables que tienen más relación lineal, vamos a representar por medio de un <em>heatmap</em> la matriz de los valores absolutos de las correlaciones de las variables no binarias
(es decir, de todas menos <code>vs</code> y <code>am</code>, la octava y la novena respectivamente). Las instrucciones que usamos son las siguientes:
</div>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb719-1"><a href="#cb719-1" aria-hidden="true"></a>mtcars2=mtcars[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">8</span>,<span class="dv">9</span>)]  <span class="co">#Eliminamos las variables binarias</span></span>
<span id="cb719-2"><a href="#cb719-2" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">abs</span>(<span class="kw">cor</span>(mtcars2)),<span class="dv">3</span>)</span>
<span id="cb719-3"><a href="#cb719-3" aria-hidden="true"></a><span class="co">#&gt;        mpg   cyl  disp    hp  drat    wt  qsec  gear  carb</span></span>
<span id="cb719-4"><a href="#cb719-4" aria-hidden="true"></a><span class="co">#&gt; mpg  1.000 0.852 0.848 0.776 0.681 0.868 0.419 0.480 0.551</span></span>
<span id="cb719-5"><a href="#cb719-5" aria-hidden="true"></a><span class="co">#&gt; cyl  0.852 1.000 0.902 0.832 0.700 0.782 0.591 0.493 0.527</span></span>
<span id="cb719-6"><a href="#cb719-6" aria-hidden="true"></a><span class="co">#&gt; disp 0.848 0.902 1.000 0.791 0.710 0.888 0.434 0.556 0.395</span></span>
<span id="cb719-7"><a href="#cb719-7" aria-hidden="true"></a><span class="co">#&gt; hp   0.776 0.832 0.791 1.000 0.449 0.659 0.708 0.126 0.750</span></span>
<span id="cb719-8"><a href="#cb719-8" aria-hidden="true"></a><span class="co">#&gt; drat 0.681 0.700 0.710 0.449 1.000 0.712 0.091 0.700 0.091</span></span>
<span id="cb719-9"><a href="#cb719-9" aria-hidden="true"></a><span class="co">#&gt; wt   0.868 0.782 0.888 0.659 0.712 1.000 0.175 0.583 0.428</span></span>
<span id="cb719-10"><a href="#cb719-10" aria-hidden="true"></a><span class="co">#&gt; qsec 0.419 0.591 0.434 0.708 0.091 0.175 1.000 0.213 0.656</span></span>
<span id="cb719-11"><a href="#cb719-11" aria-hidden="true"></a><span class="co">#&gt; gear 0.480 0.493 0.556 0.126 0.700 0.583 0.213 1.000 0.274</span></span>
<span id="cb719-12"><a href="#cb719-12" aria-hidden="true"></a><span class="co">#&gt; carb 0.551 0.527 0.395 0.750 0.091 0.428 0.656 0.274 1.000</span></span></code></pre></div>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb720-1"><a href="#cb720-1" aria-hidden="true"></a><span class="kw">heatmap</span>(<span class="kw">abs</span>(<span class="kw">cor</span>(mtcars2)), <span class="dt">Rowv=</span><span class="ot">NA</span>, <span class="dt">Colv=</span><span class="ot">NA</span>, <span class="dt">revC=</span><span class="ot">TRUE</span>) </span></code></pre></div>
<p><img src="14cap13_EDextra_files/figure-html/unnamed-chunk-12-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Podemos observar en el gráfico obtenido la correspondencia entre los colores de los cuadrados y las entradas de la matriz que representa: cuanto más rojo es el cuadrado correspondiente a un par de variables, menor es la entrada de la matriz y por lo tanto menos relación lineal existe entre ellas; y cuanto más claro,
mayor es la entrada de la matriz y por consiguiente su relación lineal. Así, podemos advertir en el gráfico que la variable <code>cyl</code>, el número de cilindros del vehículo, tiene mucha relación lineal con la cilindrada (<code>disp</code>), el consumo (<code>mpg</code>), la potencia (<code>hp</code>), el peso (<code>wt</code>) y la relación del eje trasero (<code>drat</code>); en cambio, la variable <code>qsec</code> (tiempo que tarda el vehículo en recorrer 1/4 de milla) sólo tiene relación lineal con la potencia, <code>hp</code>,
y el número de carburadores, <code>carb</code>.</p>
<p>Antes de continuar, vamos a explicar los parámetros usados en la aplicación anterior de la función <code>heatmap</code>: con <code>Rowv=NA</code> y <code>Colv=NA</code> impedimos que se añadan al gráfico dendrogramas por filas y por columnas, respectivamente (véase la Sección @ref(sec:dendr), y con <code>revC=TRUE</code> hemos indicado que el orden de las variables de izquierda a derecha sea el mismo que de arriba abajo (por defecto, el orden de las filas se invierte).</p>
<p>La función <code>corrplot</code> del paquete homónimo permite producir mapas de calor de matrices de correlaciones más completos:</p>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb721-1"><a href="#cb721-1" aria-hidden="true"></a><span class="kw">library</span>(corrplot)</span>
<span id="cb721-2"><a href="#cb721-2" aria-hidden="true"></a><span class="kw">corrplot</span>(<span class="kw">cor</span>(mtcars2))</span></code></pre></div>
<p><img src="14cap13_EDextra_files/figure-html/unnamed-chunk-13-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>En este caso hemos usado la matriz de correlaciones sin valor absoluto, porque no hace falta: los círculos más grandes indican una mayor correlación en valor absoluto y, por tanto, más relación lineal entre las variables involucradas, y los colores indican el signo de la correlación según el código descrito en la columna de la derecha.
Si además hubiéramos querido que apareciera el valor de la correlación para cada par de variables, hubiéramos podido utilizar las opciones siguientes:</p>
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb722-1"><a href="#cb722-1" aria-hidden="true"></a><span class="kw">corrplot</span>(<span class="kw">cor</span>(mtcars2), <span class="dt">method=</span><span class="st">&quot;shade&quot;</span>, <span class="dt">shade.col=</span><span class="ot">NA</span>, </span>
<span id="cb722-2"><a href="#cb722-2" aria-hidden="true"></a>   <span class="dt">tl.col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">tl.srt=</span><span class="dv">45</span>, <span class="dt">addCoef.col=</span><span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="14cap13_EDextra_files/figure-html/unnamed-chunk-14-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>El significado de los parámetros que hemos usado es el siguiente:</p>
<ul>
<li>Con <code>method="shade"</code> y <code>shade.col=NA</code> hemos indicado que queremos las celdas coloreadas homogéneamente, en vez de círculos;</li>
<li>El parámetro <code>tl.col</code> especifica el color de las etiquetas de las filas y las columnas (por defecto es rojo, como en la anterior aplicación de <code>corrplot</code>);<br />
</li>
<li>El parámetro <code>tl.srt</code> especifica el ángulo de inclinación de las etiquetas de las columnas en grados (por defecto, son verticales);</li>
<li>Con <code>addCoef.col="black"</code> hemos indicado que incluya los valores de las correlaciones en las casillas, escritos en negro.</li>
</ul>
<p>Os recomendamos consultar la Ayuda de la función para conocer el resto de parámetros disponibles.</p>

<div class="example">
<span id="exm:VEHICLES" class="example"><strong>(#exm:VEHICLES) </strong></span>Ahora vamos a visualizar por medio de un <em>heatmap</em> las diferencias entre los vehículos estudiados en la tabla <code>mtcars</code>. Las diferencias las cuantificaremos por medio de la distancia euclídea entre los vectores que definen las filas de la tabla de datos. Como en el ejemplo anterior, sólo vamos a considerar las variables numéricas, así que usaremos el <em>data frame</em> <code>mtcars2</code>. A modo de ejemplo, las filas de los vehículos <code>Mazda RX4</code> y <code>Valiant</code> son
</div>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb723-1"><a href="#cb723-1" aria-hidden="true"></a>mtcars2[<span class="kw">c</span>(<span class="st">&quot;Mazda RX4&quot;</span>,<span class="st">&quot;Valiant&quot;</span>),]</span>
<span id="cb723-2"><a href="#cb723-2" aria-hidden="true"></a><span class="co">#&gt;            mpg cyl disp  hp drat   wt  qsec gear carb</span></span>
<span id="cb723-3"><a href="#cb723-3" aria-hidden="true"></a><span class="co">#&gt; Mazda RX4 21.0   6  160 110 3.90 2.62 16.46    4    4</span></span>
<span id="cb723-4"><a href="#cb723-4" aria-hidden="true"></a><span class="co">#&gt; Valiant   18.1   6  225 105 2.76 3.46 20.22    3    1</span></span></code></pre></div>
<p>y su distancia euclídea es
<span class="math display">\[
\sqrt{(21-18.1)^2+(6-6)^2+(160-225)^2+(110-105)^2+\cdots +(4-1)^2}=65.4565.
\]</span></p>
<p>Para hallar la matriz de distancias euclídeas entre las filas de la tabla de datos <code>mtcars2</code> usamos la instrucción <code>dist</code>:</p>
<div class="sourceCode" id="cb724"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb724-1"><a href="#cb724-1" aria-hidden="true"></a>dist.mtcars=<span class="kw">as.matrix</span>(<span class="kw">dist</span>(mtcars2)) </span>
<span id="cb724-2"><a href="#cb724-2" aria-hidden="true"></a><span class="kw">round</span>(dist.mtcars[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>],<span class="dv">2</span>) <span class="co">#Submatriz de las 4 primeras filas y columnas</span></span>
<span id="cb724-3"><a href="#cb724-3" aria-hidden="true"></a><span class="co">#&gt;                Mazda RX4 Mazda RX4 Wag Datsun 710 Hornet 4 Drive</span></span>
<span id="cb724-4"><a href="#cb724-4" aria-hidden="true"></a><span class="co">#&gt; Mazda RX4           0.00          0.62      54.90          98.10</span></span>
<span id="cb724-5"><a href="#cb724-5" aria-hidden="true"></a><span class="co">#&gt; Mazda RX4 Wag       0.62          0.00      54.88          98.09</span></span>
<span id="cb724-6"><a href="#cb724-6" aria-hidden="true"></a><span class="co">#&gt; Datsun 710         54.90         54.88       0.00         150.99</span></span>
<span id="cb724-7"><a href="#cb724-7" aria-hidden="true"></a><span class="co">#&gt; Hornet 4 Drive     98.10         98.09     150.99           0.00</span></span></code></pre></div>
<p>La función <code>dist</code> calcula por defecto las distancias euclídeas entre las filas de una matriz o un <em>data frame</em> de variables numéricas. Para calcular alguna otra distancia, se ha de especificar con el parámetro <code>method</code>: consultad la Ayuda de la función para conocer los posibles valores de este parámetro. En el código anterior, hemos usado la función <code>as.matrix</code> para transformar el resultado de <code>dist</code> en una matriz ya que esta última función produce un objeto de clase <code>dist</code> y queremos que el resultado sea una matriz para poderle aplicar la función <code>heatmap</code>.</p>
<p>Dibujemos el <em>heatmap</em> de las distancias entre vehículos:</p>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb725-1"><a href="#cb725-1" aria-hidden="true"></a><span class="kw">heatmap</span>(dist.mtcars, <span class="dt">margins=</span><span class="kw">c</span>(<span class="dv">9</span>,<span class="dv">9</span>), <span class="dt">symm=</span><span class="ot">TRUE</span>, <span class="dt">Rowv=</span><span class="ot">NA</span>, <span class="dt">Colv=</span><span class="ot">NA</span>, <span class="dt">revC=</span><span class="ot">TRUE</span>)  </span></code></pre></div>
<p><img src="14cap13_EDextra_files/figure-html/unnamed-chunk-17-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>El parámetro <code>margins</code> especifica el ancho de los márgenes donde se escriben los nombres de las filas y las columnas y lo hemos adaptado para que quepan los nombres de los vehículos;
el parámetro <code>symm=TRUE</code> indica a R que ha de considerar que la matriz es simétrica. El resto de los parámetros ya los hemos explicado antes. Esta función dispone de muchos más parámetros, que podéis consultar en su Ayuda.</p>
<p>La representación visual tiene el mismo significado que antes, pero referida a la matriz a la que hemos aplicado la función <code>heatmap</code>: cuanto más roja es la casilla, menor es la distancia entre los vehículos, y por lo tanto más parecidos son.
Así, por ejemplo, si observamos la columna del vehículo <code>Mazda RX4</code>, vemos que los vehículos más diferentes a él son <code>Cadillac Fleetwood</code>, <code>Lincoln Continental</code> y <code>Chrysler Imperial</code>, ya que aparecen con un color más cercano al blanco, y los más parecidos son <code>Mazda RX4 Wag</code>, <code>Merc 280</code>, <code>Merc 280C</code>, <code>Merc 230</code>, <code>Volvo 142E</code>, <code>Toyota Corona</code>,
<code>Porsche 914-2</code>, <code>Merc 240D</code>, etc.</p>
</div>
<div id="sec:dendr" class="section level2" number="14.3">
<h2 number="14.3"><span class="header-section-number">14.3</span> Dendrogramas</h2>
<p>Dada una tabla de datos podemos construir una matriz de distancias entre los individuos representados en ella, aplicando una distancia concreta a cada par de filas; es lo que hicimos en el Ejemplo @ref(exm:VEHICLES), donde calculamos la distancia euclídea entre cada par de descripciones de tipo de coche. Una vez construida dicha matriz de distancias, podemos ir agrupando los individuos de la tabla de datos usando algún algoritmo de <em>agrupamiento</em>, o <em>clustering</em> jerárquico.</p>
<p>Muchos algoritmos de <em>clustering</em> jerárquico siguen una misma estrategia. En un primer paso, se agrupan los dos individuos más parecidos (más cercanos según la distancia usada) en un grupo y se los sustituye por este grupo, al que se considera un nuevo individuo <em>virtual</em>. A partir de aquí, en cada paso, se agrupan en un nuevo grupo los dos individuos (originales o <em>virtuales</em>) más cercanos y se los sustituye por el grupo que forman. El algoritmo termina cuando queda un único grupo. Los diferentes algoritmos de este tipo, denominados genéricamente <em>aglomerativos</em>, se distinguen básicamente según la manera como se define la distancia entre grupos a partir de las distancias entre sus individuos; aquí no entraremos en detalle y nos limitaremos a usar el algoritmo que lleva implementado R por defecto (el llamado <em>método de enlace completo</em>: la distancia entre dos grupos es el máximo de las distancias entre sus elementos). Volveremos sobre los diferentes algoritmos de <em>clustering</em> en la Lección 11 de la Segunda parte de este manual.</p>
<p>Un <em>dendrograma</em> es entonces una representación gráfica del orden en el que se han ido realizando dichas agrupaciones y de las distancias entre los pares de individuos (originales y <em>virtuales</em>) que se han ido uniendo. Así podemos visualizar qué individuos se parecen más o si aparece de manera natural alguna clasificación de los individuos.</p>
<p>Veamos un ejemplo detallado.
La tabla de datos <code>all.mammals.milk.1956</code> que llevaba el paquete <strong>cluster.datasets</strong> ha quedado obsolota y lo cargamos directamente de la fuente de Hartigan,contiene información sobre 5 variables numéricas relativas a la composición de la leche materna de 25 especies de mamíferos. Las variables de esta tabla de datos son:</p>
<ul>
<li><code>name</code>: El nombre del animal.</li>
<li><code>water</code>: Porcentaje de agua en la leche.</li>
<li><code>protein</code>: Porcentaje de proteína.</li>
<li><code>fat</code>: Porcentaje de grasa.</li>
<li><code>lactose</code>: Porcentaje de lactosa.</li>
<li><code>ash</code>: Porcentaje de ceniza.</li>
</ul>
<p>Démosle un vistazo.</p>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb726-1"><a href="#cb726-1" aria-hidden="true"></a><span class="co">#library(cluster.datasets)</span></span>
<span id="cb726-2"><a href="#cb726-2" aria-hidden="true"></a><span class="co">#data(all.mammals.milk.1956)  </span></span>
<span id="cb726-3"><a href="#cb726-3" aria-hidden="true"></a>all.mammals.milk<span class="fl">.1956</span>=<span class="kw">read.table</span>(<span class="st">&quot;https://people.sc.fsu.edu/~jburkardt/datasets/hartigan/file47.txt&quot;</span>,</span>
<span id="cb726-4"><a href="#cb726-4" aria-hidden="true"></a>                               <span class="dt">header=</span><span class="ot">TRUE</span>,<span class="dt">skip=</span><span class="dv">29</span>)</span>
<span id="cb726-5"><a href="#cb726-5" aria-hidden="true"></a>AMM=all.mammals.milk<span class="fl">.1956</span></span>
<span id="cb726-6"><a href="#cb726-6" aria-hidden="true"></a><span class="kw">str</span>(AMM)</span>
<span id="cb726-7"><a href="#cb726-7" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    25 obs. of  6 variables:</span></span>
<span id="cb726-8"><a href="#cb726-8" aria-hidden="true"></a><span class="co">#&gt;  $ Name   : chr  &quot;Horse&quot; &quot;Orangutan&quot; &quot;Monkey&quot; &quot;Donkey&quot; ...</span></span>
<span id="cb726-9"><a href="#cb726-9" aria-hidden="true"></a><span class="co">#&gt;  $ Water  : num  90.1 88.5 88.4 90.3 90.4 87.7 86.9 82.1 81.9 81.6 ...</span></span>
<span id="cb726-10"><a href="#cb726-10" aria-hidden="true"></a><span class="co">#&gt;  $ Protein: num  2.6 1.4 2.2 1.7 0.6 3.5 4.8 5.9 7.4 10.1 ...</span></span>
<span id="cb726-11"><a href="#cb726-11" aria-hidden="true"></a><span class="co">#&gt;  $ Fat    : num  1 3.5 2.7 1.4 4.5 3.4 1.7 7.9 7.2 6.3 ...</span></span>
<span id="cb726-12"><a href="#cb726-12" aria-hidden="true"></a><span class="co">#&gt;  $ Lactose: num  6.9 6 6.4 6.2 4.4 4.8 5.7 4.7 2.7 4.4 ...</span></span>
<span id="cb726-13"><a href="#cb726-13" aria-hidden="true"></a><span class="co">#&gt;  $ Ash    : num  0.35 0.24 0.18 0.4 0.1 0.71 0.9 0.78 0.85 0.75 ...</span></span>
<span id="cb726-14"><a href="#cb726-14" aria-hidden="true"></a><span class="kw">head</span>(AMM)</span>
<span id="cb726-15"><a href="#cb726-15" aria-hidden="true"></a><span class="co">#&gt;        Name Water Protein Fat Lactose  Ash</span></span>
<span id="cb726-16"><a href="#cb726-16" aria-hidden="true"></a><span class="co">#&gt; 1     Horse  90.1     2.6 1.0     6.9 0.35</span></span>
<span id="cb726-17"><a href="#cb726-17" aria-hidden="true"></a><span class="co">#&gt; 2 Orangutan  88.5     1.4 3.5     6.0 0.24</span></span>
<span id="cb726-18"><a href="#cb726-18" aria-hidden="true"></a><span class="co">#&gt; 3    Monkey  88.4     2.2 2.7     6.4 0.18</span></span>
<span id="cb726-19"><a href="#cb726-19" aria-hidden="true"></a><span class="co">#&gt; 4    Donkey  90.3     1.7 1.4     6.2 0.40</span></span>
<span id="cb726-20"><a href="#cb726-20" aria-hidden="true"></a><span class="co">#&gt; 5     Hippo  90.4     0.6 4.5     4.4 0.10</span></span>
<span id="cb726-21"><a href="#cb726-21" aria-hidden="true"></a><span class="co">#&gt; 6     Camel  87.7     3.5 3.4     4.8 0.71</span></span></code></pre></div>
<p>Para cuantificar la diferencia entre las composiciones de la leche de estos mamíferos, usaremos de nuevo la distancia euclídea entre sus vectores de valores de variables numéricas.</p>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb727-1"><a href="#cb727-1" aria-hidden="true"></a>dist.AMM=<span class="kw">dist</span>(AMM[,<span class="dv">2</span><span class="op">:</span><span class="dv">6</span>])</span>
<span id="cb727-2"><a href="#cb727-2" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">as.matrix</span>(dist.AMM)[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>],<span class="dv">3</span>)</span>
<span id="cb727-3"><a href="#cb727-3" aria-hidden="true"></a><span class="co">#&gt;       1     2     3     4     5     6</span></span>
<span id="cb727-4"><a href="#cb727-4" aria-hidden="true"></a><span class="co">#&gt; 1 0.000 3.327 2.494 1.226 4.759 4.107</span></span>
<span id="cb727-5"><a href="#cb727-5" aria-hidden="true"></a><span class="co">#&gt; 2 3.327 0.000 1.206 2.794 2.798 2.592</span></span>
<span id="cb727-6"><a href="#cb727-6" aria-hidden="true"></a><span class="co">#&gt; 3 2.494 1.206 0.000 2.375 3.716 2.348</span></span>
<span id="cb727-7"><a href="#cb727-7" aria-hidden="true"></a><span class="co">#&gt; 4 1.226 2.794 2.375 0.000 3.763 4.007</span></span>
<span id="cb727-8"><a href="#cb727-8" aria-hidden="true"></a><span class="co">#&gt; 5 4.759 2.798 3.716 3.763 0.000 4.176</span></span>
<span id="cb727-9"><a href="#cb727-9" aria-hidden="true"></a><span class="co">#&gt; 6 4.107 2.592 2.348 4.007 4.176 0.000</span></span></code></pre></div>
<p>Hemos transformado el objeto <code>dist</code> en una matriz para poder consultar algunas entradas, pero lo mantenemos como objeto de tipo <code>dist</code> para construir su dendrograma.</p>
<p>Una vez se dispone de la matriz de distancias entre los individuos (en este caso, mamíferos), se calcula su <em>clustering</em> jerárquico aplicándole la función <code>hclust</code> y se convierte el resultado de esta función en un dendrograma usando <code>as.dendrogram</code>.
La función <code>hclust</code> permite especificar el tipo de algoritmo de agrupamiento que queremos usar por medio del parámetro <code>method</code>; aquí usaremos el método por defecto.</p>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb728-1"><a href="#cb728-1" aria-hidden="true"></a>dend.AMM=<span class="kw">as.dendrogram</span>(<span class="kw">hclust</span>(dist.AMM))</span></code></pre></div>
<p>Y ahora ya podemos dibujar este dendrograma. Hay muchas opciones para hacerlo con R. La básica es aplicarle simplemente la función <code>plot</code>:</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="#cb729-1" aria-hidden="true"></a><span class="kw">plot</span>(dend.AMM)</span></code></pre></div>
<p><img src="14cap13_EDextra_files/figure-html/unnamed-chunk-21-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>En este gráfico, los grupos se representan mediante líneas horizontales y las alturas representan distancias, de manera que la altura a la que se unen dos grupos es la distancia entre ellos. Así, este dendrograma nos muestra, por ejemplo, que la composición de la leche de los animales 24 y 25 (foca y delfín) es diferente de la del resto, formando un grupo propio que no se ha unido al resto de animales hasta el último paso. En cambio, la ballena (el 23), que comparte hábitat y dieta con ellos, se agrupa con el ciervo y el reno (21 y 22).
Por otro lado, cortando por una línea horizontal imaginaria a altura 30, podemos observar que se forman tres grupos muy claros.</p>
<p>En un dendrograma producido a partir de las distancias entre las filas de un <em>data frame</em>, los individuos se representan mediante los identificadores de las filas: en nuestro ejemplo, números. Si queremos los nombres de los animales como etiquetas, una posibilidad es modificar el <em>data frame</em> <code>AMM</code> usando como identificadores de las filas los nombres de los animales; y ya que estamos, podemos eliminar esta variable del <em>data frame</em> resultante:</p>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="#cb730-1" aria-hidden="true"></a>AMM.nombres=AMM</span>
<span id="cb730-2"><a href="#cb730-2" aria-hidden="true"></a><span class="kw">rownames</span>(AMM.nombres)=AMM.nombres<span class="op">$</span>name</span>
<span id="cb730-3"><a href="#cb730-3" aria-hidden="true"></a>AMM.nombres=AMM.nombres[,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb730-4"><a href="#cb730-4" aria-hidden="true"></a><span class="kw">head</span>(AMM.nombres)</span>
<span id="cb730-5"><a href="#cb730-5" aria-hidden="true"></a><span class="co">#&gt;   Water Protein Fat Lactose  Ash</span></span>
<span id="cb730-6"><a href="#cb730-6" aria-hidden="true"></a><span class="co">#&gt; 1  90.1     2.6 1.0     6.9 0.35</span></span>
<span id="cb730-7"><a href="#cb730-7" aria-hidden="true"></a><span class="co">#&gt; 2  88.5     1.4 3.5     6.0 0.24</span></span>
<span id="cb730-8"><a href="#cb730-8" aria-hidden="true"></a><span class="co">#&gt; 3  88.4     2.2 2.7     6.4 0.18</span></span>
<span id="cb730-9"><a href="#cb730-9" aria-hidden="true"></a><span class="co">#&gt; 4  90.3     1.7 1.4     6.2 0.40</span></span>
<span id="cb730-10"><a href="#cb730-10" aria-hidden="true"></a><span class="co">#&gt; 5  90.4     0.6 4.5     4.4 0.10</span></span>
<span id="cb730-11"><a href="#cb730-11" aria-hidden="true"></a><span class="co">#&gt; 6  87.7     3.5 3.4     4.8 0.71</span></span>
<span id="cb730-12"><a href="#cb730-12" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">as.dendrogram</span>(<span class="kw">hclust</span>(<span class="kw">dist</span>(AMM.nombres))))</span></code></pre></div>
<p><img src="14cap13_EDextra_files/figure-html/unnamed-chunk-22-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>En el gráfico anterior podemos leer (más o menos) los nombres de los animales sin tener que ir a consultar el <em>data frame</em>.</p>
<p>Aparte de los parámetros usuales de la función <code>plot</code>, dos parámetros interesantes cuando se aplica a un dendrograma son <code>horiz=TRUE</code>, que lo dibuja horizontal, y <code>type="triangle"</code>, que dibuja las ramificaciones triangulares en vez de rectangulares.</p>
<p>Para tener más control sobre el aspecto de un dendrograma, por ejemplo cambiar sus etiquetas sin modificar el <em>data frame</em> original, escribirlas en un tamaño menor o mayor o colorear ramas o etiquetas a fin de añadir información al dendrograma, lo más sencillo es utilizar algunas funciones específicas aportadas por diversos paquetes. Aquí vamos a explicar algunas funcionalidades del paquete <strong>dendextend</strong>.</p>
<p>A modo de ejemplo, una vez cargado este paquete, para cambiar directamente las etiquetas del dendrograma del <em>data frame</em> <code>AMM</code>, podemos usar de manera natural la función <code>labels</code>, que nos da las etiquetas de las hojas.</p>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb731-1"><a href="#cb731-1" aria-hidden="true"></a><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(dendextend))</span>
<span id="cb731-2"><a href="#cb731-2" aria-hidden="true"></a>L=<span class="kw">labels</span>(dend.AMM)</span>
<span id="cb731-3"><a href="#cb731-3" aria-hidden="true"></a>L</span>
<span id="cb731-4"><a href="#cb731-4" aria-hidden="true"></a><span class="co">#&gt;  [1] 24 25 10  8 11 16  9 14  7 15  6 12  5  2  3  1  4 13 17 19 20 18 23 21 22</span></span>
<span id="cb731-5"><a href="#cb731-5" aria-hidden="true"></a><span class="kw">labels</span>(dend.AMM)=AMM<span class="op">$</span>Name[L]</span>
<span id="cb731-6"><a href="#cb731-6" aria-hidden="true"></a><span class="kw">labels</span>(dend.AMM)</span>
<span id="cb731-7"><a href="#cb731-7" aria-hidden="true"></a><span class="co">#&gt;  [1] &quot;Seal&quot;       &quot;Dolphin&quot;    &quot;Cat&quot;        &quot;Buffalo&quot;    &quot;Fox&quot;       </span></span>
<span id="cb731-8"><a href="#cb731-8" aria-hidden="true"></a><span class="co">#&gt;  [6] &quot;Sheep&quot;      &quot;Guinea Pig&quot; &quot;Pig&quot;        &quot;Bison&quot;      &quot;Zebra&quot;     </span></span>
<span id="cb731-9"><a href="#cb731-9" aria-hidden="true"></a><span class="co">#&gt; [11] &quot;Camel&quot;      &quot;Llama&quot;      &quot;Hippo&quot;      &quot;Orangutan&quot;  &quot;Monkey&quot;    </span></span>
<span id="cb731-10"><a href="#cb731-10" aria-hidden="true"></a><span class="co">#&gt; [16] &quot;Horse&quot;      &quot;Donkey&quot;     &quot;Mule&quot;       &quot;Dog&quot;        &quot;Rabbit&quot;    </span></span>
<span id="cb731-11"><a href="#cb731-11" aria-hidden="true"></a><span class="co">#&gt; [21] &quot;Rat&quot;        &quot;Elephant&quot;   &quot;Whale&quot;      &quot;Deer&quot;       &quot;Reindeer&quot;</span></span></code></pre></div>
<p>La función <code>labels</code> aplicada a un dendrograma nos da las etiquetas de las hojas de izquierda a derecha, y con el paquete <strong>dendextend</strong> nos permite también modificar estas etiquetas. Naturalmente, a cada etiqueta (en nuestro ejemplo, número de fila) le tenemos que hacer corresponder el nombre del animal que le toca: por eso usamos <code>labels(dend.AMM)=AMM$name[L]</code> y no <code>labels(dend.AMM)=AMM$name</code> a secas, que a la primera etiqueta del dendrograma (la 25) le asignaría el primer nombre de animal, correspondiente a la etiqueta 1.</p>
<p>Ahora que ya hemos modificado las etiquetas del dendrograma, podemos modificar su apariencia de cara a representarlo gráficamente. Para ello podemos usar la función <code>set</code>, cuya sintaxis básica es</p>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="#cb732-1" aria-hidden="true"></a><span class="kw">set</span>(dendrograma, <span class="dt">what=</span><span class="st">&quot;característica&quot;</span>, valor)</span></code></pre></div>
<p>Encontraréis la lista completa de las características que podemos usar en la Ayuda de la función.
Pero cuidado, <code>set</code> no modifica el dendrograma permanentemente, solo temporalmente. Si queréis modificar el dendrograma, tenéis que usar</p>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb733-1"><a href="#cb733-1" aria-hidden="true"></a>dendrograma =<span class="kw">set</span>(dendrograma, <span class="dt">what=</span><span class="st">&quot;característica&quot;</span>, valor)</span></code></pre></div>
<p>Si queremos cambiar más de una característica de golpe, es muy cómodo usar la notación <em>encadenada</em> de funciones, en la que a un objeto se le van aplicando funciones una tras otra separándolas con el signo <code>%&gt;%</code>. (Esta notación no se puede usar en la instalación básica de R, solo en algunos paquetes, como <strong>dendextend</strong>, que la aceptan.)
En este caso, no se entra el dendrograma dentro de <code>set</code>, sino al principio de la cadena.
Por ejemplo, para reducir el tamaño de letra de las etiquetas (para que así quepan en el gráfico) y escribirlas en rojo, podemos entrar el código siguiente:</p>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="#cb734-1" aria-hidden="true"></a>dend.AMM<span class="op">%&gt;%</span></span>
<span id="cb734-2"><a href="#cb734-2" aria-hidden="true"></a><span class="st">   </span><span class="kw">set</span>(<span class="dt">what=</span><span class="st">&quot;labels_col&quot;</span>, <span class="st">&quot;red&quot;</span>)<span class="op">%&gt;%</span><span class="st"> </span><span class="co">#Colores de las etiquetas</span></span>
<span id="cb734-3"><a href="#cb734-3" aria-hidden="true"></a><span class="st">   </span><span class="kw">set</span>(<span class="dt">what=</span><span class="st">&quot;labels_cex&quot;</span>, <span class="fl">0.8</span>)<span class="op">%&gt;%</span><span class="st"> </span><span class="co">#Tamaño de las etiquetas</span></span>
<span id="cb734-4"><a href="#cb734-4" aria-hidden="true"></a><span class="st">   </span><span class="kw">plot</span>(<span class="dt">main=</span><span class="st">&quot;Dendrograma con etiquetas coloreadas</span><span class="ch">\n</span><span class="st"> y reducidas&quot;</span>)</span></code></pre></div>
<p><img src="14cap13_EDextra_files/figure-html/unnamed-chunk-26-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Observad la sintaxis: se toma el objeto <code>dend.AMM</code>, se le aplican las dos transformaciones, una tras otra, y al final se le aplica <code>plot</code> con los parámetros que deseemos.
No hemos modificado el dendrograma <code>dend.AMM</code>, solo su apariencia en el gráfico.</p>
<p>La posibilidad de colorear las etiquetas, o las aristas, puede mejorar la comprensión del dendrograma, o incluso añadir información. Veamos dos aplicaciones:</p>
<ul>
<li>Para distinguir visualmente los principales grupos que se forman en el dendrograma, y por ejemplo usar un color en cada grupo, podemos usar el parámetro <code>k</code> igualado al número de grupos que queremos reconocer.
Por ejemplo,</li>
</ul>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb735-1"><a href="#cb735-1" aria-hidden="true"></a>dend.AMM<span class="op">%&gt;%</span></span>
<span id="cb735-2"><a href="#cb735-2" aria-hidden="true"></a><span class="st">   </span><span class="kw">set</span>(<span class="dt">what=</span><span class="st">&quot;labels_cex&quot;</span>, <span class="fl">0.8</span>)<span class="op">%&gt;%</span></span>
<span id="cb735-3"><a href="#cb735-3" aria-hidden="true"></a><span class="st">   </span><span class="kw">set</span>(<span class="dt">what=</span><span class="st">&quot;labels_colors&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>), <span class="dt">k=</span><span class="dv">3</span>)<span class="op">%&gt;%</span></span>
<span id="cb735-4"><a href="#cb735-4" aria-hidden="true"></a><span class="st">   </span><span class="kw">set</span>(<span class="dt">what=</span><span class="st">&quot;branches_k_color&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>),<span class="dt">k=</span><span class="dv">3</span>)<span class="op">%&gt;%</span><span class="st"> </span><span class="co">#Colores de las ramas</span></span>
<span id="cb735-5"><a href="#cb735-5" aria-hidden="true"></a><span class="st">   </span><span class="kw">plot</span>(<span class="dt">main=</span><span class="st">&quot;Dendrograma con 3 grupos resaltados&quot;</span>)</span></code></pre></div>
<p><img src="14cap13_EDextra_files/figure-html/unnamed-chunk-27-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ul>
<li>Podemos clasificar los individuos representados en el dendrograma mediante un factor
y usar este factor para asignar colores a las etiquetas para así ver si los grupos que produce el dendrograma se corresponden con la clasificación según el factor. Como nuestro <em>data frame</em> <code>AMM</code> no tiene ninguna variable factor que podamos usar, vamos a añadirle una que represente la dieta principal del animal: C para carnívoro, H para herbívoro, O para omnívoro, P para piscívoro.</li>
</ul>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="#cb736-1" aria-hidden="true"></a>AMM<span class="op">$</span>diet=<span class="kw">as.factor</span>(<span class="kw">c</span>(<span class="st">&quot;H&quot;</span>,<span class="st">&quot;O&quot;</span>,<span class="st">&quot;O&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>,</span>
<span id="cb736-2"><a href="#cb736-2" aria-hidden="true"></a>   <span class="st">&quot;C&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;O&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;O&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;H&quot;</span>,<span class="st">&quot;P&quot;</span>,</span>
<span id="cb736-3"><a href="#cb736-3" aria-hidden="true"></a>   <span class="st">&quot;P&quot;</span>,<span class="st">&quot;P&quot;</span>))</span>
<span id="cb736-4"><a href="#cb736-4" aria-hidden="true"></a><span class="kw">head</span>(AMM)</span>
<span id="cb736-5"><a href="#cb736-5" aria-hidden="true"></a><span class="co">#&gt;        Name Water Protein Fat Lactose  Ash diet</span></span>
<span id="cb736-6"><a href="#cb736-6" aria-hidden="true"></a><span class="co">#&gt; 1     Horse  90.1     2.6 1.0     6.9 0.35    H</span></span>
<span id="cb736-7"><a href="#cb736-7" aria-hidden="true"></a><span class="co">#&gt; 2 Orangutan  88.5     1.4 3.5     6.0 0.24    O</span></span>
<span id="cb736-8"><a href="#cb736-8" aria-hidden="true"></a><span class="co">#&gt; 3    Monkey  88.4     2.2 2.7     6.4 0.18    O</span></span>
<span id="cb736-9"><a href="#cb736-9" aria-hidden="true"></a><span class="co">#&gt; 4    Donkey  90.3     1.7 1.4     6.2 0.40    H</span></span>
<span id="cb736-10"><a href="#cb736-10" aria-hidden="true"></a><span class="co">#&gt; 5     Hippo  90.4     0.6 4.5     4.4 0.10    H</span></span>
<span id="cb736-11"><a href="#cb736-11" aria-hidden="true"></a><span class="co">#&gt; 6     Camel  87.7     3.5 3.4     4.8 0.71    H</span></span>
<span id="cb736-12"><a href="#cb736-12" aria-hidden="true"></a><span class="co"># View(AMM) #Si queréis ver el dataframe completo en la ventana de ficheros</span></span></code></pre></div>
<p>Ahora colorearemos las etiquetas del dendrograma según su dieta, y aprovecharemos para ver otra manera de usar <code>set</code>, definiendo un nuevo dendrograma <code>dend.AMM2</code> donde los cambios realizados sobre <code>dend.AMM</code> por las diferentes aplicaciones de <code>set</code> sean permanentes.</p>
<div class="sourceCode" id="cb737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb737-1"><a href="#cb737-1" aria-hidden="true"></a>dend.AMM2=dend.AMM<span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb737-2"><a href="#cb737-2" aria-hidden="true"></a><span class="st">   </span><span class="kw">set</span>(<span class="dt">what=</span><span class="st">&quot;labels_cex&quot;</span>, <span class="fl">0.8</span>)<span class="op">%&gt;%</span><span class="st">   </span><span class="co">#Tamaño de etiquetas</span></span>
<span id="cb737-3"><a href="#cb737-3" aria-hidden="true"></a><span class="st">   </span><span class="kw">set</span>(<span class="dt">what=</span><span class="st">&quot;labels&quot;</span>,AMM<span class="op">$</span>Name[L])<span class="op">%&gt;%</span><span class="st">  </span><span class="co">#Nombres en las etiquetas</span></span>
<span id="cb737-4"><a href="#cb737-4" aria-hidden="true"></a><span class="st">   </span><span class="kw">set</span>(<span class="dt">what=</span><span class="st">&quot;labels_color&quot;</span>,<span class="kw">as.numeric</span>(AMM<span class="op">$</span>diet[L]))  <span class="co">#Colores según la dieta</span></span>
<span id="cb737-5"><a href="#cb737-5" aria-hidden="true"></a><span class="kw">plot</span>(dend.AMM2, <span class="dt">main=</span><span class="st">&quot;Dendrograma de mamíferos clasificados</span></span>
<span id="cb737-6"><a href="#cb737-6" aria-hidden="true"></a><span class="st">    </span><span class="ch">\n</span><span class="st"> según la dieta&quot;</span>)</span></code></pre></div>
<p><img src="14cap13_EDextra_files/figure-html/unnamed-chunk-29-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Vemos que la similitud de la composición de la leche materna no tiene mucha correspondencia con la dieta.</p>
<p>Para más información sobre las posibilidades de <code>dendextend</code> y su interacción con otros paquetes que dibujan dendrogramas, consultad la Ayuda de <strong>dendextend</strong>. Por ejemplo,
podemos modificar un dendrograma con <code>set</code> y luego
aplicarle la función <code>circlize_dendrogram</code> del paquete <strong>circlize</strong> para obtener una representación circular. Véase el gráfico siguiente:</p>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="#cb738-1" aria-hidden="true"></a><span class="kw">library</span>(circlize)</span>
<span id="cb738-2"><a href="#cb738-2" aria-hidden="true"></a><span class="kw">circlize_dendrogram</span>(dend.AMM2)</span></code></pre></div>
<p><img src="14cap13_EDextra_files/figure-html/unnamed-chunk-30-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="gráficos-de-burbujas-o-bubbles" class="section level2" number="14.4">
<h2 number="14.4"><span class="header-section-number">14.4</span> Gráficos de burbujas o <em>bubbles</em></h2>
<p>Hay situaciones en las que nos interesa resaltar la importancia de una variable dibujando figuras geométricas (círculos, cuadrados, etc.) de tamaño proporcional a la importancia del valor de la variable. Este tipo de gráficos se
denominan <em>gráficos de burbujas</em>, o <em>bubbles</em>, y la función básica para producirlos es <code>symbols</code>. Su sintáxis básica es</p>
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb739-1"><a href="#cb739-1" aria-hidden="true"></a><span class="kw">symbols</span>(x, y, <span class="st">&quot;parámetro_figura&quot;</span> =z, ...)</span></code></pre></div>
<p>donde <code>x</code> e <code>y</code> son los vectores de primeras y segundas coordenadas de los centros de las figuras a dibujar, el
<em>parámetro_figura</em> indica el tipo de figuras (<code>circles</code> para círculos, <code>squares</code> para cuadrados, <code>stars</code> para estrellas, etc.), y <code>z</code> es el vector de los tamaños <em>lineales</em> de las figuras: radio para los círculos, lado para los cuadrados, longitud del rayo para las estrellas, etc. Además se pueden usar los dos parámetros siguientes para añadir colores a las figuras:</p>
<ul>
<li><code>fg</code>: el color de la frontera de los símbolos (por defecto, negro).</li>
<li><code>bg</code>: su color de relleno.</li>
</ul>
<p>Y finalmente, se pueden usar los parámetros usuales de <code>plot</code>; para más información, incluida la lista de figuras disponibles, consultad la Ayuda de la función.</p>
<p>Veamos un ejemplo. Consideremos la tabla de datos <code>savings</code> que lleva el paquete <strong>faraway</strong>. Dicha tabla de datos nos da los 5 indicadores económicos siguientes de 50 países durante el período 1960–1970:</p>
<ul>
<li><code>sr</code>: la tasa de ahorro, <em>savings rate</em>, de cada país.</li>
<li><code>pop15</code>: su porcentaje de población menor de 15 años.</li>
<li><code>pop75</code>: su porcentaje de población mayor de 75 años.</li>
<li><code>dpi</code>: su renta per cápita en dólares.</li>
<li><code>ddpi</code>: su tasa de crecimiento como porcentaje de su renta per cápita.</li>
</ul>
<p>Vamos a producir un gráfico de burbujas de la tasa de ahorro de cada país en función de su renta per cápita, donde la
variable <em>burbuja</em> será la tasa de crecimiento; es decir, para cada país, dibujaremos una burbuja centrada en el punto de coordenadas (renta per cápita, tasa de ahorro) de diámetro proporcional a su tasa de crecimiento.
Además, colorearemos las burbujas según una escala de colores ocres que represente el porcentaje de la población menor de 15 años: cuanto más oscura sea la burbuja, mayor es dicho porcentaje. El código para producir el gráfico, tras cargar los paquetes <strong>faraway</strong> (para tener acceso a los datos) y <strong>RColorBrewer</strong> (para poder definir la paleta de colores), es el siguiente:</p>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="#cb740-1" aria-hidden="true"></a><span class="kw">library</span>(faraway)</span>
<span id="cb740-2"><a href="#cb740-2" aria-hidden="true"></a><span class="kw">library</span>(RColorBrewer)</span></code></pre></div>
<ul>
<li>Agrupamos los porcentajes de población menor de 15 años en 9 grupos:</li>
</ul>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb741-1"><a href="#cb741-1" aria-hidden="true"></a>porcentajes15=<span class="kw">as.numeric</span>(<span class="kw">cut</span>(savings<span class="op">$</span>pop15, <span class="dv">9</span>)) </span></code></pre></div>
<ul>
<li>Definimos nuestra paleta en función de los valores de la variable anterior:</li>
</ul>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="#cb742-1" aria-hidden="true"></a>colores=<span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;YlOrBr&quot;</span>)[porcentajes15]</span></code></pre></div>
<ul>
<li>Dibujamos el gráfico de burbujas y escribimos el nombre de cada país en el centro de su burbuja :</li>
</ul>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb743-1"><a href="#cb743-1" aria-hidden="true"></a><span class="kw">symbols</span>(savings<span class="op">$</span>dpi, savings<span class="op">$</span>sr, <span class="dt">circles=</span>savings<span class="op">$</span>ddpi, </span>
<span id="cb743-2"><a href="#cb743-2" aria-hidden="true"></a>   <span class="dt">bg=</span>colores, <span class="dt">xlab=</span><span class="st">&quot;Renta per cápita&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Tasa de ahorro&quot;</span>) </span>
<span id="cb743-3"><a href="#cb743-3" aria-hidden="true"></a><span class="kw">text</span>(savings<span class="op">$</span>dpi,savings<span class="op">$</span>sr, <span class="kw">rownames</span>(savings), <span class="dt">cex=</span><span class="fl">0.75</span>) </span></code></pre></div>
<p><img src="14cap13_EDextra_files/figure-html/unnamed-chunk-35-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>A simple vista se puede observar, por ejemplo, que los Estados Unidos tienen la renta per cápita más alta, una tasa de ahorro entre moderada y baja, una tasa de crecimiento de la renta per cápita baja y un porcentaje de población menor de 15 años también bajo; en cambio, Japón tiene una renta per cápita más baja, una tasa de ahorro y una tasa de crecimiento de la renta per cápita mucho más altas pero la población menor de 15 años sigue siendo baja. También se observa que, en general, el porcentaje de población menor de 15 años en los países más desarrollados es mucho menor que en los países menos desarrollados.</p>
<p>Este tipo de gráficos, tal cual los produce R, tienen un defecto: como los tamaños de las burbujas se indican por medio de una dimensión lineal, su área crece con el cuadrado de dicha dimensión; por ejemplo, en nuestro gráfico, la burbuja de un país con el doble de tasa de crecimiento que otro tiene un área cuatro veces mayor que la de este otro país. Como, instintivamente, comparamos áreas y no diámetros,
esto puede llevar a confusión. La solución es sencilla: si queremos que las proporcionales a las tasas de crecimiento sean las áreas de los círculos, cuadrados, rectángulos, etc., y no sus amplitudes,
basta entrar como dimensiones de las figuras sus raíces cuadradas. Así, el código siguiente produce un gráfico que, para nuestro gusto, representa mejor los datos.</p>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="#cb744-1" aria-hidden="true"></a><span class="kw">symbols</span>(savings<span class="op">$</span>dpi, savings<span class="op">$</span>sr, <span class="dt">circles=</span><span class="kw">sqrt</span>(savings<span class="op">$</span>ddpi), </span>
<span id="cb744-2"><a href="#cb744-2" aria-hidden="true"></a>   <span class="dt">bg=</span>colores, <span class="dt">xlab=</span><span class="st">&quot;Renta per cápita&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Tasa de ahorro&quot;</span>) </span>
<span id="cb744-3"><a href="#cb744-3" aria-hidden="true"></a><span class="kw">text</span>(savings<span class="op">$</span>dpi,savings<span class="op">$</span>sr, <span class="kw">rownames</span>(savings), <span class="dt">cex=</span><span class="fl">0.75</span>) </span></code></pre></div>
<p><img src="14cap13_EDextra_files/figure-html/unnamed-chunk-36-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="gráficos-de-corrientes-o-streamgraphs" class="section level2" number="14.5">
<h2 number="14.5"><span class="header-section-number">14.5</span> Gráficos de corrientes o <em>streamgraphs</em></h2>
<p>En los últimos 10 años se han puesto de moda un tipo de gráficos que sirven para visualizar cómo diversas cantidades varían conjuntamente a lo largo del tiempo: son los llamados <em>gráficos de corrientes</em>, o <em>streamgraphs</em>. Con R este tipo de gráficos se producen fácilmente con el paquete <strong>streamgraph</strong>, que aún no está disponible en el servidor de la CRAN (al menos en el momento de revisar estas notas, marzo de 2020) pero puede instalarse desde <em>GitHub</em>. Para ello no podemos emplear el instalador de paquetes de <em>RStudio</em> ni la función <code>install.packages</code>, sino la función específica <code>install_github</code> del paquete <strong>devtools</strong>, aplicado al <em>url</em> del paquete (que tenemos que conocer). Así, para instalar y cargar el paquete <strong>streamgraph</strong>, a día de hoy hay que ejecutar el código siguiente:</p>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb745-1"><a href="#cb745-1" aria-hidden="true"></a><span class="kw">library</span>(devtools)</span>
<span id="cb745-2"><a href="#cb745-2" aria-hidden="true"></a><span class="kw">install_github</span>(<span class="st">&quot;hrbrmstr/streamgraph&quot;</span>,<span class="dt">force=</span><span class="ot">TRUE</span>)</span>
<span id="cb745-3"><a href="#cb745-3" aria-hidden="true"></a><span class="kw">library</span>(streamgraph)   </span></code></pre></div>
<p>Ahora que ya lo tenemos cargado, vamos a producir un <em>streamgraph</em> de los diferentes géneros de películas desde los años 30 hasta la actualidad. Para ello, usaremos la tabla de datos <code>movies</code>, con información de 58,788 películas, que lleva el paquete <strong>ggplot2movies</strong>.</p>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="#cb746-1" aria-hidden="true"></a><span class="kw">library</span>(ggplot2movies)</span>
<span id="cb746-2"><a href="#cb746-2" aria-hidden="true"></a><span class="kw">data</span>(movies)</span>
<span id="cb746-3"><a href="#cb746-3" aria-hidden="true"></a><span class="kw">str</span>(movies)</span>
<span id="cb746-4"><a href="#cb746-4" aria-hidden="true"></a><span class="co">#&gt; tibble [58,788 x 24] (S3: tbl_df/tbl/data.frame)</span></span>
<span id="cb746-5"><a href="#cb746-5" aria-hidden="true"></a><span class="co">#&gt;  $ title      : chr [1:58788] &quot;$&quot; &quot;$1000 a Touchdown&quot; &quot;$21 a Day Once a Month&quot; &quot;$40,000&quot; ...</span></span>
<span id="cb746-6"><a href="#cb746-6" aria-hidden="true"></a><span class="co">#&gt;  $ year       : int [1:58788] 1971 1939 1941 1996 1975 2000 2002 2002 1987 1917 ...</span></span>
<span id="cb746-7"><a href="#cb746-7" aria-hidden="true"></a><span class="co">#&gt;  $ length     : int [1:58788] 121 71 7 70 71 91 93 25 97 61 ...</span></span>
<span id="cb746-8"><a href="#cb746-8" aria-hidden="true"></a><span class="co">#&gt;  $ budget     : int [1:58788] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span id="cb746-9"><a href="#cb746-9" aria-hidden="true"></a><span class="co">#&gt;  $ rating     : num [1:58788] 6.4 6 8.2 8.2 3.4 4.3 5.3 6.7 6.6 6 ...</span></span>
<span id="cb746-10"><a href="#cb746-10" aria-hidden="true"></a><span class="co">#&gt;  $ votes      : int [1:58788] 348 20 5 6 17 45 200 24 18 51 ...</span></span>
<span id="cb746-11"><a href="#cb746-11" aria-hidden="true"></a><span class="co">#&gt;  $ r1         : num [1:58788] 4.5 0 0 14.5 24.5 4.5 4.5 4.5 4.5 4.5 ...</span></span>
<span id="cb746-12"><a href="#cb746-12" aria-hidden="true"></a><span class="co">#&gt;  $ r2         : num [1:58788] 4.5 14.5 0 0 4.5 4.5 0 4.5 4.5 0 ...</span></span>
<span id="cb746-13"><a href="#cb746-13" aria-hidden="true"></a><span class="co">#&gt;  $ r3         : num [1:58788] 4.5 4.5 0 0 0 4.5 4.5 4.5 4.5 4.5 ...</span></span>
<span id="cb746-14"><a href="#cb746-14" aria-hidden="true"></a><span class="co">#&gt;  $ r4         : num [1:58788] 4.5 24.5 0 0 14.5 14.5 4.5 4.5 0 4.5 ...</span></span>
<span id="cb746-15"><a href="#cb746-15" aria-hidden="true"></a><span class="co">#&gt;  $ r5         : num [1:58788] 14.5 14.5 0 0 14.5 14.5 24.5 4.5 0 4.5 ...</span></span>
<span id="cb746-16"><a href="#cb746-16" aria-hidden="true"></a><span class="co">#&gt;  $ r6         : num [1:58788] 24.5 14.5 24.5 0 4.5 14.5 24.5 14.5 0 44.5 ...</span></span>
<span id="cb746-17"><a href="#cb746-17" aria-hidden="true"></a><span class="co">#&gt;  $ r7         : num [1:58788] 24.5 14.5 0 0 0 4.5 14.5 14.5 34.5 14.5 ...</span></span>
<span id="cb746-18"><a href="#cb746-18" aria-hidden="true"></a><span class="co">#&gt;  $ r8         : num [1:58788] 14.5 4.5 44.5 0 0 4.5 4.5 14.5 14.5 4.5 ...</span></span>
<span id="cb746-19"><a href="#cb746-19" aria-hidden="true"></a><span class="co">#&gt;  $ r9         : num [1:58788] 4.5 4.5 24.5 34.5 0 14.5 4.5 4.5 4.5 4.5 ...</span></span>
<span id="cb746-20"><a href="#cb746-20" aria-hidden="true"></a><span class="co">#&gt;  $ r10        : num [1:58788] 4.5 14.5 24.5 45.5 24.5 14.5 14.5 14.5 24.5 4.5 ...</span></span>
<span id="cb746-21"><a href="#cb746-21" aria-hidden="true"></a><span class="co">#&gt;  $ mpaa       : chr [1:58788] &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; ...</span></span>
<span id="cb746-22"><a href="#cb746-22" aria-hidden="true"></a><span class="co">#&gt;  $ Action     : int [1:58788] 0 0 0 0 0 0 1 0 0 0 ...</span></span>
<span id="cb746-23"><a href="#cb746-23" aria-hidden="true"></a><span class="co">#&gt;  $ Animation  : int [1:58788] 0 0 1 0 0 0 0 0 0 0 ...</span></span>
<span id="cb746-24"><a href="#cb746-24" aria-hidden="true"></a><span class="co">#&gt;  $ Comedy     : int [1:58788] 1 1 0 1 0 0 0 0 0 0 ...</span></span>
<span id="cb746-25"><a href="#cb746-25" aria-hidden="true"></a><span class="co">#&gt;  $ Drama      : int [1:58788] 1 0 0 0 0 1 1 0 1 0 ...</span></span>
<span id="cb746-26"><a href="#cb746-26" aria-hidden="true"></a><span class="co">#&gt;  $ Documentary: int [1:58788] 0 0 0 0 0 0 0 1 0 0 ...</span></span>
<span id="cb746-27"><a href="#cb746-27" aria-hidden="true"></a><span class="co">#&gt;  $ Romance    : int [1:58788] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb746-28"><a href="#cb746-28" aria-hidden="true"></a><span class="co">#&gt;  $ Short      : int [1:58788] 0 0 1 0 0 0 0 1 0 0 ...</span></span></code></pre></div>
<p>De esta tabla de datos nos vamos a quedar solo con las variables <code>year</code> (año de estreno) y
<code>Action</code>, <code>Animation</code>, <code>Comedy</code>, <code>Drama</code>, <code>Documentary</code>, <code>Romance</code> y <code>Short</code>, variables binarias que indican si la película entra o no en cada una de las categorías siguientes: acción, animación, comedia, drama, documental, romántica y cortometraje, respectivamente.</p>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb747-1"><a href="#cb747-1" aria-hidden="true"></a>movies.small=movies[,<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">18</span><span class="op">:</span><span class="dv">24</span>)]</span>
<span id="cb747-2"><a href="#cb747-2" aria-hidden="true"></a><span class="kw">str</span>(movies.small)</span>
<span id="cb747-3"><a href="#cb747-3" aria-hidden="true"></a><span class="co">#&gt; tibble [58,788 x 8] (S3: tbl_df/tbl/data.frame)</span></span>
<span id="cb747-4"><a href="#cb747-4" aria-hidden="true"></a><span class="co">#&gt;  $ year       : int [1:58788] 1971 1939 1941 1996 1975 2000 2002 2002 1987 1917 ...</span></span>
<span id="cb747-5"><a href="#cb747-5" aria-hidden="true"></a><span class="co">#&gt;  $ Action     : int [1:58788] 0 0 0 0 0 0 1 0 0 0 ...</span></span>
<span id="cb747-6"><a href="#cb747-6" aria-hidden="true"></a><span class="co">#&gt;  $ Animation  : int [1:58788] 0 0 1 0 0 0 0 0 0 0 ...</span></span>
<span id="cb747-7"><a href="#cb747-7" aria-hidden="true"></a><span class="co">#&gt;  $ Comedy     : int [1:58788] 1 1 0 1 0 0 0 0 0 0 ...</span></span>
<span id="cb747-8"><a href="#cb747-8" aria-hidden="true"></a><span class="co">#&gt;  $ Drama      : int [1:58788] 1 0 0 0 0 1 1 0 1 0 ...</span></span>
<span id="cb747-9"><a href="#cb747-9" aria-hidden="true"></a><span class="co">#&gt;  $ Documentary: int [1:58788] 0 0 0 0 0 0 0 1 0 0 ...</span></span>
<span id="cb747-10"><a href="#cb747-10" aria-hidden="true"></a><span class="co">#&gt;  $ Romance    : int [1:58788] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb747-11"><a href="#cb747-11" aria-hidden="true"></a><span class="co">#&gt;  $ Short      : int [1:58788] 0 0 1 0 0 0 0 1 0 0 ...</span></span></code></pre></div>
<p>Ahora hemos de modificar el <em>data frame</em> para poderlo usar como una serie temporal, donde para cada año y para cada categoría nos dé el correspondiente número de películas. La manera más sencilla es, en primer lugar, usar la función <code>pivot_longuer</code> del paquete <code>**tidyr**, especializado en funciones para *limpiar* y reorganizar datos. Con esta función podemos sustituir las variables binarias correspondientes a las categorías por  una nueva variable factor (la llamaremos</code>genero<code>) cuyos valores sean los nombres de dichas variables   y añadir una nueva variable binaria (la llamaremos</code>valor`) que da el valor de la variable binaria original.
La sintaxis es</p>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="#cb748-1" aria-hidden="true"></a><span class="kw">pivot_longer</span>(<span class="dt">data=</span><span class="st">&quot;dataframe o tibble&quot;</span>, <span class="dt">cols=</span><span class="st">&quot;columnas a pivotar&quot;</span>, <span class="dt">names_to=</span><span class="st">&quot;variable que contiene elnombre de la columna&quot;</span>,<span class="dt">values_to=</span><span class="st">&quot;&quot;</span>variable que contine el valor<span class="st">&quot;)</span></span></code></pre></div>
<p>De esta manera, en nuestro caso, cada fila de <code>movies.small</code> se convierte en 7 filas del nuevo <em>data frame</em>, una para cada variable <em>agrupada</em> en la nueva variable <code>genero</code>.</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="#cb749-1" aria-hidden="true"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb749-2"><a href="#cb749-2" aria-hidden="true"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb749-3"><a href="#cb749-3" aria-hidden="true"></a>movies.agrup=movies.small <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(<span class="dt">cols=</span><span class="kw">c</span>(Action<span class="op">:</span>Short),</span>
<span id="cb749-4"><a href="#cb749-4" aria-hidden="true"></a>                                                             <span class="dt">names_to=</span><span class="st">&quot;genero&quot;</span>,</span>
<span id="cb749-5"><a href="#cb749-5" aria-hidden="true"></a>                                                            <span class="dt">values_to=</span><span class="st">&quot;valor&quot;</span>) </span>
<span id="cb749-6"><a href="#cb749-6" aria-hidden="true"></a><span class="co">#-year indica &quot;todas las variables menos year&quot;</span></span>
<span id="cb749-7"><a href="#cb749-7" aria-hidden="true"></a><span class="co"># Action:Short indica que  toamamos todas las variables entre Action y Short</span></span>
<span id="cb749-8"><a href="#cb749-8" aria-hidden="true"></a><span class="kw">str</span>(movies.agrup)</span>
<span id="cb749-9"><a href="#cb749-9" aria-hidden="true"></a><span class="co">#&gt; tibble [411,516 x 3] (S3: tbl_df/tbl/data.frame)</span></span>
<span id="cb749-10"><a href="#cb749-10" aria-hidden="true"></a><span class="co">#&gt;  $ year  : int [1:411516] 1971 1971 1971 1971 1971 1971 1971 1939 1939 1939 ...</span></span>
<span id="cb749-11"><a href="#cb749-11" aria-hidden="true"></a><span class="co">#&gt;  $ genero: chr [1:411516] &quot;Action&quot; &quot;Animation&quot; &quot;Comedy&quot; &quot;Drama&quot; ...</span></span>
<span id="cb749-12"><a href="#cb749-12" aria-hidden="true"></a><span class="co">#&gt;  $ valor : int [1:411516] 0 0 1 1 0 0 0 0 0 1 ...</span></span></code></pre></div>
<p>A continuación, observamos que menos del 0.1% de las películas se filmaron antes de 1930, por lo que en nuestro <em>streamgraph</em> esos años van a aparecer muy delgados, así que los eliminamos.</p>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="#cb750-1" aria-hidden="true"></a><span class="kw">quantile</span>(movies.agrup<span class="op">$</span>year,<span class="fl">0.001</span>)</span>
<span id="cb750-2"><a href="#cb750-2" aria-hidden="true"></a><span class="co">#&gt; 0.1% </span></span>
<span id="cb750-3"><a href="#cb750-3" aria-hidden="true"></a><span class="co">#&gt; 1900</span></span>
<span id="cb750-4"><a href="#cb750-4" aria-hidden="true"></a>movies.agrup=movies.agrup[movies.agrup<span class="op">$</span>year<span class="op">&gt;=</span><span class="dv">1900</span>,]</span></code></pre></div>
<p>A continuación, para cada año y cada categoría, sumamos los valores de la variable <code>valor</code>: como son ceros y unos, esto nos dará, los números anuales de películas de cada categoría. Una posible manera de hacerlo es con el código siguiente (la suma de dos factores indica que agrupamos los datos por todas la combinaciones de un nivel de cada factor):</p>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb751-1"><a href="#cb751-1" aria-hidden="true"></a>sum.movies.agrup=<span class="kw">aggregate</span>(valor<span class="op">~</span>year<span class="op">+</span>genero, <span class="dt">data=</span>movies.agrup,</span>
<span id="cb751-2"><a href="#cb751-2" aria-hidden="true"></a>   <span class="dt">FUN=</span>sum)</span>
<span id="cb751-3"><a href="#cb751-3" aria-hidden="true"></a><span class="kw">str</span>(sum.movies.agrup)</span>
<span id="cb751-4"><a href="#cb751-4" aria-hidden="true"></a><span class="co">#&gt; &#39;data.frame&#39;:    742 obs. of  3 variables:</span></span>
<span id="cb751-5"><a href="#cb751-5" aria-hidden="true"></a><span class="co">#&gt;  $ year  : int  1900 1901 1902 1903 1904 1905 1906 1907 1908 1909 ...</span></span>
<span id="cb751-6"><a href="#cb751-6" aria-hidden="true"></a><span class="co">#&gt;  $ genero: chr  &quot;Action&quot; &quot;Action&quot; &quot;Action&quot; &quot;Action&quot; ...</span></span>
<span id="cb751-7"><a href="#cb751-7" aria-hidden="true"></a><span class="co">#&gt;  $ valor : int  0 1 0 3 0 0 0 0 3 0 ...</span></span></code></pre></div>
<p>Y ahora ya estamos en disposición de dibujar el <em>streamgraph</em>. La función para hacerlo es )</p>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="#cb752-1" aria-hidden="true"></a><span class="kw">streamgraph</span>(data frame, <span class="st">&quot;factor&quot;</span>, <span class="st">&quot;valores&quot;</span>, <span class="st">&quot;tiempo&quot;</span>, <span class="dt">interactive=</span>...)? </span></code></pre></div>
<p>donde especificamos el <em>factor</em> del <em>data frame</em> de cuyas variables queremos representar sus <em>valores</em> a lo largo del <em>tiempo</em>. El parámetro <code>interactive</code> es muy interesante, pero por ahora lo declararemos como <code>FALSE</code>, puesto que vamos a producir un dibujo para incorporar a este documento.</p>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb753-1"><a href="#cb753-1" aria-hidden="true"></a><span class="kw">streamgraph</span>(sum.movies.agrup, <span class="st">&quot;genero&quot;</span>, <span class="st">&quot;valor&quot;</span>, <span class="st">&quot;year&quot;</span>,</span>
<span id="cb753-2"><a href="#cb753-2" aria-hidden="true"></a>   <span class="dt">interactive=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<div id="htmlwidget-65103486777b9d07d9d9" class="streamgraph html-widget" style="width:90%;height:480px;"></div>
<div id="htmlwidget-65103486777b9d07d9d9-legend" style="width:90%" class="streamgraph html-widget-legend"><center><label style='padding-right:5px' for='htmlwidget-65103486777b9d07d9d9-select'></label><select id='htmlwidget-65103486777b9d07d9d9-select' style='visibility:hidden;'></select></center></div>
<script type="application/json" data-for="htmlwidget-65103486777b9d07d9d9">{"x":{"data":{"key":["Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short"],"value":[0,1,5,5,2,0,16,1,0,8,9,5,1,27,0,0,2,2,1,0,9,3,0,8,8,2,1,37,0,0,10,4,3,0,42,0,0,6,2,4,0,17,0,1,2,4,5,0,15,0,1,6,0,1,0,12,3,1,8,1,8,0,24,0,1,7,0,14,1,29,0,0,2,2,14,3,26,1,1,2,1,14,1,21,0,1,4,0,22,5,30,2,2,11,1,13,0,22,1,1,38,1,13,0,38,2,3,22,1,16,0,35,1,6,27,0,13,2,29,0,0,18,0,14,2,15,1,3,23,1,14,2,22,2,3,29,2,17,5,20,0,0,20,0,14,3,13,1,2,23,0,23,6,17,0,4,16,1,20,8,14,1,3,19,2,20,11,17,3,2,24,0,15,7,18,0,4,36,2,27,10,21,5,3,40,2,37,17,26,3,2,32,2,41,21,20,5,6,45,4,51,9,33,0,17,60,11,74,14,54,4,26,125,7,106,53,74,5,41,146,5,138,45,91,5,63,143,6,157,33,116,6,51,159,7,167,66,107,8,49,192,7,164,61,123,17,69,192,13,140,62,122,9,85,212,4,120,47,143,14,75,209,10,153,62,127,8,76,217,11,133,53,126,17,80,183,10,179,35,127,15,85,213,16,156,45,134,16,97,242,16,139,57,141,24,100,203,19,148,40,145,18,74,165,26,129,26,123,11,68,157,14,118,32,101,15,51,126,22,122,28,84,10,66,144,12,135,32,101,14,61,137,7,162,41,85,21,79,172,12,179,35,107,18,80,179,9,187,43,100,14,72,166,11,167,27,99,17,71,187,13,191,39,105,18,69,178,12,194,31,90,21,63,178,13,183,44,92,23,70,168,12,177,47,96,13,61,154,15,220,49,93,13,56,143,17,183,38,83,13,41,142,13,236,44,68,16,36,141,10,219,42,53,24,31,143,13,186,42,50,19,27,126,13,224,35,38,28,30,135,12,186,32,49,25,35,163,11,210,30,53,30,21,164,19,199,32,43,39,28,160,21,189,34,46,29,58,175,29,158,20,85,32,50,176,20,168,20,86,40,43,193,38,200,39,79,45,46,166,37,223,29,79,46,23,164,22,266,31,44,31,12,156,32,252,28,30,55,23,155,40,260,25,42,59,11,146,31,238,19,27,68,9,150,24,258,22,27,85,18,130,27,258,32,25,63,20,148,36,244,32,44,82,16,148,38,250,26,36,79,20,152,24,246,27,26,64,22,151,39,231,30,35,65,20,160,27,248,38,32,72,13,184,33,230,41,38,62,19,178,31,243,43,22,83,18,172,40,255,34,39,78,25,166,31,265,41,33,83,26,190,45,278,57,38,108,33,213,45,256,59,52,131,29,204,31,289,44,40,109,35,252,49,339,55,56,94,37,249,42,332,67,50,132,37,239,37,324,63,63,134,21,232,41,321,65,50,97,37,250,46,330,76,68,120,30,240,74,347,77,75,137,32,254,60,381,84,95,147,41,309,94,435,97,141,161,52,281,84,493,116,165,159,52,352,98,493,127,194,162,49,404,133,555,161,217,144,61,451,133,634,160,279,160,85,562,156,694,184,408,154,89,561,175,793,207,449,169,82,582,196,837,211,468,176,81,591,249,929,245,533,180,94,642,261,899,215,555,147,56,597,258,805,169,480,43,10,123,35,137,37,54],"date":["1900-01-01","1900-01-01","1900-01-01","1900-01-01","1900-01-01","1900-01-01","1900-01-01","1901-01-01","1901-01-01","1901-01-01","1901-01-01","1901-01-01","1901-01-01","1901-01-01","1902-01-01","1902-01-01","1902-01-01","1902-01-01","1902-01-01","1902-01-01","1902-01-01","1903-01-01","1903-01-01","1903-01-01","1903-01-01","1903-01-01","1903-01-01","1903-01-01","1904-01-01","1904-01-01","1904-01-01","1904-01-01","1904-01-01","1904-01-01","1904-01-01","1905-01-01","1905-01-01","1905-01-01","1905-01-01","1905-01-01","1905-01-01","1905-01-01","1906-01-01","1906-01-01","1906-01-01","1906-01-01","1906-01-01","1906-01-01","1906-01-01","1907-01-01","1907-01-01","1907-01-01","1907-01-01","1907-01-01","1907-01-01","1907-01-01","1908-01-01","1908-01-01","1908-01-01","1908-01-01","1908-01-01","1908-01-01","1908-01-01","1909-01-01","1909-01-01","1909-01-01","1909-01-01","1909-01-01","1909-01-01","1909-01-01","1910-01-01","1910-01-01","1910-01-01","1910-01-01","1910-01-01","1910-01-01","1910-01-01","1911-01-01","1911-01-01","1911-01-01","1911-01-01","1911-01-01","1911-01-01","1911-01-01","1912-01-01","1912-01-01","1912-01-01","1912-01-01","1912-01-01","1912-01-01","1912-01-01","1913-01-01","1913-01-01","1913-01-01","1913-01-01","1913-01-01","1913-01-01","1913-01-01","1914-01-01","1914-01-01","1914-01-01","1914-01-01","1914-01-01","1914-01-01","1914-01-01","1915-01-01","1915-01-01","1915-01-01","1915-01-01","1915-01-01","1915-01-01","1915-01-01","1916-01-01","1916-01-01","1916-01-01","1916-01-01","1916-01-01","1916-01-01","1916-01-01","1917-01-01","1917-01-01","1917-01-01","1917-01-01","1917-01-01","1917-01-01","1917-01-01","1918-01-01","1918-01-01","1918-01-01","1918-01-01","1918-01-01","1918-01-01","1918-01-01","1919-01-01","1919-01-01","1919-01-01","1919-01-01","1919-01-01","1919-01-01","1919-01-01","1920-01-01","1920-01-01","1920-01-01","1920-01-01","1920-01-01","1920-01-01","1920-01-01","1921-01-01","1921-01-01","1921-01-01","1921-01-01","1921-01-01","1921-01-01","1921-01-01","1922-01-01","1922-01-01","1922-01-01","1922-01-01","1922-01-01","1922-01-01","1922-01-01","1923-01-01","1923-01-01","1923-01-01","1923-01-01","1923-01-01","1923-01-01","1923-01-01","1924-01-01","1924-01-01","1924-01-01","1924-01-01","1924-01-01","1924-01-01","1924-01-01","1925-01-01","1925-01-01","1925-01-01","1925-01-01","1925-01-01","1925-01-01","1925-01-01","1926-01-01","1926-01-01","1926-01-01","1926-01-01","1926-01-01","1926-01-01","1926-01-01","1927-01-01","1927-01-01","1927-01-01","1927-01-01","1927-01-01","1927-01-01","1927-01-01","1928-01-01","1928-01-01","1928-01-01","1928-01-01","1928-01-01","1928-01-01","1928-01-01","1929-01-01","1929-01-01","1929-01-01","1929-01-01","1929-01-01","1929-01-01","1929-01-01","1930-01-01","1930-01-01","1930-01-01","1930-01-01","1930-01-01","1930-01-01","1930-01-01","1931-01-01","1931-01-01","1931-01-01","1931-01-01","1931-01-01","1931-01-01","1931-01-01","1932-01-01","1932-01-01","1932-01-01","1932-01-01","1932-01-01","1932-01-01","1932-01-01","1933-01-01","1933-01-01","1933-01-01","1933-01-01","1933-01-01","1933-01-01","1933-01-01","1934-01-01","1934-01-01","1934-01-01","1934-01-01","1934-01-01","1934-01-01","1934-01-01","1935-01-01","1935-01-01","1935-01-01","1935-01-01","1935-01-01","1935-01-01","1935-01-01","1936-01-01","1936-01-01","1936-01-01","1936-01-01","1936-01-01","1936-01-01","1936-01-01","1937-01-01","1937-01-01","1937-01-01","1937-01-01","1937-01-01","1937-01-01","1937-01-01","1938-01-01","1938-01-01","1938-01-01","1938-01-01","1938-01-01","1938-01-01","1938-01-01","1939-01-01","1939-01-01","1939-01-01","1939-01-01","1939-01-01","1939-01-01","1939-01-01","1940-01-01","1940-01-01","1940-01-01","1940-01-01","1940-01-01","1940-01-01","1940-01-01","1941-01-01","1941-01-01","1941-01-01","1941-01-01","1941-01-01","1941-01-01","1941-01-01","1942-01-01","1942-01-01","1942-01-01","1942-01-01","1942-01-01","1942-01-01","1942-01-01","1943-01-01","1943-01-01","1943-01-01","1943-01-01","1943-01-01","1943-01-01","1943-01-01","1944-01-01","1944-01-01","1944-01-01","1944-01-01","1944-01-01","1944-01-01","1944-01-01","1945-01-01","1945-01-01","1945-01-01","1945-01-01","1945-01-01","1945-01-01","1945-01-01","1946-01-01","1946-01-01","1946-01-01","1946-01-01","1946-01-01","1946-01-01","1946-01-01","1947-01-01","1947-01-01","1947-01-01","1947-01-01","1947-01-01","1947-01-01","1947-01-01","1948-01-01","1948-01-01","1948-01-01","1948-01-01","1948-01-01","1948-01-01","1948-01-01","1949-01-01","1949-01-01","1949-01-01","1949-01-01","1949-01-01","1949-01-01","1949-01-01","1950-01-01","1950-01-01","1950-01-01","1950-01-01","1950-01-01","1950-01-01","1950-01-01","1951-01-01","1951-01-01","1951-01-01","1951-01-01","1951-01-01","1951-01-01","1951-01-01","1952-01-01","1952-01-01","1952-01-01","1952-01-01","1952-01-01","1952-01-01","1952-01-01","1953-01-01","1953-01-01","1953-01-01","1953-01-01","1953-01-01","1953-01-01","1953-01-01","1954-01-01","1954-01-01","1954-01-01","1954-01-01","1954-01-01","1954-01-01","1954-01-01","1955-01-01","1955-01-01","1955-01-01","1955-01-01","1955-01-01","1955-01-01","1955-01-01","1956-01-01","1956-01-01","1956-01-01","1956-01-01","1956-01-01","1956-01-01","1956-01-01","1957-01-01","1957-01-01","1957-01-01","1957-01-01","1957-01-01","1957-01-01","1957-01-01","1958-01-01","1958-01-01","1958-01-01","1958-01-01","1958-01-01","1958-01-01","1958-01-01","1959-01-01","1959-01-01","1959-01-01","1959-01-01","1959-01-01","1959-01-01","1959-01-01","1960-01-01","1960-01-01","1960-01-01","1960-01-01","1960-01-01","1960-01-01","1960-01-01","1961-01-01","1961-01-01","1961-01-01","1961-01-01","1961-01-01","1961-01-01","1961-01-01","1962-01-01","1962-01-01","1962-01-01","1962-01-01","1962-01-01","1962-01-01","1962-01-01","1963-01-01","1963-01-01","1963-01-01","1963-01-01","1963-01-01","1963-01-01","1963-01-01","1964-01-01","1964-01-01","1964-01-01","1964-01-01","1964-01-01","1964-01-01","1964-01-01","1965-01-01","1965-01-01","1965-01-01","1965-01-01","1965-01-01","1965-01-01","1965-01-01","1966-01-01","1966-01-01","1966-01-01","1966-01-01","1966-01-01","1966-01-01","1966-01-01","1967-01-01","1967-01-01","1967-01-01","1967-01-01","1967-01-01","1967-01-01","1967-01-01","1968-01-01","1968-01-01","1968-01-01","1968-01-01","1968-01-01","1968-01-01","1968-01-01","1969-01-01","1969-01-01","1969-01-01","1969-01-01","1969-01-01","1969-01-01","1969-01-01","1970-01-01","1970-01-01","1970-01-01","1970-01-01","1970-01-01","1970-01-01","1970-01-01","1971-01-01","1971-01-01","1971-01-01","1971-01-01","1971-01-01","1971-01-01","1971-01-01","1972-01-01","1972-01-01","1972-01-01","1972-01-01","1972-01-01","1972-01-01","1972-01-01","1973-01-01","1973-01-01","1973-01-01","1973-01-01","1973-01-01","1973-01-01","1973-01-01","1974-01-01","1974-01-01","1974-01-01","1974-01-01","1974-01-01","1974-01-01","1974-01-01","1975-01-01","1975-01-01","1975-01-01","1975-01-01","1975-01-01","1975-01-01","1975-01-01","1976-01-01","1976-01-01","1976-01-01","1976-01-01","1976-01-01","1976-01-01","1976-01-01","1977-01-01","1977-01-01","1977-01-01","1977-01-01","1977-01-01","1977-01-01","1977-01-01","1978-01-01","1978-01-01","1978-01-01","1978-01-01","1978-01-01","1978-01-01","1978-01-01","1979-01-01","1979-01-01","1979-01-01","1979-01-01","1979-01-01","1979-01-01","1979-01-01","1980-01-01","1980-01-01","1980-01-01","1980-01-01","1980-01-01","1980-01-01","1980-01-01","1981-01-01","1981-01-01","1981-01-01","1981-01-01","1981-01-01","1981-01-01","1981-01-01","1982-01-01","1982-01-01","1982-01-01","1982-01-01","1982-01-01","1982-01-01","1982-01-01","1983-01-01","1983-01-01","1983-01-01","1983-01-01","1983-01-01","1983-01-01","1983-01-01","1984-01-01","1984-01-01","1984-01-01","1984-01-01","1984-01-01","1984-01-01","1984-01-01","1985-01-01","1985-01-01","1985-01-01","1985-01-01","1985-01-01","1985-01-01","1985-01-01","1986-01-01","1986-01-01","1986-01-01","1986-01-01","1986-01-01","1986-01-01","1986-01-01","1987-01-01","1987-01-01","1987-01-01","1987-01-01","1987-01-01","1987-01-01","1987-01-01","1988-01-01","1988-01-01","1988-01-01","1988-01-01","1988-01-01","1988-01-01","1988-01-01","1989-01-01","1989-01-01","1989-01-01","1989-01-01","1989-01-01","1989-01-01","1989-01-01","1990-01-01","1990-01-01","1990-01-01","1990-01-01","1990-01-01","1990-01-01","1990-01-01","1991-01-01","1991-01-01","1991-01-01","1991-01-01","1991-01-01","1991-01-01","1991-01-01","1992-01-01","1992-01-01","1992-01-01","1992-01-01","1992-01-01","1992-01-01","1992-01-01","1993-01-01","1993-01-01","1993-01-01","1993-01-01","1993-01-01","1993-01-01","1993-01-01","1994-01-01","1994-01-01","1994-01-01","1994-01-01","1994-01-01","1994-01-01","1994-01-01","1995-01-01","1995-01-01","1995-01-01","1995-01-01","1995-01-01","1995-01-01","1995-01-01","1996-01-01","1996-01-01","1996-01-01","1996-01-01","1996-01-01","1996-01-01","1996-01-01","1997-01-01","1997-01-01","1997-01-01","1997-01-01","1997-01-01","1997-01-01","1997-01-01","1998-01-01","1998-01-01","1998-01-01","1998-01-01","1998-01-01","1998-01-01","1998-01-01","1999-01-01","1999-01-01","1999-01-01","1999-01-01","1999-01-01","1999-01-01","1999-01-01","2000-01-01","2000-01-01","2000-01-01","2000-01-01","2000-01-01","2000-01-01","2000-01-01","2001-01-01","2001-01-01","2001-01-01","2001-01-01","2001-01-01","2001-01-01","2001-01-01","2002-01-01","2002-01-01","2002-01-01","2002-01-01","2002-01-01","2002-01-01","2002-01-01","2003-01-01","2003-01-01","2003-01-01","2003-01-01","2003-01-01","2003-01-01","2003-01-01","2004-01-01","2004-01-01","2004-01-01","2004-01-01","2004-01-01","2004-01-01","2004-01-01","2005-01-01","2005-01-01","2005-01-01","2005-01-01","2005-01-01","2005-01-01","2005-01-01"]},"markers":null,"annotations":null,"offset":"silhouette","interactive":false,"interpolate":"cardinal","palette":"Spectral","text":"black","tooltip":"black","x_tick_interval":10,"x_tick_units":"year","x_tick_format":"%Y","y_tick_count":5,"y_tick_format":",g","top":20,"right":40,"bottom":30,"left":50,"legend":false,"legend_label":"","fill":"brewer","label_col":"black","x_scale":"date","sort":true,"order":"none"},"evals":[],"jsHooks":[]}</script>
<p>En este gráfico, la variable <em>tiempo</em> (en nuestro caso, <code>year</code>) se representa en el eje horizontal, y las franjas de colores corresponden, de abajo arriba, a los niveles ordenados del factor <code>genero</code>: la franja roja inferior a las películas de acción, la naranja inmediatamente superior a las de animación, y así hasta llegar a la franja azul de los cortometrajes. Su grueso, sobre cada año, representa el número de películas de cada género.</p>
<p>Por el momento, no se puede añadir fácilmente una leyenda al <em>streamgraph</em> producido en modo <code>interactive=FALSE</code>. Pero la gracia es producir el gráfico en modo interactivo, con <code>interactive=TRUE</code>. Entonces, al pasear el ratón sobre la figura nos muestra, en cada punto, qué categoría estamos consultando y el número de películas en ese año.</p>
<p>Además, se puede añadir a la figura un menú desplegable con los diferentes niveles del factor usado (en nuestro caso <code>genero</code>) que permite ver la evolución de ese nivel, con la función <code>sg_legend</code> aplicada al resultado de <code>streamgraph</code>.</p>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="#cb754-1" aria-hidden="true"></a><span class="kw">streamgraph</span>(sum.movies.agrup, <span class="st">&quot;genero&quot;</span>, <span class="st">&quot;valor&quot;</span>, <span class="st">&quot;year&quot;</span>,</span>
<span id="cb754-2"><a href="#cb754-2" aria-hidden="true"></a>   <span class="dt">interactive=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="#cb755-1" aria-hidden="true"></a><span class="kw">sg_legend</span>(<span class="kw">streamgraph</span>(sum.movies.agrup,<span class="st">&quot;genero&quot;</span>, </span>
<span id="cb755-2"><a href="#cb755-2" aria-hidden="true"></a>   <span class="st">&quot;valor&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="dt">interactive=</span><span class="ot">TRUE</span>), <span class="dt">show=</span><span class="ot">TRUE</span>, </span>
<span id="cb755-3"><a href="#cb755-3" aria-hidden="true"></a>    <span class="dt">label=</span><span class="st">&quot;Género: &quot;</span>)</span></code></pre></div>
<div id="htmlwidget-fb9a7c8721d5f8fb0c27" class="streamgraph html-widget" style="width:90%;height:480px;"></div>
<div id="htmlwidget-fb9a7c8721d5f8fb0c27-legend" style="width:90%" class="streamgraph html-widget-legend"><center><label style='padding-right:5px' for='htmlwidget-fb9a7c8721d5f8fb0c27-select'></label><select id='htmlwidget-fb9a7c8721d5f8fb0c27-select' style='visibility:hidden;'></select></center></div>
<script type="application/json" data-for="htmlwidget-fb9a7c8721d5f8fb0c27">{"x":{"data":{"key":["Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short","Action","Animation","Comedy","Documentary","Drama","Romance","Short"],"value":[0,1,5,5,2,0,16,1,0,8,9,5,1,27,0,0,2,2,1,0,9,3,0,8,8,2,1,37,0,0,10,4,3,0,42,0,0,6,2,4,0,17,0,1,2,4,5,0,15,0,1,6,0,1,0,12,3,1,8,1,8,0,24,0,1,7,0,14,1,29,0,0,2,2,14,3,26,1,1,2,1,14,1,21,0,1,4,0,22,5,30,2,2,11,1,13,0,22,1,1,38,1,13,0,38,2,3,22,1,16,0,35,1,6,27,0,13,2,29,0,0,18,0,14,2,15,1,3,23,1,14,2,22,2,3,29,2,17,5,20,0,0,20,0,14,3,13,1,2,23,0,23,6,17,0,4,16,1,20,8,14,1,3,19,2,20,11,17,3,2,24,0,15,7,18,0,4,36,2,27,10,21,5,3,40,2,37,17,26,3,2,32,2,41,21,20,5,6,45,4,51,9,33,0,17,60,11,74,14,54,4,26,125,7,106,53,74,5,41,146,5,138,45,91,5,63,143,6,157,33,116,6,51,159,7,167,66,107,8,49,192,7,164,61,123,17,69,192,13,140,62,122,9,85,212,4,120,47,143,14,75,209,10,153,62,127,8,76,217,11,133,53,126,17,80,183,10,179,35,127,15,85,213,16,156,45,134,16,97,242,16,139,57,141,24,100,203,19,148,40,145,18,74,165,26,129,26,123,11,68,157,14,118,32,101,15,51,126,22,122,28,84,10,66,144,12,135,32,101,14,61,137,7,162,41,85,21,79,172,12,179,35,107,18,80,179,9,187,43,100,14,72,166,11,167,27,99,17,71,187,13,191,39,105,18,69,178,12,194,31,90,21,63,178,13,183,44,92,23,70,168,12,177,47,96,13,61,154,15,220,49,93,13,56,143,17,183,38,83,13,41,142,13,236,44,68,16,36,141,10,219,42,53,24,31,143,13,186,42,50,19,27,126,13,224,35,38,28,30,135,12,186,32,49,25,35,163,11,210,30,53,30,21,164,19,199,32,43,39,28,160,21,189,34,46,29,58,175,29,158,20,85,32,50,176,20,168,20,86,40,43,193,38,200,39,79,45,46,166,37,223,29,79,46,23,164,22,266,31,44,31,12,156,32,252,28,30,55,23,155,40,260,25,42,59,11,146,31,238,19,27,68,9,150,24,258,22,27,85,18,130,27,258,32,25,63,20,148,36,244,32,44,82,16,148,38,250,26,36,79,20,152,24,246,27,26,64,22,151,39,231,30,35,65,20,160,27,248,38,32,72,13,184,33,230,41,38,62,19,178,31,243,43,22,83,18,172,40,255,34,39,78,25,166,31,265,41,33,83,26,190,45,278,57,38,108,33,213,45,256,59,52,131,29,204,31,289,44,40,109,35,252,49,339,55,56,94,37,249,42,332,67,50,132,37,239,37,324,63,63,134,21,232,41,321,65,50,97,37,250,46,330,76,68,120,30,240,74,347,77,75,137,32,254,60,381,84,95,147,41,309,94,435,97,141,161,52,281,84,493,116,165,159,52,352,98,493,127,194,162,49,404,133,555,161,217,144,61,451,133,634,160,279,160,85,562,156,694,184,408,154,89,561,175,793,207,449,169,82,582,196,837,211,468,176,81,591,249,929,245,533,180,94,642,261,899,215,555,147,56,597,258,805,169,480,43,10,123,35,137,37,54],"date":["1900-01-01","1900-01-01","1900-01-01","1900-01-01","1900-01-01","1900-01-01","1900-01-01","1901-01-01","1901-01-01","1901-01-01","1901-01-01","1901-01-01","1901-01-01","1901-01-01","1902-01-01","1902-01-01","1902-01-01","1902-01-01","1902-01-01","1902-01-01","1902-01-01","1903-01-01","1903-01-01","1903-01-01","1903-01-01","1903-01-01","1903-01-01","1903-01-01","1904-01-01","1904-01-01","1904-01-01","1904-01-01","1904-01-01","1904-01-01","1904-01-01","1905-01-01","1905-01-01","1905-01-01","1905-01-01","1905-01-01","1905-01-01","1905-01-01","1906-01-01","1906-01-01","1906-01-01","1906-01-01","1906-01-01","1906-01-01","1906-01-01","1907-01-01","1907-01-01","1907-01-01","1907-01-01","1907-01-01","1907-01-01","1907-01-01","1908-01-01","1908-01-01","1908-01-01","1908-01-01","1908-01-01","1908-01-01","1908-01-01","1909-01-01","1909-01-01","1909-01-01","1909-01-01","1909-01-01","1909-01-01","1909-01-01","1910-01-01","1910-01-01","1910-01-01","1910-01-01","1910-01-01","1910-01-01","1910-01-01","1911-01-01","1911-01-01","1911-01-01","1911-01-01","1911-01-01","1911-01-01","1911-01-01","1912-01-01","1912-01-01","1912-01-01","1912-01-01","1912-01-01","1912-01-01","1912-01-01","1913-01-01","1913-01-01","1913-01-01","1913-01-01","1913-01-01","1913-01-01","1913-01-01","1914-01-01","1914-01-01","1914-01-01","1914-01-01","1914-01-01","1914-01-01","1914-01-01","1915-01-01","1915-01-01","1915-01-01","1915-01-01","1915-01-01","1915-01-01","1915-01-01","1916-01-01","1916-01-01","1916-01-01","1916-01-01","1916-01-01","1916-01-01","1916-01-01","1917-01-01","1917-01-01","1917-01-01","1917-01-01","1917-01-01","1917-01-01","1917-01-01","1918-01-01","1918-01-01","1918-01-01","1918-01-01","1918-01-01","1918-01-01","1918-01-01","1919-01-01","1919-01-01","1919-01-01","1919-01-01","1919-01-01","1919-01-01","1919-01-01","1920-01-01","1920-01-01","1920-01-01","1920-01-01","1920-01-01","1920-01-01","1920-01-01","1921-01-01","1921-01-01","1921-01-01","1921-01-01","1921-01-01","1921-01-01","1921-01-01","1922-01-01","1922-01-01","1922-01-01","1922-01-01","1922-01-01","1922-01-01","1922-01-01","1923-01-01","1923-01-01","1923-01-01","1923-01-01","1923-01-01","1923-01-01","1923-01-01","1924-01-01","1924-01-01","1924-01-01","1924-01-01","1924-01-01","1924-01-01","1924-01-01","1925-01-01","1925-01-01","1925-01-01","1925-01-01","1925-01-01","1925-01-01","1925-01-01","1926-01-01","1926-01-01","1926-01-01","1926-01-01","1926-01-01","1926-01-01","1926-01-01","1927-01-01","1927-01-01","1927-01-01","1927-01-01","1927-01-01","1927-01-01","1927-01-01","1928-01-01","1928-01-01","1928-01-01","1928-01-01","1928-01-01","1928-01-01","1928-01-01","1929-01-01","1929-01-01","1929-01-01","1929-01-01","1929-01-01","1929-01-01","1929-01-01","1930-01-01","1930-01-01","1930-01-01","1930-01-01","1930-01-01","1930-01-01","1930-01-01","1931-01-01","1931-01-01","1931-01-01","1931-01-01","1931-01-01","1931-01-01","1931-01-01","1932-01-01","1932-01-01","1932-01-01","1932-01-01","1932-01-01","1932-01-01","1932-01-01","1933-01-01","1933-01-01","1933-01-01","1933-01-01","1933-01-01","1933-01-01","1933-01-01","1934-01-01","1934-01-01","1934-01-01","1934-01-01","1934-01-01","1934-01-01","1934-01-01","1935-01-01","1935-01-01","1935-01-01","1935-01-01","1935-01-01","1935-01-01","1935-01-01","1936-01-01","1936-01-01","1936-01-01","1936-01-01","1936-01-01","1936-01-01","1936-01-01","1937-01-01","1937-01-01","1937-01-01","1937-01-01","1937-01-01","1937-01-01","1937-01-01","1938-01-01","1938-01-01","1938-01-01","1938-01-01","1938-01-01","1938-01-01","1938-01-01","1939-01-01","1939-01-01","1939-01-01","1939-01-01","1939-01-01","1939-01-01","1939-01-01","1940-01-01","1940-01-01","1940-01-01","1940-01-01","1940-01-01","1940-01-01","1940-01-01","1941-01-01","1941-01-01","1941-01-01","1941-01-01","1941-01-01","1941-01-01","1941-01-01","1942-01-01","1942-01-01","1942-01-01","1942-01-01","1942-01-01","1942-01-01","1942-01-01","1943-01-01","1943-01-01","1943-01-01","1943-01-01","1943-01-01","1943-01-01","1943-01-01","1944-01-01","1944-01-01","1944-01-01","1944-01-01","1944-01-01","1944-01-01","1944-01-01","1945-01-01","1945-01-01","1945-01-01","1945-01-01","1945-01-01","1945-01-01","1945-01-01","1946-01-01","1946-01-01","1946-01-01","1946-01-01","1946-01-01","1946-01-01","1946-01-01","1947-01-01","1947-01-01","1947-01-01","1947-01-01","1947-01-01","1947-01-01","1947-01-01","1948-01-01","1948-01-01","1948-01-01","1948-01-01","1948-01-01","1948-01-01","1948-01-01","1949-01-01","1949-01-01","1949-01-01","1949-01-01","1949-01-01","1949-01-01","1949-01-01","1950-01-01","1950-01-01","1950-01-01","1950-01-01","1950-01-01","1950-01-01","1950-01-01","1951-01-01","1951-01-01","1951-01-01","1951-01-01","1951-01-01","1951-01-01","1951-01-01","1952-01-01","1952-01-01","1952-01-01","1952-01-01","1952-01-01","1952-01-01","1952-01-01","1953-01-01","1953-01-01","1953-01-01","1953-01-01","1953-01-01","1953-01-01","1953-01-01","1954-01-01","1954-01-01","1954-01-01","1954-01-01","1954-01-01","1954-01-01","1954-01-01","1955-01-01","1955-01-01","1955-01-01","1955-01-01","1955-01-01","1955-01-01","1955-01-01","1956-01-01","1956-01-01","1956-01-01","1956-01-01","1956-01-01","1956-01-01","1956-01-01","1957-01-01","1957-01-01","1957-01-01","1957-01-01","1957-01-01","1957-01-01","1957-01-01","1958-01-01","1958-01-01","1958-01-01","1958-01-01","1958-01-01","1958-01-01","1958-01-01","1959-01-01","1959-01-01","1959-01-01","1959-01-01","1959-01-01","1959-01-01","1959-01-01","1960-01-01","1960-01-01","1960-01-01","1960-01-01","1960-01-01","1960-01-01","1960-01-01","1961-01-01","1961-01-01","1961-01-01","1961-01-01","1961-01-01","1961-01-01","1961-01-01","1962-01-01","1962-01-01","1962-01-01","1962-01-01","1962-01-01","1962-01-01","1962-01-01","1963-01-01","1963-01-01","1963-01-01","1963-01-01","1963-01-01","1963-01-01","1963-01-01","1964-01-01","1964-01-01","1964-01-01","1964-01-01","1964-01-01","1964-01-01","1964-01-01","1965-01-01","1965-01-01","1965-01-01","1965-01-01","1965-01-01","1965-01-01","1965-01-01","1966-01-01","1966-01-01","1966-01-01","1966-01-01","1966-01-01","1966-01-01","1966-01-01","1967-01-01","1967-01-01","1967-01-01","1967-01-01","1967-01-01","1967-01-01","1967-01-01","1968-01-01","1968-01-01","1968-01-01","1968-01-01","1968-01-01","1968-01-01","1968-01-01","1969-01-01","1969-01-01","1969-01-01","1969-01-01","1969-01-01","1969-01-01","1969-01-01","1970-01-01","1970-01-01","1970-01-01","1970-01-01","1970-01-01","1970-01-01","1970-01-01","1971-01-01","1971-01-01","1971-01-01","1971-01-01","1971-01-01","1971-01-01","1971-01-01","1972-01-01","1972-01-01","1972-01-01","1972-01-01","1972-01-01","1972-01-01","1972-01-01","1973-01-01","1973-01-01","1973-01-01","1973-01-01","1973-01-01","1973-01-01","1973-01-01","1974-01-01","1974-01-01","1974-01-01","1974-01-01","1974-01-01","1974-01-01","1974-01-01","1975-01-01","1975-01-01","1975-01-01","1975-01-01","1975-01-01","1975-01-01","1975-01-01","1976-01-01","1976-01-01","1976-01-01","1976-01-01","1976-01-01","1976-01-01","1976-01-01","1977-01-01","1977-01-01","1977-01-01","1977-01-01","1977-01-01","1977-01-01","1977-01-01","1978-01-01","1978-01-01","1978-01-01","1978-01-01","1978-01-01","1978-01-01","1978-01-01","1979-01-01","1979-01-01","1979-01-01","1979-01-01","1979-01-01","1979-01-01","1979-01-01","1980-01-01","1980-01-01","1980-01-01","1980-01-01","1980-01-01","1980-01-01","1980-01-01","1981-01-01","1981-01-01","1981-01-01","1981-01-01","1981-01-01","1981-01-01","1981-01-01","1982-01-01","1982-01-01","1982-01-01","1982-01-01","1982-01-01","1982-01-01","1982-01-01","1983-01-01","1983-01-01","1983-01-01","1983-01-01","1983-01-01","1983-01-01","1983-01-01","1984-01-01","1984-01-01","1984-01-01","1984-01-01","1984-01-01","1984-01-01","1984-01-01","1985-01-01","1985-01-01","1985-01-01","1985-01-01","1985-01-01","1985-01-01","1985-01-01","1986-01-01","1986-01-01","1986-01-01","1986-01-01","1986-01-01","1986-01-01","1986-01-01","1987-01-01","1987-01-01","1987-01-01","1987-01-01","1987-01-01","1987-01-01","1987-01-01","1988-01-01","1988-01-01","1988-01-01","1988-01-01","1988-01-01","1988-01-01","1988-01-01","1989-01-01","1989-01-01","1989-01-01","1989-01-01","1989-01-01","1989-01-01","1989-01-01","1990-01-01","1990-01-01","1990-01-01","1990-01-01","1990-01-01","1990-01-01","1990-01-01","1991-01-01","1991-01-01","1991-01-01","1991-01-01","1991-01-01","1991-01-01","1991-01-01","1992-01-01","1992-01-01","1992-01-01","1992-01-01","1992-01-01","1992-01-01","1992-01-01","1993-01-01","1993-01-01","1993-01-01","1993-01-01","1993-01-01","1993-01-01","1993-01-01","1994-01-01","1994-01-01","1994-01-01","1994-01-01","1994-01-01","1994-01-01","1994-01-01","1995-01-01","1995-01-01","1995-01-01","1995-01-01","1995-01-01","1995-01-01","1995-01-01","1996-01-01","1996-01-01","1996-01-01","1996-01-01","1996-01-01","1996-01-01","1996-01-01","1997-01-01","1997-01-01","1997-01-01","1997-01-01","1997-01-01","1997-01-01","1997-01-01","1998-01-01","1998-01-01","1998-01-01","1998-01-01","1998-01-01","1998-01-01","1998-01-01","1999-01-01","1999-01-01","1999-01-01","1999-01-01","1999-01-01","1999-01-01","1999-01-01","2000-01-01","2000-01-01","2000-01-01","2000-01-01","2000-01-01","2000-01-01","2000-01-01","2001-01-01","2001-01-01","2001-01-01","2001-01-01","2001-01-01","2001-01-01","2001-01-01","2002-01-01","2002-01-01","2002-01-01","2002-01-01","2002-01-01","2002-01-01","2002-01-01","2003-01-01","2003-01-01","2003-01-01","2003-01-01","2003-01-01","2003-01-01","2003-01-01","2004-01-01","2004-01-01","2004-01-01","2004-01-01","2004-01-01","2004-01-01","2004-01-01","2005-01-01","2005-01-01","2005-01-01","2005-01-01","2005-01-01","2005-01-01","2005-01-01"]},"markers":null,"annotations":null,"offset":"silhouette","interactive":true,"interpolate":"cardinal","palette":"Spectral","text":"black","tooltip":"black","x_tick_interval":10,"x_tick_units":"year","x_tick_format":"%Y","y_tick_count":5,"y_tick_format":",g","top":20,"right":40,"bottom":30,"left":50,"legend":true,"legend_label":"Género: ","fill":"brewer","label_col":"black","x_scale":"date","sort":true,"order":"none"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="guía-rápida-4" class="section level2" number="14.6">
<h2 number="14.6"><span class="header-section-number">14.6</span> Guía rápida</h2>
<ul>
<li><p><code>VCorpus</code> del paquete <strong>tm</strong>, sirve para cargar un conjunto de documentos en un <em>VCorpus</em>. Sus dos parámetros son:</p>
<ul>
<li><p><code>x</code>: indica el lugar de donde se han de cargar los documentos. Algunos posibles valores:
<code>DirSource("directorio", encoding=...)</code> y <code>URISource("url", encoding=...)</code>.</p></li>
<li><p><code>readerControl</code>: se ha de igualar a una <code>list</code> de dos componentes: <code>reader</code>, que indica la función con la que se han de leer los documentos, y <code>language</code>, que indica el idioma de los documentos. Si los ficheros son de texto, no es necesario especificar la componente <code>reader</code>.</p></li>
</ul></li>
<li><p><code>inspect</code> del paquete <strong>tm</strong>, nos da el número de documentos de un <em>VCorpus</em> y, de cada uno de ellos, su formato y su número de caracteres.</p></li>
<li><p><code>writeLines(as.character(documento))</code> escribe el <code>documento</code> en la consola.</p></li>
<li><p><code>tm_map(VCorpus, "transformación")</code> del paquete <strong>tm</strong>, aplica la <code>transformación</code> a todos los documentos del <code>VCorpus</code>. Algunas transformaciones:</p>
<ul>
<li><p><code>"tolower"</code>: convierte todas las letras en minúsculas.</p></li>
<li><p><code>"removePunctuation"</code>: elimina los signos de puntuación.</p></li>
<li><p><code>"removeWords"</code>: elimina las palabras del vector que se especifique.</p></li>
<li><p><code>"stripWhitespace"</code>: elimina los espacios en blanco extra.</p></li>
<li><p><code>"removeNumbers"</code>: elimina los números.</p></li>
<li><p><code>"stemDocument"</code>: cargando el paquete <strong>SnowballC</strong>, se queda sólo con las raíces de algunas palabras.</p></li>
</ul></li>
<li><p><code>stopwords</code> del paquete <strong>tm</strong>, aplicada al nombre de un idioma, entrecomillado, produce una lista de palabras <em>comodín</em> de este idioma.</p></li>
<li><p><code>wordcloud</code> del paquete <strong>wordcloud</strong>, produce una nube de palabras del documento al que se aplica. Algunos parámetros destacables:</p>
<ul>
<li><p><code>scale</code>: un vector de longitud 2 que sirve para indicar el tamaño relativo de las palabras de mayor y menor frecuencia.</p></li>
<li><p><code>max.words</code>: el número máximo de palabras a mostrar.</p></li>
<li><p><code>min.freq</code>: la frecuencia mínima necesaria para que una palabra aparezca en el gráfico.</p></li>
<li><p><code>rot.per</code>: la proporción de palabras que se pueden mostrar giradas 90 grados.</p></li>
<li><p><code>colors</code>: la paleta de colores usada para representar las frecuencias.</p></li>
</ul></li>
<li><p><code>heatmap</code> produce el mapa de calor, o <em>heatmap</em>, de la matriz a la que se aplica. Algunos parámetros importantes:</p>
<ul>
<li><p><code>Rowv</code> y <code>Colv</code>: igualados a <code>NA</code>, impiden que se añadan dendrogramas de las filas y las columnas en los márgenes.</p></li>
<li><p><code>revC</code>: igualado a <code>TRUE</code> invierte el orden de las columnas.</p></li>
</ul></li>
<li><p><code>corrplot</code> del paquete <strong>corrplot</strong>, produce el <em>heatmap</em> de la matriz de correlaciones a la que se aplica. Algunos parámetros importantes:</p>
<ul>
<li><p><code>method</code>: especifica la forma de las casillas; algunos valores posibles son <code>circle</code> (círculos, el valor por defecto), <code>square</code> (cuadrados), <code>shade</code> (la casilla sombreada).</p></li>
<li><p><code>addshade</code>: cuando usamos <code>method=shade</code>, permite especificar si queremos marcar las casillas correspondientes a correlación positiva o negativa (o ambas), mediante rectas de pendiente positiva o negativa.</p></li>
<li><p><code>shade.col</code>: permite especificar el color de las rectas anteriores; igualado a <code>NA</code>, no las añade.</p></li>
<li><p><code>tl.col</code>: el color de las etiquetas de filas y columnas.</p></li>
<li><p><code>tl.srt</code>: la inclinación de las etiquetas de filas y columnas.</p></li>
<li><p><code>addCoef.col</code>: igualado a un color, especifica que se escriban en cada casilla la entrada correspondiente de la matriz en ese color.</p></li>
<li><p><code>dist</code>, aplicada a una matriz o a un <em>data frame</em> de variables numéricas, calcula la matriz de distancias entre sus filas. El tipo de distancia se especifica con el parámetro <code>method</code> y por defecto es la euclídea.</p></li>
</ul></li>
<li><p><code>hclust</code> calcula un <em>clustering</em> jerárquico de una matriz de distancias calculada por medio de <code>dist</code>.
El parámetro <code>method</code> permite especificar el algoritmo concreto.</p></li>
<li><p><code>as.dendrogram</code> transforma el resultado de <code>hclust</code> en un dendrograma.</p></li>
<li><p><code>plot</code>, aplicado a un dendrograma, lo dibuja. En este contexto, aparte de los parámetros usuales, se dispone de varios parámetros específicos, entre los que destacamos:</p>
<ul>
<li><p><code>type=triangle</code>: dibuja las ramificaciones triangulares en vez de rectangulares.</p></li>
<li><p><code>horiz=TRUE</code>: dibuja el dendrograma horizontal.</p></li>
</ul></li>
<li><p><code>labels</code>, aplicada a un dendrograma, nos da las etiquetas de sus hojas de izquierda a derecha y, si está cargado el paquete <code>dendextend</code>, permite también cambiar los nombres de estas etiquetas.</p></li>
<li><p><code>set(dendrograma, what="característica", valor)</code> del paquete
<strong>dendextend</strong>, permite modificar la <code>característica</code> del <code>dendrograma</code>. Algunas características útiles:</p>
<ul>
<li><code>labels</code>: los nombres de las etiquetas.</li>
<li><code>labels_col</code>: los colores de las etiquetas.</li>
<li><code>labels_cex</code>: el tamaño de las etiquetas.</li>
</ul></li>
</ul>
<p>La lista completa se puede consultar en la Ayuda de la función.</p>
<ul>
<li><p><code>%&gt;%</code> permite indicar la aplicación sucesiva de funciones, cada una al resultado de la aplicación anterior. Así
<code>x%&gt;%f(Y)%&gt;%g(Z)</code>
toma el objeto <code>x</code>, le aplica la función <code>f</code> con parámetros <code>Y</code> y al resultado le aplica la función <code>g</code> con parámetros <code>Z</code>; es decir, calcula <code>g(f(x,Y),Z)</code>. Esta notación solo está disponible en algunos paquetes (por ejemplo, <code>dendextend</code> y <code>streamgraph</code>).</p></li>
<li><p><code>circlize_dendrogram</code> del paquete <strong>circlize</strong>, dibuja un dendrograma en forma circular.</p></li>
<li><p><code>symbols(x, y, parámetro_figura=z)</code> dibuja, en cada uno de los puntos de abscisa una entrada del vector <code>x</code> y ordenada la correspondiente entrada del vector <code>y</code>, una figura del tipo especificado por el <code>parámetro_figura</code>.
(<code>circles</code> para círculos, <code>squares</code> para cuadrados, <code>stars</code> para estrellas, etc.)
de dimensión lineal la especificada por la entrada correspondiente del vector <span class="math inline">\(z\)</span>. Otros parámetros de interés, aparte de los usuales de la función <code>plot</code>:</p>
<ul>
<li><p><code>fg</code>: el color de la frontera de los símbolos.</p></li>
<li><p><code>bg</code>: su color de relleno.</p></li>
</ul></li>
<li><p><code>install_github("url")</code> del paquete <strong>devtools</strong>, instala un paquete del que conocemos su <em>url</em> en <em>GitHub</em>.</p></li>
<li><p><code>gather</code> del paquete <strong>tidyr</strong>, sustituye en un <em>data frame</em> un conjunto de variables numéricas por dos variables: un factor cuyos niveles son los nombres de las variables numéricas originales y una variable numérica nueva que da, para cada nivel de ese factor, el valor de la variable original. De esta manera, cada fila del <em>data frame</em> original se desdobla en tantas filas como variables hemos agrupado en el nuevo factor.</p></li>
<li><p><code>streamgraph</code> del paquete <strong>streamgraph</strong>, dibuja el <em>streamgraph</em> de tres variables de un <em>data frame</em>: una variable temporal, un factor, y una variable que para cada valor de la variable temporal y para cada nivel del factor nos da un valor numérico. Dispone del parámetro <code>interactive</code>, que igualado a <code>FALSE</code> produce un gráfico estático e igualado a <code>TRUE</code> produce un gráfico interactivo.</p></li>
<li><p><code>sg_legend</code> del paquete <strong>streamgraph</strong>, aplicada a un <em>streamgraph</em> producido en modo interactivo y a los parámetros <code>show=TRUE</code> y <code>label</code> igualado a un nombre que represente el factor del <em>streamgraph</em>, añade un menú desplegable con los diferentes valores del factor.</p></li>
</ul>
<!--chapter:end:14cap13_EDextra.Rmd-->
</div>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
